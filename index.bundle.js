!function(t){var e={};function F(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,F),o.l=!0,o.exports}F.m=t,F.c=e,F.d=function(t,e,n){F.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},F.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},F.t=function(t,e){if(1&e&&(t=F(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(F.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)F.d(n,o,function(e){return t[e]}.bind(null,o));return n},F.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return F.d(e,"a",e),e},F.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},F.p="",F(F.s=0)}([function(t,e,F){"use strict";F.r(e);function n(){}const o=t=>t;function r(t,e){for(const F in e)t[F]=e[F];return t}function i(t){return t()}function a(){return Object.create(null)}function s(t){t.forEach(i)}function l(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let u;function d(t,e){return u||(u=document.createElement("a")),u.href=e,t===u.href}function f(t){return 0===Object.keys(t).length}function v(t,...e){if(null==t)return n;const F=t.subscribe(...e);return F.unsubscribe?()=>F.unsubscribe():F}const p="undefined"!=typeof window;let m=p?()=>window.performance.now():()=>Date.now(),H=p?t=>requestAnimationFrame(t):n;const g=new Set;function h(t){g.forEach(e=>{e.c(t)||(g.delete(e),e.f())}),0!==g.size&&H(h)}function y(t){let e;return 0===g.size&&H(h),{promise:new Promise(F=>{g.add(e={c:t,f:F})}),abort(){g.delete(e)}}}let x=!1;function b(t,e){t.appendChild(e)}function w(t,e,F){const n=_(t);if(!n.getElementById(e)){const t=S("style");t.id=e,t.textContent=F,$(n,t)}}function _(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function $(t,e){b(t.head||t,e)}function k(t,e,F){t.insertBefore(e,F||null)}function C(t){t.parentNode.removeChild(t)}function S(t){return document.createElement(t)}function z(t){return document.createTextNode(t)}function E(){return z(" ")}function A(t,e,F,n){return t.addEventListener(e,F,n),()=>t.removeEventListener(e,F,n)}function j(t,e,F){null==F?t.removeAttribute(e):t.getAttribute(e)!==F&&t.setAttribute(e,F)}function T(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,F,n){null===F?t.style.removeProperty(e):t.style.setProperty(e,F,n?"important":"")}function M(t,e){for(let F=0;F<t.options.length;F+=1){const n=t.options[F];if(n.__value===e)return void(n.selected=!0)}t.selectedIndex=-1}function P(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function R(t,e,F){t.classList[F?"add":"remove"](e)}new Map;let D;function I(t){D=t}function L(){if(!D)throw new Error("Function called outside component initialization");return D}function q(t){L().$$.on_mount.push(t)}const B=[],G=[],Y=[],N=[],X=Promise.resolve();let J=!1;function K(){J||(J=!0,X.then(W))}function Q(t){Y.push(t)}const U=new Set;let V=0;function W(){const t=D;do{for(;V<B.length;){const t=B[V];V++,I(t),Z(t.$$)}for(I(null),B.length=0,V=0;G.length;)G.pop()();for(let t=0;t<Y.length;t+=1){const e=Y[t];U.has(e)||(U.add(e),e())}Y.length=0}while(B.length);for(;N.length;)N.pop()();J=!1,U.clear(),I(t)}function Z(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}const tt=new Set;let et;function Ft(){et={r:0,c:[],p:et}}function nt(){et.r||s(et.c),et=et.p}function ot(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function rt(t,e,F,n){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push(()=>{tt.delete(t),n&&(F&&t.d(1),n())}),t.o(e)}else n&&n()}const it="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let at;function st(t,e,F,n){const{fragment:o,on_mount:r,on_destroy:a,after_update:c}=t.$$;o&&o.m(e,F),n||Q(()=>{const e=r.map(i).filter(l);a?a.push(...e):s(e),t.$$.on_mount=[]}),c.forEach(Q)}function lt(t,e){const F=t.$$;null!==F.fragment&&(s(F.on_destroy),F.fragment&&F.fragment.d(e),F.on_destroy=F.fragment=null,F.ctx=[])}function ct(t,e,F,o,r,i,l,c=[-1]){const u=D;I(t);const d=t.$$={fragment:null,ctx:null,props:i,update:n,not_equal:r,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:a(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};l&&l(d.root);let f=!1;if(d.ctx=F?F(t,e.props||{},(e,F,...n)=>{const o=n.length?n[0]:F;return d.ctx&&r(d.ctx[e],d.ctx[e]=o)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](o),f&&function(t,e){-1===t.$$.dirty[0]&&(B.push(t),K(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),F}):[],d.update(),f=!0,s(d.before_update),d.fragment=!!o&&o(d.ctx),e.target){if(e.hydrate){x=!0;const t=(v=e.target,Array.from(v.childNodes));d.fragment&&d.fragment.l(t),t.forEach(C)}else d.fragment&&d.fragment.c();e.intro&&ot(t.$$.fragment),st(t,e.target,e.anchor,e.customElement),x=!1,W()}var v;I(u)}"function"==typeof HTMLElement&&(at=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(i).filter(l);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,F){this[t]=F}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){lt(this,1),this.$destroy=n}$on(t,e){const F=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return F.push(e),()=>{const t=F.indexOf(e);-1!==t&&F.splice(t,1)}}$set(t){this.$$set&&!f(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class ut{$destroy(){lt(this,1),this.$destroy=n}$on(t,e){const F=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return F.push(e),()=>{const t=F.indexOf(e);-1!==t&&F.splice(t,1)}}$set(t){this.$$set&&!f(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function dt(t){let e,F,o,r,i,a,s,l,c,u,f,v,p,m,H,g,h=t[0]+1+"";return{c(){e=S("div"),F=S("img"),r=E(),i=S("div"),a=S("p"),s=z("Trajectory after curriculum step "),l=z(h),c=E(),u=S("input"),f=E(),v=S("p"),p=z("Move the slider to change the step!"),d(F.src,o="images/trajectories"+t[0]+".svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the trajectories of the RL agent on the map"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","0"),j(u,"max",ft),u.value="0",j(v,"style",m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(e,"display","flex"),O(e,"flex-direction","column"),O(e,"align-items","center")},m(n,o){k(n,e,o),b(e,F),b(e,r),b(e,i),b(i,a),b(a,s),b(a,l),b(i,c),b(i,u),b(i,f),b(i,v),b(v,p),H||(g=A(u,"input",t[2]),H=!0)},p(t,[e]){1&e&&!d(F.src,o="images/trajectories"+t[0]+".svg")&&j(F,"src",o),1&e&&h!==(h=t[0]+1+"")&&T(l,h),2&e&&m!==(m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;"))&&j(v,"style",m)},i:n,o:n,d(t){t&&C(e),H=!1,g()}}}const ft=5;function vt(t,e,F){let n=0,o=!1;return[n,o,function(t){o||F(1,o=!0),F(0,n=parseInt(t.target.value))}]}var pt=class extends ut{constructor(t){super(),ct(this,t,vt,dt,c,{})}};function mt(t){let e,F,o,r,i,a,s,l,c,u,f,v,p,m,H,g;return{c(){e=S("div"),F=S("img"),r=E(),i=S("div"),a=S("p"),s=z("x = "),l=z(t[0]),c=E(),u=S("input"),f=E(),v=S("p"),p=z("Move the slider to change x!"),d(F.src,o="images/16x16_back"+t[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the back curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","1"),j(u,"max",Ht),u.value="0",j(v,"style",m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(e,"display","flex"),O(e,"flex-direction","column"),O(e,"align-items","center")},m(n,o){k(n,e,o),b(e,F),b(e,r),b(e,i),b(i,a),b(a,s),b(a,l),b(i,c),b(i,u),b(i,f),b(i,v),b(v,p),H||(g=A(u,"input",t[2]),H=!0)},p(t,[e]){1&e&&!d(F.src,o="images/16x16_back"+t[0]+"_successes.svg")&&j(F,"src",o),1&e&&T(l,t[0]),2&e&&m!==(m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;"))&&j(v,"style",m)},i:n,o:n,d(t){t&&C(e),H=!1,g()}}}const Ht=9;function gt(t,e,F){let n=1,o=!1;return[n,o,function(t){o||F(1,o=!0),F(0,n=parseInt(t.target.value))}]}var ht=class extends ut{constructor(t){super(),ct(this,t,gt,mt,c,{})}};function yt(t){let e,F,o,r,i,a,s,l,c,u,f,v,p,m,H,g;return{c(){e=S("div"),F=S("img"),r=E(),i=S("div"),a=S("p"),s=z("x = "),l=z(t[0]),c=E(),u=S("input"),f=E(),v=S("p"),p=z("Move the slider to change x!"),d(F.src,o="images/16x16_incremental"+t[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the incremental curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","0"),j(u,"max",xt),u.value="0",j(v,"style",m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(e,"display","flex"),O(e,"flex-direction","column"),O(e,"align-items","center")},m(n,o){k(n,e,o),b(e,F),b(e,r),b(e,i),b(i,a),b(a,s),b(a,l),b(i,c),b(i,u),b(i,f),b(i,v),b(v,p),H||(g=A(u,"input",t[2]),H=!0)},p(t,[e]){1&e&&!d(F.src,o="images/16x16_incremental"+t[0]+"_successes.svg")&&j(F,"src",o),1&e&&T(l,t[0]),2&e&&m!==(m="height: 1em; transition: 1s opacity; "+(t[1]&&"opacity: 0;"))&&j(v,"style",m)},i:n,o:n,d(t){t&&C(e),H=!1,g()}}}const xt=4;function bt(t,e,F){let n=0,o=!1;return[n,o,function(t){o||F(1,o=!0),F(0,n=parseInt(t.target.value))}]}var wt=class extends ut{constructor(t){super(),ct(this,t,bt,yt,c,{})}};const _t=[];function $t(t,e=n){let F;const o=new Set;function r(e){if(c(t,e)&&(t=e,F)){const e=!_t.length;for(const e of o)e[1](),_t.push(e,t);if(e){for(let t=0;t<_t.length;t+=2)_t[t][0](_t[t+1]);_t.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(i,a=n){const s=[i,a];return o.add(s),1===o.size&&(F=e(r)||n),i(t),()=>{o.delete(s),0===o.size&&(F(),F=null)}}}}function kt(t){const e=t-1;return e*e*e+1}function Ct(t){return"[object Date]"===Object.prototype.toString.call(t)}function St(t,e){if(t===e||t!=t)return()=>t;const F=typeof t;if(F!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const F=e.map((e,F)=>St(t[F],e));return t=>F.map(e=>e(t))}if("object"===F){if(!t||!e)throw new Error("Object cannot be null");if(Ct(t)&&Ct(e)){t=t.getTime();const F=(e=e.getTime())-t;return e=>new Date(t+e*F)}const F=Object.keys(e),n={};return F.forEach(F=>{n[F]=St(t[F],e[F])}),t=>{const e={};return F.forEach(F=>{e[F]=n[F](t)}),e}}if("number"===F){const F=e-t;return e=>t+e*F}throw new Error(`Cannot interpolate ${F} values`)}function zt(t){w(t,"svelte-io58ff",".confetti-holder.svelte-io58ff.svelte-io58ff{position:relative}@keyframes svelte-io58ff-rotate{0%{transform:skew(var(--skew)) rotate3d(var(--full-rotation))}100%{transform:skew(var(--skew)) rotate3d(var(--rotation-xyz), calc(var(--rotation-deg) + 360deg))}}@keyframes svelte-io58ff-translate{0%{opacity:1}8%{transform:translateY(calc(var(--translate-y) * 0.95)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.9)));opacity:1}12%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.95)));opacity:1}16%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * var(--x-spread)));opacity:1}100%{transform:translateY(calc(var(--translate-y) + var(--fall-distance))) translateX(var(--translate-x));opacity:0}}@keyframes svelte-io58ff-no-gravity-translate{0%{opacity:1}100%{transform:translateY(var(--translate-y)) translateX(var(--translate-x));opacity:0}}.confetti.svelte-io58ff.svelte-io58ff{--translate-y:calc(-200px * var(--translate-y-multiplier));--translate-x:calc(200px * var(--translate-x-multiplier));position:absolute;height:calc(var(--size) * var(--scale));width:calc(var(--size) * var(--scale));animation:svelte-io58ff-translate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;opacity:0;pointer-events:none}.confetti.svelte-io58ff.svelte-io58ff::before{--full-rotation:var(--rotation-xyz), var(--rotation-deg);content:'';display:block;width:100%;height:100%;background:var(--color);background-size:contain;transform:skew(var(--skew)) rotate3d(var(--full-rotation));animation:svelte-io58ff-rotate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear}.rounded.svelte-io58ff .confetti.svelte-io58ff::before{border-radius:50%}.cone.svelte-io58ff .confetti.svelte-io58ff{--translate-x:calc(200px * var(--translate-y-multiplier) * var(--translate-x-multiplier))}.no-gravity.svelte-io58ff .confetti.svelte-io58ff{animation-name:svelte-io58ff-no-gravity-translate;animation-timing-function:ease-out}@media(prefers-reduced-motion){.confetti.svelte-io58ff.svelte-io58ff,.confetti.svelte-io58ff.svelte-io58ff::before{animation:none}}")}function Et(t,e,F){const n=t.slice();return n[18]=e[F],n}function At(t){let e,F={length:t[6]},n=[];for(let e=0;e<F.length;e+=1)n[e]=jt(Et(t,F,e));return{c(){e=S("div");for(let t=0;t<n.length;t+=1)n[t].c();j(e,"class","confetti-holder svelte-io58ff"),R(e,"rounded",t[9]),R(e,"cone",t[10]),R(e,"no-gravity",t[11])},m(t,F){k(t,e,F);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,o){if(20991&o){let r;for(F={length:t[6]},r=0;r<F.length;r+=1){const i=Et(t,F,r);n[r]?n[r].p(i,o):(n[r]=jt(i),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=F.length}512&o&&R(e,"rounded",t[9]),1024&o&&R(e,"cone",t[10]),2048&o&&R(e,"no-gravity",t[11])},d(t){t&&C(e),function(t,e){for(let F=0;F<t.length;F+=1)t[F]&&t[F].d(e)}(n,t)}}}function jt(t){let e;return{c(){e=S("div"),j(e,"class","confetti svelte-io58ff"),O(e,"--fall-distance",t[8]),O(e,"--size",t[0]+"px"),O(e,"--color",t[14]()),O(e,"--skew",Ot(-45,45)+"deg,"+Ot(-45,45)+"deg"),O(e,"--rotation-xyz",Ot(-10,10)+", "+Ot(-10,10)+", "+Ot(-10,10)),O(e,"--rotation-deg",Ot(0,360)+"deg"),O(e,"--translate-y-multiplier",Ot(t[2][0],t[2][1])),O(e,"--translate-x-multiplier",Ot(t[1][0],t[1][1])),O(e,"--scale",.1*Ot(2,10)),O(e,"--transition-duration",t[4]?`calc(${t[3]}ms * var(--scale))`:t[3]+"ms"),O(e,"--transition-delay",Ot(t[5][0],t[5][1])+"ms"),O(e,"--transition-iteration-count",t[4]?"infinite":t[7]),O(e,"--x-spread",1-t[12])},m(t,F){k(t,e,F)},p(t,F){256&F&&O(e,"--fall-distance",t[8]),1&F&&O(e,"--size",t[0]+"px"),4&F&&O(e,"--translate-y-multiplier",Ot(t[2][0],t[2][1])),2&F&&O(e,"--translate-x-multiplier",Ot(t[1][0],t[1][1])),24&F&&O(e,"--transition-duration",t[4]?`calc(${t[3]}ms * var(--scale))`:t[3]+"ms"),32&F&&O(e,"--transition-delay",Ot(t[5][0],t[5][1])+"ms"),144&F&&O(e,"--transition-iteration-count",t[4]?"infinite":t[7]),4096&F&&O(e,"--x-spread",1-t[12])},d(t){t&&C(e)}}}function Tt(t){let e,F=!t[13]&&At(t);return{c(){F&&F.c(),e=z("")},m(t,n){F&&F.m(t,n),k(t,e,n)},p(t,[n]){t[13]?F&&(F.d(1),F=null):F?F.p(t,n):(F=At(t),F.c(),F.m(e.parentNode,e))},i:n,o:n,d(t){F&&F.d(t),t&&C(e)}}}function Ot(t,e){return Math.random()*(e-t)+t}function Mt(t,e,F){let{size:n=10}=e,{x:o=[-.5,.5]}=e,{y:r=[.25,1]}=e,{duration:i=2e3}=e,{infinite:a=!1}=e,{delay:s=[0,50]}=e,{colorRange:l=[0,360]}=e,{colorArray:c=[]}=e,{amount:u=50}=e,{iterationCount:d=1}=e,{fallDistance:f="100px"}=e,{rounded:v=!1}=e,{cone:p=!1}=e,{noGravity:m=!1}=e,{xSpread:H=.15}=e,{destroyOnComplete:g=!0}=e,h=!1;return q(()=>{g&&!a&&"infinite"!=d&&setTimeout(()=>F(13,h=!0),(i+s[1])*d)}),t.$$set=t=>{"size"in t&&F(0,n=t.size),"x"in t&&F(1,o=t.x),"y"in t&&F(2,r=t.y),"duration"in t&&F(3,i=t.duration),"infinite"in t&&F(4,a=t.infinite),"delay"in t&&F(5,s=t.delay),"colorRange"in t&&F(15,l=t.colorRange),"colorArray"in t&&F(16,c=t.colorArray),"amount"in t&&F(6,u=t.amount),"iterationCount"in t&&F(7,d=t.iterationCount),"fallDistance"in t&&F(8,f=t.fallDistance),"rounded"in t&&F(9,v=t.rounded),"cone"in t&&F(10,p=t.cone),"noGravity"in t&&F(11,m=t.noGravity),"xSpread"in t&&F(12,H=t.xSpread),"destroyOnComplete"in t&&F(17,g=t.destroyOnComplete)},[n,o,r,i,a,s,u,d,f,v,p,m,H,h,function(){return c.length?c[Math.round(Math.random()*(c.length-1))]:`hsl(${Math.round(Ot(l[0],l[1]))}, 75%, 50%`},l,c,g]}var Pt=class extends ut{constructor(t){super(),ct(this,t,Mt,Tt,c,{size:0,x:1,y:2,duration:3,infinite:4,delay:5,colorRange:15,colorArray:16,amount:6,iterationCount:7,fallDistance:8,rounded:9,cone:10,noGravity:11,xSpread:12,destroyOnComplete:17},zt)}};const Rt={small:["SFFFFFFFFF","FFFFFFFFFF","HFFFFFFFFF","FFHFFFFFFF","HFFFFHFFFF","FFHFFFHFFF","HFFFFHFFFF","FFHFFFFFFF","HFFFFFFFFF","FFFGFFFFFF"],"16x16":["HHFFFFFFFFFFFFHH","HFFFFFFFFFFFFFFH","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHFFFFHHHFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFGFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHHHHHHHHFFF","FFFFHHHHHHHHFFFF","FFFFFFFFFFFFFFFF","HFFFFFFFSFFFFFFH","HHFFFFFFFFFFFFHH"],"32x32":["HHHHHHFFFFFFFFFFFFFFFFFHHHHHHHHH","HHFFFFFFFFFFFFFFFFFFFFFFHHHHHHHH","FFFFSFFFHHFFFFFFFFFFFFFFFFFFFFFH","FFFFFFFFFHFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHFFFFFFFFFHHHHHHHHFFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHHFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHFFFFFFFFFF","HHFFHHHHHHHHHHHHFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFHHHHHFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFHHFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHF","FFFFFFFFFFFFFFFFFFFFFFFFFFFHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFGFFFFFFFHFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFHFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHFFHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFFFFFFFFFHFFFFFFFF","HHHHHHHFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHHHHHHHHFFFFFFFFFFFFFFFFFFFF"]},Dt={H:"#1976d2",S:"#ef9a9a",F:"#e1f5fe",G:"#81c784",T:"#ffe0b2"};const{window:It}=it;function Lt(t){w(t,"svelte-1t9covs","canvas.svelte-1t9covs.svelte-1t9covs{padding:1em\n  }.game.svelte-1t9covs.svelte-1t9covs{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-bottom:1.5em}.controls.svelte-1t9covs.svelte-1t9covs{display:flex;flex-direction:column;align-items:center}.status.svelte-1t9covs.svelte-1t9covs{height:1em;width:16em;text-align:center;transition:color 1s;padding-top:1em}.map.svelte-1t9covs.svelte-1t9covs{display:flex;flex-direction:column;align-items:center}.map.svelte-1t9covs p.svelte-1t9covs{margin:0}.menu.svelte-1t9covs.svelte-1t9covs{display:flex;flex-direction:row;align-items:center;padding:0.5em}.menu.svelte-1t9covs div.svelte-1t9covs{margin:0.3em;display:flex;flex-direction:column}.key.svelte-1t9covs.svelte-1t9covs{background-color:#eee;border-radius:4px;font-size:1em;padding:0.5em 0.5em;border-top:5px solid rgba(255, 255, 255, 0.5);border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(0, 0, 0, 0.2);border-bottom:5px solid rgba(0, 0, 0, 0.2);color:#555;text-align:center;width:4em;height:4em;cursor:pointer}@media(min-width: 768px){.game.svelte-1t9covs.svelte-1t9covs{flex-direction:row}.controls.svelte-1t9covs.svelte-1t9covs{flex-direction:column}.menu.svelte-1t9covs.svelte-1t9covs{flex-direction:column}.menu.svelte-1t9covs div.svelte-1t9covs{flex-direction:row;gap:10px}.key.svelte-1t9covs.svelte-1t9covs{width:3em;height:3em}}.keyboard.svelte-1t9covs.svelte-1t9covs{display:grid;grid-template-columns:auto auto auto;grid-gap:0.5em;padding:1em}.key.svelte-1t9covs.svelte-1t9covs:active{background-color:#ddd}")}function qt(t){let e,F;return e=new Pt({props:{cone:!0,delay:[0,200],amount:"50",x:[-.7,.7],y:[.5,1.5]}}),{c(){var t;(t=e.$$.fragment)&&t.c()},m(t,n){st(e,t,n),F=!0},i(t){F||(ot(e.$$.fragment,t),F=!0)},o(t){rt(e.$$.fragment,t),F=!1},d(t){lt(e,t)}}}function Bt(t){let e;return{c(){e=S("p"),e.textContent="Press the arrow keys to move...",j(e,"class","status svelte-1t9covs")},m(t,F){k(t,e,F)},p:n,d(t){t&&C(e)}}}function Gt(t){let e,F;return{c(){e=S("p"),F=z(t[10]),j(e,"class","status svelte-1t9covs"),O(e,"transition","color "+(t[10]?2:0)+"s"),O(e,"transition-timing-function","ease-in"),O(e,"color",t[10]?"white":"black")},m(t,n){k(t,e,n),b(e,F)},p(t,n){1024&n[0]&&T(F,t[10]),1024&n[0]&&O(e,"transition","color "+(t[10]?2:0)+"s"),1024&n[0]&&O(e,"color",t[10]?"white":"black")},d(t){t&&C(e)}}}function Yt(t){let e,F,n,o,r,i,a,l,c,u,f,v,p,m,H,g,h,y,x,w,_,$,P,R,D,I,L,q,B,G,Y,N,X,J,K,U,V,W,Z,tt,et,it,at,st,lt,ct,ut,dt,ft,vt,pt,mt,Ht,gt,ht,yt,xt,bt=(0==t[13]?t[14].toFixed(2):t[13].toFixed(2))+"",wt=t[11]&&qt();function _t(t,e){return t[9]?Gt:Bt}let $t=_t(t),kt=$t(t);return{c(){e=S("div"),F=S("div"),n=S("p"),o=z("Score: "),r=z(bt),i=E(),a=S("canvas"),u=E(),f=S("img"),p=E(),wt&&wt.c(),m=E(),H=S("div"),kt.c(),g=E(),h=S("div"),y=S("div"),x=S("label"),x.textContent="Choose a map:",w=E(),_=S("select"),$=S("option"),$.textContent="Frozen Lake",P=S("option"),P.textContent="Frozen Smiley",R=S("option"),R.textContent="Large Lake",D=E(),I=S("div"),L=S("label"),L.textContent="Add a teacher:",q=E(),B=S("select"),G=S("option"),G.textContent="No Teacher",Y=S("option"),Y.textContent="Distance 1",N=S("option"),N.textContent="Distance 2",X=E(),J=S("div"),K=S("label"),K.textContent="Reset strategy:",U=E(),V=S("select"),W=S("option"),W.textContent="Soft Reset",Z=S("option"),Z.textContent="Back 4",tt=S("option"),tt.textContent="Hard Reset",it=E(),at=S("div"),st=S("div"),lt=E(),ct=S("button"),ct.textContent="↑",ut=E(),dt=S("div"),ft=E(),vt=S("button"),vt.textContent="←",pt=E(),mt=S("button"),mt.textContent="↓",Ht=E(),gt=S("button"),gt.textContent="→",j(n,"class","svelte-1t9covs"),j(a,"width",l=500*t[12]),j(a,"height",c=500*t[12]),O(a,"width","300px"),O(a,"height","300px"),j(a,"class","svelte-1t9covs"),j(f,"width","300"),j(f,"alt","Legend for the above mini-game"),d(f.src,v="./images/map_legend_stacked.svg")||j(f,"src","./images/map_legend_stacked.svg"),j(F,"class","map svelte-1t9covs"),j(x,"for","map"),$.__value="small",$.value=$.__value,P.__value="16x16",P.value=P.__value,R.__value="32x32",R.value=R.__value,j(_,"name","map"),j(_,"id","map"),void 0===t[1]&&Q(()=>t[20].call(_)),j(y,"class","svelte-1t9covs"),j(L,"for","teacher"),G.__value="0",G.value=G.__value,Y.__value="1",Y.value=Y.__value,N.__value="2",N.value=N.__value,j(B,"name","teacher"),j(B,"id","teacher"),void 0===t[2]&&Q(()=>t[21].call(B)),j(I,"class","svelte-1t9covs"),j(K,"for","reset"),W.__value="SR",W.value=W.__value,Z.__value="B4",Z.value=Z.__value,tt.__value="HR",tt.value=tt.__value,j(V,"name","reset"),j(V,"id","reset"),V.disabled=et=0==t[2],void 0===t[3]&&Q(()=>t[22].call(V)),j(J,"class","svelte-1t9covs"),j(h,"class","menu svelte-1t9covs"),j(ct,"class","key svelte-1t9covs"),j(vt,"class","key svelte-1t9covs"),j(mt,"class","key svelte-1t9covs"),j(gt,"class","key svelte-1t9covs"),j(at,"class","keyboard svelte-1t9covs"),j(H,"class","controls svelte-1t9covs"),j(e,"class","game svelte-1t9covs")},m(s,l){k(s,e,l),b(e,F),b(F,n),b(n,o),b(n,r),b(F,i),b(F,a),t[18](a),b(F,u),b(F,f),b(F,p),wt&&wt.m(F,null),b(e,m),b(e,H),kt.m(H,null),b(H,g),b(H,h),b(h,y),b(y,x),b(y,w),b(y,_),b(_,$),b(_,P),b(_,R),M(_,t[1]),b(h,D),b(h,I),b(I,L),b(I,q),b(I,B),b(B,G),b(B,Y),b(B,N),M(B,t[2]),b(h,X),b(h,J),b(J,K),b(J,U),b(J,V),b(V,W),b(V,Z),b(V,tt),M(V,t[3]),b(H,it),b(H,at),b(at,st),b(at,lt),b(at,ct),b(at,ut),b(at,dt),b(at,ft),b(at,vt),b(at,pt),b(at,mt),b(at,Ht),b(at,gt),ht=!0,yt||(xt=[A(It,"keydown",t[16]),A(a,"click",t[19]),A(_,"change",t[20]),A(_,"change",t[15]),A(B,"change",t[21]),A(V,"change",t[22]),A(ct,"click",t[23]),A(vt,"click",t[24]),A(mt,"click",t[25]),A(gt,"click",t[26])],yt=!0)},p(t,e){(!ht||24576&e[0])&&bt!==(bt=(0==t[13]?t[14].toFixed(2):t[13].toFixed(2))+"")&&T(r,bt),(!ht||4096&e[0]&&l!==(l=500*t[12]))&&j(a,"width",l),(!ht||4096&e[0]&&c!==(c=500*t[12]))&&j(a,"height",c),t[11]?wt?2048&e[0]&&ot(wt,1):(wt=qt(),wt.c(),ot(wt,1),wt.m(F,null)):wt&&(Ft(),rt(wt,1,1,()=>{wt=null}),nt()),$t===($t=_t(t))&&kt?kt.p(t,e):(kt.d(1),kt=$t(t),kt&&(kt.c(),kt.m(H,g))),2&e[0]&&M(_,t[1]),4&e[0]&&M(B,t[2]),(!ht||4&e[0]&&et!==(et=0==t[2]))&&(V.disabled=et),8&e[0]&&M(V,t[3])},i(t){ht||(ot(wt),ht=!0)},o(t){rt(wt),ht=!1},d(F){F&&C(e),t[18](null),wt&&wt.d(),kt.d(),yt=!1,s(xt)}}}function Nt(t,e,F){let i,a,s,l,c,u=n;t.$$.on_destroy.push(()=>u());var d,f,p,H=!1,g=!1,h=!1,x=!1,b=!0,w=[],_=!1,$="",k=null,C=!1;const S=new Image;S.src="./images/robot.png";const z=new Image;z.src="./images/robot-flipped.png";var E=!1,A=S,j=0,T=0;function O(t){F(10,$=""),clearTimeout(k),setTimeout(()=>{F(10,$=t)},1),k=setTimeout(()=>{F(10,$="")},2e3)}q(()=>{const t=a.getContext("2d");var e,n,$,k,M;function P(t){let e=t.length,F=t[0].length,n=new Array(e).fill(!1).map(()=>new Array(F).fill(!1));for(let r=0;r<e;r++)for(let e=0;e<F;e++){var o=!1;try{o|=t[r][e+1]}catch(t){}try{o|=t[r+1][e]}catch(t){}try{o|=t[r][e-1]}catch(t){}try{o|=t[r-1][e]}catch(t){}n[r][e]=o}return n}function R(){n=Rt[s],e=a.height/n.length,M=function(t,e){if(0==e)return t;var F=new Array;for(let t=0;t<n.length;t++)F.push(n[t].split(""));let o=F.map(t=>t.map(t=>"H"==t)),r=F.map(t=>t.map(t=>"F"==t));var i,a=Array.from(o);for(let t=0;t<e;t++)i=P(a),a=i.map((t,e)=>t.map((t,F)=>t||a[e][F]));var s=Array.from(F);for(let t=0;t<F.length;t++)for(let e=0;e<F[0].length;e++)i[t][e]&&r[t][e]&&(s[t][e]="T");let l=new Array;for(let e=0;e<t.length;e++)l.push(s[e].join(""));return l}(n,l);for(let F=0;F<n.length;F++)for(let o=0;o<n[0].length;o++){let n=M[F][o];"S"==n&&($=[o,F]);let r=o*e,i=F*e;t.beginPath(),t.rect(r,i,e+1,e+1),t.fillStyle=Dt[n],t.fill(),t.closePath()}}function D(t){d.set(t),f=t,w.push(f),F(13,j-=.01)}function I(){w=[],F(14,T=j),D($),F(13,j=0)}F(12,p=window.devicePixelRatio),t.scale(p,p),R(),function s(){(g||H||h||x)&&F(9,_=!0),t.clearRect(0,0,a.width,a.height),R(),b&&(F(8,d=function(t,e={}){const F=$t(t);let n,i=t;function a(a,s){if(null==t)return F.set(t=a),Promise.resolve();i=a;let l=n,c=!1,{delay:u=0,duration:d=400,easing:f=o,interpolate:v=St}=r(r({},e),s);if(0===d)return l&&(l.abort(),l=null),F.set(t=i),Promise.resolve();const p=m()+u;let H;return n=y(e=>{if(e<p)return!0;c||(H=v(t,a),"function"==typeof d&&(d=d(t,a)),c=!0),l&&(l.abort(),l=null);const n=e-p;return n>d?(F.set(t=a),!1):(F.set(t=H(f(n/d))),!0)}),n.promise}return{set:a,update:(e,F)=>a(e(i,t),F),subscribe:F.subscribe}}($,{duration:150,easing:kt})),u(),u=v(d,t=>F(35,i=t)),F(13,j=0),I()),async function(){A=E?z:S,t.drawImage(A,i[0]*e,i[1]*e,e,e)}();const l=Math.random();g||H?l<.1?(F(5,g=!1),F(4,H=!1),F(6,h=!0)):l<.2&&(F(5,g=!1),F(4,H=!1),F(7,x=!0)):(h||x)&&(l<.1?(F(6,h=!1),F(7,x=!1),F(5,g=!0)):l<.2&&(F(6,h=!1),F(7,x=!1),F(4,H=!0))),l<.2&&(h||x||g||H)&&O("You just slipped."),g&&(E=!0),H&&(E=!1),k=Array.from(f);let[p,T]=Array.from(k);if(H?p<n[0].length-1&&(p+=1):g?p>0&&(p-=1):h?T>0&&(T-=1):x&&T<n.length-1&&(T+=1),(H||g||x||h)&&D([p,T]),"G"==n[T][p])F(11,C=!0),F(13,j+=6),setTimeout(()=>{F(11,C=!1)},3e3),O("You won!"),I();else if("H"==n[T][p])O("You failed."),F(13,j=0),I();else if("T"==M[T][p]){if("HR"==c){let t=j;I(),F(13,j=t)}else if("B4"==c){for(let t=0;t<4&&w.length>1;t++)w.pop();F(13,j+=.01),D(w[w.length-1])}else"SR"==c&&(F(13,j+=.01),D(k));O("The teacher set you back.")}b=!1,F(4,H=!1),F(5,g=!1),F(6,h=!1),F(7,x=!1),requestAnimationFrame(s)}()});return[a,s,l,c,H,g,h,x,d,_,$,C,p,j,T,function(){b=!0},function(t){39==t.keyCode||"d"==t.key?(F(4,H=!0),t.preventDefault()):37==t.keyCode||"a"==t.key?(F(5,g=!0),t.preventDefault()):38==t.keyCode||"w"==t.key?(F(6,h=!0),t.preventDefault()):40!=t.keyCode&&"s"!=t.key||(F(7,x=!0),t.preventDefault())},O,function(t){G[t?"unshift":"push"](()=>{a=t,F(0,a)})},()=>O("Press the arrow keys to move..."),function(){s=P(this),F(1,s)},function(){l=P(this),F(2,l)},function(){c=P(this),F(3,c)},()=>F(6,h=!0),()=>F(5,g=!0),()=>F(7,x=!0),()=>F(4,H=!0)]}var Xt=class extends ut{constructor(t){super(),ct(this,t,Nt,Yt,c,{},Lt,[-1,-1])}},Jt=document.getElementById("trajectories-visualization");Jt.addEventListener("ready",(function(){var t=Jt.querySelector("#trajectories-visualization-target");new pt({target:t})}));var Kt=document.getElementById("back-visualization");Kt.addEventListener("ready",(function(){var t=Kt.querySelector("#back-visualization-target");new ht({target:t})}));var Qt=document.getElementById("incremental-visualization");Qt.addEventListener("ready",(function(){var t=Qt.querySelector("#incremental-visualization-target");new wt({target:t})}));var Ut=document.getElementById("grid-visualization");Ut.addEventListener("ready",(function(){var t=Ut.querySelector("#grid-visualization-target");new Xt({target:t})}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vL3RyYWplY3Rvcmllcy5zdmVsdGUiLCJ3ZWJwYWNrOi8vL2JhY2suc3ZlbHRlIiwid2VicGFjazovLy9pbmNyZW1lbnRhbC5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9zdG9yZS9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9lYXNpbmcvaW5kZXgubWpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zdmVsdGUvbW90aW9uL2luZGV4Lm1qcyIsIndlYnBhY2s6Ly8vQ29uZmV0dGkuc3ZlbHRlIiwid2VicGFjazovLy9jb25zdGFudHMuc3ZlbHRlIiwid2VicGFjazovLy9ncmlkLnN2ZWx0ZSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJub29wIiwiaWRlbnRpdHkiLCJ4IiwidGFyIiwic3JjIiwiayIsImZuIiwiYmxhbmtfb2JqZWN0IiwicnVuX2FsbCIsImZucyIsImZvckVhY2giLCJpc19mdW5jdGlvbiIsInRoaW5nIiwic2FmZV9ub3RfZXF1YWwiLCJhIiwiYiIsInNyY191cmxfZXF1YWxfYW5jaG9yIiwic3JjX3VybF9lcXVhbCIsImVsZW1lbnRfc3JjIiwidXJsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaHJlZiIsImlzX2VtcHR5Iiwib2JqIiwia2V5cyIsImxlbmd0aCIsInN0b3JlIiwiY2FsbGJhY2tzIiwidW5zdWIiLCJzdWJzY3JpYmUiLCJ1bnN1YnNjcmliZSIsImlzX2NsaWVudCIsIndpbmRvdyIsIm5vdyIsInBlcmZvcm1hbmNlIiwiRGF0ZSIsInJhZiIsImNiIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidGFza3MiLCJTZXQiLCJydW5fdGFza3MiLCJ0YXNrIiwiZGVsZXRlIiwiZiIsInNpemUiLCJsb29wIiwiY2FsbGJhY2siLCJwcm9taXNlIiwiUHJvbWlzZSIsImZ1bGZpbGwiLCJhZGQiLCJpc19oeWRyYXRpbmciLCJhcHBlbmQiLCJ0YXJnZXQiLCJub2RlIiwiYXBwZW5kQ2hpbGQiLCJhcHBlbmRfc3R5bGVzIiwic3R5bGVfc2hlZXRfaWQiLCJzdHlsZXMiLCJhcHBlbmRfc3R5bGVzX3RvIiwiZ2V0X3Jvb3RfZm9yX3N0eWxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImlkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRfc3R5bGVzaGVldCIsInJvb3QiLCJnZXRSb290Tm9kZSIsIm93bmVyRG9jdW1lbnQiLCJob3N0IiwiaGVhZCIsImluc2VydCIsImFuY2hvciIsImluc2VydEJlZm9yZSIsImRldGFjaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRhdGEiLCJjcmVhdGVUZXh0Tm9kZSIsInNwYWNlIiwibGlzdGVuIiwiZXZlbnQiLCJoYW5kbGVyIiwib3B0aW9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYXR0ciIsImF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldF9kYXRhIiwidGV4dCIsIndob2xlVGV4dCIsInNldF9zdHlsZSIsImltcG9ydGFudCIsInJlbW92ZVByb3BlcnR5Iiwic2V0UHJvcGVydHkiLCJzZWxlY3Rfb3B0aW9uIiwic2VsZWN0Iiwib3B0aW9uIiwiX192YWx1ZSIsInNlbGVjdGVkIiwic2VsZWN0ZWRJbmRleCIsInNlbGVjdF92YWx1ZSIsInNlbGVjdGVkX29wdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2dnbGVfY2xhc3MiLCJlbGVtZW50IiwidG9nZ2xlIiwiY2xhc3NMaXN0IiwiTWFwIiwiY3VycmVudF9jb21wb25lbnQiLCJzZXRfY3VycmVudF9jb21wb25lbnQiLCJjb21wb25lbnQiLCJnZXRfY3VycmVudF9jb21wb25lbnQiLCJFcnJvciIsIm9uTW91bnQiLCIkJCIsIm9uX21vdW50IiwicHVzaCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwicmVzb2x2ZSIsInVwZGF0ZV9zY2hlZHVsZWQiLCJzY2hlZHVsZV91cGRhdGUiLCJ0aGVuIiwiZmx1c2giLCJhZGRfcmVuZGVyX2NhbGxiYWNrIiwic2Vlbl9jYWxsYmFja3MiLCJmbHVzaGlkeCIsInNhdmVkX2NvbXBvbmVudCIsInBvcCIsImhhcyIsImNsZWFyIiwiZnJhZ21lbnQiLCJ1cGRhdGUiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsIm91dHJvcyIsImdyb3VwX291dHJvcyIsImNoZWNrX291dHJvcyIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwidHJhbnNpdGlvbl9vdXQiLCJnbG9iYWxzIiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIlN2ZWx0ZUVsZW1lbnQiLCJtb3VudF9jb21wb25lbnQiLCJjdXN0b21FbGVtZW50Iiwib25fZGVzdHJveSIsIm5ld19vbl9kZXN0cm95IiwibWFwIiwiZmlsdGVyIiwiZGVzdHJveV9jb21wb25lbnQiLCJkZXRhY2hpbmciLCJpbml0IiwiaW5zdGFuY2UiLCJjcmVhdGVfZnJhZ21lbnQiLCJub3RfZXF1YWwiLCJwcm9wcyIsInBhcmVudF9jb21wb25lbnQiLCJib3VuZCIsIm9uX2Rpc2Nvbm5lY3QiLCJjb250ZXh0Iiwic2tpcF9ib3VuZCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGROb2RlcyIsImludHJvIiwiSFRNTEVsZW1lbnQiLCJzdXBlciIsInRoaXMiLCJhdHRhY2hTaGFkb3ciLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkJHByb3BzIiwiJCRzZXQiLCJTdmVsdGVDb21wb25lbnQiLCJsZW4iLCJjb3VudCIsImhhc0ludGVyYWN0ZWQiLCJwYXJzZUludCIsInN1YnNjcmliZXJfcXVldWUiLCJ3cml0YWJsZSIsInN0YXJ0Iiwic3RvcCIsInN1YnNjcmliZXJzIiwic2V0IiwibmV3X3ZhbHVlIiwicnVuX3F1ZXVlIiwic3Vic2NyaWJlciIsInJ1biIsImludmFsaWRhdGUiLCJjdWJpY091dCIsImlzX2RhdGUiLCJ0b1N0cmluZyIsImdldF9pbnRlcnBvbGF0b3IiLCJpc0FycmF5IiwiYXJyIiwiYmkiLCJnZXRUaW1lIiwiZGVsdGEiLCJpbnRlcnBvbGF0b3JzIiwicmVzdWx0IiwiaXRlcmF0aW9ucyIsInJhbmRvbUJldHdlZW4iLCJtaW4iLCJtYXgiLCJNYXRoIiwicmFuZG9tIiwieSIsImR1cmF0aW9uIiwiaW5maW5pdGUiLCJkZWxheSIsImNvbG9yUmFuZ2UiLCJjb2xvckFycmF5IiwiYW1vdW50IiwiaXRlcmF0aW9uQ291bnQiLCJmYWxsRGlzdGFuY2UiLCJyb3VuZGVkIiwiY29uZSIsIm5vR3Jhdml0eSIsInhTcHJlYWQiLCJkZXN0cm95T25Db21wbGV0ZSIsImNvbXBsZXRlIiwic2V0VGltZW91dCIsInJvdW5kIiwibWFwcyIsImNvbG9ycyIsInRvRml4ZWQiLCJjYW52YXMiLCJzZWxlY3RlZE1hcCIsInNlbGVjdGVkVGVhY2hlciIsInNlbGVjdGVkUmVzZXQiLCJwb3MiLCJyZWFsUG9zIiwicGl4ZWxSYXRpbyIsInJpZ2h0UHJlc3NlZCIsImxlZnRQcmVzc2VkIiwidXBQcmVzc2VkIiwiZG93blByZXNzZWQiLCJtYXBDaGFuZ2VkIiwiaGlzdG9yeSIsInN0YXR1c01lc3NhZ2UiLCJzdGF0dXNUaW1lciIsImNvbmZldHRpIiwicm9ib3QiLCJJbWFnZSIsInJvYm90RmxpcHBlZCIsImZsaXBwZWQiLCJpbWFnZSIsInNjb3JlIiwibGFzdFNjb3JlIiwic2hvd01lc3NhZ2UiLCJtc2ciLCJjbGVhclRpbWVvdXQiLCJnZXRDb250ZXh0IiwidGlsZVNpemUiLCJsYXN0UG9zaXRpb24iLCJ0ZWFjaGVyTWFwIiwib25lU3RlcFJlYWNoIiwiYmFzZU1hc2siLCJyb3dzIiwiY29scyIsIm9uZVN0ZXBNYXNrIiwiaiIsInJlcyIsImUiLCJkcmF3RW52aXJvbm1lbnQiLCJoZWlnaHQiLCJiYXNlTWFwIiwiZGlzdGFuY2UiLCJuZXdCYXNlTWFwIiwic3BsaXQiLCJiYXNlRGFuZ2VyTWFzayIsInJvdyIsImJhc2VFbXB0eU1hc2siLCJyZWFjaE1hc2siLCJwcmV2aW91c01hc2siLCJuZXdNYXAiLCJqb2luIiwiYWRkVGVhY2hlciIsInN0YXRlIiwiYmVnaW5QYXRoIiwicmVjdCIsImZpbGxTdHlsZSIsImNsb3NlUGF0aCIsIm1vdmVBZ2VudCIsIm5ld1BvcyIsInJlc2V0QWdlbnQiLCJkZXZpY2VQaXhlbFJhdGlvIiwic2NhbGUiLCJkcmF3IiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJkZWZhdWx0cyIsInRhcmdldF92YWx1ZSIsIm9wdHMiLCJwcmV2aW91c190YXNrIiwic3RhcnRlZCIsImVhc2luZyIsImludGVycG9sYXRlIiwiYWJvcnQiLCJlbGFwc2VkIiwidHdlZW5lZCIsImRyYXdJbWFnZSIsIiRwb3MiLCJkcmF3QWdlbnQiLCJybmQiLCJ0bXBTY29yZSIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInRyYWplY3Rvcmllc1RhZyIsIlRyYWplY3RvcmllcyIsImJhY2tUYWciLCJCYWNrIiwiaW5jcmVtZW50YWxUYWciLCJJbmNyZW1lbnRhbCIsImdyaWRUYWciLCJHcmlkIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9B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VSxTQUFTMkMsZUFBZSxzQkFFeEN1UixHQUFRaFEsaUJBQWlCLFNBQVMsV0FDakMsSUFBTS9CLEVBQVMrUixHQUFRMU8sY0FBYyw4QkFDOUIsSUFBSTJPLEdBQUssQ0FBRWhTIiwiZmlsZSI6ImluZGV4LmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImZ1bmN0aW9uIG5vb3AoKSB7IH1cbmNvbnN0IGlkZW50aXR5ID0geCA9PiB4O1xuZnVuY3Rpb24gYXNzaWduKHRhciwgc3JjKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgayBpbiBzcmMpXG4gICAgICAgIHRhcltrXSA9IHNyY1trXTtcbiAgICByZXR1cm4gdGFyO1xufVxuZnVuY3Rpb24gaXNfcHJvbWlzZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gYWRkX2xvY2F0aW9uKGVsZW1lbnQsIGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhcikge1xuICAgIGVsZW1lbnQuX19zdmVsdGVfbWV0YSA9IHtcbiAgICAgICAgbG9jOiB7IGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhciB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHJ1bihmbikge1xuICAgIHJldHVybiBmbigpO1xufVxuZnVuY3Rpb24gYmxhbmtfb2JqZWN0KCkge1xuICAgIHJldHVybiBPYmplY3QuY3JlYXRlKG51bGwpO1xufVxuZnVuY3Rpb24gcnVuX2FsbChmbnMpIHtcbiAgICBmbnMuZm9yRWFjaChydW4pO1xufVxuZnVuY3Rpb24gaXNfZnVuY3Rpb24odGhpbmcpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gc2FmZV9ub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiIHx8ICgoYSAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHx8IHR5cGVvZiBhID09PSAnZnVuY3Rpb24nKTtcbn1cbmxldCBzcmNfdXJsX2VxdWFsX2FuY2hvcjtcbmZ1bmN0aW9uIHNyY191cmxfZXF1YWwoZWxlbWVudF9zcmMsIHVybCkge1xuICAgIGlmICghc3JjX3VybF9lcXVhbF9hbmNob3IpIHtcbiAgICAgICAgc3JjX3VybF9lcXVhbF9hbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgfVxuICAgIHNyY191cmxfZXF1YWxfYW5jaG9yLmhyZWYgPSB1cmw7XG4gICAgcmV0dXJuIGVsZW1lbnRfc3JjID09PSBzcmNfdXJsX2VxdWFsX2FuY2hvci5ocmVmO1xufVxuZnVuY3Rpb24gbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYjtcbn1cbmZ1bmN0aW9uIGlzX2VtcHR5KG9iaikge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PT0gMDtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3N0b3JlKHN0b3JlLCBuYW1lKSB7XG4gICAgaWYgKHN0b3JlICE9IG51bGwgJiYgdHlwZW9mIHN0b3JlLnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke25hbWV9JyBpcyBub3QgYSBzdG9yZSB3aXRoIGEgJ3N1YnNjcmliZScgbWV0aG9kYCk7XG4gICAgfVxufVxuZnVuY3Rpb24gc3Vic2NyaWJlKHN0b3JlLCAuLi5jYWxsYmFja3MpIHtcbiAgICBpZiAoc3RvcmUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gICAgY29uc3QgdW5zdWIgPSBzdG9yZS5zdWJzY3JpYmUoLi4uY2FsbGJhY2tzKTtcbiAgICByZXR1cm4gdW5zdWIudW5zdWJzY3JpYmUgPyAoKSA9PiB1bnN1Yi51bnN1YnNjcmliZSgpIDogdW5zdWI7XG59XG5mdW5jdGlvbiBnZXRfc3RvcmVfdmFsdWUoc3RvcmUpIHtcbiAgICBsZXQgdmFsdWU7XG4gICAgc3Vic2NyaWJlKHN0b3JlLCBfID0+IHZhbHVlID0gXykoKTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBjb21wb25lbnRfc3Vic2NyaWJlKGNvbXBvbmVudCwgc3RvcmUsIGNhbGxiYWNrKSB7XG4gICAgY29tcG9uZW50LiQkLm9uX2Rlc3Ryb3kucHVzaChzdWJzY3JpYmUoc3RvcmUsIGNhbGxiYWNrKSk7XG59XG5mdW5jdGlvbiBjcmVhdGVfc2xvdChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKSB7XG4gICAgaWYgKGRlZmluaXRpb24pIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jdHggPSBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pO1xuICAgICAgICByZXR1cm4gZGVmaW5pdGlvblswXShzbG90X2N0eCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKSB7XG4gICAgcmV0dXJuIGRlZmluaXRpb25bMV0gJiYgZm5cbiAgICAgICAgPyBhc3NpZ24oJCRzY29wZS5jdHguc2xpY2UoKSwgZGVmaW5pdGlvblsxXShmbihjdHgpKSlcbiAgICAgICAgOiAkJHNjb3BlLmN0eDtcbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NoYW5nZXMoZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGZuKSB7XG4gICAgaWYgKGRlZmluaXRpb25bMl0gJiYgZm4pIHtcbiAgICAgICAgY29uc3QgbGV0cyA9IGRlZmluaXRpb25bMl0oZm4oZGlydHkpKTtcbiAgICAgICAgaWYgKCQkc2NvcGUuZGlydHkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGxldHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBsZXRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgY29uc3QgbWVyZ2VkID0gW107XG4gICAgICAgICAgICBjb25zdCBsZW4gPSBNYXRoLm1heCgkJHNjb3BlLmRpcnR5Lmxlbmd0aCwgbGV0cy5sZW5ndGgpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZFtpXSA9ICQkc2NvcGUuZGlydHlbaV0gfCBsZXRzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1lcmdlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJCRzY29wZS5kaXJ0eSB8IGxldHM7XG4gICAgfVxuICAgIHJldHVybiAkJHNjb3BlLmRpcnR5O1xufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3RfYmFzZShzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0X2ZuKSB7XG4gICAgaWYgKHNsb3RfY2hhbmdlcykge1xuICAgICAgICBjb25zdCBzbG90X2NvbnRleHQgPSBnZXRfc2xvdF9jb250ZXh0KHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbiAgICAgICAgc2xvdC5wKHNsb3RfY29udGV4dCwgc2xvdF9jaGFuZ2VzKTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdChzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIHVwZGF0ZV9zbG90X2Jhc2Uoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIHNsb3RfY2hhbmdlcywgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG59XG5mdW5jdGlvbiBnZXRfYWxsX2RpcnR5X2Zyb21fc2NvcGUoJCRzY29wZSkge1xuICAgIGlmICgkJHNjb3BlLmN0eC5sZW5ndGggPiAzMikge1xuICAgICAgICBjb25zdCBkaXJ0eSA9IFtdO1xuICAgICAgICBjb25zdCBsZW5ndGggPSAkJHNjb3BlLmN0eC5sZW5ndGggLyAzMjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGlydHlbaV0gPSAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlydHk7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMocHJvcHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmIChrWzBdICE9PSAnJCcpXG4gICAgICAgICAgICByZXN1bHRba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY29tcHV0ZV9yZXN0X3Byb3BzKHByb3BzLCBrZXlzKSB7XG4gICAgY29uc3QgcmVzdCA9IHt9O1xuICAgIGtleXMgPSBuZXcgU2V0KGtleXMpO1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKCFrZXlzLmhhcyhrKSAmJiBrWzBdICE9PSAnJCcpXG4gICAgICAgICAgICByZXN0W2tdID0gcHJvcHNba107XG4gICAgcmV0dXJuIHJlc3Q7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Nsb3RzKHNsb3RzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gc2xvdHMpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gb25jZShmbikge1xuICAgIGxldCByYW4gPSBmYWxzZTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgaWYgKHJhbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcmFuID0gdHJ1ZTtcbiAgICAgICAgZm4uY2FsbCh0aGlzLCAuLi5hcmdzKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gbnVsbF90b19lbXB0eSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9zdG9yZV92YWx1ZShzdG9yZSwgcmV0LCB2YWx1ZSkge1xuICAgIHN0b3JlLnNldCh2YWx1ZSk7XG4gICAgcmV0dXJuIHJldDtcbn1cbmNvbnN0IGhhc19wcm9wID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG5mdW5jdGlvbiBhY3Rpb25fZGVzdHJveWVyKGFjdGlvbl9yZXN1bHQpIHtcbiAgICByZXR1cm4gYWN0aW9uX3Jlc3VsdCAmJiBpc19mdW5jdGlvbihhY3Rpb25fcmVzdWx0LmRlc3Ryb3kpID8gYWN0aW9uX3Jlc3VsdC5kZXN0cm95IDogbm9vcDtcbn1cblxuY29uc3QgaXNfY2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XG5sZXQgbm93ID0gaXNfY2xpZW50XG4gICAgPyAoKSA9PiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcbiAgICA6ICgpID0+IERhdGUubm93KCk7XG5sZXQgcmFmID0gaXNfY2xpZW50ID8gY2IgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKSA6IG5vb3A7XG4vLyB1c2VkIGludGVybmFsbHkgZm9yIHRlc3RpbmdcbmZ1bmN0aW9uIHNldF9ub3coZm4pIHtcbiAgICBub3cgPSBmbjtcbn1cbmZ1bmN0aW9uIHNldF9yYWYoZm4pIHtcbiAgICByYWYgPSBmbjtcbn1cblxuY29uc3QgdGFza3MgPSBuZXcgU2V0KCk7XG5mdW5jdGlvbiBydW5fdGFza3Mobm93KSB7XG4gICAgdGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgaWYgKCF0YXNrLmMobm93KSkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICAgICAgdGFzay5mKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAodGFza3Muc2l6ZSAhPT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG59XG4vKipcbiAqIEZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkhXG4gKi9cbmZ1bmN0aW9uIGNsZWFyX2xvb3BzKCkge1xuICAgIHRhc2tzLmNsZWFyKCk7XG59XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdGFzayB0aGF0IHJ1bnMgb24gZWFjaCByYWYgZnJhbWVcbiAqIHVudGlsIGl0IHJldHVybnMgYSBmYWxzeSB2YWx1ZSBvciBpcyBhYm9ydGVkXG4gKi9cbmZ1bmN0aW9uIGxvb3AoY2FsbGJhY2spIHtcbiAgICBsZXQgdGFzaztcbiAgICBpZiAodGFza3Muc2l6ZSA9PT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvbWlzZTogbmV3IFByb21pc2UoZnVsZmlsbCA9PiB7XG4gICAgICAgICAgICB0YXNrcy5hZGQodGFzayA9IHsgYzogY2FsbGJhY2ssIGY6IGZ1bGZpbGwgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8vIFRyYWNrIHdoaWNoIG5vZGVzIGFyZSBjbGFpbWVkIGR1cmluZyBoeWRyYXRpb24uIFVuY2xhaW1lZCBub2RlcyBjYW4gdGhlbiBiZSByZW1vdmVkIGZyb20gdGhlIERPTVxuLy8gYXQgdGhlIGVuZCBvZiBoeWRyYXRpb24gd2l0aG91dCB0b3VjaGluZyB0aGUgcmVtYWluaW5nIG5vZGVzLlxubGV0IGlzX2h5ZHJhdGluZyA9IGZhbHNlO1xuZnVuY3Rpb24gc3RhcnRfaHlkcmF0aW5nKCkge1xuICAgIGlzX2h5ZHJhdGluZyA9IHRydWU7XG59XG5mdW5jdGlvbiBlbmRfaHlkcmF0aW5nKCkge1xuICAgIGlzX2h5ZHJhdGluZyA9IGZhbHNlO1xufVxuZnVuY3Rpb24gdXBwZXJfYm91bmQobG93LCBoaWdoLCBrZXksIHZhbHVlKSB7XG4gICAgLy8gUmV0dXJuIGZpcnN0IGluZGV4IG9mIHZhbHVlIGxhcmdlciB0aGFuIGlucHV0IHZhbHVlIGluIHRoZSByYW5nZSBbbG93LCBoaWdoKVxuICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7XG4gICAgICAgIGNvbnN0IG1pZCA9IGxvdyArICgoaGlnaCAtIGxvdykgPj4gMSk7XG4gICAgICAgIGlmIChrZXkobWlkKSA8PSB2YWx1ZSkge1xuICAgICAgICAgICAgbG93ID0gbWlkICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGhpZ2ggPSBtaWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbn1cbmZ1bmN0aW9uIGluaXRfaHlkcmF0ZSh0YXJnZXQpIHtcbiAgICBpZiAodGFyZ2V0Lmh5ZHJhdGVfaW5pdClcbiAgICAgICAgcmV0dXJuO1xuICAgIHRhcmdldC5oeWRyYXRlX2luaXQgPSB0cnVlO1xuICAgIC8vIFdlIGtub3cgdGhhdCBhbGwgY2hpbGRyZW4gaGF2ZSBjbGFpbV9vcmRlciB2YWx1ZXMgc2luY2UgdGhlIHVuY2xhaW1lZCBoYXZlIGJlZW4gZGV0YWNoZWQgaWYgdGFyZ2V0IGlzIG5vdCA8aGVhZD5cbiAgICBsZXQgY2hpbGRyZW4gPSB0YXJnZXQuY2hpbGROb2RlcztcbiAgICAvLyBJZiB0YXJnZXQgaXMgPGhlYWQ+LCB0aGVyZSBtYXkgYmUgY2hpbGRyZW4gd2l0aG91dCBjbGFpbV9vcmRlclxuICAgIGlmICh0YXJnZXQubm9kZU5hbWUgPT09ICdIRUFEJykge1xuICAgICAgICBjb25zdCBteUNoaWxkcmVuID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgICAgIGlmIChub2RlLmNsYWltX29yZGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBteUNoaWxkcmVuLnB1c2gobm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGRyZW4gPSBteUNoaWxkcmVuO1xuICAgIH1cbiAgICAvKlxuICAgICogUmVvcmRlciBjbGFpbWVkIGNoaWxkcmVuIG9wdGltYWxseS5cbiAgICAqIFdlIGNhbiByZW9yZGVyIGNsYWltZWQgY2hpbGRyZW4gb3B0aW1hbGx5IGJ5IGZpbmRpbmcgdGhlIGxvbmdlc3Qgc3Vic2VxdWVuY2Ugb2ZcbiAgICAqIG5vZGVzIHRoYXQgYXJlIGFscmVhZHkgY2xhaW1lZCBpbiBvcmRlciBhbmQgb25seSBtb3ZpbmcgdGhlIHJlc3QuIFRoZSBsb25nZXN0XG4gICAgKiBzdWJzZXF1ZW5jZSBzdWJzZXF1ZW5jZSBvZiBub2RlcyB0aGF0IGFyZSBjbGFpbWVkIGluIG9yZGVyIGNhbiBiZSBmb3VuZCBieVxuICAgICogY29tcHV0aW5nIHRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgLmNsYWltX29yZGVyIHZhbHVlcy5cbiAgICAqXG4gICAgKiBUaGlzIGFsZ29yaXRobSBpcyBvcHRpbWFsIGluIGdlbmVyYXRpbmcgdGhlIGxlYXN0IGFtb3VudCBvZiByZW9yZGVyIG9wZXJhdGlvbnNcbiAgICAqIHBvc3NpYmxlLlxuICAgICpcbiAgICAqIFByb29mOlxuICAgICogV2Uga25vdyB0aGF0LCBnaXZlbiBhIHNldCBvZiByZW9yZGVyaW5nIG9wZXJhdGlvbnMsIHRoZSBub2RlcyB0aGF0IGRvIG5vdCBtb3ZlXG4gICAgKiBhbHdheXMgZm9ybSBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlLCBzaW5jZSB0aGV5IGRvIG5vdCBtb3ZlIGFtb25nIGVhY2ggb3RoZXJcbiAgICAqIG1lYW5pbmcgdGhhdCB0aGV5IG11c3QgYmUgYWxyZWFkeSBvcmRlcmVkIGFtb25nIGVhY2ggb3RoZXIuIFRodXMsIHRoZSBtYXhpbWFsXG4gICAgKiBzZXQgb2Ygbm9kZXMgdGhhdCBkbyBub3QgbW92ZSBmb3JtIGEgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlLlxuICAgICovXG4gICAgLy8gQ29tcHV0ZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2VcbiAgICAvLyBtOiBzdWJzZXF1ZW5jZSBsZW5ndGggaiA9PiBpbmRleCBrIG9mIHNtYWxsZXN0IHZhbHVlIHRoYXQgZW5kcyBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIGxlbmd0aCBqXG4gICAgY29uc3QgbSA9IG5ldyBJbnQzMkFycmF5KGNoaWxkcmVuLmxlbmd0aCArIDEpO1xuICAgIC8vIFByZWRlY2Vzc29yIGluZGljZXMgKyAxXG4gICAgY29uc3QgcCA9IG5ldyBJbnQzMkFycmF5KGNoaWxkcmVuLmxlbmd0aCk7XG4gICAgbVswXSA9IC0xO1xuICAgIGxldCBsb25nZXN0ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjaGlsZHJlbltpXS5jbGFpbV9vcmRlcjtcbiAgICAgICAgLy8gRmluZCB0aGUgbGFyZ2VzdCBzdWJzZXF1ZW5jZSBsZW5ndGggc3VjaCB0aGF0IGl0IGVuZHMgaW4gYSB2YWx1ZSBsZXNzIHRoYW4gb3VyIGN1cnJlbnQgdmFsdWVcbiAgICAgICAgLy8gdXBwZXJfYm91bmQgcmV0dXJucyBmaXJzdCBncmVhdGVyIHZhbHVlLCBzbyB3ZSBzdWJ0cmFjdCBvbmVcbiAgICAgICAgLy8gd2l0aCBmYXN0IHBhdGggZm9yIHdoZW4gd2UgYXJlIG9uIHRoZSBjdXJyZW50IGxvbmdlc3Qgc3Vic2VxdWVuY2VcbiAgICAgICAgY29uc3Qgc2VxTGVuID0gKChsb25nZXN0ID4gMCAmJiBjaGlsZHJlblttW2xvbmdlc3RdXS5jbGFpbV9vcmRlciA8PSBjdXJyZW50KSA/IGxvbmdlc3QgKyAxIDogdXBwZXJfYm91bmQoMSwgbG9uZ2VzdCwgaWR4ID0+IGNoaWxkcmVuW21baWR4XV0uY2xhaW1fb3JkZXIsIGN1cnJlbnQpKSAtIDE7XG4gICAgICAgIHBbaV0gPSBtW3NlcUxlbl0gKyAxO1xuICAgICAgICBjb25zdCBuZXdMZW4gPSBzZXFMZW4gKyAxO1xuICAgICAgICAvLyBXZSBjYW4gZ3VhcmFudGVlIHRoYXQgY3VycmVudCBpcyB0aGUgc21hbGxlc3QgdmFsdWUuIE90aGVyd2lzZSwgd2Ugd291bGQgaGF2ZSBnZW5lcmF0ZWQgYSBsb25nZXIgc2VxdWVuY2UuXG4gICAgICAgIG1bbmV3TGVuXSA9IGk7XG4gICAgICAgIGxvbmdlc3QgPSBNYXRoLm1heChuZXdMZW4sIGxvbmdlc3QpO1xuICAgIH1cbiAgICAvLyBUaGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIG5vZGVzIChpbml0aWFsbHkgcmV2ZXJzZWQpXG4gICAgY29uc3QgbGlzID0gW107XG4gICAgLy8gVGhlIHJlc3Qgb2YgdGhlIG5vZGVzLCBub2RlcyB0aGF0IHdpbGwgYmUgbW92ZWRcbiAgICBjb25zdCB0b01vdmUgPSBbXTtcbiAgICBsZXQgbGFzdCA9IGNoaWxkcmVuLmxlbmd0aCAtIDE7XG4gICAgZm9yIChsZXQgY3VyID0gbVtsb25nZXN0XSArIDE7IGN1ciAhPSAwOyBjdXIgPSBwW2N1ciAtIDFdKSB7XG4gICAgICAgIGxpcy5wdXNoKGNoaWxkcmVuW2N1ciAtIDFdKTtcbiAgICAgICAgZm9yICg7IGxhc3QgPj0gY3VyOyBsYXN0LS0pIHtcbiAgICAgICAgICAgIHRvTW92ZS5wdXNoKGNoaWxkcmVuW2xhc3RdKTtcbiAgICAgICAgfVxuICAgICAgICBsYXN0LS07XG4gICAgfVxuICAgIGZvciAoOyBsYXN0ID49IDA7IGxhc3QtLSkge1xuICAgICAgICB0b01vdmUucHVzaChjaGlsZHJlbltsYXN0XSk7XG4gICAgfVxuICAgIGxpcy5yZXZlcnNlKCk7XG4gICAgLy8gV2Ugc29ydCB0aGUgbm9kZXMgYmVpbmcgbW92ZWQgdG8gZ3VhcmFudGVlIHRoYXQgdGhlaXIgaW5zZXJ0aW9uIG9yZGVyIG1hdGNoZXMgdGhlIGNsYWltIG9yZGVyXG4gICAgdG9Nb3ZlLnNvcnQoKGEsIGIpID0+IGEuY2xhaW1fb3JkZXIgLSBiLmNsYWltX29yZGVyKTtcbiAgICAvLyBGaW5hbGx5LCB3ZSBtb3ZlIHRoZSBub2Rlc1xuICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHRvTW92ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB3aGlsZSAoaiA8IGxpcy5sZW5ndGggJiYgdG9Nb3ZlW2ldLmNsYWltX29yZGVyID49IGxpc1tqXS5jbGFpbV9vcmRlcikge1xuICAgICAgICAgICAgaisrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IGogPCBsaXMubGVuZ3RoID8gbGlzW2pdIDogbnVsbDtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZSh0b01vdmVbaV0sIGFuY2hvcik7XG4gICAgfVxufVxuZnVuY3Rpb24gYXBwZW5kKHRhcmdldCwgbm9kZSkge1xuICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9zdHlsZXModGFyZ2V0LCBzdHlsZV9zaGVldF9pZCwgc3R5bGVzKSB7XG4gICAgY29uc3QgYXBwZW5kX3N0eWxlc190byA9IGdldF9yb290X2Zvcl9zdHlsZSh0YXJnZXQpO1xuICAgIGlmICghYXBwZW5kX3N0eWxlc190by5nZXRFbGVtZW50QnlJZChzdHlsZV9zaGVldF9pZCkpIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBlbGVtZW50KCdzdHlsZScpO1xuICAgICAgICBzdHlsZS5pZCA9IHN0eWxlX3NoZWV0X2lkO1xuICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IHN0eWxlcztcbiAgICAgICAgYXBwZW5kX3N0eWxlc2hlZXQoYXBwZW5kX3N0eWxlc190bywgc3R5bGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9yb290X2Zvcl9zdHlsZShub2RlKSB7XG4gICAgaWYgKCFub2RlKVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgY29uc3Qgcm9vdCA9IG5vZGUuZ2V0Um9vdE5vZGUgPyBub2RlLmdldFJvb3ROb2RlKCkgOiBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgaWYgKHJvb3QgJiYgcm9vdC5ob3N0KSB7XG4gICAgICAgIHJldHVybiByb290O1xuICAgIH1cbiAgICByZXR1cm4gbm9kZS5vd25lckRvY3VtZW50O1xufVxuZnVuY3Rpb24gYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQobm9kZSkge1xuICAgIGNvbnN0IHN0eWxlX2VsZW1lbnQgPSBlbGVtZW50KCdzdHlsZScpO1xuICAgIGFwcGVuZF9zdHlsZXNoZWV0KGdldF9yb290X2Zvcl9zdHlsZShub2RlKSwgc3R5bGVfZWxlbWVudCk7XG4gICAgcmV0dXJuIHN0eWxlX2VsZW1lbnQuc2hlZXQ7XG59XG5mdW5jdGlvbiBhcHBlbmRfc3R5bGVzaGVldChub2RlLCBzdHlsZSkge1xuICAgIGFwcGVuZChub2RlLmhlYWQgfHwgbm9kZSwgc3R5bGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpIHtcbiAgICBpZiAoaXNfaHlkcmF0aW5nKSB7XG4gICAgICAgIGluaXRfaHlkcmF0ZSh0YXJnZXQpO1xuICAgICAgICBpZiAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID09PSB1bmRlZmluZWQpIHx8ICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgIT09IG51bGwpICYmICh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5wYXJlbnRFbGVtZW50ICE9PSB0YXJnZXQpKSkge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSB0YXJnZXQuZmlyc3RDaGlsZDtcbiAgICAgICAgfVxuICAgICAgICAvLyBTa2lwIG5vZGVzIG9mIHVuZGVmaW5lZCBvcmRlcmluZ1xuICAgICAgICB3aGlsZSAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkICE9PSBudWxsKSAmJiAodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQuY2xhaW1fb3JkZXIgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUgIT09IHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkKSB7XG4gICAgICAgICAgICAvLyBXZSBvbmx5IGluc2VydCBpZiB0aGUgb3JkZXJpbmcgb2YgdGhpcyBub2RlIHNob3VsZCBiZSBtb2RpZmllZCBvciB0aGUgcGFyZW50IG5vZGUgaXMgbm90IHRhcmdldFxuICAgICAgICAgICAgaWYgKG5vZGUuY2xhaW1fb3JkZXIgIT09IHVuZGVmaW5lZCB8fCBub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0IHx8IG5vZGUubmV4dFNpYmxpbmcgIT09IG51bGwpIHtcbiAgICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGlmIChpc19oeWRyYXRpbmcgJiYgIWFuY2hvcikge1xuICAgICAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0IHx8IG5vZGUubmV4dFNpYmxpbmcgIT0gYW5jaG9yKSB7XG4gICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaChub2RlKSB7XG4gICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gZGVzdHJveV9lYWNoKGl0ZXJhdGlvbnMsIGRldGFjaGluZykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlcmF0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoaXRlcmF0aW9uc1tpXSlcbiAgICAgICAgICAgIGl0ZXJhdGlvbnNbaV0uZChkZXRhY2hpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGVsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUpO1xufVxuZnVuY3Rpb24gZWxlbWVudF9pcyhuYW1lLCBpcykge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUsIHsgaXMgfSk7XG59XG5mdW5jdGlvbiBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzKG9iaiwgZXhjbHVkZSkge1xuICAgIGNvbnN0IHRhcmdldCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBvYmopIHtcbiAgICAgICAgaWYgKGhhc19wcm9wKG9iaiwgaylcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICYmIGV4Y2x1ZGUuaW5kZXhPZihrKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRhcmdldFtrXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gc3ZnX2VsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgbmFtZSk7XG59XG5mdW5jdGlvbiB0ZXh0KGRhdGEpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YSk7XG59XG5mdW5jdGlvbiBzcGFjZSgpIHtcbiAgICByZXR1cm4gdGV4dCgnICcpO1xufVxuZnVuY3Rpb24gZW1wdHkoKSB7XG4gICAgcmV0dXJuIHRleHQoJycpO1xufVxuZnVuY3Rpb24gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4gbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIHByZXZlbnRfZGVmYXVsdChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHN0b3BfcHJvcGFnYXRpb24oZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2VsZihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRydXN0ZWQoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKGV2ZW50LmlzVHJ1c3RlZClcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICBlbHNlIGlmIChub2RlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpICE9PSB2YWx1ZSlcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBzZXRfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobm9kZS5fX3Byb3RvX18pO1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNba2V5XSA9PSBudWxsKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5jc3NUZXh0ID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ19fdmFsdWUnKSB7XG4gICAgICAgICAgICBub2RlLnZhbHVlID0gbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlc2NyaXB0b3JzW2tleV0gJiYgZGVzY3JpcHRvcnNba2V5XS5zZXQpIHtcbiAgICAgICAgICAgIG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X3N2Z19hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9jdXN0b21fZWxlbWVudF9kYXRhKG5vZGUsIHByb3AsIHZhbHVlKSB7XG4gICAgaWYgKHByb3AgaW4gbm9kZSkge1xuICAgICAgICBub2RlW3Byb3BdID0gdHlwZW9mIG5vZGVbcHJvcF0gPT09ICdib29sZWFuJyAmJiB2YWx1ZSA9PT0gJycgPyB0cnVlIDogdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhdHRyKG5vZGUsIHByb3AsIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB4bGlua19hdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBub2RlLnNldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBnZXRfYmluZGluZ19ncm91cF92YWx1ZShncm91cCwgX192YWx1ZSwgY2hlY2tlZCkge1xuICAgIGNvbnN0IHZhbHVlID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGdyb3VwW2ldLmNoZWNrZWQpXG4gICAgICAgICAgICB2YWx1ZS5hZGQoZ3JvdXBbaV0uX192YWx1ZSk7XG4gICAgfVxuICAgIGlmICghY2hlY2tlZCkge1xuICAgICAgICB2YWx1ZS5kZWxldGUoX192YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBBcnJheS5mcm9tKHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHRvX251bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gJycgPyBudWxsIDogK3ZhbHVlO1xufVxuZnVuY3Rpb24gdGltZV9yYW5nZXNfdG9fYXJyYXkocmFuZ2VzKSB7XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBhcnJheS5wdXNoKHsgc3RhcnQ6IHJhbmdlcy5zdGFydChpKSwgZW5kOiByYW5nZXMuZW5kKGkpIH0pO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5mdW5jdGlvbiBjaGlsZHJlbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKTtcbn1cbmZ1bmN0aW9uIGluaXRfY2xhaW1faW5mbyhub2Rlcykge1xuICAgIGlmIChub2Rlcy5jbGFpbV9pbmZvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbm9kZXMuY2xhaW1faW5mbyA9IHsgbGFzdF9pbmRleDogMCwgdG90YWxfY2xhaW1lZDogMCB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsYWltX25vZGUobm9kZXMsIHByZWRpY2F0ZSwgcHJvY2Vzc05vZGUsIGNyZWF0ZU5vZGUsIGRvbnRVcGRhdGVMYXN0SW5kZXggPSBmYWxzZSkge1xuICAgIC8vIFRyeSB0byBmaW5kIG5vZGVzIGluIGFuIG9yZGVyIHN1Y2ggdGhhdCB3ZSBsZW5ndGhlbiB0aGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlXG4gICAgaW5pdF9jbGFpbV9pbmZvKG5vZGVzKTtcbiAgICBjb25zdCByZXN1bHROb2RlID0gKCgpID0+IHtcbiAgICAgICAgLy8gV2UgZmlyc3QgdHJ5IHRvIGZpbmQgYW4gZWxlbWVudCBhZnRlciB0aGUgcHJldmlvdXMgb25lXG4gICAgICAgIGZvciAobGV0IGkgPSBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXg7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gcHJvY2Vzc05vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFkb250VXBkYXRlTGFzdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgd2UgdHJ5IHRvIGZpbmQgb25lIGJlZm9yZVxuICAgICAgICAvLyBXZSBpdGVyYXRlIGluIHJldmVyc2Ugc28gdGhhdCB3ZSBkb24ndCBnbyB0b28gZmFyIGJhY2tcbiAgICAgICAgZm9yIChsZXQgaSA9IG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBwcm9jZXNzTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWRvbnRVcGRhdGVMYXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB3ZSBzcGxpY2VkIGJlZm9yZSB0aGUgbGFzdF9pbmRleCwgd2UgZGVjcmVhc2UgaXRcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4LS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGNhbid0IGZpbmQgYW55IG1hdGNoaW5nIG5vZGUsIHdlIGNyZWF0ZSBhIG5ldyBvbmVcbiAgICAgICAgcmV0dXJuIGNyZWF0ZU5vZGUoKTtcbiAgICB9KSgpO1xuICAgIHJlc3VsdE5vZGUuY2xhaW1fb3JkZXIgPSBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQ7XG4gICAgbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkICs9IDE7XG4gICAgcmV0dXJuIHJlc3VsdE5vZGU7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIGNyZWF0ZV9lbGVtZW50KSB7XG4gICAgcmV0dXJuIGNsYWltX25vZGUobm9kZXMsIChub2RlKSA9PiBub2RlLm5vZGVOYW1lID09PSBuYW1lLCAobm9kZSkgPT4ge1xuICAgICAgICBjb25zdCByZW1vdmUgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5vZGUuYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlc1thdHRyaWJ1dGUubmFtZV0pIHtcbiAgICAgICAgICAgICAgICByZW1vdmUucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlLmZvckVhY2godiA9PiBub2RlLnJlbW92ZUF0dHJpYnV0ZSh2KSk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSwgKCkgPT4gY3JlYXRlX2VsZW1lbnQobmFtZSkpO1xufVxuZnVuY3Rpb24gY2xhaW1fZWxlbWVudChub2RlcywgbmFtZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIGVsZW1lbnQpO1xufVxuZnVuY3Rpb24gY2xhaW1fc3ZnX2VsZW1lbnQobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBzdmdfZWxlbWVudCk7XG59XG5mdW5jdGlvbiBjbGFpbV90ZXh0KG5vZGVzLCBkYXRhKSB7XG4gICAgcmV0dXJuIGNsYWltX25vZGUobm9kZXMsIChub2RlKSA9PiBub2RlLm5vZGVUeXBlID09PSAzLCAobm9kZSkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhU3RyID0gJycgKyBkYXRhO1xuICAgICAgICBpZiAobm9kZS5kYXRhLnN0YXJ0c1dpdGgoZGF0YVN0cikpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmRhdGEubGVuZ3RoICE9PSBkYXRhU3RyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLnNwbGl0VGV4dChkYXRhU3RyLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlLmRhdGEgPSBkYXRhU3RyO1xuICAgICAgICB9XG4gICAgfSwgKCkgPT4gdGV4dChkYXRhKSwgdHJ1ZSAvLyBUZXh0IG5vZGVzIHNob3VsZCBub3QgdXBkYXRlIGxhc3QgaW5kZXggc2luY2UgaXQgaXMgbGlrZWx5IG5vdCB3b3J0aCBpdCB0byBlbGltaW5hdGUgYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBhY3R1YWwgZWxlbWVudHNcbiAgICApO1xufVxuZnVuY3Rpb24gY2xhaW1fc3BhY2Uobm9kZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fdGV4dChub2RlcywgJyAnKTtcbn1cbmZ1bmN0aW9uIGZpbmRfY29tbWVudChub2RlcywgdGV4dCwgc3RhcnQpIHtcbiAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSA4IC8qIGNvbW1lbnQgbm9kZSAqLyAmJiBub2RlLnRleHRDb250ZW50LnRyaW0oKSA9PT0gdGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vZGVzLmxlbmd0aDtcbn1cbmZ1bmN0aW9uIGNsYWltX2h0bWxfdGFnKG5vZGVzLCBpc19zdmcpIHtcbiAgICAvLyBmaW5kIGh0bWwgb3BlbmluZyB0YWdcbiAgICBjb25zdCBzdGFydF9pbmRleCA9IGZpbmRfY29tbWVudChub2RlcywgJ0hUTUxfVEFHX1NUQVJUJywgMCk7XG4gICAgY29uc3QgZW5kX2luZGV4ID0gZmluZF9jb21tZW50KG5vZGVzLCAnSFRNTF9UQUdfRU5EJywgc3RhcnRfaW5kZXgpO1xuICAgIGlmIChzdGFydF9pbmRleCA9PT0gZW5kX2luZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbih1bmRlZmluZWQsIGlzX3N2Zyk7XG4gICAgfVxuICAgIGluaXRfY2xhaW1faW5mbyhub2Rlcyk7XG4gICAgY29uc3QgaHRtbF90YWdfbm9kZXMgPSBub2Rlcy5zcGxpY2Uoc3RhcnRfaW5kZXgsIGVuZF9pbmRleCAtIHN0YXJ0X2luZGV4ICsgMSk7XG4gICAgZGV0YWNoKGh0bWxfdGFnX25vZGVzWzBdKTtcbiAgICBkZXRhY2goaHRtbF90YWdfbm9kZXNbaHRtbF90YWdfbm9kZXMubGVuZ3RoIC0gMV0pO1xuICAgIGNvbnN0IGNsYWltZWRfbm9kZXMgPSBodG1sX3RhZ19ub2Rlcy5zbGljZSgxLCBodG1sX3RhZ19ub2Rlcy5sZW5ndGggLSAxKTtcbiAgICBmb3IgKGNvbnN0IG4gb2YgY2xhaW1lZF9ub2Rlcykge1xuICAgICAgICBuLmNsYWltX29yZGVyID0gbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkO1xuICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQgKz0gMTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBIdG1sVGFnSHlkcmF0aW9uKGNsYWltZWRfbm9kZXMsIGlzX3N2Zyk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YSh0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgIT09IGRhdGEpXG4gICAgICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgaW5wdXQudmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF90eXBlKGlucHV0LCB0eXBlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaW5wdXQudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3R5bGUobm9kZSwga2V5LCB2YWx1ZSwgaW1wb3J0YW50KSB7XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucmVtb3ZlUHJvcGVydHkoa2V5KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG5vZGUuc3R5bGUuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSwgaW1wb3J0YW50ID8gJ2ltcG9ydGFudCcgOiAnJyk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X29wdGlvbihzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgaWYgKG9wdGlvbi5fX3ZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Quc2VsZWN0ZWRJbmRleCA9IC0xOyAvLyBubyBvcHRpb24gc2hvdWxkIGJlIHNlbGVjdGVkXG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9ucyhzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gfnZhbHVlLmluZGV4T2Yob3B0aW9uLl9fdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF92YWx1ZShzZWxlY3QpIHtcbiAgICBjb25zdCBzZWxlY3RlZF9vcHRpb24gPSBzZWxlY3QucXVlcnlTZWxlY3RvcignOmNoZWNrZWQnKSB8fCBzZWxlY3Qub3B0aW9uc1swXTtcbiAgICByZXR1cm4gc2VsZWN0ZWRfb3B0aW9uICYmIHNlbGVjdGVkX29wdGlvbi5fX3ZhbHVlO1xufVxuZnVuY3Rpb24gc2VsZWN0X211bHRpcGxlX3ZhbHVlKHNlbGVjdCkge1xuICAgIHJldHVybiBbXS5tYXAuY2FsbChzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnOmNoZWNrZWQnKSwgb3B0aW9uID0+IG9wdGlvbi5fX3ZhbHVlKTtcbn1cbi8vIHVuZm9ydHVuYXRlbHkgdGhpcyBjYW4ndCBiZSBhIGNvbnN0YW50IGFzIHRoYXQgd291bGRuJ3QgYmUgdHJlZS1zaGFrZWFibGVcbi8vIHNvIHdlIGNhY2hlIHRoZSByZXN1bHQgaW5zdGVhZFxubGV0IGNyb3Nzb3JpZ2luO1xuZnVuY3Rpb24gaXNfY3Jvc3NvcmlnaW4oKSB7XG4gICAgaWYgKGNyb3Nzb3JpZ2luID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY3Jvc3NvcmlnaW4gPSBmYWxzZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdm9pZCB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY3Jvc3NvcmlnaW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcm9zc29yaWdpbjtcbn1cbmZ1bmN0aW9uIGFkZF9yZXNpemVfbGlzdGVuZXIobm9kZSwgZm4pIHtcbiAgICBjb25zdCBjb21wdXRlZF9zdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKGNvbXB1dGVkX3N0eWxlLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICB9XG4gICAgY29uc3QgaWZyYW1lID0gZWxlbWVudCgnaWZyYW1lJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyBsZWZ0OiAwOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyAnICtcbiAgICAgICAgJ292ZXJmbG93OiBoaWRkZW47IGJvcmRlcjogMDsgb3BhY2l0eTogMDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHotaW5kZXg6IC0xOycpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICBpZnJhbWUudGFiSW5kZXggPSAtMTtcbiAgICBjb25zdCBjcm9zc29yaWdpbiA9IGlzX2Nyb3Nzb3JpZ2luKCk7XG4gICAgbGV0IHVuc3Vic2NyaWJlO1xuICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICBpZnJhbWUuc3JjID0gXCJkYXRhOnRleHQvaHRtbCw8c2NyaXB0Pm9ucmVzaXplPWZ1bmN0aW9uKCl7cGFyZW50LnBvc3RNZXNzYWdlKDAsJyonKX08L3NjcmlwdD5cIjtcbiAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4od2luZG93LCAnbWVzc2FnZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpXG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJztcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKGlmcmFtZS5jb250ZW50V2luZG93LCAncmVzaXplJywgZm4pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhcHBlbmQobm9kZSwgaWZyYW1lKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodW5zdWJzY3JpYmUgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZGV0YWNoKGlmcmFtZSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZV9jbGFzcyhlbGVtZW50LCBuYW1lLCB0b2dnbGUpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdFt0b2dnbGUgPyAnYWRkJyA6ICdyZW1vdmUnXShuYW1lKTtcbn1cbmZ1bmN0aW9uIGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwsIHsgYnViYmxlcyA9IGZhbHNlLCBjYW5jZWxhYmxlID0gZmFsc2UgfSA9IHt9KSB7XG4gICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGJ1YmJsZXMsIGNhbmNlbGFibGUsIGRldGFpbCk7XG4gICAgcmV0dXJuIGU7XG59XG5mdW5jdGlvbiBxdWVyeV9zZWxlY3Rvcl9hbGwoc2VsZWN0b3IsIHBhcmVudCA9IGRvY3VtZW50LmJvZHkpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShwYXJlbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xufVxuY2xhc3MgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoaXNfc3ZnID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5pc19zdmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc19zdmcgPSBpc19zdmc7XG4gICAgICAgIHRoaXMuZSA9IHRoaXMubiA9IG51bGw7XG4gICAgfVxuICAgIGMoaHRtbCkge1xuICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgfVxuICAgIG0oaHRtbCwgdGFyZ2V0LCBhbmNob3IgPSBudWxsKSB7XG4gICAgICAgIGlmICghdGhpcy5lKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc19zdmcpXG4gICAgICAgICAgICAgICAgdGhpcy5lID0gc3ZnX2VsZW1lbnQodGFyZ2V0Lm5vZGVOYW1lKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0aGlzLmUgPSBlbGVtZW50KHRhcmdldC5ub2RlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmMoaHRtbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pKGFuY2hvcik7XG4gICAgfVxuICAgIGgoaHRtbCkge1xuICAgICAgICB0aGlzLmUuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgdGhpcy5uID0gQXJyYXkuZnJvbSh0aGlzLmUuY2hpbGROb2Rlcyk7XG4gICAgfVxuICAgIGkoYW5jaG9yKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpbnNlcnQodGhpcy50LCB0aGlzLm5baV0sIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcChodG1sKSB7XG4gICAgICAgIHRoaXMuZCgpO1xuICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgICAgIHRoaXMuaSh0aGlzLmEpO1xuICAgIH1cbiAgICBkKCkge1xuICAgICAgICB0aGlzLm4uZm9yRWFjaChkZXRhY2gpO1xuICAgIH1cbn1cbmNsYXNzIEh0bWxUYWdIeWRyYXRpb24gZXh0ZW5kcyBIdG1sVGFnIHtcbiAgICBjb25zdHJ1Y3RvcihjbGFpbWVkX25vZGVzLCBpc19zdmcgPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihpc19zdmcpO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgICAgICB0aGlzLmwgPSBjbGFpbWVkX25vZGVzO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgaWYgKHRoaXMubCkge1xuICAgICAgICAgICAgdGhpcy5uID0gdGhpcy5sO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VwZXIuYyhodG1sKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0X2h5ZHJhdGlvbih0aGlzLnQsIHRoaXMubltpXSwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZV90b19vYmplY3QoYXR0cmlidXRlcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgcmVzdWx0W2F0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZS52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMoZWxlbWVudCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHJlc3VsdFtub2RlLnNsb3QgfHwgJ2RlZmF1bHQnXSA9IHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gd2UgbmVlZCB0byBzdG9yZSB0aGUgaW5mb3JtYXRpb24gZm9yIG11bHRpcGxlIGRvY3VtZW50cyBiZWNhdXNlIGEgU3ZlbHRlIGFwcGxpY2F0aW9uIGNvdWxkIGFsc28gY29udGFpbiBpZnJhbWVzXG4vLyBodHRwczovL2dpdGh1Yi5jb20vc3ZlbHRlanMvc3ZlbHRlL2lzc3Vlcy8zNjI0XG5jb25zdCBtYW5hZ2VkX3N0eWxlcyA9IG5ldyBNYXAoKTtcbmxldCBhY3RpdmUgPSAwO1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Rhcmtza3lhcHAvc3RyaW5nLWhhc2gvYmxvYi9tYXN0ZXIvaW5kZXguanNcbmZ1bmN0aW9uIGhhc2goc3RyKSB7XG4gICAgbGV0IGhhc2ggPSA1MzgxO1xuICAgIGxldCBpID0gc3RyLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgXiBzdHIuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gaGFzaCA+Pj4gMDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zdHlsZV9pbmZvcm1hdGlvbihkb2MsIG5vZGUpIHtcbiAgICBjb25zdCBpbmZvID0geyBzdHlsZXNoZWV0OiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSwgcnVsZXM6IHt9IH07XG4gICAgbWFuYWdlZF9zdHlsZXMuc2V0KGRvYywgaW5mbyk7XG4gICAgcmV0dXJuIGluZm87XG59XG5mdW5jdGlvbiBjcmVhdGVfcnVsZShub2RlLCBhLCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2UsIGZuLCB1aWQgPSAwKSB7XG4gICAgY29uc3Qgc3RlcCA9IDE2LjY2NiAvIGR1cmF0aW9uO1xuICAgIGxldCBrZXlmcmFtZXMgPSAne1xcbic7XG4gICAgZm9yIChsZXQgcCA9IDA7IHAgPD0gMTsgcCArPSBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhICsgKGIgLSBhKSAqIGVhc2UocCk7XG4gICAgICAgIGtleWZyYW1lcyArPSBwICogMTAwICsgYCV7JHtmbih0LCAxIC0gdCl9fVxcbmA7XG4gICAgfVxuICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXMgKyBgMTAwJSB7JHtmbihiLCAxIC0gYil9fVxcbn1gO1xuICAgIGNvbnN0IG5hbWUgPSBgX19zdmVsdGVfJHtoYXNoKHJ1bGUpfV8ke3VpZH1gO1xuICAgIGNvbnN0IGRvYyA9IGdldF9yb290X2Zvcl9zdHlsZShub2RlKTtcbiAgICBjb25zdCB7IHN0eWxlc2hlZXQsIHJ1bGVzIH0gPSBtYW5hZ2VkX3N0eWxlcy5nZXQoZG9jKSB8fCBjcmVhdGVfc3R5bGVfaW5mb3JtYXRpb24oZG9jLCBub2RlKTtcbiAgICBpZiAoIXJ1bGVzW25hbWVdKSB7XG4gICAgICAgIHJ1bGVzW25hbWVdID0gdHJ1ZTtcbiAgICAgICAgc3R5bGVzaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7bmFtZX0gJHtydWxlfWAsIHN0eWxlc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbiAgICB9XG4gICAgY29uc3QgYW5pbWF0aW9uID0gbm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJyc7XG4gICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBgJHthbmltYXRpb24gPyBgJHthbmltYXRpb259LCBgIDogJyd9JHtuYW1lfSAke2R1cmF0aW9ufW1zIGxpbmVhciAke2RlbGF5fW1zIDEgYm90aGA7XG4gICAgYWN0aXZlICs9IDE7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5mdW5jdGlvbiBkZWxldGVfcnVsZShub2RlLCBuYW1lKSB7XG4gICAgY29uc3QgcHJldmlvdXMgPSAobm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJycpLnNwbGl0KCcsICcpO1xuICAgIGNvbnN0IG5leHQgPSBwcmV2aW91cy5maWx0ZXIobmFtZVxuICAgICAgICA/IGFuaW0gPT4gYW5pbS5pbmRleE9mKG5hbWUpIDwgMCAvLyByZW1vdmUgc3BlY2lmaWMgYW5pbWF0aW9uXG4gICAgICAgIDogYW5pbSA9PiBhbmltLmluZGV4T2YoJ19fc3ZlbHRlJykgPT09IC0xIC8vIHJlbW92ZSBhbGwgU3ZlbHRlIGFuaW1hdGlvbnNcbiAgICApO1xuICAgIGNvbnN0IGRlbGV0ZWQgPSBwcmV2aW91cy5sZW5ndGggLSBuZXh0Lmxlbmd0aDtcbiAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IG5leHQuam9pbignLCAnKTtcbiAgICAgICAgYWN0aXZlIC09IGRlbGV0ZWQ7XG4gICAgICAgIGlmICghYWN0aXZlKVxuICAgICAgICAgICAgY2xlYXJfcnVsZXMoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjbGVhcl9ydWxlcygpIHtcbiAgICByYWYoKCkgPT4ge1xuICAgICAgICBpZiAoYWN0aXZlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBtYW5hZ2VkX3N0eWxlcy5mb3JFYWNoKGluZm8gPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzdHlsZXNoZWV0IH0gPSBpbmZvO1xuICAgICAgICAgICAgbGV0IGkgPSBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICAgICAgc3R5bGVzaGVldC5kZWxldGVSdWxlKGkpO1xuICAgICAgICAgICAgaW5mby5ydWxlcyA9IHt9O1xuICAgICAgICB9KTtcbiAgICAgICAgbWFuYWdlZF9zdHlsZXMuY2xlYXIoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbicpO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwsIHsgY2FuY2VsYWJsZSA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSBjb21wb25lbnQuJCQuY2FsbGJhY2tzW3R5cGVdO1xuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICAvLyBUT0RPIGFyZSB0aGVyZSBzaXR1YXRpb25zIHdoZXJlIGV2ZW50cyBjb3VsZCBiZSBkaXNwYXRjaGVkXG4gICAgICAgICAgICAvLyBpbiBhIHNlcnZlciAobm9uLURPTSkgZW52aXJvbm1lbnQ/XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwsIHsgY2FuY2VsYWJsZSB9KTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2V0Q29udGV4dChrZXksIGNvbnRleHQpIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LnNldChrZXksIGNvbnRleHQpO1xuICAgIHJldHVybiBjb250ZXh0O1xufVxuZnVuY3Rpb24gZ2V0Q29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5nZXQoa2V5KTtcbn1cbmZ1bmN0aW9uIGdldEFsbENvbnRleHRzKCkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0O1xufVxuZnVuY3Rpb24gaGFzQ29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5oYXMoa2V5KTtcbn1cbi8vIFRPRE8gZmlndXJlIG91dCBpZiB3ZSBzdGlsbCB3YW50IHRvIHN1cHBvcnRcbi8vIHNob3J0aGFuZCBldmVudHMsIG9yIGlmIHdlIHdhbnQgdG8gaW1wbGVtZW50XG4vLyBhIHJlYWwgYnViYmxpbmcgbWVjaGFuaXNtXG5mdW5jdGlvbiBidWJibGUoY29tcG9uZW50LCBldmVudCkge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbZXZlbnQudHlwZV07XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4gZm4uY2FsbCh0aGlzLCBldmVudCkpO1xuICAgIH1cbn1cblxuY29uc3QgZGlydHlfY29tcG9uZW50cyA9IFtdO1xuY29uc3QgaW50cm9zID0geyBlbmFibGVkOiBmYWxzZSB9O1xuY29uc3QgYmluZGluZ19jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlbmRlcl9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IGZsdXNoX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVzb2x2ZWRfcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xubGV0IHVwZGF0ZV9zY2hlZHVsZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIHNjaGVkdWxlX3VwZGF0ZSgpIHtcbiAgICBpZiAoIXVwZGF0ZV9zY2hlZHVsZWQpIHtcbiAgICAgICAgdXBkYXRlX3NjaGVkdWxlZCA9IHRydWU7XG4gICAgICAgIHJlc29sdmVkX3Byb21pc2UudGhlbihmbHVzaCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdGljaygpIHtcbiAgICBzY2hlZHVsZV91cGRhdGUoKTtcbiAgICByZXR1cm4gcmVzb2x2ZWRfcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGFkZF9yZW5kZXJfY2FsbGJhY2soZm4pIHtcbiAgICByZW5kZXJfY2FsbGJhY2tzLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gYWRkX2ZsdXNoX2NhbGxiYWNrKGZuKSB7XG4gICAgZmx1c2hfY2FsbGJhY2tzLnB1c2goZm4pO1xufVxuLy8gZmx1c2goKSBjYWxscyBjYWxsYmFja3MgaW4gdGhpcyBvcmRlcjpcbi8vIDEuIEFsbCBiZWZvcmVVcGRhdGUgY2FsbGJhY2tzLCBpbiBvcmRlcjogcGFyZW50cyBiZWZvcmUgY2hpbGRyZW5cbi8vIDIuIEFsbCBiaW5kOnRoaXMgY2FsbGJhY2tzLCBpbiByZXZlcnNlIG9yZGVyOiBjaGlsZHJlbiBiZWZvcmUgcGFyZW50cy5cbi8vIDMuIEFsbCBhZnRlclVwZGF0ZSBjYWxsYmFja3MsIGluIG9yZGVyOiBwYXJlbnRzIGJlZm9yZSBjaGlsZHJlbi4gRVhDRVBUXG4vLyAgICBmb3IgYWZ0ZXJVcGRhdGVzIGNhbGxlZCBkdXJpbmcgdGhlIGluaXRpYWwgb25Nb3VudCwgd2hpY2ggYXJlIGNhbGxlZCBpblxuLy8gICAgcmV2ZXJzZSBvcmRlcjogY2hpbGRyZW4gYmVmb3JlIHBhcmVudHMuXG4vLyBTaW5jZSBjYWxsYmFja3MgbWlnaHQgdXBkYXRlIGNvbXBvbmVudCB2YWx1ZXMsIHdoaWNoIGNvdWxkIHRyaWdnZXIgYW5vdGhlclxuLy8gY2FsbCB0byBmbHVzaCgpLCB0aGUgZm9sbG93aW5nIHN0ZXBzIGd1YXJkIGFnYWluc3QgdGhpczpcbi8vIDEuIER1cmluZyBiZWZvcmVVcGRhdGUsIGFueSB1cGRhdGVkIGNvbXBvbmVudHMgd2lsbCBiZSBhZGRlZCB0byB0aGVcbi8vICAgIGRpcnR5X2NvbXBvbmVudHMgYXJyYXkgYW5kIHdpbGwgY2F1c2UgYSByZWVudHJhbnQgY2FsbCB0byBmbHVzaCgpLiBCZWNhdXNlXG4vLyAgICB0aGUgZmx1c2ggaW5kZXggaXMga2VwdCBvdXRzaWRlIHRoZSBmdW5jdGlvbiwgdGhlIHJlZW50cmFudCBjYWxsIHdpbGwgcGlja1xuLy8gICAgdXAgd2hlcmUgdGhlIGVhcmxpZXIgY2FsbCBsZWZ0IG9mZiBhbmQgZ28gdGhyb3VnaCBhbGwgZGlydHkgY29tcG9uZW50cy4gVGhlXG4vLyAgICBjdXJyZW50X2NvbXBvbmVudCB2YWx1ZSBpcyBzYXZlZCBhbmQgcmVzdG9yZWQgc28gdGhhdCB0aGUgcmVlbnRyYW50IGNhbGwgd2lsbFxuLy8gICAgbm90IGludGVyZmVyZSB3aXRoIHRoZSBcInBhcmVudFwiIGZsdXNoKCkgY2FsbC5cbi8vIDIuIGJpbmQ6dGhpcyBjYWxsYmFja3MgY2Fubm90IHRyaWdnZXIgbmV3IGZsdXNoKCkgY2FsbHMuXG4vLyAzLiBEdXJpbmcgYWZ0ZXJVcGRhdGUsIGFueSB1cGRhdGVkIGNvbXBvbmVudHMgd2lsbCBOT1QgaGF2ZSB0aGVpciBhZnRlclVwZGF0ZVxuLy8gICAgY2FsbGJhY2sgY2FsbGVkIGEgc2Vjb25kIHRpbWU7IHRoZSBzZWVuX2NhbGxiYWNrcyBzZXQsIG91dHNpZGUgdGhlIGZsdXNoKClcbi8vICAgIGZ1bmN0aW9uLCBndWFyYW50ZWVzIHRoaXMgYmVoYXZpb3IuXG5jb25zdCBzZWVuX2NhbGxiYWNrcyA9IG5ldyBTZXQoKTtcbmxldCBmbHVzaGlkeCA9IDA7IC8vIERvICpub3QqIG1vdmUgdGhpcyBpbnNpZGUgdGhlIGZsdXNoKCkgZnVuY3Rpb25cbmZ1bmN0aW9uIGZsdXNoKCkge1xuICAgIGNvbnN0IHNhdmVkX2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIGRvIHtcbiAgICAgICAgLy8gZmlyc3QsIGNhbGwgYmVmb3JlVXBkYXRlIGZ1bmN0aW9uc1xuICAgICAgICAvLyBhbmQgdXBkYXRlIGNvbXBvbmVudHNcbiAgICAgICAgd2hpbGUgKGZsdXNoaWR4IDwgZGlydHlfY29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGRpcnR5X2NvbXBvbmVudHNbZmx1c2hpZHhdO1xuICAgICAgICAgICAgZmx1c2hpZHgrKztcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGNvbXBvbmVudC4kJCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIGZsdXNoaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGJpbmRpbmdfY2FsbGJhY2tzLmxlbmd0aClcbiAgICAgICAgICAgIGJpbmRpbmdfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgIC8vIHRoZW4sIG9uY2UgY29tcG9uZW50cyBhcmUgdXBkYXRlZCwgY2FsbFxuICAgICAgICAvLyBhZnRlclVwZGF0ZSBmdW5jdGlvbnMuIFRoaXMgbWF5IGNhdXNlXG4gICAgICAgIC8vIHN1YnNlcXVlbnQgdXBkYXRlcy4uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gcmVuZGVyX2NhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgIGlmICghc2Vlbl9jYWxsYmFja3MuaGFzKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICAgIC8vIC4uLnNvIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgbG9vcHNcbiAgICAgICAgICAgICAgICBzZWVuX2NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgIH0gd2hpbGUgKGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKTtcbiAgICB3aGlsZSAoZmx1c2hfY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICBmbHVzaF9jYWxsYmFja3MucG9wKCkoKTtcbiAgICB9XG4gICAgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIHNlZW5fY2FsbGJhY2tzLmNsZWFyKCk7XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHNhdmVkX2NvbXBvbmVudCk7XG59XG5mdW5jdGlvbiB1cGRhdGUoJCQpIHtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgJCQudXBkYXRlKCk7XG4gICAgICAgIHJ1bl9hbGwoJCQuYmVmb3JlX3VwZGF0ZSk7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gJCQuZGlydHk7XG4gICAgICAgICQkLmRpcnR5ID0gWy0xXTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQucCgkJC5jdHgsIGRpcnR5KTtcbiAgICAgICAgJCQuYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG4gICAgfVxufVxuXG5sZXQgcHJvbWlzZTtcbmZ1bmN0aW9uIHdhaXQoKSB7XG4gICAgaWYgKCFwcm9taXNlKSB7XG4gICAgICAgIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5mdW5jdGlvbiBkaXNwYXRjaChub2RlLCBkaXJlY3Rpb24sIGtpbmQpIHtcbiAgICBub2RlLmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KGAke2RpcmVjdGlvbiA/ICdpbnRybycgOiAnb3V0cm8nfSR7a2luZH1gKSk7XG59XG5jb25zdCBvdXRyb2luZyA9IG5ldyBTZXQoKTtcbmxldCBvdXRyb3M7XG5mdW5jdGlvbiBncm91cF9vdXRyb3MoKSB7XG4gICAgb3V0cm9zID0ge1xuICAgICAgICByOiAwLFxuICAgICAgICBjOiBbXSxcbiAgICAgICAgcDogb3V0cm9zIC8vIHBhcmVudCBncm91cFxuICAgIH07XG59XG5mdW5jdGlvbiBjaGVja19vdXRyb3MoKSB7XG4gICAgaWYgKCFvdXRyb3Mucikge1xuICAgICAgICBydW5fYWxsKG91dHJvcy5jKTtcbiAgICB9XG4gICAgb3V0cm9zID0gb3V0cm9zLnA7XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX2luKGJsb2NrLCBsb2NhbCkge1xuICAgIGlmIChibG9jayAmJiBibG9jay5pKSB7XG4gICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgIGJsb2NrLmkobG9jYWwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25fb3V0KGJsb2NrLCBsb2NhbCwgZGV0YWNoLCBjYWxsYmFjaykge1xuICAgIGlmIChibG9jayAmJiBibG9jay5vKSB7XG4gICAgICAgIGlmIChvdXRyb2luZy5oYXMoYmxvY2spKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvdXRyb2luZy5hZGQoYmxvY2spO1xuICAgICAgICBvdXRyb3MuYy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoZGV0YWNoKVxuICAgICAgICAgICAgICAgICAgICBibG9jay5kKDEpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBibG9jay5vKGxvY2FsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICB9XG59XG5jb25zdCBudWxsX3RyYW5zaXRpb24gPSB7IGR1cmF0aW9uOiAwIH07XG5mdW5jdGlvbiBjcmVhdGVfaW5fdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSBmYWxzZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IHVpZCA9IDA7XG4gICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMCwgMSwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcywgdWlkKyspO1xuICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGlmICh0YXNrKVxuICAgICAgICAgICAgdGFzay5hYm9ydCgpO1xuICAgICAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCB0cnVlLCAnc3RhcnQnKSk7XG4gICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0KCkge1xuICAgICAgICAgICAgaWYgKHN0YXJ0ZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlKTtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oZ28pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW52YWxpZGF0ZSgpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBjb25zdCBncm91cCA9IG91dHJvcztcbiAgICBncm91cC5yICs9IDE7XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDEsIDAsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdzdGFydCcpKTtcbiAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghLS1ncm91cC5yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmVzdWx0IGluIGBlbmQoKWAgYmVpbmcgY2FsbGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgZG9uJ3QgbmVlZCB0byBjbGVhbiB1cCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKGdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEgLSB0LCB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBnbygpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBlbmQocmVzZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXNldCAmJiBjb25maWcudGljaykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy50aWNrKDEsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zLCBpbnRybykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCB0ID0gaW50cm8gPyAwIDogMTtcbiAgICBsZXQgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWUgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGNsZWFyX2FuaW1hdGlvbigpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbml0KHByb2dyYW0sIGR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGQgPSAocHJvZ3JhbS5iIC0gdCk7XG4gICAgICAgIGR1cmF0aW9uICo9IE1hdGguYWJzKGQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYTogdCxcbiAgICAgICAgICAgIGI6IHByb2dyYW0uYixcbiAgICAgICAgICAgIGQsXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIHN0YXJ0OiBwcm9ncmFtLnN0YXJ0LFxuICAgICAgICAgICAgZW5kOiBwcm9ncmFtLnN0YXJ0ICsgZHVyYXRpb24sXG4gICAgICAgICAgICBncm91cDogcHJvZ3JhbS5ncm91cFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbyhiKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSB7XG4gICAgICAgICAgICBzdGFydDogbm93KCkgKyBkZWxheSxcbiAgICAgICAgICAgIGJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFiKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgcHJvZ3JhbS5ncm91cCA9IG91dHJvcztcbiAgICAgICAgICAgIG91dHJvcy5yICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IHByb2dyYW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGludHJvLCBhbmQgdGhlcmUncyBhIGRlbGF5LCB3ZSBuZWVkIHRvIGRvXG4gICAgICAgICAgICAvLyBhbiBpbml0aWFsIHRpY2sgYW5kL29yIGFwcGx5IENTUyBhbmltYXRpb24gaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIGIsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGIpXG4gICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBiLCAnc3RhcnQnKSk7XG4gICAgICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdfcHJvZ3JhbSAmJiBub3cgPiBwZW5kaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwZW5kaW5nX3Byb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdzdGFydCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgcnVubmluZ19wcm9ncmFtLmIsIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbiwgMCwgZWFzaW5nLCBjb25maWcuY3NzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLmVuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0ID0gcnVubmluZ19wcm9ncmFtLmIsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtLmIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW50cm8g4oCUIHdlIGNhbiB0aWR5IHVwIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3V0cm8g4oCUIG5lZWRzIHRvIGJlIGNvb3JkaW5hdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghLS1ydW5uaW5nX3Byb2dyYW0uZ3JvdXAucilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwocnVubmluZ19wcm9ncmFtLmdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHJ1bm5pbmdfcHJvZ3JhbS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBydW5uaW5nX3Byb2dyYW0uYSArIHJ1bm5pbmdfcHJvZ3JhbS5kICogZWFzaW5nKHAgLyBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcnVuKGIpIHtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVfcHJvbWlzZShwcm9taXNlLCBpbmZvKSB7XG4gICAgY29uc3QgdG9rZW4gPSBpbmZvLnRva2VuID0ge307XG4gICAgZnVuY3Rpb24gdXBkYXRlKHR5cGUsIGluZGV4LCBrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmIChpbmZvLnRva2VuICE9PSB0b2tlbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHZhbHVlO1xuICAgICAgICBsZXQgY2hpbGRfY3R4ID0gaW5mby5jdHg7XG4gICAgICAgIGlmIChrZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2hpbGRfY3R4ID0gY2hpbGRfY3R4LnNsaWNlKCk7XG4gICAgICAgICAgICBjaGlsZF9jdHhba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJsb2NrID0gdHlwZSAmJiAoaW5mby5jdXJyZW50ID0gdHlwZSkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IG5lZWRzX2ZsdXNoID0gZmFsc2U7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrKSB7XG4gICAgICAgICAgICBpZiAoaW5mby5ibG9ja3MpIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaW5kZXggJiYgYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5ibG9ja3NbaV0gPT09IGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2NrLmQoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jKCk7XG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGJsb2NrLCAxKTtcbiAgICAgICAgICAgIGJsb2NrLm0oaW5mby5tb3VudCgpLCBpbmZvLmFuY2hvcik7XG4gICAgICAgICAgICBuZWVkc19mbHVzaCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5ibG9jayA9IGJsb2NrO1xuICAgICAgICBpZiAoaW5mby5ibG9ja3MpXG4gICAgICAgICAgICBpbmZvLmJsb2Nrc1tpbmRleF0gPSBibG9jaztcbiAgICAgICAgaWYgKG5lZWRzX2ZsdXNoKSB7XG4gICAgICAgICAgICBmbHVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChpc19wcm9taXNlKHByb21pc2UpKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgICAgIHByb21pc2UudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8uY2F0Y2gsIDIsIGluZm8uZXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgICAgIGlmICghaW5mby5oYXNDYXRjaCkge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gaWYgd2UgcHJldmlvdXNseSBoYWQgYSB0aGVuL2NhdGNoIGJsb2NrLCBkZXN0cm95IGl0XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8ucGVuZGluZykge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8ucGVuZGluZywgMCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby50aGVuKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSBwcm9taXNlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2goaW5mbywgY3R4LCBkaXJ0eSkge1xuICAgIGNvbnN0IGNoaWxkX2N0eCA9IGN0eC5zbGljZSgpO1xuICAgIGNvbnN0IHsgcmVzb2x2ZWQgfSA9IGluZm87XG4gICAgaWYgKGluZm8uY3VycmVudCA9PT0gaW5mby50aGVuKSB7XG4gICAgICAgIGNoaWxkX2N0eFtpbmZvLnZhbHVlXSA9IHJlc29sdmVkO1xuICAgIH1cbiAgICBpZiAoaW5mby5jdXJyZW50ID09PSBpbmZvLmNhdGNoKSB7XG4gICAgICAgIGNoaWxkX2N0eFtpbmZvLmVycm9yXSA9IHJlc29sdmVkO1xuICAgIH1cbiAgICBpbmZvLmJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG59XG5cbmNvbnN0IGdsb2JhbHMgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IHdpbmRvd1xuICAgIDogdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXG4gICAgICAgID8gZ2xvYmFsVGhpc1xuICAgICAgICA6IGdsb2JhbCk7XG5cbmZ1bmN0aW9uIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmQoMSk7XG4gICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xufVxuZnVuY3Rpb24gb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiB1cGRhdGVfa2V5ZWRfZWFjaChvbGRfYmxvY2tzLCBkaXJ0eSwgZ2V0X2tleSwgZHluYW1pYywgY3R4LCBsaXN0LCBsb29rdXAsIG5vZGUsIGRlc3Ryb3ksIGNyZWF0ZV9lYWNoX2Jsb2NrLCBuZXh0LCBnZXRfY29udGV4dCkge1xuICAgIGxldCBvID0gb2xkX2Jsb2Nrcy5sZW5ndGg7XG4gICAgbGV0IG4gPSBsaXN0Lmxlbmd0aDtcbiAgICBsZXQgaSA9IG87XG4gICAgY29uc3Qgb2xkX2luZGV4ZXMgPSB7fTtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBvbGRfaW5kZXhlc1tvbGRfYmxvY2tzW2ldLmtleV0gPSBpO1xuICAgIGNvbnN0IG5ld19ibG9ja3MgPSBbXTtcbiAgICBjb25zdCBuZXdfbG9va3VwID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGRlbHRhcyA9IG5ldyBNYXAoKTtcbiAgICBpID0gbjtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkX2N0eCA9IGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSk7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IGJsb2NrID0gbG9va3VwLmdldChrZXkpO1xuICAgICAgICBpZiAoIWJsb2NrKSB7XG4gICAgICAgICAgICBibG9jayA9IGNyZWF0ZV9lYWNoX2Jsb2NrKGtleSwgY2hpbGRfY3R4KTtcbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkeW5hbWljKSB7XG4gICAgICAgICAgICBibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xuICAgICAgICB9XG4gICAgICAgIG5ld19sb29rdXAuc2V0KGtleSwgbmV3X2Jsb2Nrc1tpXSA9IGJsb2NrKTtcbiAgICAgICAgaWYgKGtleSBpbiBvbGRfaW5kZXhlcylcbiAgICAgICAgICAgIGRlbHRhcy5zZXQoa2V5LCBNYXRoLmFicyhpIC0gb2xkX2luZGV4ZXNba2V5XSkpO1xuICAgIH1cbiAgICBjb25zdCB3aWxsX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgZGlkX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgZnVuY3Rpb24gaW5zZXJ0KGJsb2NrKSB7XG4gICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICBibG9jay5tKG5vZGUsIG5leHQpO1xuICAgICAgICBsb29rdXAuc2V0KGJsb2NrLmtleSwgYmxvY2spO1xuICAgICAgICBuZXh0ID0gYmxvY2suZmlyc3Q7XG4gICAgICAgIG4tLTtcbiAgICB9XG4gICAgd2hpbGUgKG8gJiYgbikge1xuICAgICAgICBjb25zdCBuZXdfYmxvY2sgPSBuZXdfYmxvY2tzW24gLSAxXTtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvIC0gMV07XG4gICAgICAgIGNvbnN0IG5ld19rZXkgPSBuZXdfYmxvY2sua2V5O1xuICAgICAgICBjb25zdCBvbGRfa2V5ID0gb2xkX2Jsb2NrLmtleTtcbiAgICAgICAgaWYgKG5ld19ibG9jayA9PT0gb2xkX2Jsb2NrKSB7XG4gICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICBuZXh0ID0gbmV3X2Jsb2NrLmZpcnN0O1xuICAgICAgICAgICAgby0tO1xuICAgICAgICAgICAgbi0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBibG9ja1xuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWxvb2t1cC5oYXMobmV3X2tleSkgfHwgd2lsbF9tb3ZlLmhhcyhuZXdfa2V5KSkge1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlkX21vdmUuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVsdGFzLmdldChuZXdfa2V5KSA+IGRlbHRhcy5nZXQob2xkX2tleSkpIHtcbiAgICAgICAgICAgIGRpZF9tb3ZlLmFkZChuZXdfa2V5KTtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgd2lsbF9tb3ZlLmFkZChvbGRfa2V5KTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAoby0tKSB7XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3Nbb107XG4gICAgICAgIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2Jsb2NrLmtleSkpXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICB9XG4gICAgd2hpbGUgKG4pXG4gICAgICAgIGluc2VydChuZXdfYmxvY2tzW24gLSAxXSk7XG4gICAgcmV0dXJuIG5ld19ibG9ja3M7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2tleXMoY3R4LCBsaXN0LCBnZXRfY29udGV4dCwgZ2V0X2tleSkge1xuICAgIGNvbnN0IGtleXMgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKSk7XG4gICAgICAgIGlmIChrZXlzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBoYXZlIGR1cGxpY2F0ZSBrZXlzIGluIGEga2V5ZWQgZWFjaCcpO1xuICAgICAgICB9XG4gICAgICAgIGtleXMuYWRkKGtleSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRfc3ByZWFkX3VwZGF0ZShsZXZlbHMsIHVwZGF0ZXMpIHtcbiAgICBjb25zdCB1cGRhdGUgPSB7fTtcbiAgICBjb25zdCB0b19udWxsX291dCA9IHt9O1xuICAgIGNvbnN0IGFjY291bnRlZF9mb3IgPSB7ICQkc2NvcGU6IDEgfTtcbiAgICBsZXQgaSA9IGxldmVscy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBvID0gbGV2ZWxzW2ldO1xuICAgICAgICBjb25zdCBuID0gdXBkYXRlc1tpXTtcbiAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gbikpXG4gICAgICAgICAgICAgICAgICAgIHRvX251bGxfb3V0W2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbikge1xuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudGVkX2ZvcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gbltrZXldO1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldmVsc1tpXSA9IG47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0b19udWxsX291dCkge1xuICAgICAgICBpZiAoIShrZXkgaW4gdXBkYXRlKSlcbiAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlO1xufVxuZnVuY3Rpb24gZ2V0X3NwcmVhZF9vYmplY3Qoc3ByZWFkX3Byb3BzKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBzcHJlYWRfcHJvcHMgPT09ICdvYmplY3QnICYmIHNwcmVhZF9wcm9wcyAhPT0gbnVsbCA/IHNwcmVhZF9wcm9wcyA6IHt9O1xufVxuXG4vLyBzb3VyY2U6IGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbFxuY29uc3QgYm9vbGVhbl9hdHRyaWJ1dGVzID0gbmV3IFNldChbXG4gICAgJ2FsbG93ZnVsbHNjcmVlbicsXG4gICAgJ2FsbG93cGF5bWVudHJlcXVlc3QnLFxuICAgICdhc3luYycsXG4gICAgJ2F1dG9mb2N1cycsXG4gICAgJ2F1dG9wbGF5JyxcbiAgICAnY2hlY2tlZCcsXG4gICAgJ2NvbnRyb2xzJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RlZmVyJyxcbiAgICAnZGlzYWJsZWQnLFxuICAgICdmb3Jtbm92YWxpZGF0ZScsXG4gICAgJ2hpZGRlbicsXG4gICAgJ2lzbWFwJyxcbiAgICAnbG9vcCcsXG4gICAgJ211bHRpcGxlJyxcbiAgICAnbXV0ZWQnLFxuICAgICdub21vZHVsZScsXG4gICAgJ25vdmFsaWRhdGUnLFxuICAgICdvcGVuJyxcbiAgICAncGxheXNpbmxpbmUnLFxuICAgICdyZWFkb25seScsXG4gICAgJ3JlcXVpcmVkJyxcbiAgICAncmV2ZXJzZWQnLFxuICAgICdzZWxlY3RlZCdcbl0pO1xuXG5jb25zdCB2b2lkX2VsZW1lbnRfbmFtZXMgPSAvXig/OmFyZWF8YmFzZXxicnxjb2x8Y29tbWFuZHxlbWJlZHxocnxpbWd8aW5wdXR8a2V5Z2VufGxpbmt8bWV0YXxwYXJhbXxzb3VyY2V8dHJhY2t8d2JyKSQvO1xuZnVuY3Rpb24gaXNfdm9pZChuYW1lKSB7XG4gICAgcmV0dXJuIHZvaWRfZWxlbWVudF9uYW1lcy50ZXN0KG5hbWUpIHx8IG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJyFkb2N0eXBlJztcbn1cblxuY29uc3QgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIgPSAvW1xccydcIj4vPVxcdXtGREQwfS1cXHV7RkRFRn1cXHV7RkZGRX1cXHV7RkZGRn1cXHV7MUZGRkV9XFx1ezFGRkZGfVxcdXsyRkZGRX1cXHV7MkZGRkZ9XFx1ezNGRkZFfVxcdXszRkZGRn1cXHV7NEZGRkV9XFx1ezRGRkZGfVxcdXs1RkZGRX1cXHV7NUZGRkZ9XFx1ezZGRkZFfVxcdXs2RkZGRn1cXHV7N0ZGRkV9XFx1ezdGRkZGfVxcdXs4RkZGRX1cXHV7OEZGRkZ9XFx1ezlGRkZFfVxcdXs5RkZGRn1cXHV7QUZGRkV9XFx1e0FGRkZGfVxcdXtCRkZGRX1cXHV7QkZGRkZ9XFx1e0NGRkZFfVxcdXtDRkZGRn1cXHV7REZGRkV9XFx1e0RGRkZGfVxcdXtFRkZGRX1cXHV7RUZGRkZ9XFx1e0ZGRkZFfVxcdXtGRkZGRn1cXHV7MTBGRkZFfVxcdXsxMEZGRkZ9XS91O1xuLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjYXR0cmlidXRlcy0yXG4vLyBodHRwczovL2luZnJhLnNwZWMud2hhdHdnLm9yZy8jbm9uY2hhcmFjdGVyXG5mdW5jdGlvbiBzcHJlYWQoYXJncywgYXR0cnNfdG9fYWRkKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IE9iamVjdC5hc3NpZ24oe30sIC4uLmFyZ3MpO1xuICAgIGlmIChhdHRyc190b19hZGQpIHtcbiAgICAgICAgY29uc3QgY2xhc3Nlc190b19hZGQgPSBhdHRyc190b19hZGQuY2xhc3NlcztcbiAgICAgICAgY29uc3Qgc3R5bGVzX3RvX2FkZCA9IGF0dHJzX3RvX2FkZC5zdHlsZXM7XG4gICAgICAgIGlmIChjbGFzc2VzX3RvX2FkZCkge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuY2xhc3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgKz0gJyAnICsgY2xhc3Nlc190b19hZGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0eWxlc190b19hZGQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLnN0eWxlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhzdHlsZXNfdG9fYWRkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuc3R5bGUgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKG1lcmdlX3Nzcl9zdHlsZXMoYXR0cmlidXRlcy5zdHlsZSwgc3R5bGVzX3RvX2FkZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBzdHIgPSAnJztcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBpZiAoaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIudGVzdChuYW1lKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUgPT09IHRydWUpXG4gICAgICAgICAgICBzdHIgKz0gJyAnICsgbmFtZTtcbiAgICAgICAgZWxzZSBpZiAoYm9vbGVhbl9hdHRyaWJ1dGVzLmhhcyhuYW1lLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RyICs9IGAgJHtuYW1lfT1cIiR7dmFsdWV9XCJgO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHN0cjtcbn1cbmZ1bmN0aW9uIG1lcmdlX3Nzcl9zdHlsZXMoc3R5bGVfYXR0cmlidXRlLCBzdHlsZV9kaXJlY3RpdmUpIHtcbiAgICBjb25zdCBzdHlsZV9vYmplY3QgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGluZGl2aWR1YWxfc3R5bGUgb2Ygc3R5bGVfYXR0cmlidXRlLnNwbGl0KCc7JykpIHtcbiAgICAgICAgY29uc3QgY29sb25faW5kZXggPSBpbmRpdmlkdWFsX3N0eWxlLmluZGV4T2YoJzonKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IGluZGl2aWR1YWxfc3R5bGUuc2xpY2UoMCwgY29sb25faW5kZXgpLnRyaW0oKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBpbmRpdmlkdWFsX3N0eWxlLnNsaWNlKGNvbG9uX2luZGV4ICsgMSkudHJpbSgpO1xuICAgICAgICBpZiAoIW5hbWUpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgc3R5bGVfb2JqZWN0W25hbWVdID0gdmFsdWU7XG4gICAgfVxuICAgIGZvciAoY29uc3QgbmFtZSBpbiBzdHlsZV9kaXJlY3RpdmUpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBzdHlsZV9kaXJlY3RpdmVbbmFtZV07XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgc3R5bGVfb2JqZWN0W25hbWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgc3R5bGVfb2JqZWN0W25hbWVdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdHlsZV9vYmplY3Q7XG59XG5jb25zdCBBVFRSX1JFR0VYID0gL1smXCJdL2c7XG5jb25zdCBDT05URU5UX1JFR0VYID0gL1smPF0vZztcbi8qKlxuICogTm90ZTogdGhpcyBtZXRob2QgaXMgcGVyZm9ybWFuY2Ugc2Vuc2l0aXZlIGFuZCBoYXMgYmVlbiBvcHRpbWl6ZWRcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zdmVsdGVqcy9zdmVsdGUvcHVsbC81NzAxXG4gKi9cbmZ1bmN0aW9uIGVzY2FwZSh2YWx1ZSwgaXNfYXR0ciA9IGZhbHNlKSB7XG4gICAgY29uc3Qgc3RyID0gU3RyaW5nKHZhbHVlKTtcbiAgICBjb25zdCBwYXR0ZXJuID0gaXNfYXR0ciA/IEFUVFJfUkVHRVggOiBDT05URU5UX1JFR0VYO1xuICAgIHBhdHRlcm4ubGFzdEluZGV4ID0gMDtcbiAgICBsZXQgZXNjYXBlZCA9ICcnO1xuICAgIGxldCBsYXN0ID0gMDtcbiAgICB3aGlsZSAocGF0dGVybi50ZXN0KHN0cikpIHtcbiAgICAgICAgY29uc3QgaSA9IHBhdHRlcm4ubGFzdEluZGV4IC0gMTtcbiAgICAgICAgY29uc3QgY2ggPSBzdHJbaV07XG4gICAgICAgIGVzY2FwZWQgKz0gc3RyLnN1YnN0cmluZyhsYXN0LCBpKSArIChjaCA9PT0gJyYnID8gJyZhbXA7JyA6IChjaCA9PT0gJ1wiJyA/ICcmcXVvdDsnIDogJyZsdDsnKSk7XG4gICAgICAgIGxhc3QgPSBpICsgMTtcbiAgICB9XG4gICAgcmV0dXJuIGVzY2FwZWQgKyBzdHIuc3Vic3RyaW5nKGxhc3QpO1xufVxuZnVuY3Rpb24gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSh2YWx1ZSkge1xuICAgIC8vIGtlZXAgYm9vbGVhbnMsIG51bGwsIGFuZCB1bmRlZmluZWQgZm9yIHRoZSBzYWtlIG9mIGBzcHJlYWRgXG4gICAgY29uc3Qgc2hvdWxkX2VzY2FwZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpO1xuICAgIHJldHVybiBzaG91bGRfZXNjYXBlID8gZXNjYXBlKHZhbHVlLCB0cnVlKSA6IHZhbHVlO1xufVxuZnVuY3Rpb24gZXNjYXBlX29iamVjdChvYmopIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlKG9ialtrZXldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGVhY2goaXRlbXMsIGZuKSB7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgc3RyICs9IGZuKGl0ZW1zW2ldLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmNvbnN0IG1pc3NpbmdfY29tcG9uZW50ID0ge1xuICAgICQkcmVuZGVyOiAoKSA9PiAnJ1xufTtcbmZ1bmN0aW9uIHZhbGlkYXRlX2NvbXBvbmVudChjb21wb25lbnQsIG5hbWUpIHtcbiAgICBpZiAoIWNvbXBvbmVudCB8fCAhY29tcG9uZW50LiQkcmVuZGVyKSB7XG4gICAgICAgIGlmIChuYW1lID09PSAnc3ZlbHRlOmNvbXBvbmVudCcpXG4gICAgICAgICAgICBuYW1lICs9ICcgdGhpcz17Li4ufSc7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPCR7bmFtZX0+IGlzIG5vdCBhIHZhbGlkIFNTUiBjb21wb25lbnQuIFlvdSBtYXkgbmVlZCB0byByZXZpZXcgeW91ciBidWlsZCBjb25maWcgdG8gZW5zdXJlIHRoYXQgZGVwZW5kZW5jaWVzIGFyZSBjb21waWxlZCwgcmF0aGVyIHRoYW4gaW1wb3J0ZWQgYXMgcHJlLWNvbXBpbGVkIG1vZHVsZXNgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGRlYnVnKGZpbGUsIGxpbmUsIGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgY29uc29sZS5sb2coYHtAZGVidWd9ICR7ZmlsZSA/IGZpbGUgKyAnICcgOiAnJ30oJHtsaW5lfToke2NvbHVtbn0pYCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiAnJztcbn1cbmxldCBvbl9kZXN0cm95O1xuZnVuY3Rpb24gY3JlYXRlX3Nzcl9jb21wb25lbnQoZm4pIHtcbiAgICBmdW5jdGlvbiAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMsIGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgICAgICBjb25zdCAkJCA9IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3ksXG4gICAgICAgICAgICBjb250ZXh0OiBuZXcgTWFwKGNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAgICAgLy8gdGhlc2Ugd2lsbCBiZSBpbW1lZGlhdGVseSBkaXNjYXJkZWRcbiAgICAgICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHsgJCQgfSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBmbihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMpO1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXI6IChwcm9wcyA9IHt9LCB7ICQkc2xvdHMgPSB7fSwgY29udGV4dCA9IG5ldyBNYXAoKSB9ID0ge30pID0+IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHsgdGl0bGU6ICcnLCBoZWFkOiAnJywgY3NzOiBuZXcgU2V0KCkgfTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCB7fSwgJCRzbG90cywgY29udGV4dCk7XG4gICAgICAgICAgICBydW5fYWxsKG9uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBodG1sLFxuICAgICAgICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBBcnJheS5mcm9tKHJlc3VsdC5jc3MpLm1hcChjc3MgPT4gY3NzLmNvZGUpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG51bGwgLy8gVE9ET1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGVhZDogcmVzdWx0LnRpdGxlICsgcmVzdWx0LmhlYWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgICQkcmVuZGVyXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGFkZF9hdHRyaWJ1dGUobmFtZSwgdmFsdWUsIGJvb2xlYW4pIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCAoYm9vbGVhbiAmJiAhdmFsdWUpKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgY29uc3QgYXNzaWdubWVudCA9IChib29sZWFuICYmIHZhbHVlID09PSB0cnVlKSA/ICcnIDogYD1cIiR7ZXNjYXBlKHZhbHVlLCB0cnVlKX1cImA7XG4gICAgcmV0dXJuIGAgJHtuYW1lfSR7YXNzaWdubWVudH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiAnJztcbn1cbmZ1bmN0aW9uIHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHN0eWxlX29iamVjdClcbiAgICAgICAgLmZpbHRlcihrZXkgPT4gc3R5bGVfb2JqZWN0W2tleV0pXG4gICAgICAgIC5tYXAoa2V5ID0+IGAke2tleX06ICR7c3R5bGVfb2JqZWN0W2tleV19O2ApXG4gICAgICAgIC5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBhZGRfc3R5bGVzKHN0eWxlX29iamVjdCkge1xuICAgIGNvbnN0IHN0eWxlcyA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KTtcbiAgICByZXR1cm4gc3R5bGVzID8gYCBzdHlsZT1cIiR7c3R5bGVzfVwiYCA6ICcnO1xufVxuXG5mdW5jdGlvbiBiaW5kKGNvbXBvbmVudCwgbmFtZSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBpbmRleCA9IGNvbXBvbmVudC4kJC5wcm9wc1tuYW1lXTtcbiAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb21wb25lbnQuJCQuYm91bmRbaW5kZXhdID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrKGNvbXBvbmVudC4kJC5jdHhbaW5kZXhdKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVfY29tcG9uZW50KGJsb2NrKSB7XG4gICAgYmxvY2sgJiYgYmxvY2suYygpO1xufVxuZnVuY3Rpb24gY2xhaW1fY29tcG9uZW50KGJsb2NrLCBwYXJlbnRfbm9kZXMpIHtcbiAgICBibG9jayAmJiBibG9jay5sKHBhcmVudF9ub2Rlcyk7XG59XG5mdW5jdGlvbiBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCB0YXJnZXQsIGFuY2hvciwgY3VzdG9tRWxlbWVudCkge1xuICAgIGNvbnN0IHsgZnJhZ21lbnQsIG9uX21vdW50LCBvbl9kZXN0cm95LCBhZnRlcl91cGRhdGUgfSA9IGNvbXBvbmVudC4kJDtcbiAgICBmcmFnbWVudCAmJiBmcmFnbWVudC5tKHRhcmdldCwgYW5jaG9yKTtcbiAgICBpZiAoIWN1c3RvbUVsZW1lbnQpIHtcbiAgICAgICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld19vbl9kZXN0cm95ID0gb25fbW91bnQubWFwKHJ1bikuZmlsdGVyKGlzX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICAgICAgb25fZGVzdHJveS5wdXNoKC4uLm5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEVkZ2UgY2FzZSAtIGNvbXBvbmVudCB3YXMgZGVzdHJveWVkIGltbWVkaWF0ZWx5LFxuICAgICAgICAgICAgICAgIC8vIG1vc3QgbGlrZWx5IGFzIGEgcmVzdWx0IG9mIGEgYmluZGluZyBpbml0aWFsaXNpbmdcbiAgICAgICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC4kJC5vbl9tb3VudCA9IFtdO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2NvbXBvbmVudChjb21wb25lbnQsIGRldGFjaGluZykge1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkO1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICBydW5fYWxsKCQkLm9uX2Rlc3Ryb3kpO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5kKGRldGFjaGluZyk7XG4gICAgICAgIC8vIFRPRE8gbnVsbCBvdXQgb3RoZXIgcmVmcywgaW5jbHVkaW5nIGNvbXBvbmVudC4kJCAoYnV0IG5lZWQgdG9cbiAgICAgICAgLy8gcHJlc2VydmUgZmluYWwgc3RhdGU/KVxuICAgICAgICAkJC5vbl9kZXN0cm95ID0gJCQuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICAkJC5jdHggPSBbXTtcbiAgICB9XG59XG5mdW5jdGlvbiBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSkge1xuICAgIGlmIChjb21wb25lbnQuJCQuZGlydHlbMF0gPT09IC0xKSB7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgICBzY2hlZHVsZV91cGRhdGUoKTtcbiAgICAgICAgY29tcG9uZW50LiQkLmRpcnR5LmZpbGwoMCk7XG4gICAgfVxuICAgIGNvbXBvbmVudC4kJC5kaXJ0eVsoaSAvIDMxKSB8IDBdIHw9ICgxIDw8IChpICUgMzEpKTtcbn1cbmZ1bmN0aW9uIGluaXQoY29tcG9uZW50LCBvcHRpb25zLCBpbnN0YW5jZSwgY3JlYXRlX2ZyYWdtZW50LCBub3RfZXF1YWwsIHByb3BzLCBhcHBlbmRfc3R5bGVzLCBkaXJ0eSA9IFstMV0pIHtcbiAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQgPSB7XG4gICAgICAgIGZyYWdtZW50OiBudWxsLFxuICAgICAgICBjdHg6IG51bGwsXG4gICAgICAgIC8vIHN0YXRlXG4gICAgICAgIHByb3BzLFxuICAgICAgICB1cGRhdGU6IG5vb3AsXG4gICAgICAgIG5vdF9lcXVhbCxcbiAgICAgICAgYm91bmQ6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICAvLyBsaWZlY3ljbGVcbiAgICAgICAgb25fbW91bnQ6IFtdLFxuICAgICAgICBvbl9kZXN0cm95OiBbXSxcbiAgICAgICAgb25fZGlzY29ubmVjdDogW10sXG4gICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICBhZnRlcl91cGRhdGU6IFtdLFxuICAgICAgICBjb250ZXh0OiBuZXcgTWFwKG9wdGlvbnMuY29udGV4dCB8fCAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSksXG4gICAgICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZVxuICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICBkaXJ0eSxcbiAgICAgICAgc2tpcF9ib3VuZDogZmFsc2UsXG4gICAgICAgIHJvb3Q6IG9wdGlvbnMudGFyZ2V0IHx8IHBhcmVudF9jb21wb25lbnQuJCQucm9vdFxuICAgIH07XG4gICAgYXBwZW5kX3N0eWxlcyAmJiBhcHBlbmRfc3R5bGVzKCQkLnJvb3QpO1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICQkLmN0eCA9IGluc3RhbmNlXG4gICAgICAgID8gaW5zdGFuY2UoY29tcG9uZW50LCBvcHRpb25zLnByb3BzIHx8IHt9LCAoaSwgcmV0LCAuLi5yZXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJlc3QubGVuZ3RoID8gcmVzdFswXSA6IHJldDtcbiAgICAgICAgICAgIGlmICgkJC5jdHggJiYgbm90X2VxdWFsKCQkLmN0eFtpXSwgJCQuY3R4W2ldID0gdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkJC5za2lwX2JvdW5kICYmICQkLmJvdW5kW2ldKVxuICAgICAgICAgICAgICAgICAgICAkJC5ib3VuZFtpXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlYWR5KVxuICAgICAgICAgICAgICAgICAgICBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KVxuICAgICAgICA6IFtdO1xuICAgICQkLnVwZGF0ZSgpO1xuICAgIHJlYWR5ID0gdHJ1ZTtcbiAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgIC8vIGBmYWxzZWAgYXMgYSBzcGVjaWFsIGNhc2Ugb2Ygbm8gRE9NIGNvbXBvbmVudFxuICAgICQkLmZyYWdtZW50ID0gY3JlYXRlX2ZyYWdtZW50ID8gY3JlYXRlX2ZyYWdtZW50KCQkLmN0eCkgOiBmYWxzZTtcbiAgICBpZiAob3B0aW9ucy50YXJnZXQpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaHlkcmF0ZSkge1xuICAgICAgICAgICAgc3RhcnRfaHlkcmF0aW5nKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGNoaWxkcmVuKG9wdGlvbnMudGFyZ2V0KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5sKG5vZGVzKTtcbiAgICAgICAgICAgIG5vZGVzLmZvckVhY2goZGV0YWNoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuaW50cm8pXG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGNvbXBvbmVudC4kJC5mcmFnbWVudCk7XG4gICAgICAgIG1vdW50X2NvbXBvbmVudChjb21wb25lbnQsIG9wdGlvbnMudGFyZ2V0LCBvcHRpb25zLmFuY2hvciwgb3B0aW9ucy5jdXN0b21FbGVtZW50KTtcbiAgICAgICAgZW5kX2h5ZHJhdGluZygpO1xuICAgICAgICBmbHVzaCgpO1xuICAgIH1cbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG59XG5sZXQgU3ZlbHRlRWxlbWVudDtcbmlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBTdmVsdGVFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgY29uc3QgeyBvbl9tb3VudCB9ID0gdGhpcy4kJDtcbiAgICAgICAgICAgIHRoaXMuJCQub25fZGlzY29ubmVjdCA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy4kJC5zbG90dGVkKSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHRoaXMuJCQuc2xvdHRlZFtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2soYXR0ciwgX29sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdGhpc1thdHRyXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgcnVuX2FsbCh0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QpO1xuICAgICAgICB9XG4gICAgICAgICRkZXN0cm95KCkge1xuICAgICAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICAgICAgfVxuICAgICAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIC8vIFRPRE8gc2hvdWxkIHRoaXMgZGVsZWdhdGUgdG8gYWRkRXZlbnRMaXN0ZW5lcj9cbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBTdmVsdGUgY29tcG9uZW50cy4gVXNlZCB3aGVuIGRldj1mYWxzZS5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgIH1cbiAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2hfZGV2KHR5cGUsIGRldGFpbCkge1xuICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KHR5cGUsIE9iamVjdC5hc3NpZ24oeyB2ZXJzaW9uOiAnMy40OS4wJyB9LCBkZXRhaWwpLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG59XG5mdW5jdGlvbiBpbnNlcnRfZGV2KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uX2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQodGFnKSB7XG4gICAgY29uc3QgaXNfc3RyaW5nID0gdHlwZW9mIHRhZyA9PT0gJ3N0cmluZyc7XG4gICAgaWYgKHRhZyAmJiAhaXNfc3RyaW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignPHN2ZWx0ZTplbGVtZW50PiBleHBlY3RzIFwidGhpc1wiIGF0dHJpYnV0ZSB0byBiZSBhIHN0cmluZy4nKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCh0YWcpIHtcbiAgICBpZiAodGFnICYmIGlzX3ZvaWQodGFnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDxzdmVsdGU6ZWxlbWVudCB0aGlzPVwiJHt0YWd9XCI+IGlzIHNlbGYtY2xvc2luZyBhbmQgY2Fubm90IGhhdmUgY29udGVudC5gKTtcbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwYXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBIdG1sVGFnSHlkcmF0aW9uLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3N0eWxlcywgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQsIGFwcGVuZF9oeWRyYXRpb24sIGFwcGVuZF9oeWRyYXRpb25fZGV2LCBhcHBlbmRfc3R5bGVzLCBhc3NpZ24sIGF0dHIsIGF0dHJfZGV2LCBhdHRyaWJ1dGVfdG9fb2JqZWN0LCBiZWZvcmVVcGRhdGUsIGJpbmQsIGJpbmRpbmdfY2FsbGJhY2tzLCBibGFua19vYmplY3QsIGJ1YmJsZSwgY2hlY2tfb3V0cm9zLCBjaGlsZHJlbiwgY2xhaW1fY29tcG9uZW50LCBjbGFpbV9lbGVtZW50LCBjbGFpbV9odG1sX3RhZywgY2xhaW1fc3BhY2UsIGNsYWltX3N2Z19lbGVtZW50LCBjbGFpbV90ZXh0LCBjbGVhcl9sb29wcywgY29tcG9uZW50X3N1YnNjcmliZSwgY29tcHV0ZV9yZXN0X3Byb3BzLCBjb21wdXRlX3Nsb3RzLCBjcmVhdGVFdmVudERpc3BhdGNoZXIsIGNyZWF0ZV9hbmltYXRpb24sIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24sIGNyZWF0ZV9jb21wb25lbnQsIGNyZWF0ZV9pbl90cmFuc2l0aW9uLCBjcmVhdGVfb3V0X3RyYW5zaXRpb24sIGNyZWF0ZV9zbG90LCBjcmVhdGVfc3NyX2NvbXBvbmVudCwgY3VycmVudF9jb21wb25lbnQsIGN1c3RvbV9ldmVudCwgZGF0YXNldF9kZXYsIGRlYnVnLCBkZXN0cm95X2Jsb2NrLCBkZXN0cm95X2NvbXBvbmVudCwgZGVzdHJveV9lYWNoLCBkZXRhY2gsIGRldGFjaF9hZnRlcl9kZXYsIGRldGFjaF9iZWZvcmVfZGV2LCBkZXRhY2hfYmV0d2Vlbl9kZXYsIGRldGFjaF9kZXYsIGRpcnR5X2NvbXBvbmVudHMsIGRpc3BhdGNoX2RldiwgZWFjaCwgZWxlbWVudCwgZWxlbWVudF9pcywgZW1wdHksIGVuZF9oeWRyYXRpbmcsIGVzY2FwZSwgZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSwgZXNjYXBlX29iamVjdCwgZXhjbHVkZV9pbnRlcm5hbF9wcm9wcywgZml4X2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfcG9zaXRpb24sIGZsdXNoLCBnZXRBbGxDb250ZXh0cywgZ2V0Q29udGV4dCwgZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlLCBnZXRfYmluZGluZ19ncm91cF92YWx1ZSwgZ2V0X2N1cnJlbnRfY29tcG9uZW50LCBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzLCBnZXRfcm9vdF9mb3Jfc3R5bGUsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW5zZXJ0X2h5ZHJhdGlvbiwgaW5zZXJ0X2h5ZHJhdGlvbl9kZXYsIGludHJvcywgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIsIGlzX2NsaWVudCwgaXNfY3Jvc3NvcmlnaW4sIGlzX2VtcHR5LCBpc19mdW5jdGlvbiwgaXNfcHJvbWlzZSwgaXNfdm9pZCwgbGlzdGVuLCBsaXN0ZW5fZGV2LCBsb29wLCBsb29wX2d1YXJkLCBtZXJnZV9zc3Jfc3R5bGVzLCBtaXNzaW5nX2NvbXBvbmVudCwgbW91bnRfY29tcG9uZW50LCBub29wLCBub3RfZXF1YWwsIG5vdywgbnVsbF90b19lbXB0eSwgb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcywgb25EZXN0cm95LCBvbk1vdW50LCBvbmNlLCBvdXRyb19hbmRfZGVzdHJveV9ibG9jaywgcHJldmVudF9kZWZhdWx0LCBwcm9wX2RldiwgcXVlcnlfc2VsZWN0b3JfYWxsLCByYWYsIHJ1biwgcnVuX2FsbCwgc2FmZV9ub3RfZXF1YWwsIHNjaGVkdWxlX3VwZGF0ZSwgc2VsZWN0X211bHRpcGxlX3ZhbHVlLCBzZWxlY3Rfb3B0aW9uLCBzZWxlY3Rfb3B0aW9ucywgc2VsZWN0X3ZhbHVlLCBzZWxmLCBzZXRDb250ZXh0LCBzZXRfYXR0cmlidXRlcywgc2V0X2N1cnJlbnRfY29tcG9uZW50LCBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YSwgc2V0X2RhdGEsIHNldF9kYXRhX2Rldiwgc2V0X2lucHV0X3R5cGUsIHNldF9pbnB1dF92YWx1ZSwgc2V0X25vdywgc2V0X3JhZiwgc2V0X3N0b3JlX3ZhbHVlLCBzZXRfc3R5bGUsIHNldF9zdmdfYXR0cmlidXRlcywgc3BhY2UsIHNwcmVhZCwgc3JjX3VybF9lcXVhbCwgc3RhcnRfaHlkcmF0aW5nLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB0cnVzdGVkLCB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoLCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X2Jhc2UsIHZhbGlkYXRlX2NvbXBvbmVudCwgdmFsaWRhdGVfZHluYW1pY19lbGVtZW50LCB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50LCB2YWxpZGF0ZV9lYWNoX2tleXMsIHZhbGlkYXRlX3Nsb3RzLCB2YWxpZGF0ZV9zdG9yZSwgdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQsIHhsaW5rX2F0dHIgfTtcbiIsIjxzY3JpcHQ+XG4gIGNvbnN0IGxlbiA9IDU7XG4gIGxldCBjb3VudCA9IDA7XG4gIGxldCBoYXNJbnRlcmFjdGVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gaW5wdXQoeCkge1xuICAgIGlmICghaGFzSW50ZXJhY3RlZCkge1xuICAgICAgaGFzSW50ZXJhY3RlZCA9IHRydWU7XG4gICAgfVxuICAgIGNvdW50ID0gcGFyc2VJbnQoeC50YXJnZXQudmFsdWUpO1xuICB9XG48L3NjcmlwdD5cblxuPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XG4gIDxpbWdcbiAgICBzcmM9XCJpbWFnZXMvdHJhamVjdG9yaWVze2NvdW50fS5zdmdcIlxuICAgIGFsdD1cIkludGVyYWN0aXZlIHBsb3QgZGlzcGxheWluZyB0aGUgdHJhamVjdG9yaWVzIG9mIHRoZSBSTCBhZ2VudCBvbiB0aGUgbWFwXCJcbiAgICBoZWlnaHQ9XCIzMDBweFwiXG4gICAgd2lkdGg9XCI0MDBweFwiXG4gIC8+XG4gIDxkaXYgc3R5bGU9XCJ3aWR0aDozMDBweDsgbWFyZ2luOmF1dG87IHRleHQtYWxpZ246Y2VudGVyO1wiPlxuICAgIDxwPlRyYWplY3RvcnkgYWZ0ZXIgY3VycmljdWx1bSBzdGVwIHtjb3VudCArIDF9PC9wPlxuICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBtaW49XCIwXCIgbWF4PVwie2xlbn1cIiB2YWx1ZT1cIjBcIiBvbjppbnB1dD17aW5wdXR9PlxuICAgIDxwIHN0eWxlPVwiaGVpZ2h0OiAxZW07IHRyYW5zaXRpb246IDFzIG9wYWNpdHk7IHtoYXNJbnRlcmFjdGVkICYmICdvcGFjaXR5OiAwOyd9XCI+TW92ZSB0aGUgc2xpZGVyIHRvIGNoYW5nZSB0aGUgc3RlcCE8L3A+XG4gIDwvZGl2PlxuPC9kaXY+XG4iLCI8c2NyaXB0PlxuICBjb25zdCBsZW4gPSA5O1xuICBsZXQgY291bnQgPSAxO1xuICBsZXQgaGFzSW50ZXJhY3RlZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBpZiAoIWhhc0ludGVyYWN0ZWQpIHtcbiAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKTtcbiAgfVxuPC9zY3JpcHQ+XG5cbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPiBcbiAgPGltZyBcbiAgICBzcmM9XCJpbWFnZXMvMTZ4MTZfYmFja3tjb3VudH1fc3VjY2Vzc2VzLnN2Z1wiXG4gICAgYWx0PVwiSW50ZXJhY3RpdmUgcGxvdCBkaXNwbGF5aW5nIHRoZSBzdWNjZXNzIHJhdGUgb2YgdGhlIGJhY2sgY3VycmljdWx1bSBwb2xpY3kgb3ZlciB0aGUgbnVtYmVyIG9mIGN1cnJpY3VsdW0gc3RlcHNcIlxuICAgIGhlaWdodD1cIjMwMHB4XCJcbiAgICB3aWR0aD1cIjQwMHB4XCJcbiAgLz4gXG4gIDxkaXYgc3R5bGU9XCJ3aWR0aDozMDBweDsgbWFyZ2luOmF1dG87IHRleHQtYWxpZ246Y2VudGVyO1wiPlxuICAgIDxwPnggPSB7Y291bnR9PC9wPlxuICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBtaW49XCIxXCIgbWF4PVwie2xlbn1cIiB2YWx1ZT1cIjBcIiBvbjppbnB1dD17aW5wdXR9PlxuICAgIDxwIHN0eWxlPVwiaGVpZ2h0OiAxZW07IHRyYW5zaXRpb246IDFzIG9wYWNpdHk7IHtoYXNJbnRlcmFjdGVkICYmICdvcGFjaXR5OiAwOyd9XCI+TW92ZSB0aGUgc2xpZGVyIHRvIGNoYW5nZSB4ITwvcD5cbiAgPC9kaXY+IFxuPC9kaXY+XG4iLCI8c2NyaXB0PlxuICBjb25zdCBsZW4gPSA0O1xuICBsZXQgY291bnQgPSAwO1xuICBsZXQgaGFzSW50ZXJhY3RlZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBpZiAoIWhhc0ludGVyYWN0ZWQpIHtcbiAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKVxuICB9XG48L3NjcmlwdD5cblxuPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+IFxuICA8aW1nIFxuICAgIHNyYz1cImltYWdlcy8xNngxNl9pbmNyZW1lbnRhbHtjb3VudH1fc3VjY2Vzc2VzLnN2Z1wiXG4gICAgYWx0PVwiSW50ZXJhY3RpdmUgcGxvdCBkaXNwbGF5aW5nIHRoZSBzdWNjZXNzIHJhdGUgb2YgdGhlIGluY3JlbWVudGFsIGN1cnJpY3VsdW0gcG9saWN5IG92ZXIgdGhlIG51bWJlciBvZiBjdXJyaWN1bHVtIHN0ZXBzXCJcbiAgICBoZWlnaHQ9XCIzMDBweFwiXG4gICAgd2lkdGg9XCI0MDBweFwiXG4gIC8+XG4gIDxkaXYgc3R5bGU9XCJ3aWR0aDozMDBweDsgbWFyZ2luOmF1dG87IHRleHQtYWxpZ246Y2VudGVyO1wiPlxuICAgIDxwPnggPSB7Y291bnR9PC9wPlxuICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBtaW49XCIwXCIgbWF4PVwie2xlbn1cIiB2YWx1ZT1cIjBcIiBvbjppbnB1dD17aW5wdXR9PlxuICAgIDxwIHN0eWxlPVwiaGVpZ2h0OiAxZW07IHRyYW5zaXRpb246IDFzIG9wYWNpdHk7IHtoYXNJbnRlcmFjdGVkICYmICdvcGFjaXR5OiAwOyd9XCI+TW92ZSB0aGUgc2xpZGVyIHRvIGNoYW5nZSB4ITwvcD5cbiAgPC9kaXY+XG48L2Rpdj5cbiIsImltcG9ydCB7IG5vb3AsIHNhZmVfbm90X2VxdWFsLCBzdWJzY3JpYmUsIHJ1bl9hbGwsIGlzX2Z1bmN0aW9uIH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcbmV4cG9ydCB7IGdldF9zdG9yZV92YWx1ZSBhcyBnZXQgfSBmcm9tICcuLi9pbnRlcm5hbC9pbmRleC5tanMnO1xuXG5jb25zdCBzdWJzY3JpYmVyX3F1ZXVlID0gW107XG4vKipcbiAqIENyZWF0ZXMgYSBgUmVhZGFibGVgIHN0b3JlIHRoYXQgYWxsb3dzIHJlYWRpbmcgYnkgc3Vic2NyaXB0aW9uLlxuICogQHBhcmFtIHZhbHVlIGluaXRpYWwgdmFsdWVcbiAqIEBwYXJhbSB7U3RhcnRTdG9wTm90aWZpZXJ9c3RhcnQgc3RhcnQgYW5kIHN0b3Agbm90aWZpY2F0aW9ucyBmb3Igc3Vic2NyaXB0aW9uc1xuICovXG5mdW5jdGlvbiByZWFkYWJsZSh2YWx1ZSwgc3RhcnQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdWJzY3JpYmU6IHdyaXRhYmxlKHZhbHVlLCBzdGFydCkuc3Vic2NyaWJlXG4gICAgfTtcbn1cbi8qKlxuICogQ3JlYXRlIGEgYFdyaXRhYmxlYCBzdG9yZSB0aGF0IGFsbG93cyBib3RoIHVwZGF0aW5nIGFuZCByZWFkaW5nIGJ5IHN1YnNjcmlwdGlvbi5cbiAqIEBwYXJhbSB7Kj19dmFsdWUgaW5pdGlhbCB2YWx1ZVxuICogQHBhcmFtIHtTdGFydFN0b3BOb3RpZmllcj19c3RhcnQgc3RhcnQgYW5kIHN0b3Agbm90aWZpY2F0aW9ucyBmb3Igc3Vic2NyaXB0aW9uc1xuICovXG5mdW5jdGlvbiB3cml0YWJsZSh2YWx1ZSwgc3RhcnQgPSBub29wKSB7XG4gICAgbGV0IHN0b3A7XG4gICAgY29uc3Qgc3Vic2NyaWJlcnMgPSBuZXcgU2V0KCk7XG4gICAgZnVuY3Rpb24gc2V0KG5ld192YWx1ZSkge1xuICAgICAgICBpZiAoc2FmZV9ub3RfZXF1YWwodmFsdWUsIG5ld192YWx1ZSkpIHtcbiAgICAgICAgICAgIHZhbHVlID0gbmV3X3ZhbHVlO1xuICAgICAgICAgICAgaWYgKHN0b3ApIHsgLy8gc3RvcmUgaXMgcmVhZHlcbiAgICAgICAgICAgICAgICBjb25zdCBydW5fcXVldWUgPSAhc3Vic2NyaWJlcl9xdWV1ZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBzdWJzY3JpYmVyIG9mIHN1YnNjcmliZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXJbMV0oKTtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcl9xdWV1ZS5wdXNoKHN1YnNjcmliZXIsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bl9xdWV1ZSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN1YnNjcmliZXJfcXVldWUubGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXJfcXVldWVbaV1bMF0oc3Vic2NyaWJlcl9xdWV1ZVtpICsgMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXJfcXVldWUubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlKGZuKSB7XG4gICAgICAgIHNldChmbih2YWx1ZSkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBzdWJzY3JpYmUocnVuLCBpbnZhbGlkYXRlID0gbm9vcCkge1xuICAgICAgICBjb25zdCBzdWJzY3JpYmVyID0gW3J1biwgaW52YWxpZGF0ZV07XG4gICAgICAgIHN1YnNjcmliZXJzLmFkZChzdWJzY3JpYmVyKTtcbiAgICAgICAgaWYgKHN1YnNjcmliZXJzLnNpemUgPT09IDEpIHtcbiAgICAgICAgICAgIHN0b3AgPSBzdGFydChzZXQpIHx8IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgcnVuKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHN1YnNjcmliZXJzLmRlbGV0ZShzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgIGlmIChzdWJzY3JpYmVycy5zaXplID09PSAwKSB7XG4gICAgICAgICAgICAgICAgc3RvcCgpO1xuICAgICAgICAgICAgICAgIHN0b3AgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4geyBzZXQsIHVwZGF0ZSwgc3Vic2NyaWJlIH07XG59XG5mdW5jdGlvbiBkZXJpdmVkKHN0b3JlcywgZm4sIGluaXRpYWxfdmFsdWUpIHtcbiAgICBjb25zdCBzaW5nbGUgPSAhQXJyYXkuaXNBcnJheShzdG9yZXMpO1xuICAgIGNvbnN0IHN0b3Jlc19hcnJheSA9IHNpbmdsZVxuICAgICAgICA/IFtzdG9yZXNdXG4gICAgICAgIDogc3RvcmVzO1xuICAgIGNvbnN0IGF1dG8gPSBmbi5sZW5ndGggPCAyO1xuICAgIHJldHVybiByZWFkYWJsZShpbml0aWFsX3ZhbHVlLCAoc2V0KSA9PiB7XG4gICAgICAgIGxldCBpbml0ZWQgPSBmYWxzZTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gW107XG4gICAgICAgIGxldCBwZW5kaW5nID0gMDtcbiAgICAgICAgbGV0IGNsZWFudXAgPSBub29wO1xuICAgICAgICBjb25zdCBzeW5jID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHBlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBmbihzaW5nbGUgPyB2YWx1ZXNbMF0gOiB2YWx1ZXMsIHNldCk7XG4gICAgICAgICAgICBpZiAoYXV0bykge1xuICAgICAgICAgICAgICAgIHNldChyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCA9IGlzX2Z1bmN0aW9uKHJlc3VsdCkgPyByZXN1bHQgOiBub29wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCB1bnN1YnNjcmliZXJzID0gc3RvcmVzX2FycmF5Lm1hcCgoc3RvcmUsIGkpID0+IHN1YnNjcmliZShzdG9yZSwgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB2YWx1ZXNbaV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHBlbmRpbmcgJj0gfigxIDw8IGkpO1xuICAgICAgICAgICAgaWYgKGluaXRlZCkge1xuICAgICAgICAgICAgICAgIHN5bmMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgcGVuZGluZyB8PSAoMSA8PCBpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBpbml0ZWQgPSB0cnVlO1xuICAgICAgICBzeW5jKCk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICAgICAgcnVuX2FsbCh1bnN1YnNjcmliZXJzKTtcbiAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgfTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IHsgZGVyaXZlZCwgcmVhZGFibGUsIHdyaXRhYmxlIH07XG4iLCJleHBvcnQgeyBpZGVudGl0eSBhcyBsaW5lYXIgfSBmcm9tICcuLi9pbnRlcm5hbC9pbmRleC5tanMnO1xuXG4vKlxuQWRhcHRlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXR0ZGVzbFxuRGlzdHJpYnV0ZWQgdW5kZXIgTUlUIExpY2Vuc2UgaHR0cHM6Ly9naXRodWIuY29tL21hdHRkZXNsL2Vhc2VzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWRcbiovXG5mdW5jdGlvbiBiYWNrSW5PdXQodCkge1xuICAgIGNvbnN0IHMgPSAxLjcwMTU4ICogMS41MjU7XG4gICAgaWYgKCh0ICo9IDIpIDwgMSlcbiAgICAgICAgcmV0dXJuIDAuNSAqICh0ICogdCAqICgocyArIDEpICogdCAtIHMpKTtcbiAgICByZXR1cm4gMC41ICogKCh0IC09IDIpICogdCAqICgocyArIDEpICogdCArIHMpICsgMik7XG59XG5mdW5jdGlvbiBiYWNrSW4odCkge1xuICAgIGNvbnN0IHMgPSAxLjcwMTU4O1xuICAgIHJldHVybiB0ICogdCAqICgocyArIDEpICogdCAtIHMpO1xufVxuZnVuY3Rpb24gYmFja091dCh0KSB7XG4gICAgY29uc3QgcyA9IDEuNzAxNTg7XG4gICAgcmV0dXJuIC0tdCAqIHQgKiAoKHMgKyAxKSAqIHQgKyBzKSArIDE7XG59XG5mdW5jdGlvbiBib3VuY2VPdXQodCkge1xuICAgIGNvbnN0IGEgPSA0LjAgLyAxMS4wO1xuICAgIGNvbnN0IGIgPSA4LjAgLyAxMS4wO1xuICAgIGNvbnN0IGMgPSA5LjAgLyAxMC4wO1xuICAgIGNvbnN0IGNhID0gNDM1Ni4wIC8gMzYxLjA7XG4gICAgY29uc3QgY2IgPSAzNTQ0Mi4wIC8gMTgwNS4wO1xuICAgIGNvbnN0IGNjID0gMTYwNjEuMCAvIDE4MDUuMDtcbiAgICBjb25zdCB0MiA9IHQgKiB0O1xuICAgIHJldHVybiB0IDwgYVxuICAgICAgICA/IDcuNTYyNSAqIHQyXG4gICAgICAgIDogdCA8IGJcbiAgICAgICAgICAgID8gOS4wNzUgKiB0MiAtIDkuOSAqIHQgKyAzLjRcbiAgICAgICAgICAgIDogdCA8IGNcbiAgICAgICAgICAgICAgICA/IGNhICogdDIgLSBjYiAqIHQgKyBjY1xuICAgICAgICAgICAgICAgIDogMTAuOCAqIHQgKiB0IC0gMjAuNTIgKiB0ICsgMTAuNzI7XG59XG5mdW5jdGlvbiBib3VuY2VJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjVcbiAgICAgICAgPyAwLjUgKiAoMS4wIC0gYm91bmNlT3V0KDEuMCAtIHQgKiAyLjApKVxuICAgICAgICA6IDAuNSAqIGJvdW5jZU91dCh0ICogMi4wIC0gMS4wKSArIDAuNTtcbn1cbmZ1bmN0aW9uIGJvdW5jZUluKHQpIHtcbiAgICByZXR1cm4gMS4wIC0gYm91bmNlT3V0KDEuMCAtIHQpO1xufVxuZnVuY3Rpb24gY2lyY0luT3V0KHQpIHtcbiAgICBpZiAoKHQgKj0gMikgPCAxKVxuICAgICAgICByZXR1cm4gLTAuNSAqIChNYXRoLnNxcnQoMSAtIHQgKiB0KSAtIDEpO1xuICAgIHJldHVybiAwLjUgKiAoTWF0aC5zcXJ0KDEgLSAodCAtPSAyKSAqIHQpICsgMSk7XG59XG5mdW5jdGlvbiBjaXJjSW4odCkge1xuICAgIHJldHVybiAxLjAgLSBNYXRoLnNxcnQoMS4wIC0gdCAqIHQpO1xufVxuZnVuY3Rpb24gY2lyY091dCh0KSB7XG4gICAgcmV0dXJuIE1hdGguc3FydCgxIC0gLS10ICogdCk7XG59XG5mdW5jdGlvbiBjdWJpY0luT3V0KHQpIHtcbiAgICByZXR1cm4gdCA8IDAuNSA/IDQuMCAqIHQgKiB0ICogdCA6IDAuNSAqIE1hdGgucG93KDIuMCAqIHQgLSAyLjAsIDMuMCkgKyAxLjA7XG59XG5mdW5jdGlvbiBjdWJpY0luKHQpIHtcbiAgICByZXR1cm4gdCAqIHQgKiB0O1xufVxuZnVuY3Rpb24gY3ViaWNPdXQodCkge1xuICAgIGNvbnN0IGYgPSB0IC0gMS4wO1xuICAgIHJldHVybiBmICogZiAqIGYgKyAxLjA7XG59XG5mdW5jdGlvbiBlbGFzdGljSW5PdXQodCkge1xuICAgIHJldHVybiB0IDwgMC41XG4gICAgICAgID8gMC41ICpcbiAgICAgICAgICAgIE1hdGguc2luKCgoKzEzLjAgKiBNYXRoLlBJKSAvIDIpICogMi4wICogdCkgKlxuICAgICAgICAgICAgTWF0aC5wb3coMi4wLCAxMC4wICogKDIuMCAqIHQgLSAxLjApKVxuICAgICAgICA6IDAuNSAqXG4gICAgICAgICAgICBNYXRoLnNpbigoKC0xMy4wICogTWF0aC5QSSkgLyAyKSAqICgyLjAgKiB0IC0gMS4wICsgMS4wKSkgKlxuICAgICAgICAgICAgTWF0aC5wb3coMi4wLCAtMTAuMCAqICgyLjAgKiB0IC0gMS4wKSkgK1xuICAgICAgICAgICAgMS4wO1xufVxuZnVuY3Rpb24gZWxhc3RpY0luKHQpIHtcbiAgICByZXR1cm4gTWF0aC5zaW4oKDEzLjAgKiB0ICogTWF0aC5QSSkgLyAyKSAqIE1hdGgucG93KDIuMCwgMTAuMCAqICh0IC0gMS4wKSk7XG59XG5mdW5jdGlvbiBlbGFzdGljT3V0KHQpIHtcbiAgICByZXR1cm4gKE1hdGguc2luKCgtMTMuMCAqICh0ICsgMS4wKSAqIE1hdGguUEkpIC8gMikgKiBNYXRoLnBvdygyLjAsIC0xMC4wICogdCkgKyAxLjApO1xufVxuZnVuY3Rpb24gZXhwb0luT3V0KHQpIHtcbiAgICByZXR1cm4gdCA9PT0gMC4wIHx8IHQgPT09IDEuMFxuICAgICAgICA/IHRcbiAgICAgICAgOiB0IDwgMC41XG4gICAgICAgICAgICA/ICswLjUgKiBNYXRoLnBvdygyLjAsIDIwLjAgKiB0IC0gMTAuMClcbiAgICAgICAgICAgIDogLTAuNSAqIE1hdGgucG93KDIuMCwgMTAuMCAtIHQgKiAyMC4wKSArIDEuMDtcbn1cbmZ1bmN0aW9uIGV4cG9Jbih0KSB7XG4gICAgcmV0dXJuIHQgPT09IDAuMCA/IHQgOiBNYXRoLnBvdygyLjAsIDEwLjAgKiAodCAtIDEuMCkpO1xufVxuZnVuY3Rpb24gZXhwb091dCh0KSB7XG4gICAgcmV0dXJuIHQgPT09IDEuMCA/IHQgOiAxLjAgLSBNYXRoLnBvdygyLjAsIC0xMC4wICogdCk7XG59XG5mdW5jdGlvbiBxdWFkSW5PdXQodCkge1xuICAgIHQgLz0gMC41O1xuICAgIGlmICh0IDwgMSlcbiAgICAgICAgcmV0dXJuIDAuNSAqIHQgKiB0O1xuICAgIHQtLTtcbiAgICByZXR1cm4gLTAuNSAqICh0ICogKHQgLSAyKSAtIDEpO1xufVxuZnVuY3Rpb24gcXVhZEluKHQpIHtcbiAgICByZXR1cm4gdCAqIHQ7XG59XG5mdW5jdGlvbiBxdWFkT3V0KHQpIHtcbiAgICByZXR1cm4gLXQgKiAodCAtIDIuMCk7XG59XG5mdW5jdGlvbiBxdWFydEluT3V0KHQpIHtcbiAgICByZXR1cm4gdCA8IDAuNVxuICAgICAgICA/ICs4LjAgKiBNYXRoLnBvdyh0LCA0LjApXG4gICAgICAgIDogLTguMCAqIE1hdGgucG93KHQgLSAxLjAsIDQuMCkgKyAxLjA7XG59XG5mdW5jdGlvbiBxdWFydEluKHQpIHtcbiAgICByZXR1cm4gTWF0aC5wb3codCwgNC4wKTtcbn1cbmZ1bmN0aW9uIHF1YXJ0T3V0KHQpIHtcbiAgICByZXR1cm4gTWF0aC5wb3codCAtIDEuMCwgMy4wKSAqICgxLjAgLSB0KSArIDEuMDtcbn1cbmZ1bmN0aW9uIHF1aW50SW5PdXQodCkge1xuICAgIGlmICgodCAqPSAyKSA8IDEpXG4gICAgICAgIHJldHVybiAwLjUgKiB0ICogdCAqIHQgKiB0ICogdDtcbiAgICByZXR1cm4gMC41ICogKCh0IC09IDIpICogdCAqIHQgKiB0ICogdCArIDIpO1xufVxuZnVuY3Rpb24gcXVpbnRJbih0KSB7XG4gICAgcmV0dXJuIHQgKiB0ICogdCAqIHQgKiB0O1xufVxuZnVuY3Rpb24gcXVpbnRPdXQodCkge1xuICAgIHJldHVybiAtLXQgKiB0ICogdCAqIHQgKiB0ICsgMTtcbn1cbmZ1bmN0aW9uIHNpbmVJbk91dCh0KSB7XG4gICAgcmV0dXJuIC0wLjUgKiAoTWF0aC5jb3MoTWF0aC5QSSAqIHQpIC0gMSk7XG59XG5mdW5jdGlvbiBzaW5lSW4odCkge1xuICAgIGNvbnN0IHYgPSBNYXRoLmNvcyh0ICogTWF0aC5QSSAqIDAuNSk7XG4gICAgaWYgKE1hdGguYWJzKHYpIDwgMWUtMTQpXG4gICAgICAgIHJldHVybiAxO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIDEgLSB2O1xufVxuZnVuY3Rpb24gc2luZU91dCh0KSB7XG4gICAgcmV0dXJuIE1hdGguc2luKCh0ICogTWF0aC5QSSkgLyAyKTtcbn1cblxuZXhwb3J0IHsgYmFja0luLCBiYWNrSW5PdXQsIGJhY2tPdXQsIGJvdW5jZUluLCBib3VuY2VJbk91dCwgYm91bmNlT3V0LCBjaXJjSW4sIGNpcmNJbk91dCwgY2lyY091dCwgY3ViaWNJbiwgY3ViaWNJbk91dCwgY3ViaWNPdXQsIGVsYXN0aWNJbiwgZWxhc3RpY0luT3V0LCBlbGFzdGljT3V0LCBleHBvSW4sIGV4cG9Jbk91dCwgZXhwb091dCwgcXVhZEluLCBxdWFkSW5PdXQsIHF1YWRPdXQsIHF1YXJ0SW4sIHF1YXJ0SW5PdXQsIHF1YXJ0T3V0LCBxdWludEluLCBxdWludEluT3V0LCBxdWludE91dCwgc2luZUluLCBzaW5lSW5PdXQsIHNpbmVPdXQgfTtcbiIsImltcG9ydCB7IHdyaXRhYmxlIH0gZnJvbSAnLi4vc3RvcmUvaW5kZXgubWpzJztcbmltcG9ydCB7IG5vdywgbG9vcCwgYXNzaWduIH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcbmltcG9ydCB7IGxpbmVhciB9IGZyb20gJy4uL2Vhc2luZy9pbmRleC5tanMnO1xuXG5mdW5jdGlvbiBpc19kYXRlKG9iaikge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgRGF0ZV0nO1xufVxuXG5mdW5jdGlvbiB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWUsIGN1cnJlbnRfdmFsdWUsIHRhcmdldF92YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgY3VycmVudF92YWx1ZSA9PT0gJ251bWJlcicgfHwgaXNfZGF0ZShjdXJyZW50X3ZhbHVlKSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGRlbHRhID0gdGFyZ2V0X3ZhbHVlIC0gY3VycmVudF92YWx1ZTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCB2ZWxvY2l0eSA9IChjdXJyZW50X3ZhbHVlIC0gbGFzdF92YWx1ZSkgLyAoY3R4LmR0IHx8IDEgLyA2MCk7IC8vIGd1YXJkIGRpdiBieSAwXG4gICAgICAgIGNvbnN0IHNwcmluZyA9IGN0eC5vcHRzLnN0aWZmbmVzcyAqIGRlbHRhO1xuICAgICAgICBjb25zdCBkYW1wZXIgPSBjdHgub3B0cy5kYW1waW5nICogdmVsb2NpdHk7XG4gICAgICAgIGNvbnN0IGFjY2VsZXJhdGlvbiA9IChzcHJpbmcgLSBkYW1wZXIpICogY3R4Lmludl9tYXNzO1xuICAgICAgICBjb25zdCBkID0gKHZlbG9jaXR5ICsgYWNjZWxlcmF0aW9uKSAqIGN0eC5kdDtcbiAgICAgICAgaWYgKE1hdGguYWJzKGQpIDwgY3R4Lm9wdHMucHJlY2lzaW9uICYmIE1hdGguYWJzKGRlbHRhKSA8IGN0eC5vcHRzLnByZWNpc2lvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldF92YWx1ZTsgLy8gc2V0dGxlZFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY3R4LnNldHRsZWQgPSBmYWxzZTsgLy8gc2lnbmFsIGxvb3AgdG8ga2VlcCB0aWNraW5nXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICByZXR1cm4gaXNfZGF0ZShjdXJyZW50X3ZhbHVlKSA/XG4gICAgICAgICAgICAgICAgbmV3IERhdGUoY3VycmVudF92YWx1ZS5nZXRUaW1lKCkgKyBkKSA6IGN1cnJlbnRfdmFsdWUgKyBkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY3VycmVudF92YWx1ZSkpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gY3VycmVudF92YWx1ZS5tYXAoKF8sIGkpID0+IHRpY2tfc3ByaW5nKGN0eCwgbGFzdF92YWx1ZVtpXSwgY3VycmVudF92YWx1ZVtpXSwgdGFyZ2V0X3ZhbHVlW2ldKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBjdXJyZW50X3ZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICBjb25zdCBuZXh0X3ZhbHVlID0ge307XG4gICAgICAgIGZvciAoY29uc3QgayBpbiBjdXJyZW50X3ZhbHVlKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBuZXh0X3ZhbHVlW2tdID0gdGlja19zcHJpbmcoY3R4LCBsYXN0X3ZhbHVlW2tdLCBjdXJyZW50X3ZhbHVlW2tdLCB0YXJnZXRfdmFsdWVba10pO1xuICAgICAgICB9XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIG5leHRfdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBzcHJpbmcgJHt0eXBlb2YgY3VycmVudF92YWx1ZX0gdmFsdWVzYCk7XG4gICAgfVxufVxuZnVuY3Rpb24gc3ByaW5nKHZhbHVlLCBvcHRzID0ge30pIHtcbiAgICBjb25zdCBzdG9yZSA9IHdyaXRhYmxlKHZhbHVlKTtcbiAgICBjb25zdCB7IHN0aWZmbmVzcyA9IDAuMTUsIGRhbXBpbmcgPSAwLjgsIHByZWNpc2lvbiA9IDAuMDEgfSA9IG9wdHM7XG4gICAgbGV0IGxhc3RfdGltZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgY3VycmVudF90b2tlbjtcbiAgICBsZXQgbGFzdF92YWx1ZSA9IHZhbHVlO1xuICAgIGxldCB0YXJnZXRfdmFsdWUgPSB2YWx1ZTtcbiAgICBsZXQgaW52X21hc3MgPSAxO1xuICAgIGxldCBpbnZfbWFzc19yZWNvdmVyeV9yYXRlID0gMDtcbiAgICBsZXQgY2FuY2VsX3Rhc2sgPSBmYWxzZTtcbiAgICBmdW5jdGlvbiBzZXQobmV3X3ZhbHVlLCBvcHRzID0ge30pIHtcbiAgICAgICAgdGFyZ2V0X3ZhbHVlID0gbmV3X3ZhbHVlO1xuICAgICAgICBjb25zdCB0b2tlbiA9IGN1cnJlbnRfdG9rZW4gPSB7fTtcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwgfHwgb3B0cy5oYXJkIHx8IChzcHJpbmcuc3RpZmZuZXNzID49IDEgJiYgc3ByaW5nLmRhbXBpbmcgPj0gMSkpIHtcbiAgICAgICAgICAgIGNhbmNlbF90YXNrID0gdHJ1ZTsgLy8gY2FuY2VsIGFueSBydW5uaW5nIGFuaW1hdGlvblxuICAgICAgICAgICAgbGFzdF90aW1lID0gbm93KCk7XG4gICAgICAgICAgICBsYXN0X3ZhbHVlID0gbmV3X3ZhbHVlO1xuICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gdGFyZ2V0X3ZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvcHRzLnNvZnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHJhdGUgPSBvcHRzLnNvZnQgPT09IHRydWUgPyAuNSA6ICtvcHRzLnNvZnQ7XG4gICAgICAgICAgICBpbnZfbWFzc19yZWNvdmVyeV9yYXRlID0gMSAvIChyYXRlICogNjApO1xuICAgICAgICAgICAgaW52X21hc3MgPSAwOyAvLyBpbmZpbml0ZSBtYXNzLCB1bmFmZmVjdGVkIGJ5IHNwcmluZyBmb3JjZXNcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRhc2spIHtcbiAgICAgICAgICAgIGxhc3RfdGltZSA9IG5vdygpO1xuICAgICAgICAgICAgY2FuY2VsX3Rhc2sgPSBmYWxzZTtcbiAgICAgICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbF90YXNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbF90YXNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRhc2sgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGludl9tYXNzID0gTWF0aC5taW4oaW52X21hc3MgKyBpbnZfbWFzc19yZWNvdmVyeV9yYXRlLCAxKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdHggPSB7XG4gICAgICAgICAgICAgICAgICAgIGludl9tYXNzLFxuICAgICAgICAgICAgICAgICAgICBvcHRzOiBzcHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHNldHRsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGR0OiAobm93IC0gbGFzdF90aW1lKSAqIDYwIC8gMTAwMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dF92YWx1ZSA9IHRpY2tfc3ByaW5nKGN0eCwgbGFzdF92YWx1ZSwgdmFsdWUsIHRhcmdldF92YWx1ZSk7XG4gICAgICAgICAgICAgICAgbGFzdF90aW1lID0gbm93O1xuICAgICAgICAgICAgICAgIGxhc3RfdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBuZXh0X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoY3R4LnNldHRsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFzayA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhY3R4LnNldHRsZWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVsZmlsID0+IHtcbiAgICAgICAgICAgIHRhc2sucHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodG9rZW4gPT09IGN1cnJlbnRfdG9rZW4pXG4gICAgICAgICAgICAgICAgICAgIGZ1bGZpbCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzcHJpbmcgPSB7XG4gICAgICAgIHNldCxcbiAgICAgICAgdXBkYXRlOiAoZm4sIG9wdHMpID0+IHNldChmbih0YXJnZXRfdmFsdWUsIHZhbHVlKSwgb3B0cyksXG4gICAgICAgIHN1YnNjcmliZTogc3RvcmUuc3Vic2NyaWJlLFxuICAgICAgICBzdGlmZm5lc3MsXG4gICAgICAgIGRhbXBpbmcsXG4gICAgICAgIHByZWNpc2lvblxuICAgIH07XG4gICAgcmV0dXJuIHNwcmluZztcbn1cblxuZnVuY3Rpb24gZ2V0X2ludGVycG9sYXRvcihhLCBiKSB7XG4gICAgaWYgKGEgPT09IGIgfHwgYSAhPT0gYSlcbiAgICAgICAgcmV0dXJuICgpID0+IGE7XG4gICAgY29uc3QgdHlwZSA9IHR5cGVvZiBhO1xuICAgIGlmICh0eXBlICE9PSB0eXBlb2YgYiB8fCBBcnJheS5pc0FycmF5KGEpICE9PSBBcnJheS5pc0FycmF5KGIpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGludGVycG9sYXRlIHZhbHVlcyBvZiBkaWZmZXJlbnQgdHlwZScpO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShhKSkge1xuICAgICAgICBjb25zdCBhcnIgPSBiLm1hcCgoYmksIGkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBnZXRfaW50ZXJwb2xhdG9yKGFbaV0sIGJpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0ID0+IGFyci5tYXAoZm4gPT4gZm4odCkpO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgaWYgKCFhIHx8ICFiKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPYmplY3QgY2Fubm90IGJlIG51bGwnKTtcbiAgICAgICAgaWYgKGlzX2RhdGUoYSkgJiYgaXNfZGF0ZShiKSkge1xuICAgICAgICAgICAgYSA9IGEuZ2V0VGltZSgpO1xuICAgICAgICAgICAgYiA9IGIuZ2V0VGltZSgpO1xuICAgICAgICAgICAgY29uc3QgZGVsdGEgPSBiIC0gYTtcbiAgICAgICAgICAgIHJldHVybiB0ID0+IG5ldyBEYXRlKGEgKyB0ICogZGVsdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhiKTtcbiAgICAgICAgY29uc3QgaW50ZXJwb2xhdG9ycyA9IHt9O1xuICAgICAgICBrZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGludGVycG9sYXRvcnNba2V5XSA9IGdldF9pbnRlcnBvbGF0b3IoYVtrZXldLCBiW2tleV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICAgICAgICBrZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IGludGVycG9sYXRvcnNba2V5XSh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGNvbnN0IGRlbHRhID0gYiAtIGE7XG4gICAgICAgIHJldHVybiB0ID0+IGEgKyB0ICogZGVsdGE7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGludGVycG9sYXRlICR7dHlwZX0gdmFsdWVzYCk7XG59XG5mdW5jdGlvbiB0d2VlbmVkKHZhbHVlLCBkZWZhdWx0cyA9IHt9KSB7XG4gICAgY29uc3Qgc3RvcmUgPSB3cml0YWJsZSh2YWx1ZSk7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IHRhcmdldF92YWx1ZSA9IHZhbHVlO1xuICAgIGZ1bmN0aW9uIHNldChuZXdfdmFsdWUsIG9wdHMpIHtcbiAgICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IG5ld192YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0X3ZhbHVlID0gbmV3X3ZhbHVlO1xuICAgICAgICBsZXQgcHJldmlvdXNfdGFzayA9IHRhc2s7XG4gICAgICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgICAgIGxldCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSA0MDAsIGVhc2luZyA9IGxpbmVhciwgaW50ZXJwb2xhdGUgPSBnZXRfaW50ZXJwb2xhdG9yIH0gPSBhc3NpZ24oYXNzaWduKHt9LCBkZWZhdWx0cyksIG9wdHMpO1xuICAgICAgICBpZiAoZHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgICAgIGlmIChwcmV2aW91c190YXNrKSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNfdGFzay5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2sgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gdGFyZ2V0X3ZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzdGFydCA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGxldCBmbjtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChub3cgPCBzdGFydClcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGlmICghc3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIGZuID0gaW50ZXJwb2xhdGUodmFsdWUsIG5ld192YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSBkdXJhdGlvbih2YWx1ZSwgbmV3X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcmV2aW91c190YXNrKSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNfdGFzay5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2sgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZWxhcHNlZCA9IG5vdyAtIHN0YXJ0O1xuICAgICAgICAgICAgaWYgKGVsYXBzZWQgPiBkdXJhdGlvbikge1xuICAgICAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IG5ld192YWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gZm4oZWFzaW5nKGVsYXBzZWQgLyBkdXJhdGlvbikpKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRhc2sucHJvbWlzZTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2V0LFxuICAgICAgICB1cGRhdGU6IChmbiwgb3B0cykgPT4gc2V0KGZuKHRhcmdldF92YWx1ZSwgdmFsdWUpLCBvcHRzKSxcbiAgICAgICAgc3Vic2NyaWJlOiBzdG9yZS5zdWJzY3JpYmVcbiAgICB9O1xufVxuXG5leHBvcnQgeyBzcHJpbmcsIHR3ZWVuZWQgfTtcbiIsIjxzY3JpcHQ+XHJcbiAgaW1wb3J0IHsgb25Nb3VudCB9IGZyb20gXCJzdmVsdGVcIlxyXG5cclxuICBleHBvcnQgbGV0IHNpemUgPSAxMFxyXG4gIGV4cG9ydCBsZXQgeCA9IFstMC41LCAwLjVdXHJcbiAgZXhwb3J0IGxldCB5ID0gWzAuMjUsIDFdXHJcbiAgZXhwb3J0IGxldCBkdXJhdGlvbiA9IDIwMDBcclxuICBleHBvcnQgbGV0IGluZmluaXRlID0gZmFsc2VcclxuICBleHBvcnQgbGV0IGRlbGF5ID0gWzAsIDUwXVxyXG4gIGV4cG9ydCBsZXQgY29sb3JSYW5nZSA9IFswLCAzNjBdXHJcbiAgZXhwb3J0IGxldCBjb2xvckFycmF5ID0gW11cclxuICBleHBvcnQgbGV0IGFtb3VudCA9IDUwXHJcbiAgZXhwb3J0IGxldCBpdGVyYXRpb25Db3VudCA9IDFcclxuICBleHBvcnQgbGV0IGZhbGxEaXN0YW5jZSA9IFwiMTAwcHhcIlxyXG4gIGV4cG9ydCBsZXQgcm91bmRlZCA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCBjb25lID0gZmFsc2VcclxuICBleHBvcnQgbGV0IG5vR3Jhdml0eSA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCB4U3ByZWFkID0gMC4xNVxyXG4gIGV4cG9ydCBsZXQgZGVzdHJveU9uQ29tcGxldGUgPSB0cnVlXHJcblxyXG4gIGxldCBjb21wbGV0ZSA9IGZhbHNlXHJcblxyXG4gIG9uTW91bnQoKCkgPT4ge1xyXG4gICAgaWYgKCFkZXN0cm95T25Db21wbGV0ZSB8fCBpbmZpbml0ZSB8fCBpdGVyYXRpb25Db3VudCA9PSBcImluZmluaXRlXCIpIHJldHVyblxyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4gY29tcGxldGUgPSB0cnVlLCAoZHVyYXRpb24gKyBkZWxheVsxXSkgKiBpdGVyYXRpb25Db3VudClcclxuICB9KVxyXG5cclxuICBmdW5jdGlvbiByYW5kb21CZXR3ZWVuKG1pbiwgbWF4KSB7XHJcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRDb2xvcigpIHtcclxuICAgIGlmIChjb2xvckFycmF5Lmxlbmd0aCkgcmV0dXJuIGNvbG9yQXJyYXlbTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKGNvbG9yQXJyYXkubGVuZ3RoIC0gMSkpXVxyXG4gICAgZWxzZSByZXR1cm4gYGhzbCgke01hdGgucm91bmQocmFuZG9tQmV0d2Vlbihjb2xvclJhbmdlWzBdLCBjb2xvclJhbmdlWzFdKSl9LCA3NSUsIDUwJWBcclxuICB9XHJcbjwvc2NyaXB0PlxyXG5cclxuXHJcblxyXG57I2lmICFjb21wbGV0ZX1cclxuICA8ZGl2IGNsYXNzPVwiY29uZmV0dGktaG9sZGVyXCIgY2xhc3M6cm91bmRlZCBjbGFzczpjb25lIGNsYXNzOm5vLWdyYXZpdHk9e25vR3Jhdml0eX0+XHJcbiAgICB7I2VhY2ggeyBsZW5ndGg6IGFtb3VudCB9IGFzIF99XHJcbiAgICAgIDxkaXZcclxuICAgICAgICBjbGFzcz1cImNvbmZldHRpXCJcclxuICAgICAgICBzdHlsZT1cIlxyXG4gICAgICAgIC0tZmFsbC1kaXN0YW5jZToge2ZhbGxEaXN0YW5jZX07XHJcbiAgICAgICAgLS1zaXplOiB7c2l6ZX1weDtcclxuICAgICAgICAtLWNvbG9yOiB7Z2V0Q29sb3IoKX07XHJcbiAgICAgICAgLS1za2V3OiB7cmFuZG9tQmV0d2VlbigtNDUsIDQ1KX1kZWcse3JhbmRvbUJldHdlZW4oLTQ1LCA0NSl9ZGVnO1xyXG4gICAgICAgIC0tcm90YXRpb24teHl6OiB7cmFuZG9tQmV0d2VlbigtMTAsIDEwKX0sIHtyYW5kb21CZXR3ZWVuKC0xMCwgMTApfSwge3JhbmRvbUJldHdlZW4oLTEwLCAxMCl9O1xyXG4gICAgICAgIC0tcm90YXRpb24tZGVnOiB7cmFuZG9tQmV0d2VlbigwLCAzNjApfWRlZztcclxuICAgICAgICAtLXRyYW5zbGF0ZS15LW11bHRpcGxpZXI6IHtyYW5kb21CZXR3ZWVuKHlbMF0sIHlbMV0pfTtcclxuICAgICAgICAtLXRyYW5zbGF0ZS14LW11bHRpcGxpZXI6IHtyYW5kb21CZXR3ZWVuKHhbMF0sIHhbMV0pfTtcclxuICAgICAgICAtLXNjYWxlOiB7MC4xICogcmFuZG9tQmV0d2VlbigyLCAxMCl9O1xyXG4gICAgICAgIC0tdHJhbnNpdGlvbi1kdXJhdGlvbjoge2luZmluaXRlID8gYGNhbGMoJHtkdXJhdGlvbn1tcyAqIHZhcigtLXNjYWxlKSlgIDogYCR7ZHVyYXRpb259bXNgfTtcclxuICAgICAgICAtLXRyYW5zaXRpb24tZGVsYXk6IHtyYW5kb21CZXR3ZWVuKGRlbGF5WzBdLCBkZWxheVsxXSl9bXM7XHJcbiAgICAgICAgLS10cmFuc2l0aW9uLWl0ZXJhdGlvbi1jb3VudDoge2luZmluaXRlID8gJ2luZmluaXRlJyA6IGl0ZXJhdGlvbkNvdW50fTtcclxuICAgICAgICAtLXgtc3ByZWFkOiB7KDEgLSB4U3ByZWFkKX1cIiAvPlxyXG4gICAgey9lYWNofVxyXG4gIDwvZGl2PlxyXG57L2lmfVxyXG5cclxuXHJcblxyXG48c3R5bGU+XHJcbiAgLmNvbmZldHRpLWhvbGRlciB7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgfVxyXG5cclxuICBAa2V5ZnJhbWVzIHJvdGF0ZSB7XHJcbiAgICAwJSB7XHJcbiAgICAgIHRyYW5zZm9ybTogc2tldyh2YXIoLS1za2V3KSkgcm90YXRlM2QodmFyKC0tZnVsbC1yb3RhdGlvbikpO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHNrZXcodmFyKC0tc2tldykpIHJvdGF0ZTNkKHZhcigtLXJvdGF0aW9uLXh5eiksIGNhbGModmFyKC0tcm90YXRpb24tZGVnKSArIDM2MGRlZykpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQGtleWZyYW1lcyB0cmFuc2xhdGUge1xyXG4gICAgMCUge1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDglIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKGNhbGModmFyKC0tdHJhbnNsYXRlLXkpICogMC45NSkpIHRyYW5zbGF0ZVgoY2FsYyh2YXIoLS10cmFuc2xhdGUteCkgKiAodmFyKC0teC1zcHJlYWQpICogMC45KSkpO1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDEyJSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSh2YXIoLS10cmFuc2xhdGUteSkpIHRyYW5zbGF0ZVgoY2FsYyh2YXIoLS10cmFuc2xhdGUteCkgKiAodmFyKC0teC1zcHJlYWQpICogMC45NSkpKTtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICAxNiUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkodmFyKC0tdHJhbnNsYXRlLXkpKSB0cmFuc2xhdGVYKGNhbGModmFyKC0tdHJhbnNsYXRlLXgpICogdmFyKC0teC1zcHJlYWQpKSk7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgMTAwJSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWShjYWxjKHZhcigtLXRyYW5zbGF0ZS15KSArIHZhcigtLWZhbGwtZGlzdGFuY2UpKSkgdHJhbnNsYXRlWCh2YXIoLS10cmFuc2xhdGUteCkpO1xyXG4gICAgICBvcGFjaXR5OiAwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQGtleWZyYW1lcyBuby1ncmF2aXR5LXRyYW5zbGF0ZSB7XHJcbiAgICAwJSB7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgMTAwJSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSh2YXIoLS10cmFuc2xhdGUteSkpIHRyYW5zbGF0ZVgodmFyKC0tdHJhbnNsYXRlLXgpKTtcclxuICAgICAgb3BhY2l0eTogMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC5jb25mZXR0aSB7XHJcbiAgICAtLXRyYW5zbGF0ZS15OiBjYWxjKC0yMDBweCAqIHZhcigtLXRyYW5zbGF0ZS15LW11bHRpcGxpZXIpKTtcclxuICAgIC0tdHJhbnNsYXRlLXg6IGNhbGMoMjAwcHggKiB2YXIoLS10cmFuc2xhdGUteC1tdWx0aXBsaWVyKSk7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICBoZWlnaHQ6IGNhbGModmFyKC0tc2l6ZSkgKiB2YXIoLS1zY2FsZSkpO1xyXG4gICAgd2lkdGg6IGNhbGModmFyKC0tc2l6ZSkgKiB2YXIoLS1zY2FsZSkpO1xyXG4gICAgYW5pbWF0aW9uOiB0cmFuc2xhdGUgdmFyKC0tdHJhbnNpdGlvbi1kdXJhdGlvbikgdmFyKC0tdHJhbnNpdGlvbi1kZWxheSkgdmFyKC0tdHJhbnNpdGlvbi1pdGVyYXRpb24tY291bnQpIGxpbmVhcjtcclxuICAgIG9wYWNpdHk6IDA7XHJcbiAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcclxuICB9XHJcblxyXG4gIC5jb25mZXR0aTo6YmVmb3JlIHtcclxuICAgIC0tZnVsbC1yb3RhdGlvbjogdmFyKC0tcm90YXRpb24teHl6KSwgdmFyKC0tcm90YXRpb24tZGVnKTtcclxuICAgIGNvbnRlbnQ6ICcnO1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGhlaWdodDogMTAwJTtcclxuICAgIGJhY2tncm91bmQ6IHZhcigtLWNvbG9yKTtcclxuICAgIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjtcclxuICAgIHRyYW5zZm9ybTogc2tldyh2YXIoLS1za2V3KSkgcm90YXRlM2QodmFyKC0tZnVsbC1yb3RhdGlvbikpO1xyXG4gICAgYW5pbWF0aW9uOiByb3RhdGUgdmFyKC0tdHJhbnNpdGlvbi1kdXJhdGlvbikgdmFyKC0tdHJhbnNpdGlvbi1kZWxheSkgdmFyKC0tdHJhbnNpdGlvbi1pdGVyYXRpb24tY291bnQpIGxpbmVhcjtcclxuICB9XHJcblxyXG4gIC5yb3VuZGVkIC5jb25mZXR0aTo6YmVmb3JlIHtcclxuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICB9XHJcblxyXG4gIC5jb25lIC5jb25mZXR0aSB7XHJcbiAgICAtLXRyYW5zbGF0ZS14OiBjYWxjKDIwMHB4ICogdmFyKC0tdHJhbnNsYXRlLXktbXVsdGlwbGllcikgKiB2YXIoLS10cmFuc2xhdGUteC1tdWx0aXBsaWVyKSk7XHJcbiAgfVxyXG5cclxuICAubm8tZ3Jhdml0eSAuY29uZmV0dGkge1xyXG4gICAgYW5pbWF0aW9uLW5hbWU6IG5vLWdyYXZpdHktdHJhbnNsYXRlO1xyXG4gICAgYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjogZWFzZS1vdXQ7XHJcbiAgfVxyXG5cclxuICBAbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb24pIHtcclxuICAgIC5jb25mZXR0aSxcclxuICAgIC5jb25mZXR0aTo6YmVmb3JlIHtcclxuICAgICAgYW5pbWF0aW9uOiBub25lO1xyXG4gICAgfVxyXG4gIH1cclxuPC9zdHlsZT5cclxuIiwiPHNjcmlwdCBjb250ZXh0PVwibW9kdWxlXCI+XG4gIGV4cG9ydCBjb25zdCBtYXBzID0ge1xuICAgICdzbWFsbCc6IFtcbiAgICAgICdTRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGJyxcbiAgICAgICdGRkhGRkZGRkZGJyxcbiAgICAgICdIRkZGRkhGRkZGJyxcbiAgICAgICdGRkhGRkZIRkZGJyxcbiAgICAgICdIRkZGRkhGRkZGJyxcbiAgICAgICdGRkhGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGJyxcbiAgICAgICdGRkZHRkZGRkZGJ1xuICAgIF0sXG4gICAgJzE2eDE2JzogW1xuICAgICAgJ0hIRkZGRkZGRkZGRkZGSEgnLFxuICAgICAgJ0hGRkZGRkZGRkZGRkZGRkgnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkhISEZGRkZISEhGRkYnLFxuICAgICAgJ0ZGRkhISEZGRkZISEhGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGR0ZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkhISEZGRkZISEhGRkYnLFxuICAgICAgJ0ZGRkhISEhISEhISEhGRkYnLFxuICAgICAgJ0ZGRkZISEhISEhISEZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGU0ZGRkZGRkgnLFxuICAgICAgJ0hIRkZGRkZGRkZGRkZGSEgnXG4gICAgXSxcbiAgICAnMzJ4MzInOiBbXG4gICAgICAnSEhISEhIRkZGRkZGRkZGRkZGRkZGRkZISEhISEhISEgnLFxuICAgICAgJ0hIRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhISEhIJyxcbiAgICAgICdGRkZGU0ZGRkhIRkZGRkZGRkZGRkZGRkZGRkZGRkZGSCcsXG4gICAgICAnRkZGRkZGRkZGSEZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEhISEhGRkZGRkZGRkZISEhISEhISEZGRkZGRkZGRkYnLFxuICAgICAgJ0hISEhISEhISEhISEhISEhISEhISEhIRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEhISEhISEhISEhISEhISEhIRkZGRkZGRkZGRicsXG4gICAgICAnSEhGRkhISEhISEhISEhISEZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGRkZGRkZISEhISEZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGRkZISEZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhIRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISEYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhISCcsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhGRkgnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGR0ZGRkZGRkZIRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZIRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEZGSEZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhGRkZGRkZGRicsXG4gICAgICAnSEhISEhISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hISEhISEhISEhISEZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICBdLFxuICB9XG4gIGV4cG9ydCBjb25zdCBjb2xvcnMgPSB7XG4gICAgJ0gnOiAnIzE5NzZkMicsXG4gICAgJ1MnOiAnI2VmOWE5YScsXG4gICAgJ0YnOiAnI2UxZjVmZScsXG4gICAgJ0cnOiAnIzgxYzc4NCcsXG4gICAgJ1QnOiAnI2ZmZTBiMidcbiAgfVxuPC9zY3JpcHQ+IiwiPHNjcmlwdD5cbiAgaW1wb3J0IHsgb25Nb3VudCwgdGljayB9IGZyb20gJ3N2ZWx0ZSc7XG4gIGltcG9ydCB7IHR3ZWVuZWQgfSBmcm9tIFwic3ZlbHRlL21vdGlvblwiO1xuICBpbXBvcnQgeyBjdWJpY091dCB9IGZyb20gXCJzdmVsdGUvZWFzaW5nXCI7XG4gIGltcG9ydCB7IENvbmZldHRpIH0gZnJvbSBcInN2ZWx0ZS1jb25mZXR0aVwiO1xuICBpbXBvcnQgeyBtYXBzLCBjb2xvcnMgfSBmcm9tIFwiLi9jb25zdGFudHMuc3ZlbHRlXCJcblxuICBsZXQgY2FudmFzO1xuXG4gIGxldCBzZWxlY3RlZE1hcDtcbiAgbGV0IHNlbGVjdGVkVGVhY2hlcjtcbiAgbGV0IHNlbGVjdGVkUmVzZXQ7XG5cbiAgdmFyIHJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xuICB2YXIgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgdmFyIHVwUHJlc3NlZCA9IGZhbHNlO1xuICB2YXIgZG93blByZXNzZWQgPSBmYWxzZTtcblxuICB2YXIgbWFwQ2hhbmdlZCA9IHRydWU7XG5cbiAgdmFyIHBvczsgIC8vIHRoZSBwb3NpdGlvbiB3aGVyZSB0aGUgcGxheWVyIGlzIGRpc3BsYXllZFxuICB2YXIgcmVhbFBvczsgIC8vIHRoZSBhY3R1YWwgcG9zaXRpb24gb2YgdGhlIHBsYXllciAoYW5pbWF0aW9ucyBkb24ndCBjaGFuZ2UgdGhpcylcbiAgdmFyIGhpc3RvcnkgPSBbXTsgIC8vIHRoZSBoaXN0b3J5IG9mIHBsYXllciBwb3NpdGlvbnNcblxuICB2YXIgaGFzSW50ZXJhY3RlZCA9IGZhbHNlOyAgLy8gaGFzIHRoZSByZWFkZXIgaW50ZXJhY3RlZCB3aXRoIHRoZSBnYW1lIHlldD9cbiAgdmFyIHN0YXR1c01lc3NhZ2UgPSAnJzsgIC8vIGRpc3BsYXllZCBzdGF0dXMgbWVzc2FnZVxuICB2YXIgc3RhdHVzVGltZXIgPSBudWxsOyAgLy8gdGltZXIgaWQgZm9yIGNsZWFyaW5nIG9sZCB0aW1lclxuXG4gIHZhciBjb25mZXR0aSA9IGZhbHNlO1xuXG4gIHZhciBwaXhlbFJhdGlvOyAvLyBhZGp1c3QgZ2FtZSByZXNvbHV0aW9uIHRvIGhpZ2hlciByZXNvbHV0aW9uIGRpc3BsYXlzXG5cbiAgY29uc3Qgcm9ib3QgPSBuZXcgSW1hZ2UoKTtcbiAgcm9ib3Quc3JjID0gJy4vaW1hZ2VzL3JvYm90LnBuZyc7XG5cbiAgY29uc3Qgcm9ib3RGbGlwcGVkID0gbmV3IEltYWdlKCk7XG4gIHJvYm90RmxpcHBlZC5zcmMgPSAnLi9pbWFnZXMvcm9ib3QtZmxpcHBlZC5wbmcnXG5cbiAgdmFyIGZsaXBwZWQgPSBmYWxzZTtcbiAgdmFyIGltYWdlID0gcm9ib3Q7XG5cbiAgdmFyIHNjb3JlID0gMDtcbiAgdmFyIGxhc3RTY29yZSA9IDA7XG5cbiAgb25Nb3VudCgoKSA9PiB7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgcGl4ZWxSYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICAgIGN0eC5zY2FsZShwaXhlbFJhdGlvLCBwaXhlbFJhdGlvKTtcblxuICAgIHZhciB0aWxlU2l6ZTtcbiAgICB2YXIgbWFwO1xuICAgIHZhciBzdGFydDtcbiAgICB2YXIgbGFzdFBvc2l0aW9uO1xuICAgIHZhciB0ZWFjaGVyTWFwO1xuXG4gICAgZHJhd0Vudmlyb25tZW50KCk7XG5cbiAgICBmdW5jdGlvbiBvbmVTdGVwUmVhY2goYmFzZU1hc2spIHtcbiAgICAgIGxldCByb3dzID0gYmFzZU1hc2subGVuZ3RoO1xuICAgICAgbGV0IGNvbHMgPSBiYXNlTWFza1swXS5sZW5ndGg7XG5cbiAgICAgIGxldCBvbmVTdGVwTWFzayA9IG5ldyBBcnJheShyb3dzKS5maWxsKGZhbHNlKS5tYXAoKCkgPT4gbmV3IEFycmF5KGNvbHMpLmZpbGwoZmFsc2UpKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93czsgaSsrKSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY29sczsgaisrKSB7XG4gICAgICAgICAgdmFyIHJlcyA9IGZhbHNlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaV1baisxXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzIHw9IGJhc2VNYXNrW2krMV1bal1cbiAgICAgICAgICB9IGNhdGNoKGUpIHt9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlcyB8PSBiYXNlTWFza1tpXVtqLTFdXG4gICAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaS0xXVtqXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cblxuICAgICAgICAgIG9uZVN0ZXBNYXNrW2ldW2pdID0gcmVzXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9uZVN0ZXBNYXNrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFRlYWNoZXIoYmFzZU1hcCwgZGlzdGFuY2UpIHtcblxuICAgICAgaWYgKGRpc3RhbmNlID09IDApIHtcbiAgICAgICAgcmV0dXJuIGJhc2VNYXBcbiAgICAgIH1cblxuICAgICAgdmFyIG5ld0Jhc2VNYXAgPSBuZXcgQXJyYXkoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG5ld0Jhc2VNYXAucHVzaChtYXBbaV0uc3BsaXQoJycpKVxuICAgICAgfVxuXG4gICAgICBsZXQgYmFzZURhbmdlck1hc2sgPSBuZXdCYXNlTWFwLm1hcCgocm93KSA9PiB7XG4gICAgICAgIHJldHVybiByb3cubWFwKGVsZW1lbnQgPT4gZWxlbWVudCA9PSAnSCcpXG4gICAgICB9KVxuICAgICAgbGV0IGJhc2VFbXB0eU1hc2sgPSBuZXdCYXNlTWFwLm1hcCgocm93KSA9PiB7XG4gICAgICAgIHJldHVybiByb3cubWFwKGVsZW1lbnQgPT4gZWxlbWVudCA9PSAnRicpXG4gICAgICB9KVxuXG4gICAgICB2YXIgcHJldmlvdXNNYXNrID0gQXJyYXkuZnJvbShiYXNlRGFuZ2VyTWFzayk7XG4gICAgICB2YXIgcmVhY2hNYXNrXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpc3RhbmNlOyBpKyspIHtcbiAgICAgICAgcmVhY2hNYXNrID0gb25lU3RlcFJlYWNoKHByZXZpb3VzTWFzayk7XG4gICAgICAgIHByZXZpb3VzTWFzayA9IHJlYWNoTWFzay5tYXAoKHJvdywgaSkgPT4ge1xuICAgICAgICAgIHJldHVybiByb3cubWFwKChlbGVtZW50LCBqKSA9PiBlbGVtZW50IHx8IHByZXZpb3VzTWFza1tpXVtqXSlcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgdmFyIG5ld01hcCA9IEFycmF5LmZyb20obmV3QmFzZU1hcCk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld0Jhc2VNYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBuZXdCYXNlTWFwWzBdLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgaWYgKHJlYWNoTWFza1tpXVtqXSAmJiBiYXNlRW1wdHlNYXNrW2ldW2pdKSB7XG4gICAgICAgICAgICBuZXdNYXBbaV1bal0gPSAnVCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IHRlYWNoZXJNYXAgPSBuZXcgQXJyYXkoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmFzZU1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0ZWFjaGVyTWFwLnB1c2gobmV3TWFwW2ldLmpvaW4oJycpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRlYWNoZXJNYXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJhd0Vudmlyb25tZW50KCkge1xuICAgICAgbWFwID0gbWFwc1tzZWxlY3RlZE1hcF1cbiAgICAgIHRpbGVTaXplID0gY2FudmFzLmhlaWdodCAvIG1hcC5sZW5ndGg7XG4gICAgICB0ZWFjaGVyTWFwID0gYWRkVGVhY2hlcihtYXAsIHNlbGVjdGVkVGVhY2hlcik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWFwWzBdLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgbGV0IHN0YXRlID0gdGVhY2hlck1hcFtpXVtqXTtcblxuICAgICAgICAgIGlmIChzdGF0ZSA9PSAnUycpIHtcbiAgICAgICAgICAgIHN0YXJ0ID0gW2osIGldO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxldCB4ID0gaiAqIHRpbGVTaXplO1xuICAgICAgICAgIGxldCB5ID0gaSAqIHRpbGVTaXplO1xuXG4gICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgIGN0eC5yZWN0KHgsIHksIHRpbGVTaXplICsgMSwgdGlsZVNpemUgKyAxKTtcbiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gY29sb3JzW3N0YXRlXTtcbiAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTsgXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBmdW5jdGlvbiBkcmF3QWdlbnQoKSB7XG4gICAgICBpZiAoZmxpcHBlZCkge1xuICAgICAgICBpbWFnZSA9IHJvYm90RmxpcHBlZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGltYWdlID0gcm9ib3Q7XG4gICAgICB9XG5cbiAgICAgIGN0eC5kcmF3SW1hZ2UoaW1hZ2UsICRwb3NbMF0gKiB0aWxlU2l6ZSwgJHBvc1sxXSAqIHRpbGVTaXplLCB0aWxlU2l6ZSwgdGlsZVNpemUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1vdmVBZ2VudChuZXdQb3MpIHtcbiAgICAgIHBvcy5zZXQobmV3UG9zKTtcbiAgICAgIHJlYWxQb3MgPSBuZXdQb3M7XG4gICAgICBoaXN0b3J5LnB1c2gocmVhbFBvcyk7XG4gICAgICBzY29yZSAtPSAwLjAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0QWdlbnQoKSB7XG4gICAgICBoaXN0b3J5ID0gW107XG4gICAgICBsYXN0U2NvcmUgPSBzY29yZTtcbiAgICAgIG1vdmVBZ2VudChzdGFydCk7XG4gICAgICBzY29yZSA9IDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJhdygpIHtcblxuICAgICAgaWYgKGxlZnRQcmVzc2VkIHx8IHJpZ2h0UHJlc3NlZCB8fCB1cFByZXNzZWQgfHwgZG93blByZXNzZWQpIHtcbiAgICAgICAgaGFzSW50ZXJhY3RlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblxuICAgICAgZHJhd0Vudmlyb25tZW50KCk7XG5cbiAgICAgIGlmIChtYXBDaGFuZ2VkKSB7XG4gICAgICAgIHBvcyA9IHR3ZWVuZWQoc3RhcnQsIHtcbiAgICAgICAgICBkdXJhdGlvbjogMTUwLFxuICAgICAgICAgIGVhc2luZzogY3ViaWNPdXQsXG4gICAgICAgIH0pO1xuICAgICAgICBzY29yZSA9IDA7XG4gICAgICAgIHJlc2V0QWdlbnQoKTtcbiAgICAgIH1cblxuICAgICAgZHJhd0FnZW50KCk7IFxuXG4gICAgICAvLyBzbGlwIHdpdGggMjAlIHByb2JhYmlsaXR5XG4gICAgICBjb25zdCBybmQgPSBNYXRoLnJhbmRvbSgpXG4gICAgICBpZiAobGVmdFByZXNzZWQgfHwgcmlnaHRQcmVzc2VkKSB7XG4gICAgICAgIGlmIChybmQgPCAwLjEpIHtcbiAgICAgICAgICBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHVwUHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocm5kIDwgMC4yKSB7XG4gICAgICAgICAgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodXBQcmVzc2VkIHx8IGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGlmIChybmQgPCAwLjEpIHtcbiAgICAgICAgICB1cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIGxlZnRQcmVzc2VkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChybmQgPCAwLjIpIHtcbiAgICAgICAgICB1cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHJpZ2h0UHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChybmQgPCAwLjIgJiYgKHVwUHJlc3NlZCB8fCBkb3duUHJlc3NlZCB8fCBsZWZ0UHJlc3NlZCB8fCByaWdodFByZXNzZWQpKSB7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3UganVzdCBzbGlwcGVkLicpXG4gICAgICB9XG5cbiAgICAgIGlmIChsZWZ0UHJlc3NlZCkgZmxpcHBlZCA9IHRydWU7XG4gICAgICBpZiAocmlnaHRQcmVzc2VkKSBmbGlwcGVkID0gZmFsc2U7XG5cbiAgICAgIC8vIHJlbWVtYmVyIGxhc3QgcG9zaXRpb25cbiAgICAgIGxhc3RQb3NpdGlvbiA9IEFycmF5LmZyb20ocmVhbFBvcyk7XG4gICAgICBsZXQgW3gsIHldID0gQXJyYXkuZnJvbShsYXN0UG9zaXRpb24pO1xuXG4gICAgICAvLyBjaGFuZ2UgcGxheWVyIHBvc1xuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCkge1xuICAgICAgICBpZiAoeCA8IG1hcFswXS5sZW5ndGggLSAxKSB4ICs9IDFcbiAgICAgIH0gZWxzZSBpZiAobGVmdFByZXNzZWQpIHtcbiAgICAgICAgaWYgKHggPiAwKSB4IC09IDFcbiAgICAgIH0gZWxzZSBpZiAodXBQcmVzc2VkKSB7XG4gICAgICAgIGlmICh5ID4gMCkgeSAtPSAxXG4gICAgICB9IGVsc2UgaWYgKGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGlmICh5IDwgbWFwLmxlbmd0aCAtIDEpIHkgKz0gMVxuICAgICAgfVxuXG4gICAgICAvLyBtb3ZlIGlmIGJ1dHRvbiBpcyBwcmVzc2VkXG4gICAgICBpZiAocmlnaHRQcmVzc2VkIHx8IGxlZnRQcmVzc2VkIHx8IGRvd25QcmVzc2VkIHx8IHVwUHJlc3NlZCkge1xuICAgICAgICBtb3ZlQWdlbnQoW3gsIHldKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gY2hlY2sgZm9yIHdpbiBhbmQgZmFpbFxuICAgICAgaWYgKG1hcFt5XVt4XSA9PSAnRycpIHtcbiAgICAgICAgY29uZmV0dGkgPSB0cnVlO1xuICAgICAgICBzY29yZSArPSA2O1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtjb25mZXR0aSA9IGZhbHNlfSwgMzAwMCk7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3Ugd29uIScpO1xuICAgICAgICByZXNldEFnZW50KCk7XG4gICAgICB9IGVsc2UgaWYgKG1hcFt5XVt4XSA9PSAnSCcpIHtcbiAgICAgICAgc2hvd01lc3NhZ2UoJ1lvdSBmYWlsZWQuJyk7XG4gICAgICAgIHNjb3JlID0gMDtcbiAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgfVxuXG4gICAgICAvLyBUZWFjaGVyIGludGVydmVudGlvbnNcbiAgICAgIGVsc2UgaWYgKHRlYWNoZXJNYXBbeV1beF0gPT0gJ1QnKSB7XG4gICAgICAgIGlmIChzZWxlY3RlZFJlc2V0ID09ICdIUicpIHtcbiAgICAgICAgICAvLyBoYXJkIHJlc2V0XG4gICAgICAgICAgbGV0IHRtcFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgICAgIHNjb3JlID0gdG1wU2NvcmU7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRSZXNldCA9PSAnQjQnKSB7XG4gICAgICAgICAgLy8gYmFjayA0IHJlc2V0XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0ICYmIGhpc3RvcnkubGVuZ3RoID4gMTsgaSsrKSB7XG4gICAgICAgICAgICBoaXN0b3J5LnBvcCgpXG4gICAgICAgICAgfVxuICAgICAgICAgIHNjb3JlICs9IDAuMDE7XG4gICAgICAgICAgbW92ZUFnZW50KGhpc3RvcnlbaGlzdG9yeS5sZW5ndGgtMV0pO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkUmVzZXQgPT0gJ1NSJykge1xuICAgICAgICAgIC8vIHNvZnQgcmVzZXRcbiAgICAgICAgICBzY29yZSArPSAwLjAxO1xuICAgICAgICAgIG1vdmVBZ2VudChsYXN0UG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHNob3dNZXNzYWdlKCdUaGUgdGVhY2hlciBzZXQgeW91IGJhY2suJyk7XG4gICAgICB9XG5cbiAgICAgIG1hcENoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG4gICAgICBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7XG4gICAgfVxuXG4gICAgZHJhdygpO1xuICB9KTtcblxuICBmdW5jdGlvbiBtYXBDaGFuZ2VkSGFuZGxlcigpIHtcbiAgICBtYXBDaGFuZ2VkID0gdHJ1ZTtcbiAgfVxuICBcbiAgZnVuY3Rpb24ga2V5RG93bkhhbmRsZXIoZSkge1xuXHRcdGlmKGUua2V5Q29kZSA9PSAzOSB8fCBlLmtleSA9PSAnZCcpIHtcblx0XHRcdHJpZ2h0UHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYoZS5rZXlDb2RlID09IDM3IHx8IGUua2V5ID09ICdhJykge1xuXHRcdFx0bGVmdFByZXNzZWQgPSB0cnVlO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cbiAgICBlbHNlIGlmKGUua2V5Q29kZSA9PSAzOCB8fCBlLmtleSA9PSAndycpIHtcbiAgICAgIHVwUHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIGVsc2UgaWYoZS5rZXlDb2RlID09IDQwIHx8IGUua2V5ID09ICdzJykge1xuICAgICAgZG93blByZXNzZWQgPSB0cnVlO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblx0fVxuXG4gIGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1zZykge1xuICAgIC8vIHNob3cgYSBzdGF0dXMgbWVzc2FnZSBiZWxvdyB0aGUgbWFwXG4gICAgc3RhdHVzTWVzc2FnZSA9ICcnOyAgLy8gY2xlYXIgc3RhdHVzIG1lc3NhZ2UgYW5kIGNzcyB0cmFuc2l0aW9uXG4gICAgY2xlYXJUaW1lb3V0KHN0YXR1c1RpbWVyKTsgIC8vIHJlc2V0IHByZXZpb3VzIHN0YXR1cyBtZXNzYWdlIGNsZWFyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7c3RhdHVzTWVzc2FnZSA9IG1zZ30sIDEpICAvLyB3YWl0IGZvciBzdGF0dXNNZXNzYWdlIHRvIGJlIHJlc2V0XG4gICAgc3RhdHVzVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtzdGF0dXNNZXNzYWdlID0gJyd9LCAyMDAwKSAgLy8gY2xlYXIgc3RhdHVzIG1lc3NhZ2UgYWZ0ZXIgc29tZSB0aW1lXG4gIH1cbjwvc2NyaXB0PlxuXG48c3ZlbHRlOndpbmRvdyBvbjprZXlkb3duPXtrZXlEb3duSGFuZGxlcn0vPlxuXG48ZGl2IGNsYXNzPVwiZ2FtZVwiPlxuXG4gIDxkaXYgY2xhc3M9XCJtYXBcIj5cblxuICAgIDxwPlNjb3JlOiB7c2NvcmUgPT0gMCA/IGxhc3RTY29yZS50b0ZpeGVkKDIpIDogc2NvcmUudG9GaXhlZCgyKSB9PC9wPlxuXG4gICAgPGNhbnZhc1xuICAgICAgYmluZDp0aGlzPXtjYW52YXN9XG4gICAgICB3aWR0aD17NTAwICogcGl4ZWxSYXRpb31cbiAgICAgIGhlaWdodD17NTAwICogcGl4ZWxSYXRpb31cbiAgICAgIHN0eWxlPVwid2lkdGg6IDMwMHB4OyBoZWlnaHQ6IDMwMHB4O1wiXG4gICAgICBvbjpjbGljaz17KCkgPT4gc2hvd01lc3NhZ2UoJ1ByZXNzIHRoZSBhcnJvdyBrZXlzIHRvIG1vdmUuLi4nKX1cbiAgICA+PC9jYW52YXM+XG5cbiAgICA8aW1nIHdpZHRoPTMwMCBhbHQ9XCJMZWdlbmQgZm9yIHRoZSBhYm92ZSBtaW5pLWdhbWVcIiBzcmM9XCIuL2ltYWdlcy9tYXBfbGVnZW5kX3N0YWNrZWQuc3ZnXCI+XG5cbiAgICB7I2lmIGNvbmZldHRpfVxuICAgICAgPENvbmZldHRpIGNvbmUgZGVsYXk9e1swLCAyMDBdfSBhbW91bnQ9NTAgeD17Wy0wLjcsIDAuN119IHk9e1swLjUsIDEuNV19IC8+XG4gICAgey9pZn1cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+XG5cbiAgICB7I2lmIGhhc0ludGVyYWN0ZWR9XG4gICAgICA8cCBjbGFzcz1cInN0YXR1c1wiIHN0eWxlPVwidHJhbnNpdGlvbjogY29sb3Ige3N0YXR1c01lc3NhZ2UgPyAyIDogMH1zOyB0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjogZWFzZS1pbjsgY29sb3I6IHtzdGF0dXNNZXNzYWdlID8gJ3doaXRlJyA6ICdibGFjayd9O1wiPntzdGF0dXNNZXNzYWdlfTwvcD5cbiAgICB7OmVsc2V9XG4gICAgICA8cCBjbGFzcz1cInN0YXR1c1wiPlByZXNzIHRoZSBhcnJvdyBrZXlzIHRvIG1vdmUuLi48L3A+XG4gICAgey9pZn1cblxuICAgIDxkaXYgY2xhc3M9XCJtZW51XCI+XG4gICAgICA8ZGl2PlxuICAgICAgICA8bGFiZWwgZm9yPVwibWFwXCI+Q2hvb3NlIGEgbWFwOjwvbGFiZWw+XG4gICAgICAgIDxzZWxlY3QgYmluZDp2YWx1ZT17c2VsZWN0ZWRNYXB9IG9uOmNoYW5nZT17bWFwQ2hhbmdlZEhhbmRsZXJ9IG5hbWU9XCJtYXBcIiBpZD1cIm1hcFwiPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJzbWFsbFwiPkZyb3plbiBMYWtlPC9vcHRpb24+XG4gICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjE2eDE2XCI+RnJvemVuIFNtaWxleTwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIzMngzMlwiPkxhcmdlIExha2U8L29wdGlvbj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGZvcj1cInRlYWNoZXJcIj5BZGQgYSB0ZWFjaGVyOjwvbGFiZWw+XG4gICAgICAgIDxzZWxlY3QgYmluZDp2YWx1ZT17c2VsZWN0ZWRUZWFjaGVyfSBuYW1lPVwidGVhY2hlclwiIGlkPVwidGVhY2hlclwiPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIwXCI+Tm8gVGVhY2hlcjwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxXCI+RGlzdGFuY2UgMTwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIyXCI+RGlzdGFuY2UgMjwvb3B0aW9uPlxuICAgICAgICA8L3NlbGVjdD5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2PlxuICAgICAgICA8bGFiZWwgZm9yPVwicmVzZXRcIj5SZXNldCBzdHJhdGVneTo8L2xhYmVsPlxuICAgICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkUmVzZXR9IG5hbWU9XCJyZXNldFwiIGlkPVwicmVzZXRcIiBkaXNhYmxlZD17c2VsZWN0ZWRUZWFjaGVyPT0wfT5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiU1JcIj5Tb2Z0IFJlc2V0PC9vcHRpb24+XG4gICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIkI0XCI+QmFjayA0PC9vcHRpb24+XG4gICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIkhSXCI+SGFyZCBSZXNldDwvb3B0aW9uPlxuICAgICAgICA8L3NlbGVjdD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBjbGFzcz1cImtleWJvYXJkXCI+XG4gICAgICA8ZGl2PjwvZGl2PlxuICAgICAgPGJ1dHRvbiBvbjpjbGljaz17KCkgPT4gdXBQcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTM7PC9idXR0b24+XG4gICAgICA8ZGl2PjwvZGl2PlxuICAgICAgPGJ1dHRvbiBvbjpjbGljaz17KCkgPT4gbGVmdFByZXNzZWQgPSB0cnVlfSBjbGFzcz1cImtleVwiPiYjODU5Mjs8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IGRvd25QcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTU7PC9idXR0b24+XG4gICAgICA8YnV0dG9uIG9uOmNsaWNrPXsoKSA9PiByaWdodFByZXNzZWQgPSB0cnVlfSBjbGFzcz1cImtleVwiPiYjODU5NDs8L2J1dHRvbj5cbiAgICA8L2Rpdj5cblxuICA8L2Rpdj5cblxuPC9kaXY+XG5cbjxzdHlsZT5cblx0Y2FudmFzIHtcbiAgICBwYWRkaW5nOiAxZW1cbiAgfVxuXG4gIC5nYW1lIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICBwYWRkaW5nLWJvdHRvbTogMS41ZW07XG4gIH1cblxuICAuY29udHJvbHMge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLnN0YXR1cyB7XG4gICAgaGVpZ2h0OiAxZW07XG4gICAgd2lkdGg6IDE2ZW07XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHRyYW5zaXRpb246IGNvbG9yIDFzO1xuICAgIHBhZGRpbmctdG9wOiAxZW07XG4gIH1cblxuICAubWFwIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgfVxuXG4gIC5tYXAgcCB7XG4gICAgbWFyZ2luOiAwO1xuICB9XG5cbiAgLm1lbnUge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIHBhZGRpbmc6IDAuNWVtO1xuICB9XG5cbiAgLm1lbnUgZGl2IHtcbiAgICBtYXJnaW46IDAuM2VtO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgfVxuXG4gIC5rZXkge1xuXHRcdGJhY2tncm91bmQtY29sb3I6ICNlZWU7XG5cdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdHBhZGRpbmc6IDAuNWVtIDAuNWVtO1xuXHRcdGJvcmRlci10b3A6IDVweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7XG5cdFx0Ym9yZGVyLWxlZnQ6IDVweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7XG5cdFx0Ym9yZGVyLXJpZ2h0OiA1cHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjIpO1xuXHRcdGJvcmRlci1ib3R0b206IDVweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMik7XG5cdFx0Y29sb3I6ICM1NTU7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHdpZHRoOiA0ZW07XG4gICAgaGVpZ2h0OiA0ZW07XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuXHR9XG5cbiAgQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSB7XG4gICAgLmdhbWUge1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICB9XG4gICAgLmNvbnRyb2xzIHtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgfVxuICAgIC5tZW51IHtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgfVxuICAgIC5tZW51IGRpdiB7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgICAgZ2FwOiAxMHB4O1xuICAgIH1cbiAgICAua2V5IHtcbiAgICAgIHdpZHRoOiAzZW07XG4gICAgICBoZWlnaHQ6IDNlbTtcbiAgICB9XG4gIH1cblxuICAua2V5Ym9hcmQge1xuICAgIGRpc3BsYXk6IGdyaWQ7XG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBhdXRvIGF1dG8gYXV0bztcbiAgICBncmlkLWdhcDogMC41ZW07XG4gICAgcGFkZGluZzogMWVtO1xuICB9XG5cbiAgLmtleTphY3RpdmUge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNkZGQ7XG4gIH1cbjwvc3R5bGU+XG4iLCIvLyBIb3QgcmVsb2FkaW5nXG5pbXBvcnQgKiBhcyBfdW51c2VkIGZyb20gXCJyYXctbG9hZGVyIS4vaW5kZXguZWpzXCI7XG4vLyBUT0RPOiBkaXNhYmxlIGJlZm9yZSBwdWJsaXNoaW5nXG5cbmltcG9ydCBUcmFqZWN0b3JpZXMgZnJvbSBcIi4vZGlhZ3JhbXMvdHJhamVjdG9yaWVzLnN2ZWx0ZVwiO1xuaW1wb3J0IEJhY2sgZnJvbSBcIi4vZGlhZ3JhbXMvYmFjay5zdmVsdGVcIlxuaW1wb3J0IEluY3JlbWVudGFsIGZyb20gXCIuL2RpYWdyYW1zL2luY3JlbWVudGFsLnN2ZWx0ZVwiXG5pbXBvcnQgR3JpZCBmcm9tIFwiLi9kaWFncmFtcy9ncmlkLnN2ZWx0ZVwiXG5cbi8vIGxhemlseSBpbml0aWFsaXplIGFueSBkaWFncmFtIGJlbG93IHRoZSBmb2xkLiBFLkc6XG5cbmNvbnN0IHRyYWplY3Rvcmllc1RhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHJhamVjdG9yaWVzLXZpc3VhbGl6YXRpb25cIik7XG5sZXQgdHJhamVjdG9yaWVzO1xudHJhamVjdG9yaWVzVGFnLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XG5cdGNvbnN0IHRhcmdldCA9IHRyYWplY3Rvcmllc1RhZy5xdWVyeVNlbGVjdG9yKFwiI3RyYWplY3Rvcmllcy12aXN1YWxpemF0aW9uLXRhcmdldFwiKTtcblx0dHJhamVjdG9yaWVzID0gbmV3IFRyYWplY3Rvcmllcyh7IHRhcmdldCB9KTtcbn0pO1xuXG5jb25zdCBiYWNrVGFnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiYWNrLXZpc3VhbGl6YXRpb25cIik7XG5sZXQgYmFjaztcbmJhY2tUYWcuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5XCIsICgpID0+IHtcblx0Y29uc3QgdGFyZ2V0ID0gYmFja1RhZy5xdWVyeVNlbGVjdG9yKFwiI2JhY2stdmlzdWFsaXphdGlvbi10YXJnZXRcIik7XG5cdGJhY2sgPSBuZXcgQmFjayh7IHRhcmdldCB9KTtcbn0pO1xuXG5jb25zdCBpbmNyZW1lbnRhbFRhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW5jcmVtZW50YWwtdmlzdWFsaXphdGlvblwiKTtcbmxldCBpbmNyZW1lbnRhbDtcbmluY3JlbWVudGFsVGFnLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XG5cdGNvbnN0IHRhcmdldCA9IGluY3JlbWVudGFsVGFnLnF1ZXJ5U2VsZWN0b3IoXCIjaW5jcmVtZW50YWwtdmlzdWFsaXphdGlvbi10YXJnZXRcIik7XG5cdGluY3JlbWVudGFsID0gbmV3IEluY3JlbWVudGFsKHsgdGFyZ2V0IH0pO1xufSk7XG5cbmNvbnN0IGdyaWRUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdyaWQtdmlzdWFsaXphdGlvblwiKTtcbmxldCBncmlkO1xuZ3JpZFRhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSBncmlkVGFnLnF1ZXJ5U2VsZWN0b3IoXCIjZ3JpZC12aXN1YWxpemF0aW9uLXRhcmdldFwiKTtcblx0Z3JpZCA9IG5ldyBHcmlkKHsgdGFyZ2V0IH0pO1xufSk7Il0sInNvdXJjZVJvb3QiOiIifQ==