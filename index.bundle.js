!function(e){var t={};function F(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,F),o.l=!0,o.exports}F.m=e,F.c=t,F.d=function(e,t,n){F.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},F.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},F.t=function(e,t){if(1&t&&(e=F(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(F.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)F.d(n,o,function(t){return e[t]}.bind(null,o));return n},F.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return F.d(t,"a",t),t},F.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},F.p="",F(F.s=0)}([function(e,t,F){"use strict";F.r(t);function n(){}const o=e=>e;function r(e,t){for(const F in t)e[F]=t[F];return e}function i(e){return e()}function a(){return Object.create(null)}function l(e){e.forEach(i)}function s(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let u;function d(e,t){return u||(u=document.createElement("a")),u.href=t,e===u.href}function f(e){return 0===Object.keys(e).length}function p(e,...t){if(null==e)return n;const F=e.subscribe(...t);return F.unsubscribe?()=>F.unsubscribe():F}const v="undefined"!=typeof window;let m=v?()=>window.performance.now():()=>Date.now(),H=v?e=>requestAnimationFrame(e):n;const g=new Set;function h(e){g.forEach(t=>{t.c(e)||(g.delete(t),t.f())}),0!==g.size&&H(h)}function y(e){let t;return 0===g.size&&H(h),{promise:new Promise(F=>{g.add(t={c:e,f:F})}),abort(){g.delete(t)}}}let x=!1;function b(e,t){e.appendChild(t)}function z(e,t,F){const n=w(e);if(!n.getElementById(t)){const e=k("style");e.id=t,e.textContent=F,q(n,e)}}function w(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function q(e,t){b(e.head||e,t)}function $(e,t,F){e.insertBefore(t,F||null)}function _(e){e.parentNode.removeChild(e)}function k(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function S(){return C(" ")}function E(e,t,F,n){return e.addEventListener(t,F,n),()=>e.removeEventListener(t,F,n)}function j(e,t,F){null==F?e.removeAttribute(t):e.getAttribute(t)!==F&&e.setAttribute(t,F)}function A(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function T(e,t,F,n){null===F?e.style.removeProperty(t):e.style.setProperty(t,F,n?"important":"")}function O(e,t){for(let F=0;F<e.options.length;F+=1){const n=e.options[F];if(n.__value===t)return void(n.selected=!0)}e.selectedIndex=-1}function D(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function M(e,t,F){e.classList[F?"add":"remove"](t)}new Map;let P;function R(e){P=e}function I(){if(!P)throw new Error("Function called outside component initialization");return P}function L(e){I().$$.on_mount.push(e)}const G=[],B=[],Y=[],N=[],X=Promise.resolve();let J=!1;function K(){J||(J=!0,X.then(W))}function Q(e){Y.push(e)}const U=new Set;let V=0;function W(){const e=P;do{for(;V<G.length;){const e=G[V];V++,R(e),Z(e.$$)}for(R(null),G.length=0,V=0;B.length;)B.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];U.has(t)||(U.add(t),t())}Y.length=0}while(G.length);for(;N.length;)N.pop()();J=!1,U.clear(),R(e)}function Z(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}const ee=new Set;let te;function Fe(){te={r:0,c:[],p:te}}function ne(){te.r||l(te.c),te=te.p}function oe(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function re(e,t,F,n){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.c.push(()=>{ee.delete(e),n&&(F&&e.d(1),n())}),e.o(t)}else n&&n()}const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let ae;function le(e,t,F,n){const{fragment:o,on_mount:r,on_destroy:a,after_update:c}=e.$$;o&&o.m(t,F),n||Q(()=>{const t=r.map(i).filter(s);a?a.push(...t):l(t),e.$$.on_mount=[]}),c.forEach(Q)}function se(e,t){const F=e.$$;null!==F.fragment&&(l(F.on_destroy),F.fragment&&F.fragment.d(t),F.on_destroy=F.fragment=null,F.ctx=[])}function ce(e,t,F,o,r,i,s,c=[-1]){const u=P;R(e);const d=e.$$={fragment:null,ctx:null,props:i,update:n,not_equal:r,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:a(),dirty:c,skip_bound:!1,root:t.target||u.$$.root};s&&s(d.root);let f=!1;if(d.ctx=F?F(e,t.props||{},(t,F,...n)=>{const o=n.length?n[0]:F;return d.ctx&&r(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),f&&function(e,t){-1===e.$$.dirty[0]&&(G.push(e),K(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),F}):[],d.update(),f=!0,l(d.before_update),d.fragment=!!o&&o(d.ctx),t.target){if(t.hydrate){x=!0;const e=(p=t.target,Array.from(p.childNodes));d.fragment&&d.fragment.l(e),e.forEach(_)}else d.fragment&&d.fragment.c();t.intro&&oe(e.$$.fragment),le(e,t.target,t.anchor,t.customElement),x=!1,W()}var p;R(u)}"function"==typeof HTMLElement&&(ae=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(i).filter(s);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,F){this[e]=F}disconnectedCallback(){l(this.$$.on_disconnect)}$destroy(){se(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ue{$destroy(){se(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!f(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function de(e){let t,F,o,r,i,a,l,s,c,u,f,p,v,m,H,g,h=e[0]+1+"";return{c(){t=k("div"),F=k("img"),r=S(),i=k("div"),a=k("p"),l=C("Trajectory after curriculum step "),s=C(h),c=S(),u=k("input"),f=S(),p=k("p"),v=C("Move the slider to change the step!"),d(F.src,o="images/trajectories"+e[0]+".svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the trajectories of the RL agent on the map"),j(u,"type","range"),j(u,"min","0"),j(u,"max",fe),u.value="0",j(p,"style",m="transition: 1s opacity; "+(e[1]&&"opacity: 0;")),T(i,"text-align","center"),T(t,"display","flex"),T(t,"flex-direction","column"),T(t,"align-items","center"),T(t,"padding-top","1em")},m(n,o){$(n,t,o),b(t,F),b(t,r),b(t,i),b(i,a),b(a,l),b(a,s),b(i,c),b(i,u),b(i,f),b(i,p),b(p,v),H||(g=E(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!d(F.src,o="images/trajectories"+e[0]+".svg")&&j(F,"src",o),1&t&&h!==(h=e[0]+1+"")&&A(s,h),2&t&&m!==(m="transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",m)},i:n,o:n,d(e){e&&_(t),H=!1,g()}}}const fe=5;function pe(e,t,F){let n=0,o=!1;return[n,o,function(e){o||F(1,o=!0),F(0,n=parseInt(e.target.value))}]}var ve=class extends ue{constructor(e){super(),ce(this,e,pe,de,c,{})}};function me(e){let t,F,o,r,i,a,l,s,c,u,f,p,v,m,H,g;return{c(){t=k("div"),F=k("img"),r=S(),i=k("div"),a=k("p"),l=C("x = "),s=C(e[0]),c=S(),u=k("input"),f=S(),p=k("p"),v=C("Move the slider to change x!"),d(F.src,o="images/16x16_back"+e[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the back curriculum policy over the number of curriculum steps"),j(u,"type","range"),j(u,"min","1"),j(u,"max",He),u.value="0",j(p,"style",m="transition: 1s opacity; "+(e[1]&&"opacity: 0;")),T(i,"text-align","center"),T(t,"display","flex"),T(t,"flex-direction","column"),T(t,"align-items","center")},m(n,o){$(n,t,o),b(t,F),b(t,r),b(t,i),b(i,a),b(a,l),b(a,s),b(i,c),b(i,u),b(i,f),b(i,p),b(p,v),H||(g=E(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!d(F.src,o="images/16x16_back"+e[0]+"_successes.svg")&&j(F,"src",o),1&t&&A(s,e[0]),2&t&&m!==(m="transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",m)},i:n,o:n,d(e){e&&_(t),H=!1,g()}}}const He=9;function ge(e,t,F){let n=1,o=!1;return[n,o,function(e){o||F(1,o=!0),F(0,n=parseInt(e.target.value))}]}var he=class extends ue{constructor(e){super(),ce(this,e,ge,me,c,{})}};function ye(e){let t,F,o,r,i,a,l,s,c,u,f,p,v,m,H,g;return{c(){t=k("div"),F=k("img"),r=S(),i=k("div"),a=k("p"),l=C("x = "),s=C(e[0]),c=S(),u=k("input"),f=S(),p=k("p"),v=C("Move the slider to change x!"),d(F.src,o="images/16x16_incremental"+e[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the incremental curriculum policy over the number of curriculum steps"),j(u,"type","range"),j(u,"min","0"),j(u,"max",xe),u.value="0",j(p,"style",m="transition: 1s opacity; "+(e[1]&&"opacity: 0;")),T(i,"text-align","center"),T(t,"display","flex"),T(t,"flex-direction","column"),T(t,"align-items","center")},m(n,o){$(n,t,o),b(t,F),b(t,r),b(t,i),b(i,a),b(a,l),b(a,s),b(i,c),b(i,u),b(i,f),b(i,p),b(p,v),H||(g=E(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!d(F.src,o="images/16x16_incremental"+e[0]+"_successes.svg")&&j(F,"src",o),1&t&&A(s,e[0]),2&t&&m!==(m="transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",m)},i:n,o:n,d(e){e&&_(t),H=!1,g()}}}const xe=4;function be(e,t,F){let n=0,o=!1;return[n,o,function(e){o||F(1,o=!0),F(0,n=parseInt(e.target.value))}]}var ze=class extends ue{constructor(e){super(),ce(this,e,be,ye,c,{})}};const we=[];function qe(e,t=n){let F;const o=new Set;function r(t){if(c(e,t)&&(e=t,F)){const t=!we.length;for(const t of o)t[1](),we.push(t,e);if(t){for(let e=0;e<we.length;e+=2)we[e][0](we[e+1]);we.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,a=n){const l=[i,a];return o.add(l),1===o.size&&(F=t(r)||n),i(e),()=>{o.delete(l),0===o.size&&(F(),F=null)}}}}function $e(e){const t=e-1;return t*t*t+1}function _e(e){return"[object Date]"===Object.prototype.toString.call(e)}function ke(e,t){if(e===t||e!=e)return()=>e;const F=typeof e;if(F!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const F=t.map((t,F)=>ke(e[F],t));return e=>F.map(t=>t(e))}if("object"===F){if(!e||!t)throw new Error("Object cannot be null");if(_e(e)&&_e(t)){e=e.getTime();const F=(t=t.getTime())-e;return t=>new Date(e+t*F)}const F=Object.keys(t),n={};return F.forEach(F=>{n[F]=ke(e[F],t[F])}),e=>{const t={};return F.forEach(F=>{t[F]=n[F](e)}),t}}if("number"===F){const F=t-e;return t=>e+t*F}throw new Error(`Cannot interpolate ${F} values`)}function Ce(e){z(e,"svelte-io58ff",".confetti-holder.svelte-io58ff.svelte-io58ff{position:relative}@keyframes svelte-io58ff-rotate{0%{transform:skew(var(--skew)) rotate3d(var(--full-rotation))}100%{transform:skew(var(--skew)) rotate3d(var(--rotation-xyz), calc(var(--rotation-deg) + 360deg))}}@keyframes svelte-io58ff-translate{0%{opacity:1}8%{transform:translateY(calc(var(--translate-y) * 0.95)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.9)));opacity:1}12%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.95)));opacity:1}16%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * var(--x-spread)));opacity:1}100%{transform:translateY(calc(var(--translate-y) + var(--fall-distance))) translateX(var(--translate-x));opacity:0}}@keyframes svelte-io58ff-no-gravity-translate{0%{opacity:1}100%{transform:translateY(var(--translate-y)) translateX(var(--translate-x));opacity:0}}.confetti.svelte-io58ff.svelte-io58ff{--translate-y:calc(-200px * var(--translate-y-multiplier));--translate-x:calc(200px * var(--translate-x-multiplier));position:absolute;height:calc(var(--size) * var(--scale));width:calc(var(--size) * var(--scale));animation:svelte-io58ff-translate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;opacity:0;pointer-events:none}.confetti.svelte-io58ff.svelte-io58ff::before{--full-rotation:var(--rotation-xyz), var(--rotation-deg);content:'';display:block;width:100%;height:100%;background:var(--color);background-size:contain;transform:skew(var(--skew)) rotate3d(var(--full-rotation));animation:svelte-io58ff-rotate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear}.rounded.svelte-io58ff .confetti.svelte-io58ff::before{border-radius:50%}.cone.svelte-io58ff .confetti.svelte-io58ff{--translate-x:calc(200px * var(--translate-y-multiplier) * var(--translate-x-multiplier))}.no-gravity.svelte-io58ff .confetti.svelte-io58ff{animation-name:svelte-io58ff-no-gravity-translate;animation-timing-function:ease-out}@media(prefers-reduced-motion){.confetti.svelte-io58ff.svelte-io58ff,.confetti.svelte-io58ff.svelte-io58ff::before{animation:none}}")}function Se(e,t,F){const n=e.slice();return n[18]=t[F],n}function Ee(e){let t,F={length:e[6]},n=[];for(let t=0;t<F.length;t+=1)n[t]=je(Se(e,F,t));return{c(){t=k("div");for(let e=0;e<n.length;e+=1)n[e].c();j(t,"class","confetti-holder svelte-io58ff"),M(t,"rounded",e[9]),M(t,"cone",e[10]),M(t,"no-gravity",e[11])},m(e,F){$(e,t,F);for(let e=0;e<n.length;e+=1)n[e].m(t,null)},p(e,o){if(20991&o){let r;for(F={length:e[6]},r=0;r<F.length;r+=1){const i=Se(e,F,r);n[r]?n[r].p(i,o):(n[r]=je(i),n[r].c(),n[r].m(t,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=F.length}512&o&&M(t,"rounded",e[9]),1024&o&&M(t,"cone",e[10]),2048&o&&M(t,"no-gravity",e[11])},d(e){e&&_(t),function(e,t){for(let F=0;F<e.length;F+=1)e[F]&&e[F].d(t)}(n,e)}}}function je(e){let t;return{c(){t=k("div"),j(t,"class","confetti svelte-io58ff"),T(t,"--fall-distance",e[8]),T(t,"--size",e[0]+"px"),T(t,"--color",e[14]()),T(t,"--skew",Te(-45,45)+"deg,"+Te(-45,45)+"deg"),T(t,"--rotation-xyz",Te(-10,10)+", "+Te(-10,10)+", "+Te(-10,10)),T(t,"--rotation-deg",Te(0,360)+"deg"),T(t,"--translate-y-multiplier",Te(e[2][0],e[2][1])),T(t,"--translate-x-multiplier",Te(e[1][0],e[1][1])),T(t,"--scale",.1*Te(2,10)),T(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),T(t,"--transition-delay",Te(e[5][0],e[5][1])+"ms"),T(t,"--transition-iteration-count",e[4]?"infinite":e[7]),T(t,"--x-spread",1-e[12])},m(e,F){$(e,t,F)},p(e,F){256&F&&T(t,"--fall-distance",e[8]),1&F&&T(t,"--size",e[0]+"px"),4&F&&T(t,"--translate-y-multiplier",Te(e[2][0],e[2][1])),2&F&&T(t,"--translate-x-multiplier",Te(e[1][0],e[1][1])),24&F&&T(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),32&F&&T(t,"--transition-delay",Te(e[5][0],e[5][1])+"ms"),144&F&&T(t,"--transition-iteration-count",e[4]?"infinite":e[7]),4096&F&&T(t,"--x-spread",1-e[12])},d(e){e&&_(t)}}}function Ae(e){let t,F=!e[13]&&Ee(e);return{c(){F&&F.c(),t=C("")},m(e,n){F&&F.m(e,n),$(e,t,n)},p(e,[n]){e[13]?F&&(F.d(1),F=null):F?F.p(e,n):(F=Ee(e),F.c(),F.m(t.parentNode,t))},i:n,o:n,d(e){F&&F.d(e),e&&_(t)}}}function Te(e,t){return Math.random()*(t-e)+e}function Oe(e,t,F){let{size:n=10}=t,{x:o=[-.5,.5]}=t,{y:r=[.25,1]}=t,{duration:i=2e3}=t,{infinite:a=!1}=t,{delay:l=[0,50]}=t,{colorRange:s=[0,360]}=t,{colorArray:c=[]}=t,{amount:u=50}=t,{iterationCount:d=1}=t,{fallDistance:f="100px"}=t,{rounded:p=!1}=t,{cone:v=!1}=t,{noGravity:m=!1}=t,{xSpread:H=.15}=t,{destroyOnComplete:g=!0}=t,h=!1;return L(()=>{g&&!a&&"infinite"!=d&&setTimeout(()=>F(13,h=!0),(i+l[1])*d)}),e.$$set=e=>{"size"in e&&F(0,n=e.size),"x"in e&&F(1,o=e.x),"y"in e&&F(2,r=e.y),"duration"in e&&F(3,i=e.duration),"infinite"in e&&F(4,a=e.infinite),"delay"in e&&F(5,l=e.delay),"colorRange"in e&&F(15,s=e.colorRange),"colorArray"in e&&F(16,c=e.colorArray),"amount"in e&&F(6,u=e.amount),"iterationCount"in e&&F(7,d=e.iterationCount),"fallDistance"in e&&F(8,f=e.fallDistance),"rounded"in e&&F(9,p=e.rounded),"cone"in e&&F(10,v=e.cone),"noGravity"in e&&F(11,m=e.noGravity),"xSpread"in e&&F(12,H=e.xSpread),"destroyOnComplete"in e&&F(17,g=e.destroyOnComplete)},[n,o,r,i,a,l,u,d,f,p,v,m,H,h,function(){return c.length?c[Math.round(Math.random()*(c.length-1))]:`hsl(${Math.round(Te(s[0],s[1]))}, 75%, 50%`},s,c,g]}var De=class extends ue{constructor(e){super(),ce(this,e,Oe,Ae,c,{size:0,x:1,y:2,duration:3,infinite:4,delay:5,colorRange:15,colorArray:16,amount:6,iterationCount:7,fallDistance:8,rounded:9,cone:10,noGravity:11,xSpread:12,destroyOnComplete:17},Ce)}};const Me={small:["SFFFFFFFFF","FFFFFFFFFF","HFFFFFFFFF","FFHFFFFFFF","HFFFFHFFFF","FFHFFFHFFF","HFFFFHFFFF","FFHFFFFFFF","HFFFFFFFFF","FFFGFFFFFF"],"16x16":["HHFFFFFFFFFFFFHH","HFFFFFFFFFFFFFFH","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHFFFFHHHFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFGFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHHHHHHHHFFF","FFFFHHHHHHHHFFFF","FFFFFFFFFFFFFFFF","HFFFFFFFSFFFFFFH","HHFFFFFFFFFFFFHH"],"32x32":["HHHHHHFFFFFFFFFFFFFFFFFHHHHHHHHH","HHFFFFFFFFFFFFFFFFFFFFFFHHHHHHHH","FFFFSFFFHHFFFFFFFFFFFFFFFFFFFFFH","FFFFFFFFFHFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHFFFFFFFFFHHHHHHHHFFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHHFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHFFFFFFFFFF","HHFFHHHHHHHHHHHHFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFHHHHHFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFHHFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHF","FFFFFFFFFFFFFFFFFFFFFFFFFFFHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFGFFFFFFFHFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFHFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHFFHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFFFFFFFFFHFFFFFFFF","HHHHHHHFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHHHHHHHHFFFFFFFFFFFFFFFFFFFF"]},Pe={H:"#1976d2",S:"#ef9a9a",F:"#e1f5fe",G:"#81c784",T:"#ffe0b2"};const{window:Re}=ie;function Ie(e){z(e,"svelte-6qz89p","canvas.svelte-6qz89p.svelte-6qz89p{padding-bottom:1em;padding-top:1em}.game.svelte-6qz89p.svelte-6qz89p{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-bottom:1.5em}.controls.svelte-6qz89p.svelte-6qz89p{display:flex;flex-direction:column;align-items:center;width:100%;max-width:350px}.status.svelte-6qz89p.svelte-6qz89p{height:1em;width:100%;max-width:300px;text-align:center;transition:color 1s;padding-top:1em}.map.svelte-6qz89p.svelte-6qz89p{display:flex;flex-direction:column;align-items:center}.view.svelte-6qz89p.svelte-6qz89p{display:flex;flex-direction:column;align-items:center}.map.svelte-6qz89p p.svelte-6qz89p{margin:0}.menu.svelte-6qz89p.svelte-6qz89p{display:flex;flex-direction:row;gap:0.2em;overflow:auto;flex-wrap:wrap}.menu.svelte-6qz89p div.svelte-6qz89p{margin:0.3em;display:flex;flex-direction:column}.key.svelte-6qz89p.svelte-6qz89p{background-color:#eee;border-radius:4px;font-size:1em;padding:0.5em 0.5em;border-top:5px solid rgba(255, 255, 255, 0.5);border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(0, 0, 0, 0.2);border-bottom:5px solid rgba(0, 0, 0, 0.2);color:#555;text-align:center;width:4em;height:4em;cursor:pointer}.legend.svelte-6qz89p.svelte-6qz89p{display:grid;grid-template-columns:1.5em 1fr 1.5em 1fr 1.5em 1fr;width:100%;max-width:300px;gap:0.5em}.legend.svelte-6qz89p div.svelte-6qz89p{display:flex;justify-content:center left}@media(min-width: 1000px){.view.svelte-6qz89p.svelte-6qz89p{flex-direction:row}.legend.svelte-6qz89p.svelte-6qz89p{grid-template-columns:1.5em 1fr;max-width:100px;padding-left:1em}.controls.svelte-6qz89p.svelte-6qz89p{max-width:350px}}@media(min-width: 768px){.game.svelte-6qz89p.svelte-6qz89p{flex-direction:row}.controls.svelte-6qz89p.svelte-6qz89p{flex-direction:column;max-width:300px}.menu.svelte-6qz89p.svelte-6qz89p{flex-direction:column}.menu.svelte-6qz89p div.svelte-6qz89p{flex-direction:row;gap:10px}.key.svelte-6qz89p.svelte-6qz89p{width:3em;height:3em}}.keyboard.svelte-6qz89p.svelte-6qz89p{display:grid;grid-template-columns:auto auto auto;grid-gap:0.5em;padding-top:1em;padding-bottom:1em}.key.svelte-6qz89p.svelte-6qz89p:active{background-color:#ddd}.color.svelte-6qz89p.svelte-6qz89p{width:1.5em;height:1.5em}")}function Le(e){let t,F;return t=new De({props:{cone:!0,delay:[0,200],amount:"50",x:[-.7,.7],y:[.5,1.5]}}),{c(){var e;(e=t.$$.fragment)&&e.c()},m(e,n){le(t,e,n),F=!0},i(e){F||(oe(t.$$.fragment,e),F=!0)},o(e){re(t.$$.fragment,e),F=!1},d(e){se(t,e)}}}function Ge(e){let t;return{c(){t=k("p"),t.textContent="Press the arrow keys to move...",j(t,"class","status svelte-6qz89p")},m(e,F){$(e,t,F)},p:n,d(e){e&&_(t)}}}function Be(e){let t,F;return{c(){t=k("p"),F=C(e[10]),j(t,"class","status svelte-6qz89p"),T(t,"transition","color "+(e[10]?2:0)+"s"),T(t,"transition-timing-function","ease-in"),T(t,"color",e[10]?"white":"black")},m(e,n){$(e,t,n),b(t,F)},p(e,n){1024&n[0]&&A(F,e[10]),1024&n[0]&&T(t,"transition","color "+(e[10]?2:0)+"s"),1024&n[0]&&T(t,"color",e[10]?"white":"black")},d(e){e&&_(t)}}}function Ye(e){let t,F,n,o,r,i,a,s,c,u,d,f,p,v,m,H,g,h,y,x,z,w,q,D,M,P,R,I,L,G,B,Y,N,X,J,K,U,V,W,Z,ee,te,ie,ae,le,se,ce,ue,de,fe,pe,ve,me,He,ge,he,ye,xe,be,ze,we,qe,$e,_e,ke,Ce,Se,Ee,je,Ae,Te,Oe,De,Me,Ie,Ye,Ne=(0==e[13]?e[14].toFixed(2):e[13].toFixed(2))+"",Xe=e[11]&&Le();function Je(e,t){return e[9]?Be:Ge}let Ke=Je(e),Qe=Ke(e);return{c(){t=k("div"),F=k("div"),n=k("div"),o=k("p"),r=C("Score: "),i=C(Ne),a=S(),s=k("canvas"),d=S(),Xe&&Xe.c(),f=S(),p=k("div"),v=k("div"),m=S(),H=k("div"),H.textContent="Safe",g=S(),h=k("div"),y=S(),x=k("div"),x.textContent="Goal",z=S(),w=k("div"),q=S(),D=k("div"),D.textContent="Danger",M=S(),P=k("div"),R=S(),I=k("div"),I.textContent="Start",L=S(),G=k("div"),B=S(),Y=k("div"),Y.textContent="Trigger",N=S(),X=k("div"),Qe.c(),J=S(),K=k("div"),U=k("div"),V=S(),W=k("button"),W.textContent="↑",Z=S(),ee=k("div"),te=S(),ie=k("button"),ie.textContent="←",ae=S(),le=k("button"),le.textContent="↓",se=S(),ce=k("button"),ce.textContent="→",ue=S(),de=k("div"),fe=k("div"),pe=k("label"),pe.textContent="Choose a map:",ve=S(),me=k("select"),He=k("option"),He.textContent="Frozen Lake",ge=k("option"),ge.textContent="Frozen Smiley",he=k("option"),he.textContent="Large Lake",ye=S(),xe=k("div"),be=k("label"),be.textContent="Add a teacher:",ze=S(),we=k("select"),qe=k("option"),qe.textContent="No Teacher",$e=k("option"),$e.textContent="Distance 1",_e=k("option"),_e.textContent="Distance 2",ke=S(),Ce=k("div"),Se=k("label"),Se.textContent="Reset strategy:",Ee=S(),je=k("select"),Ae=k("option"),Ae.textContent="Soft Reset",Te=k("option"),Te.textContent="Back 4",Oe=k("option"),Oe.textContent="Hard Reset",j(o,"class","svelte-6qz89p"),j(s,"width",c=500*e[12]),j(s,"height",u=500*e[12]),T(s,"max-width","300px"),T(s,"width","100%"),T(s,"height","100%"),j(s,"class","svelte-6qz89p"),j(n,"class","map svelte-6qz89p"),j(v,"class","color svelte-6qz89p"),T(v,"background-color",Pe.F),j(H,"class","svelte-6qz89p"),j(h,"class","color svelte-6qz89p"),T(h,"background-color",Pe.G),j(x,"class","svelte-6qz89p"),j(w,"class","color svelte-6qz89p"),T(w,"background-color",Pe.H),j(D,"class","svelte-6qz89p"),j(P,"class","color svelte-6qz89p"),T(P,"background-color",Pe.S),j(I,"class","svelte-6qz89p"),j(G,"class","color svelte-6qz89p"),T(G,"background-color",Pe.T),j(Y,"class","svelte-6qz89p"),j(p,"class","legend svelte-6qz89p"),j(F,"class","view svelte-6qz89p"),j(W,"class","key svelte-6qz89p"),j(ie,"class","key svelte-6qz89p"),j(le,"class","key svelte-6qz89p"),j(ce,"class","key svelte-6qz89p"),j(K,"class","keyboard svelte-6qz89p"),j(pe,"for","map"),He.__value="small",He.value=He.__value,ge.__value="16x16",ge.value=ge.__value,he.__value="32x32",he.value=he.__value,j(me,"name","map"),j(me,"id","map"),void 0===e[1]&&Q(()=>e[24].call(me)),j(fe,"class","svelte-6qz89p"),j(be,"for","teacher"),qe.__value="0",qe.value=qe.__value,$e.__value="1",$e.value=$e.__value,_e.__value="2",_e.value=_e.__value,j(we,"name","teacher"),j(we,"id","teacher"),void 0===e[2]&&Q(()=>e[25].call(we)),j(xe,"class","svelte-6qz89p"),j(Se,"for","reset"),Ae.__value="SR",Ae.value=Ae.__value,Te.__value="B4",Te.value=Te.__value,Oe.__value="HR",Oe.value=Oe.__value,j(je,"name","reset"),j(je,"id","reset"),je.disabled=De=0==e[2],void 0===e[3]&&Q(()=>e[26].call(je)),j(Ce,"class","svelte-6qz89p"),j(de,"class","menu svelte-6qz89p"),j(X,"class","controls svelte-6qz89p"),j(t,"class","game svelte-6qz89p")},m(l,c){$(l,t,c),b(t,F),b(F,n),b(n,o),b(o,r),b(o,i),b(n,a),b(n,s),e[18](s),b(n,d),Xe&&Xe.m(n,null),b(F,f),b(F,p),b(p,v),b(p,m),b(p,H),b(p,g),b(p,h),b(p,y),b(p,x),b(p,z),b(p,w),b(p,q),b(p,D),b(p,M),b(p,P),b(p,R),b(p,I),b(p,L),b(p,G),b(p,B),b(p,Y),b(t,N),b(t,X),Qe.m(X,null),b(X,J),b(X,K),b(K,U),b(K,V),b(K,W),b(K,Z),b(K,ee),b(K,te),b(K,ie),b(K,ae),b(K,le),b(K,se),b(K,ce),b(X,ue),b(X,de),b(de,fe),b(fe,pe),b(fe,ve),b(fe,me),b(me,He),b(me,ge),b(me,he),O(me,e[1]),b(de,ye),b(de,xe),b(xe,be),b(xe,ze),b(xe,we),b(we,qe),b(we,$e),b(we,_e),O(we,e[2]),b(de,ke),b(de,Ce),b(Ce,Se),b(Ce,Ee),b(Ce,je),b(je,Ae),b(je,Te),b(je,Oe),O(je,e[3]),Me=!0,Ie||(Ye=[E(Re,"keydown",e[16]),E(s,"click",e[19]),E(W,"click",e[20]),E(ie,"click",e[21]),E(le,"click",e[22]),E(ce,"click",e[23]),E(me,"change",e[24]),E(me,"change",e[15]),E(we,"change",e[25]),E(je,"change",e[26])],Ie=!0)},p(e,t){(!Me||24576&t[0])&&Ne!==(Ne=(0==e[13]?e[14].toFixed(2):e[13].toFixed(2))+"")&&A(i,Ne),(!Me||4096&t[0]&&c!==(c=500*e[12]))&&j(s,"width",c),(!Me||4096&t[0]&&u!==(u=500*e[12]))&&j(s,"height",u),e[11]?Xe?2048&t[0]&&oe(Xe,1):(Xe=Le(),Xe.c(),oe(Xe,1),Xe.m(n,null)):Xe&&(Fe(),re(Xe,1,1,()=>{Xe=null}),ne()),Ke===(Ke=Je(e))&&Qe?Qe.p(e,t):(Qe.d(1),Qe=Ke(e),Qe&&(Qe.c(),Qe.m(X,J))),2&t[0]&&O(me,e[1]),4&t[0]&&O(we,e[2]),(!Me||4&t[0]&&De!==(De=0==e[2]))&&(je.disabled=De),8&t[0]&&O(je,e[3])},i(e){Me||(oe(Xe),Me=!0)},o(e){re(Xe),Me=!1},d(F){F&&_(t),e[18](null),Xe&&Xe.d(),Qe.d(),Ie=!1,l(Ye)}}}function Ne(e,t,F){let i,a,l,s,c,u=n;e.$$.on_destroy.push(()=>u());var d,f,v,H=!1,g=!1,h=!1,x=!1,b=!0,z=[],w=!1,q="",$=null,_=!1;const k=new Image;k.src="./images/robot.png";const C=new Image;C.src="./images/robot-flipped.png";var S=!1,E=0,j=0;function A(e){F(10,q=""),clearTimeout($),setTimeout(()=>{F(10,q=e)},1),$=setTimeout(()=>{F(10,q="")},2e3)}L(()=>{const e=a.getContext("2d");var t,n,q,$,T;function O(e){let t=e.length,F=e[0].length,n=new Array(t).fill(!1).map(()=>new Array(F).fill(!1));for(let r=0;r<t;r++)for(let t=0;t<F;t++){var o=!1;try{o|=e[r][t+1]}catch(e){}try{o|=e[r+1][t]}catch(e){}try{o|=e[r][t-1]}catch(e){}try{o|=e[r-1][t]}catch(e){}n[r][t]=o}return n}function D(){n=Me[l],t=a.height/n.length,T=function(e,t){if(0==t)return e;var F=new Array;for(let e=0;e<n.length;e++)F.push(n[e].split(""));let o=F.map(e=>e.map(e=>"H"==e)),r=F.map(e=>e.map(e=>"F"==e));var i,a=Array.from(o);for(let e=0;e<t;e++)i=O(a),a=i.map((e,t)=>e.map((e,F)=>e||a[t][F]));var l=Array.from(F);for(let e=0;e<F.length;e++)for(let t=0;t<F[0].length;t++)i[e][t]&&r[e][t]&&(l[e][t]="T");let s=new Array;for(let t=0;t<e.length;t++)s.push(l[t].join(""));return s}(n,s);for(let F=0;F<n.length;F++)for(let o=0;o<n[0].length;o++){let n=T[F][o];"S"==n&&(q=[o,F]);const r=o*t,i=F*t;e.beginPath(),e.rect(r,i,t+1,t+1),e.fillStyle=Pe[n],e.fill(),e.closePath()}}function M(e){d.set(e),f=e,z.push(f),F(13,E-=.01)}function P(){z=[],F(14,j=E),M(q),F(13,E=0)}F(12,v=window.devicePixelRatio),e.scale(v,v),D(),function l(){(g||H||h||x)&&F(9,w=!0),e.clearRect(0,0,a.width,a.height),D(),b&&(F(8,d=function(e,t={}){const F=qe(e);let n,i=e;function a(a,l){if(null==e)return F.set(e=a),Promise.resolve();i=a;let s=n,c=!1,{delay:u=0,duration:d=400,easing:f=o,interpolate:p=ke}=r(r({},t),l);if(0===d)return s&&(s.abort(),s=null),F.set(e=i),Promise.resolve();const v=m()+u;let H;return n=y(t=>{if(t<v)return!0;c||(H=p(e,a),"function"==typeof d&&(d=d(e,a)),c=!0),s&&(s.abort(),s=null);const n=t-v;return n>d?(F.set(e=a),!1):(F.set(e=H(f(n/d))),!0)}),n.promise}return{set:a,update:(t,F)=>a(t(i,e),F),subscribe:F.subscribe}}(q,{duration:150,easing:$e})),u(),u=p(d,e=>F(34,i=e)),F(13,E=0),P()),async function(){const F=S?C:k;e.drawImage(F,i[0]*t,i[1]*t,t,t)}();const s=Math.random();g||H?s<.1?(F(5,g=!1),F(4,H=!1),F(6,h=!0)):s<.2&&(F(5,g=!1),F(4,H=!1),F(7,x=!0)):(h||x)&&(s<.1?(F(6,h=!1),F(7,x=!1),F(5,g=!0)):s<.2&&(F(6,h=!1),F(7,x=!1),F(4,H=!0))),s<.2&&(h||x||g||H)&&A("You just slipped."),g&&(S=!0),H&&(S=!1),$=Array.from(f);let[v,j]=Array.from($);if(H?v<n[0].length-1&&(v+=1):g?v>0&&(v-=1):h?j>0&&(j-=1):x&&j<n.length-1&&(j+=1),(H||g||x||h)&&M([v,j]),"G"==n[j][v])F(11,_=!0),F(13,E+=6),setTimeout(()=>{F(11,_=!1)},3e3),A("You won!"),P();else if("H"==n[j][v])A("You failed."),F(13,E=0),P();else if("T"==T[j][v]){if("HR"==c){let e=E;P(),F(13,E=e)}else if("B4"==c){for(let e=0;e<4&&z.length>1;e++)z.pop();F(13,E+=.01),M(z[z.length-1])}else"SR"==c&&(F(13,E+=.01),M($));A("The teacher set you back.")}b=!1,F(4,H=!1),F(5,g=!1),F(6,h=!1),F(7,x=!1),requestAnimationFrame(l)}()});return[a,l,s,c,H,g,h,x,d,w,q,_,v,E,j,function(){b=!0},function(e){39==e.keyCode||"d"==e.key?(F(4,H=!0),e.preventDefault()):37==e.keyCode||"a"==e.key?(F(5,g=!0),e.preventDefault()):38==e.keyCode||"w"==e.key?(F(6,h=!0),e.preventDefault()):40!=e.keyCode&&"s"!=e.key||(F(7,x=!0),e.preventDefault())},A,function(e){B[e?"unshift":"push"](()=>{a=e,F(0,a)})},()=>A("Press the arrow keys to move..."),()=>F(6,h=!0),()=>F(5,g=!0),()=>F(7,x=!0),()=>F(4,H=!0),function(){l=D(this),F(1,l)},function(){s=D(this),F(2,s)},function(){c=D(this),F(3,c)}]}var Xe=class extends ue{constructor(e){super(),ce(this,e,Ne,Ye,c,{},Ie,[-1,-1])}},Je=document.getElementById("trajectories-visualization");Je.addEventListener("ready",(function(){var e=Je.querySelector("#trajectories-visualization-target");new ve({target:e})}));var Ke=document.getElementById("back-visualization");Ke.addEventListener("ready",(function(){var e=Ke.querySelector("#back-visualization-target");new he({target:e})}));var Qe=document.getElementById("incremental-visualization");Qe.addEventListener("ready",(function(){var e=Qe.querySelector("#incremental-visualization-target");new ze({target:e})}));var Ue=document.getElementById("minigame");Ue.addEventListener("ready",(function(){var e=Ue.querySelector("#minigame-target");new Xe({target:e})}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vL3RyYWplY3Rvcmllcy5zdmVsdGUiLCJ3ZWJwYWNrOi8vL2JhY2suc3ZlbHRlIiwid2VicGFjazovLy9pbmNyZW1lbnRhbC5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9zdG9yZS9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9lYXNpbmcvaW5kZXgubWpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zdmVsdGUvbW90aW9uL2luZGV4Lm1qcyIsIndlYnBhY2s6Ly8vQ29uZmV0dGkuc3ZlbHRlIiwid2VicGFjazovLy9jb25zdGFudHMuc3ZlbHRlIiwid2VicGFjazovLy9taW5pZ2FtZS5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwibm9vcCIsImlkZW50aXR5IiwieCIsInRhciIsInNyYyIsImsiLCJmbiIsImJsYW5rX29iamVjdCIsInJ1bl9hbGwiLCJmbnMiLCJmb3JFYWNoIiwiaXNfZnVuY3Rpb24iLCJ0aGluZyIsInNhZmVfbm90X2VxdWFsIiwiYSIsImIiLCJzcmNfdXJsX2VxdWFsX2FuY2hvciIsInNyY191cmxfZXF1YWwiLCJlbGVtZW50X3NyYyIsInVybCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJpc19lbXB0eSIsIm9iaiIsImtleXMiLCJsZW5ndGgiLCJzdG9yZSIsImNhbGxiYWNrcyIsInVuc3ViIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiLCJpc19jbGllbnQiLCJ3aW5kb3ciLCJub3ciLCJwZXJmb3JtYW5jZSIsIkRhdGUiLCJyYWYiLCJjYiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInRhc2tzIiwiU2V0IiwicnVuX3Rhc2tzIiwidGFzayIsImRlbGV0ZSIsImYiLCJzaXplIiwibG9vcCIsImNhbGxiYWNrIiwicHJvbWlzZSIsIlByb21pc2UiLCJmdWxmaWxsIiwiYWRkIiwiaXNfaHlkcmF0aW5nIiwiYXBwZW5kIiwidGFyZ2V0Iiwibm9kZSIsImFwcGVuZENoaWxkIiwiYXBwZW5kX3N0eWxlcyIsInN0eWxlX3NoZWV0X2lkIiwic3R5bGVzIiwiYXBwZW5kX3N0eWxlc190byIsImdldF9yb290X2Zvcl9zdHlsZSIsImdldEVsZW1lbnRCeUlkIiwic3R5bGUiLCJpZCIsInRleHRDb250ZW50IiwiYXBwZW5kX3N0eWxlc2hlZXQiLCJyb290IiwiZ2V0Um9vdE5vZGUiLCJvd25lckRvY3VtZW50IiwiaG9zdCIsImhlYWQiLCJpbnNlcnQiLCJhbmNob3IiLCJpbnNlcnRCZWZvcmUiLCJkZXRhY2giLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkYXRhIiwiY3JlYXRlVGV4dE5vZGUiLCJzcGFjZSIsImxpc3RlbiIsImV2ZW50IiwiaGFuZGxlciIsIm9wdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImF0dHIiLCJhdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJnZXRBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzZXRfZGF0YSIsInRleHQiLCJ3aG9sZVRleHQiLCJzZXRfc3R5bGUiLCJpbXBvcnRhbnQiLCJyZW1vdmVQcm9wZXJ0eSIsInNldFByb3BlcnR5Iiwic2VsZWN0X29wdGlvbiIsInNlbGVjdCIsIm9wdGlvbiIsIl9fdmFsdWUiLCJzZWxlY3RlZCIsInNlbGVjdGVkSW5kZXgiLCJzZWxlY3RfdmFsdWUiLCJzZWxlY3RlZF9vcHRpb24iLCJxdWVyeVNlbGVjdG9yIiwidG9nZ2xlX2NsYXNzIiwiZWxlbWVudCIsInRvZ2dsZSIsImNsYXNzTGlzdCIsIk1hcCIsImN1cnJlbnRfY29tcG9uZW50Iiwic2V0X2N1cnJlbnRfY29tcG9uZW50IiwiY29tcG9uZW50IiwiZ2V0X2N1cnJlbnRfY29tcG9uZW50IiwiRXJyb3IiLCJvbk1vdW50IiwiJCQiLCJvbl9tb3VudCIsInB1c2giLCJkaXJ0eV9jb21wb25lbnRzIiwiYmluZGluZ19jYWxsYmFja3MiLCJyZW5kZXJfY2FsbGJhY2tzIiwiZmx1c2hfY2FsbGJhY2tzIiwicmVzb2x2ZWRfcHJvbWlzZSIsInJlc29sdmUiLCJ1cGRhdGVfc2NoZWR1bGVkIiwic2NoZWR1bGVfdXBkYXRlIiwidGhlbiIsImZsdXNoIiwiYWRkX3JlbmRlcl9jYWxsYmFjayIsInNlZW5fY2FsbGJhY2tzIiwiZmx1c2hpZHgiLCJzYXZlZF9jb21wb25lbnQiLCJwb3AiLCJoYXMiLCJjbGVhciIsImZyYWdtZW50IiwidXBkYXRlIiwiYmVmb3JlX3VwZGF0ZSIsImRpcnR5IiwiY3R4IiwiYWZ0ZXJfdXBkYXRlIiwib3V0cm9pbmciLCJvdXRyb3MiLCJncm91cF9vdXRyb3MiLCJjaGVja19vdXRyb3MiLCJ0cmFuc2l0aW9uX2luIiwiYmxvY2siLCJsb2NhbCIsInRyYW5zaXRpb25fb3V0IiwiZ2xvYmFscyIsImdsb2JhbFRoaXMiLCJnbG9iYWwiLCJTdmVsdGVFbGVtZW50IiwibW91bnRfY29tcG9uZW50IiwiY3VzdG9tRWxlbWVudCIsIm9uX2Rlc3Ryb3kiLCJuZXdfb25fZGVzdHJveSIsIm1hcCIsImZpbHRlciIsImRlc3Ryb3lfY29tcG9uZW50IiwiZGV0YWNoaW5nIiwiaW5pdCIsImluc3RhbmNlIiwiY3JlYXRlX2ZyYWdtZW50Iiwibm90X2VxdWFsIiwicHJvcHMiLCJwYXJlbnRfY29tcG9uZW50IiwiYm91bmQiLCJvbl9kaXNjb25uZWN0IiwiY29udGV4dCIsInNraXBfYm91bmQiLCJyZWFkeSIsInJldCIsInJlc3QiLCJmaWxsIiwibWFrZV9kaXJ0eSIsImh5ZHJhdGUiLCJub2RlcyIsIkFycmF5IiwiZnJvbSIsImNoaWxkTm9kZXMiLCJpbnRybyIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJ0aGlzIiwiYXR0YWNoU2hhZG93Iiwic2xvdHRlZCIsIl9vbGRWYWx1ZSIsIm5ld1ZhbHVlIiwiJGRlc3Ryb3kiLCJ0eXBlIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiJCRwcm9wcyIsIiQkc2V0IiwiU3ZlbHRlQ29tcG9uZW50IiwibGVuIiwiY291bnQiLCJoYXNJbnRlcmFjdGVkIiwicGFyc2VJbnQiLCJzdWJzY3JpYmVyX3F1ZXVlIiwid3JpdGFibGUiLCJzdGFydCIsInN0b3AiLCJzdWJzY3JpYmVycyIsInNldCIsIm5ld192YWx1ZSIsInJ1bl9xdWV1ZSIsInN1YnNjcmliZXIiLCJydW4iLCJpbnZhbGlkYXRlIiwiY3ViaWNPdXQiLCJpc19kYXRlIiwidG9TdHJpbmciLCJnZXRfaW50ZXJwb2xhdG9yIiwiaXNBcnJheSIsImFyciIsImJpIiwiZ2V0VGltZSIsImRlbHRhIiwiaW50ZXJwb2xhdG9ycyIsInJlc3VsdCIsIml0ZXJhdGlvbnMiLCJyYW5kb21CZXR3ZWVuIiwibWluIiwibWF4IiwiTWF0aCIsInJhbmRvbSIsInkiLCJkdXJhdGlvbiIsImluZmluaXRlIiwiZGVsYXkiLCJjb2xvclJhbmdlIiwiY29sb3JBcnJheSIsImFtb3VudCIsIml0ZXJhdGlvbkNvdW50IiwiZmFsbERpc3RhbmNlIiwicm91bmRlZCIsImNvbmUiLCJub0dyYXZpdHkiLCJ4U3ByZWFkIiwiZGVzdHJveU9uQ29tcGxldGUiLCJjb21wbGV0ZSIsInNldFRpbWVvdXQiLCJyb3VuZCIsIm1hcHMiLCJjb2xvcnMiLCJ0b0ZpeGVkIiwiY2FudmFzIiwic2VsZWN0ZWRNYXAiLCJzZWxlY3RlZFRlYWNoZXIiLCJzZWxlY3RlZFJlc2V0IiwicG9zIiwicmVhbFBvcyIsInBpeGVsUmF0aW8iLCJyaWdodFByZXNzZWQiLCJsZWZ0UHJlc3NlZCIsInVwUHJlc3NlZCIsImRvd25QcmVzc2VkIiwibWFwQ2hhbmdlZCIsImhpc3RvcnkiLCJzdGF0dXNNZXNzYWdlIiwic3RhdHVzVGltZXIiLCJjb25mZXR0aSIsInJvYm90IiwiSW1hZ2UiLCJyb2JvdEZsaXBwZWQiLCJmbGlwcGVkIiwic2NvcmUiLCJsYXN0U2NvcmUiLCJzaG93TWVzc2FnZSIsIm1zZyIsImNsZWFyVGltZW91dCIsImdldENvbnRleHQiLCJ0aWxlU2l6ZSIsImxhc3RQb3NpdGlvbiIsInRlYWNoZXJNYXAiLCJvbmVTdGVwUmVhY2giLCJiYXNlTWFzayIsInJvd3MiLCJjb2xzIiwib25lU3RlcE1hc2siLCJqIiwicmVzIiwiZSIsImRyYXdFbnZpcm9ubWVudCIsImhlaWdodCIsImJhc2VNYXAiLCJkaXN0YW5jZSIsIm5ld0Jhc2VNYXAiLCJzcGxpdCIsImJhc2VEYW5nZXJNYXNrIiwicm93IiwiYmFzZUVtcHR5TWFzayIsInJlYWNoTWFzayIsInByZXZpb3VzTWFzayIsIm5ld01hcCIsImpvaW4iLCJhZGRUZWFjaGVyIiwic3RhdGUiLCJiZWdpblBhdGgiLCJyZWN0IiwiZmlsbFN0eWxlIiwiY2xvc2VQYXRoIiwibW92ZUFnZW50IiwibmV3UG9zIiwicmVzZXRBZ2VudCIsImRldmljZVBpeGVsUmF0aW8iLCJzY2FsZSIsImRyYXciLCJjbGVhclJlY3QiLCJ3aWR0aCIsImRlZmF1bHRzIiwidGFyZ2V0X3ZhbHVlIiwib3B0cyIsInByZXZpb3VzX3Rhc2siLCJzdGFydGVkIiwiZWFzaW5nIiwiaW50ZXJwb2xhdGUiLCJhYm9ydCIsImVsYXBzZWQiLCJ0d2VlbmVkIiwiaW1hZ2UiLCJkcmF3SW1hZ2UiLCIkcG9zIiwiZHJhd0FnZW50Iiwicm5kIiwidG1wU2NvcmUiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJ0cmFqZWN0b3JpZXNUYWciLCJUcmFqZWN0b3JpZXMiLCJiYWNrVGFnIiwiQmFjayIsImluY3JlbWVudGFsVGFnIiwiSW5jcmVtZW50YWwiLCJtaW5pZ2FtZVRhZyIsIk1pbmlnYW1lIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElB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UTVQLGlCQUFpQixTQUFTLFdBQ2pDLElBQU0vQixFQUFTMlIsR0FBUXRPLGNBQWMsOEJBQzlCLElBQUl1TyxHQUFLLENBQUU1UixjQUduQixJQUFNNlIsR0FBaUJoVSxTQUFTMkMsZUFBZSw2QkFFL0NxUixHQUFlOVAsaUJBQWlCLFNBQVMsV0FDeEMsSUFBTS9CLEVBQVM2UixHQUFleE8sY0FBYyxxQ0FDOUIsSUFBSXlPLEdBQVksQ0FBRTlSLGNBR2pDLElBQU0rUixHQUFjbFUsU0FBUzJDLGVBQWUsWUFFNUN1UixHQUFZaFEsaUJBQWlCLFNBQVMsV0FDckMsSUFBTS9CLEVBQVMrUixHQUFZMU8sY0FBYyxvQkFDOUIsSUFBSTJPLEdBQVMsQ0FBRWhTIiwiZmlsZSI6ImluZGV4LmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImZ1bmN0aW9uIG5vb3AoKSB7IH1cbmNvbnN0IGlkZW50aXR5ID0geCA9PiB4O1xuZnVuY3Rpb24gYXNzaWduKHRhciwgc3JjKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgayBpbiBzcmMpXG4gICAgICAgIHRhcltrXSA9IHNyY1trXTtcbiAgICByZXR1cm4gdGFyO1xufVxuZnVuY3Rpb24gaXNfcHJvbWlzZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gYWRkX2xvY2F0aW9uKGVsZW1lbnQsIGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhcikge1xuICAgIGVsZW1lbnQuX19zdmVsdGVfbWV0YSA9IHtcbiAgICAgICAgbG9jOiB7IGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhciB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHJ1bihmbikge1xuICAgIHJldHVybiBmbigpO1xufVxuZnVuY3Rpb24gYmxhbmtfb2JqZWN0KCkge1xuICAgIHJldHVybiBPYmplY3QuY3JlYXRlKG51bGwpO1xufVxuZnVuY3Rpb24gcnVuX2FsbChmbnMpIHtcbiAgICBmbnMuZm9yRWFjaChydW4pO1xufVxuZnVuY3Rpb24gaXNfZnVuY3Rpb24odGhpbmcpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gc2FmZV9ub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiIHx8ICgoYSAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHx8IHR5cGVvZiBhID09PSAnZnVuY3Rpb24nKTtcbn1cbmxldCBzcmNfdXJsX2VxdWFsX2FuY2hvcjtcbmZ1bmN0aW9uIHNyY191cmxfZXF1YWwoZWxlbWVudF9zcmMsIHVybCkge1xuICAgIGlmICghc3JjX3VybF9lcXVhbF9hbmNob3IpIHtcbiAgICAgICAgc3JjX3VybF9lcXVhbF9hbmNob3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgfVxuICAgIHNyY191cmxfZXF1YWxfYW5jaG9yLmhyZWYgPSB1cmw7XG4gICAgcmV0dXJuIGVsZW1lbnRfc3JjID09PSBzcmNfdXJsX2VxdWFsX2FuY2hvci5ocmVmO1xufVxuZnVuY3Rpb24gbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYjtcbn1cbmZ1bmN0aW9uIGlzX2VtcHR5KG9iaikge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PT0gMDtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3N0b3JlKHN0b3JlLCBuYW1lKSB7XG4gICAgaWYgKHN0b3JlICE9IG51bGwgJiYgdHlwZW9mIHN0b3JlLnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke25hbWV9JyBpcyBub3QgYSBzdG9yZSB3aXRoIGEgJ3N1YnNjcmliZScgbWV0aG9kYCk7XG4gICAgfVxufVxuZnVuY3Rpb24gc3Vic2NyaWJlKHN0b3JlLCAuLi5jYWxsYmFja3MpIHtcbiAgICBpZiAoc3RvcmUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICB9XG4gICAgY29uc3QgdW5zdWIgPSBzdG9yZS5zdWJzY3JpYmUoLi4uY2FsbGJhY2tzKTtcbiAgICByZXR1cm4gdW5zdWIudW5zdWJzY3JpYmUgPyAoKSA9PiB1bnN1Yi51bnN1YnNjcmliZSgpIDogdW5zdWI7XG59XG5mdW5jdGlvbiBnZXRfc3RvcmVfdmFsdWUoc3RvcmUpIHtcbiAgICBsZXQgdmFsdWU7XG4gICAgc3Vic2NyaWJlKHN0b3JlLCBfID0+IHZhbHVlID0gXykoKTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBjb21wb25lbnRfc3Vic2NyaWJlKGNvbXBvbmVudCwgc3RvcmUsIGNhbGxiYWNrKSB7XG4gICAgY29tcG9uZW50LiQkLm9uX2Rlc3Ryb3kucHVzaChzdWJzY3JpYmUoc3RvcmUsIGNhbGxiYWNrKSk7XG59XG5mdW5jdGlvbiBjcmVhdGVfc2xvdChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKSB7XG4gICAgaWYgKGRlZmluaXRpb24pIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jdHggPSBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pO1xuICAgICAgICByZXR1cm4gZGVmaW5pdGlvblswXShzbG90X2N0eCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKSB7XG4gICAgcmV0dXJuIGRlZmluaXRpb25bMV0gJiYgZm5cbiAgICAgICAgPyBhc3NpZ24oJCRzY29wZS5jdHguc2xpY2UoKSwgZGVmaW5pdGlvblsxXShmbihjdHgpKSlcbiAgICAgICAgOiAkJHNjb3BlLmN0eDtcbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NoYW5nZXMoZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGZuKSB7XG4gICAgaWYgKGRlZmluaXRpb25bMl0gJiYgZm4pIHtcbiAgICAgICAgY29uc3QgbGV0cyA9IGRlZmluaXRpb25bMl0oZm4oZGlydHkpKTtcbiAgICAgICAgaWYgKCQkc2NvcGUuZGlydHkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGxldHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBsZXRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgY29uc3QgbWVyZ2VkID0gW107XG4gICAgICAgICAgICBjb25zdCBsZW4gPSBNYXRoLm1heCgkJHNjb3BlLmRpcnR5Lmxlbmd0aCwgbGV0cy5sZW5ndGgpO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIG1lcmdlZFtpXSA9ICQkc2NvcGUuZGlydHlbaV0gfCBsZXRzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1lcmdlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJCRzY29wZS5kaXJ0eSB8IGxldHM7XG4gICAgfVxuICAgIHJldHVybiAkJHNjb3BlLmRpcnR5O1xufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3RfYmFzZShzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0X2ZuKSB7XG4gICAgaWYgKHNsb3RfY2hhbmdlcykge1xuICAgICAgICBjb25zdCBzbG90X2NvbnRleHQgPSBnZXRfc2xvdF9jb250ZXh0KHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbiAgICAgICAgc2xvdC5wKHNsb3RfY29udGV4dCwgc2xvdF9jaGFuZ2VzKTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdChzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIHVwZGF0ZV9zbG90X2Jhc2Uoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIHNsb3RfY2hhbmdlcywgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG59XG5mdW5jdGlvbiBnZXRfYWxsX2RpcnR5X2Zyb21fc2NvcGUoJCRzY29wZSkge1xuICAgIGlmICgkJHNjb3BlLmN0eC5sZW5ndGggPiAzMikge1xuICAgICAgICBjb25zdCBkaXJ0eSA9IFtdO1xuICAgICAgICBjb25zdCBsZW5ndGggPSAkJHNjb3BlLmN0eC5sZW5ndGggLyAzMjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZGlydHlbaV0gPSAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlydHk7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMocHJvcHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmIChrWzBdICE9PSAnJCcpXG4gICAgICAgICAgICByZXN1bHRba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY29tcHV0ZV9yZXN0X3Byb3BzKHByb3BzLCBrZXlzKSB7XG4gICAgY29uc3QgcmVzdCA9IHt9O1xuICAgIGtleXMgPSBuZXcgU2V0KGtleXMpO1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKCFrZXlzLmhhcyhrKSAmJiBrWzBdICE9PSAnJCcpXG4gICAgICAgICAgICByZXN0W2tdID0gcHJvcHNba107XG4gICAgcmV0dXJuIHJlc3Q7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Nsb3RzKHNsb3RzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gc2xvdHMpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gb25jZShmbikge1xuICAgIGxldCByYW4gPSBmYWxzZTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgaWYgKHJhbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcmFuID0gdHJ1ZTtcbiAgICAgICAgZm4uY2FsbCh0aGlzLCAuLi5hcmdzKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gbnVsbF90b19lbXB0eSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9zdG9yZV92YWx1ZShzdG9yZSwgcmV0LCB2YWx1ZSkge1xuICAgIHN0b3JlLnNldCh2YWx1ZSk7XG4gICAgcmV0dXJuIHJldDtcbn1cbmNvbnN0IGhhc19wcm9wID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG5mdW5jdGlvbiBhY3Rpb25fZGVzdHJveWVyKGFjdGlvbl9yZXN1bHQpIHtcbiAgICByZXR1cm4gYWN0aW9uX3Jlc3VsdCAmJiBpc19mdW5jdGlvbihhY3Rpb25fcmVzdWx0LmRlc3Ryb3kpID8gYWN0aW9uX3Jlc3VsdC5kZXN0cm95IDogbm9vcDtcbn1cblxuY29uc3QgaXNfY2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XG5sZXQgbm93ID0gaXNfY2xpZW50XG4gICAgPyAoKSA9PiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcbiAgICA6ICgpID0+IERhdGUubm93KCk7XG5sZXQgcmFmID0gaXNfY2xpZW50ID8gY2IgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKSA6IG5vb3A7XG4vLyB1c2VkIGludGVybmFsbHkgZm9yIHRlc3RpbmdcbmZ1bmN0aW9uIHNldF9ub3coZm4pIHtcbiAgICBub3cgPSBmbjtcbn1cbmZ1bmN0aW9uIHNldF9yYWYoZm4pIHtcbiAgICByYWYgPSBmbjtcbn1cblxuY29uc3QgdGFza3MgPSBuZXcgU2V0KCk7XG5mdW5jdGlvbiBydW5fdGFza3Mobm93KSB7XG4gICAgdGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgaWYgKCF0YXNrLmMobm93KSkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICAgICAgdGFzay5mKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAodGFza3Muc2l6ZSAhPT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG59XG4vKipcbiAqIEZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkhXG4gKi9cbmZ1bmN0aW9uIGNsZWFyX2xvb3BzKCkge1xuICAgIHRhc2tzLmNsZWFyKCk7XG59XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdGFzayB0aGF0IHJ1bnMgb24gZWFjaCByYWYgZnJhbWVcbiAqIHVudGlsIGl0IHJldHVybnMgYSBmYWxzeSB2YWx1ZSBvciBpcyBhYm9ydGVkXG4gKi9cbmZ1bmN0aW9uIGxvb3AoY2FsbGJhY2spIHtcbiAgICBsZXQgdGFzaztcbiAgICBpZiAodGFza3Muc2l6ZSA9PT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvbWlzZTogbmV3IFByb21pc2UoZnVsZmlsbCA9PiB7XG4gICAgICAgICAgICB0YXNrcy5hZGQodGFzayA9IHsgYzogY2FsbGJhY2ssIGY6IGZ1bGZpbGwgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8vIFRyYWNrIHdoaWNoIG5vZGVzIGFyZSBjbGFpbWVkIGR1cmluZyBoeWRyYXRpb24uIFVuY2xhaW1lZCBub2RlcyBjYW4gdGhlbiBiZSByZW1vdmVkIGZyb20gdGhlIERPTVxuLy8gYXQgdGhlIGVuZCBvZiBoeWRyYXRpb24gd2l0aG91dCB0b3VjaGluZyB0aGUgcmVtYWluaW5nIG5vZGVzLlxubGV0IGlzX2h5ZHJhdGluZyA9IGZhbHNlO1xuZnVuY3Rpb24gc3RhcnRfaHlkcmF0aW5nKCkge1xuICAgIGlzX2h5ZHJhdGluZyA9IHRydWU7XG59XG5mdW5jdGlvbiBlbmRfaHlkcmF0aW5nKCkge1xuICAgIGlzX2h5ZHJhdGluZyA9IGZhbHNlO1xufVxuZnVuY3Rpb24gdXBwZXJfYm91bmQobG93LCBoaWdoLCBrZXksIHZhbHVlKSB7XG4gICAgLy8gUmV0dXJuIGZpcnN0IGluZGV4IG9mIHZhbHVlIGxhcmdlciB0aGFuIGlucHV0IHZhbHVlIGluIHRoZSByYW5nZSBbbG93LCBoaWdoKVxuICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7XG4gICAgICAgIGNvbnN0IG1pZCA9IGxvdyArICgoaGlnaCAtIGxvdykgPj4gMSk7XG4gICAgICAgIGlmIChrZXkobWlkKSA8PSB2YWx1ZSkge1xuICAgICAgICAgICAgbG93ID0gbWlkICsgMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGhpZ2ggPSBtaWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbn1cbmZ1bmN0aW9uIGluaXRfaHlkcmF0ZSh0YXJnZXQpIHtcbiAgICBpZiAodGFyZ2V0Lmh5ZHJhdGVfaW5pdClcbiAgICAgICAgcmV0dXJuO1xuICAgIHRhcmdldC5oeWRyYXRlX2luaXQgPSB0cnVlO1xuICAgIC8vIFdlIGtub3cgdGhhdCBhbGwgY2hpbGRyZW4gaGF2ZSBjbGFpbV9vcmRlciB2YWx1ZXMgc2luY2UgdGhlIHVuY2xhaW1lZCBoYXZlIGJlZW4gZGV0YWNoZWQgaWYgdGFyZ2V0IGlzIG5vdCA8aGVhZD5cbiAgICBsZXQgY2hpbGRyZW4gPSB0YXJnZXQuY2hpbGROb2RlcztcbiAgICAvLyBJZiB0YXJnZXQgaXMgPGhlYWQ+LCB0aGVyZSBtYXkgYmUgY2hpbGRyZW4gd2l0aG91dCBjbGFpbV9vcmRlclxuICAgIGlmICh0YXJnZXQubm9kZU5hbWUgPT09ICdIRUFEJykge1xuICAgICAgICBjb25zdCBteUNoaWxkcmVuID0gW107XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBjaGlsZHJlbltpXTtcbiAgICAgICAgICAgIGlmIChub2RlLmNsYWltX29yZGVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBteUNoaWxkcmVuLnB1c2gobm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGRyZW4gPSBteUNoaWxkcmVuO1xuICAgIH1cbiAgICAvKlxuICAgICogUmVvcmRlciBjbGFpbWVkIGNoaWxkcmVuIG9wdGltYWxseS5cbiAgICAqIFdlIGNhbiByZW9yZGVyIGNsYWltZWQgY2hpbGRyZW4gb3B0aW1hbGx5IGJ5IGZpbmRpbmcgdGhlIGxvbmdlc3Qgc3Vic2VxdWVuY2Ugb2ZcbiAgICAqIG5vZGVzIHRoYXQgYXJlIGFscmVhZHkgY2xhaW1lZCBpbiBvcmRlciBhbmQgb25seSBtb3ZpbmcgdGhlIHJlc3QuIFRoZSBsb25nZXN0XG4gICAgKiBzdWJzZXF1ZW5jZSBzdWJzZXF1ZW5jZSBvZiBub2RlcyB0aGF0IGFyZSBjbGFpbWVkIGluIG9yZGVyIGNhbiBiZSBmb3VuZCBieVxuICAgICogY29tcHV0aW5nIHRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgLmNsYWltX29yZGVyIHZhbHVlcy5cbiAgICAqXG4gICAgKiBUaGlzIGFsZ29yaXRobSBpcyBvcHRpbWFsIGluIGdlbmVyYXRpbmcgdGhlIGxlYXN0IGFtb3VudCBvZiByZW9yZGVyIG9wZXJhdGlvbnNcbiAgICAqIHBvc3NpYmxlLlxuICAgICpcbiAgICAqIFByb29mOlxuICAgICogV2Uga25vdyB0aGF0LCBnaXZlbiBhIHNldCBvZiByZW9yZGVyaW5nIG9wZXJhdGlvbnMsIHRoZSBub2RlcyB0aGF0IGRvIG5vdCBtb3ZlXG4gICAgKiBhbHdheXMgZm9ybSBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlLCBzaW5jZSB0aGV5IGRvIG5vdCBtb3ZlIGFtb25nIGVhY2ggb3RoZXJcbiAgICAqIG1lYW5pbmcgdGhhdCB0aGV5IG11c3QgYmUgYWxyZWFkeSBvcmRlcmVkIGFtb25nIGVhY2ggb3RoZXIuIFRodXMsIHRoZSBtYXhpbWFsXG4gICAgKiBzZXQgb2Ygbm9kZXMgdGhhdCBkbyBub3QgbW92ZSBmb3JtIGEgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlLlxuICAgICovXG4gICAgLy8gQ29tcHV0ZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2VcbiAgICAvLyBtOiBzdWJzZXF1ZW5jZSBsZW5ndGggaiA9PiBpbmRleCBrIG9mIHNtYWxsZXN0IHZhbHVlIHRoYXQgZW5kcyBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIGxlbmd0aCBqXG4gICAgY29uc3QgbSA9IG5ldyBJbnQzMkFycmF5KGNoaWxkcmVuLmxlbmd0aCArIDEpO1xuICAgIC8vIFByZWRlY2Vzc29yIGluZGljZXMgKyAxXG4gICAgY29uc3QgcCA9IG5ldyBJbnQzMkFycmF5KGNoaWxkcmVuLmxlbmd0aCk7XG4gICAgbVswXSA9IC0xO1xuICAgIGxldCBsb25nZXN0ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjaGlsZHJlbltpXS5jbGFpbV9vcmRlcjtcbiAgICAgICAgLy8gRmluZCB0aGUgbGFyZ2VzdCBzdWJzZXF1ZW5jZSBsZW5ndGggc3VjaCB0aGF0IGl0IGVuZHMgaW4gYSB2YWx1ZSBsZXNzIHRoYW4gb3VyIGN1cnJlbnQgdmFsdWVcbiAgICAgICAgLy8gdXBwZXJfYm91bmQgcmV0dXJucyBmaXJzdCBncmVhdGVyIHZhbHVlLCBzbyB3ZSBzdWJ0cmFjdCBvbmVcbiAgICAgICAgLy8gd2l0aCBmYXN0IHBhdGggZm9yIHdoZW4gd2UgYXJlIG9uIHRoZSBjdXJyZW50IGxvbmdlc3Qgc3Vic2VxdWVuY2VcbiAgICAgICAgY29uc3Qgc2VxTGVuID0gKChsb25nZXN0ID4gMCAmJiBjaGlsZHJlblttW2xvbmdlc3RdXS5jbGFpbV9vcmRlciA8PSBjdXJyZW50KSA/IGxvbmdlc3QgKyAxIDogdXBwZXJfYm91bmQoMSwgbG9uZ2VzdCwgaWR4ID0+IGNoaWxkcmVuW21baWR4XV0uY2xhaW1fb3JkZXIsIGN1cnJlbnQpKSAtIDE7XG4gICAgICAgIHBbaV0gPSBtW3NlcUxlbl0gKyAxO1xuICAgICAgICBjb25zdCBuZXdMZW4gPSBzZXFMZW4gKyAxO1xuICAgICAgICAvLyBXZSBjYW4gZ3VhcmFudGVlIHRoYXQgY3VycmVudCBpcyB0aGUgc21hbGxlc3QgdmFsdWUuIE90aGVyd2lzZSwgd2Ugd291bGQgaGF2ZSBnZW5lcmF0ZWQgYSBsb25nZXIgc2VxdWVuY2UuXG4gICAgICAgIG1bbmV3TGVuXSA9IGk7XG4gICAgICAgIGxvbmdlc3QgPSBNYXRoLm1heChuZXdMZW4sIGxvbmdlc3QpO1xuICAgIH1cbiAgICAvLyBUaGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIG5vZGVzIChpbml0aWFsbHkgcmV2ZXJzZWQpXG4gICAgY29uc3QgbGlzID0gW107XG4gICAgLy8gVGhlIHJlc3Qgb2YgdGhlIG5vZGVzLCBub2RlcyB0aGF0IHdpbGwgYmUgbW92ZWRcbiAgICBjb25zdCB0b01vdmUgPSBbXTtcbiAgICBsZXQgbGFzdCA9IGNoaWxkcmVuLmxlbmd0aCAtIDE7XG4gICAgZm9yIChsZXQgY3VyID0gbVtsb25nZXN0XSArIDE7IGN1ciAhPSAwOyBjdXIgPSBwW2N1ciAtIDFdKSB7XG4gICAgICAgIGxpcy5wdXNoKGNoaWxkcmVuW2N1ciAtIDFdKTtcbiAgICAgICAgZm9yICg7IGxhc3QgPj0gY3VyOyBsYXN0LS0pIHtcbiAgICAgICAgICAgIHRvTW92ZS5wdXNoKGNoaWxkcmVuW2xhc3RdKTtcbiAgICAgICAgfVxuICAgICAgICBsYXN0LS07XG4gICAgfVxuICAgIGZvciAoOyBsYXN0ID49IDA7IGxhc3QtLSkge1xuICAgICAgICB0b01vdmUucHVzaChjaGlsZHJlbltsYXN0XSk7XG4gICAgfVxuICAgIGxpcy5yZXZlcnNlKCk7XG4gICAgLy8gV2Ugc29ydCB0aGUgbm9kZXMgYmVpbmcgbW92ZWQgdG8gZ3VhcmFudGVlIHRoYXQgdGhlaXIgaW5zZXJ0aW9uIG9yZGVyIG1hdGNoZXMgdGhlIGNsYWltIG9yZGVyXG4gICAgdG9Nb3ZlLnNvcnQoKGEsIGIpID0+IGEuY2xhaW1fb3JkZXIgLSBiLmNsYWltX29yZGVyKTtcbiAgICAvLyBGaW5hbGx5LCB3ZSBtb3ZlIHRoZSBub2Rlc1xuICAgIGZvciAobGV0IGkgPSAwLCBqID0gMDsgaSA8IHRvTW92ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB3aGlsZSAoaiA8IGxpcy5sZW5ndGggJiYgdG9Nb3ZlW2ldLmNsYWltX29yZGVyID49IGxpc1tqXS5jbGFpbV9vcmRlcikge1xuICAgICAgICAgICAgaisrO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IGogPCBsaXMubGVuZ3RoID8gbGlzW2pdIDogbnVsbDtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZSh0b01vdmVbaV0sIGFuY2hvcik7XG4gICAgfVxufVxuZnVuY3Rpb24gYXBwZW5kKHRhcmdldCwgbm9kZSkge1xuICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9zdHlsZXModGFyZ2V0LCBzdHlsZV9zaGVldF9pZCwgc3R5bGVzKSB7XG4gICAgY29uc3QgYXBwZW5kX3N0eWxlc190byA9IGdldF9yb290X2Zvcl9zdHlsZSh0YXJnZXQpO1xuICAgIGlmICghYXBwZW5kX3N0eWxlc190by5nZXRFbGVtZW50QnlJZChzdHlsZV9zaGVldF9pZCkpIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBlbGVtZW50KCdzdHlsZScpO1xuICAgICAgICBzdHlsZS5pZCA9IHN0eWxlX3NoZWV0X2lkO1xuICAgICAgICBzdHlsZS50ZXh0Q29udGVudCA9IHN0eWxlcztcbiAgICAgICAgYXBwZW5kX3N0eWxlc2hlZXQoYXBwZW5kX3N0eWxlc190bywgc3R5bGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9yb290X2Zvcl9zdHlsZShub2RlKSB7XG4gICAgaWYgKCFub2RlKVxuICAgICAgICByZXR1cm4gZG9jdW1lbnQ7XG4gICAgY29uc3Qgcm9vdCA9IG5vZGUuZ2V0Um9vdE5vZGUgPyBub2RlLmdldFJvb3ROb2RlKCkgOiBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgaWYgKHJvb3QgJiYgcm9vdC5ob3N0KSB7XG4gICAgICAgIHJldHVybiByb290O1xuICAgIH1cbiAgICByZXR1cm4gbm9kZS5vd25lckRvY3VtZW50O1xufVxuZnVuY3Rpb24gYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQobm9kZSkge1xuICAgIGNvbnN0IHN0eWxlX2VsZW1lbnQgPSBlbGVtZW50KCdzdHlsZScpO1xuICAgIGFwcGVuZF9zdHlsZXNoZWV0KGdldF9yb290X2Zvcl9zdHlsZShub2RlKSwgc3R5bGVfZWxlbWVudCk7XG4gICAgcmV0dXJuIHN0eWxlX2VsZW1lbnQuc2hlZXQ7XG59XG5mdW5jdGlvbiBhcHBlbmRfc3R5bGVzaGVldChub2RlLCBzdHlsZSkge1xuICAgIGFwcGVuZChub2RlLmhlYWQgfHwgbm9kZSwgc3R5bGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpIHtcbiAgICBpZiAoaXNfaHlkcmF0aW5nKSB7XG4gICAgICAgIGluaXRfaHlkcmF0ZSh0YXJnZXQpO1xuICAgICAgICBpZiAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID09PSB1bmRlZmluZWQpIHx8ICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgIT09IG51bGwpICYmICh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5wYXJlbnRFbGVtZW50ICE9PSB0YXJnZXQpKSkge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSB0YXJnZXQuZmlyc3RDaGlsZDtcbiAgICAgICAgfVxuICAgICAgICAvLyBTa2lwIG5vZGVzIG9mIHVuZGVmaW5lZCBvcmRlcmluZ1xuICAgICAgICB3aGlsZSAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkICE9PSBudWxsKSAmJiAodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQuY2xhaW1fb3JkZXIgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUgIT09IHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkKSB7XG4gICAgICAgICAgICAvLyBXZSBvbmx5IGluc2VydCBpZiB0aGUgb3JkZXJpbmcgb2YgdGhpcyBub2RlIHNob3VsZCBiZSBtb2RpZmllZCBvciB0aGUgcGFyZW50IG5vZGUgaXMgbm90IHRhcmdldFxuICAgICAgICAgICAgaWYgKG5vZGUuY2xhaW1fb3JkZXIgIT09IHVuZGVmaW5lZCB8fCBub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCkge1xuICAgICAgICAgICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSBub2RlLm5leHRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0IHx8IG5vZGUubmV4dFNpYmxpbmcgIT09IG51bGwpIHtcbiAgICAgICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGlmIChpc19oeWRyYXRpbmcgJiYgIWFuY2hvcikge1xuICAgICAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0IHx8IG5vZGUubmV4dFNpYmxpbmcgIT0gYW5jaG9yKSB7XG4gICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaChub2RlKSB7XG4gICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gZGVzdHJveV9lYWNoKGl0ZXJhdGlvbnMsIGRldGFjaGluZykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlcmF0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoaXRlcmF0aW9uc1tpXSlcbiAgICAgICAgICAgIGl0ZXJhdGlvbnNbaV0uZChkZXRhY2hpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGVsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUpO1xufVxuZnVuY3Rpb24gZWxlbWVudF9pcyhuYW1lLCBpcykge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUsIHsgaXMgfSk7XG59XG5mdW5jdGlvbiBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzKG9iaiwgZXhjbHVkZSkge1xuICAgIGNvbnN0IHRhcmdldCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBvYmopIHtcbiAgICAgICAgaWYgKGhhc19wcm9wKG9iaiwgaylcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICYmIGV4Y2x1ZGUuaW5kZXhPZihrKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRhcmdldFtrXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gc3ZnX2VsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgbmFtZSk7XG59XG5mdW5jdGlvbiB0ZXh0KGRhdGEpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YSk7XG59XG5mdW5jdGlvbiBzcGFjZSgpIHtcbiAgICByZXR1cm4gdGV4dCgnICcpO1xufVxuZnVuY3Rpb24gZW1wdHkoKSB7XG4gICAgcmV0dXJuIHRleHQoJycpO1xufVxuZnVuY3Rpb24gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4gbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIHByZXZlbnRfZGVmYXVsdChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHN0b3BfcHJvcGFnYXRpb24oZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2VsZihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRydXN0ZWQoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKGV2ZW50LmlzVHJ1c3RlZClcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICBlbHNlIGlmIChub2RlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpICE9PSB2YWx1ZSlcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBzZXRfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobm9kZS5fX3Byb3RvX18pO1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNba2V5XSA9PSBudWxsKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5jc3NUZXh0ID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ19fdmFsdWUnKSB7XG4gICAgICAgICAgICBub2RlLnZhbHVlID0gbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlc2NyaXB0b3JzW2tleV0gJiYgZGVzY3JpcHRvcnNba2V5XS5zZXQpIHtcbiAgICAgICAgICAgIG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X3N2Z19hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9jdXN0b21fZWxlbWVudF9kYXRhKG5vZGUsIHByb3AsIHZhbHVlKSB7XG4gICAgaWYgKHByb3AgaW4gbm9kZSkge1xuICAgICAgICBub2RlW3Byb3BdID0gdHlwZW9mIG5vZGVbcHJvcF0gPT09ICdib29sZWFuJyAmJiB2YWx1ZSA9PT0gJycgPyB0cnVlIDogdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhdHRyKG5vZGUsIHByb3AsIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB4bGlua19hdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBub2RlLnNldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBnZXRfYmluZGluZ19ncm91cF92YWx1ZShncm91cCwgX192YWx1ZSwgY2hlY2tlZCkge1xuICAgIGNvbnN0IHZhbHVlID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGdyb3VwW2ldLmNoZWNrZWQpXG4gICAgICAgICAgICB2YWx1ZS5hZGQoZ3JvdXBbaV0uX192YWx1ZSk7XG4gICAgfVxuICAgIGlmICghY2hlY2tlZCkge1xuICAgICAgICB2YWx1ZS5kZWxldGUoX192YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBBcnJheS5mcm9tKHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHRvX251bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gJycgPyBudWxsIDogK3ZhbHVlO1xufVxuZnVuY3Rpb24gdGltZV9yYW5nZXNfdG9fYXJyYXkocmFuZ2VzKSB7XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBhcnJheS5wdXNoKHsgc3RhcnQ6IHJhbmdlcy5zdGFydChpKSwgZW5kOiByYW5nZXMuZW5kKGkpIH0pO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5mdW5jdGlvbiBjaGlsZHJlbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKTtcbn1cbmZ1bmN0aW9uIGluaXRfY2xhaW1faW5mbyhub2Rlcykge1xuICAgIGlmIChub2Rlcy5jbGFpbV9pbmZvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbm9kZXMuY2xhaW1faW5mbyA9IHsgbGFzdF9pbmRleDogMCwgdG90YWxfY2xhaW1lZDogMCB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsYWltX25vZGUobm9kZXMsIHByZWRpY2F0ZSwgcHJvY2Vzc05vZGUsIGNyZWF0ZU5vZGUsIGRvbnRVcGRhdGVMYXN0SW5kZXggPSBmYWxzZSkge1xuICAgIC8vIFRyeSB0byBmaW5kIG5vZGVzIGluIGFuIG9yZGVyIHN1Y2ggdGhhdCB3ZSBsZW5ndGhlbiB0aGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlXG4gICAgaW5pdF9jbGFpbV9pbmZvKG5vZGVzKTtcbiAgICBjb25zdCByZXN1bHROb2RlID0gKCgpID0+IHtcbiAgICAgICAgLy8gV2UgZmlyc3QgdHJ5IHRvIGZpbmQgYW4gZWxlbWVudCBhZnRlciB0aGUgcHJldmlvdXMgb25lXG4gICAgICAgIGZvciAobGV0IGkgPSBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXg7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gcHJvY2Vzc05vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFkb250VXBkYXRlTGFzdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgd2UgdHJ5IHRvIGZpbmQgb25lIGJlZm9yZVxuICAgICAgICAvLyBXZSBpdGVyYXRlIGluIHJldmVyc2Ugc28gdGhhdCB3ZSBkb24ndCBnbyB0b28gZmFyIGJhY2tcbiAgICAgICAgZm9yIChsZXQgaSA9IG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBwcm9jZXNzTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWRvbnRVcGRhdGVMYXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTaW5jZSB3ZSBzcGxpY2VkIGJlZm9yZSB0aGUgbGFzdF9pbmRleCwgd2UgZGVjcmVhc2UgaXRcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4LS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGNhbid0IGZpbmQgYW55IG1hdGNoaW5nIG5vZGUsIHdlIGNyZWF0ZSBhIG5ldyBvbmVcbiAgICAgICAgcmV0dXJuIGNyZWF0ZU5vZGUoKTtcbiAgICB9KSgpO1xuICAgIHJlc3VsdE5vZGUuY2xhaW1fb3JkZXIgPSBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQ7XG4gICAgbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkICs9IDE7XG4gICAgcmV0dXJuIHJlc3VsdE5vZGU7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIGNyZWF0ZV9lbGVtZW50KSB7XG4gICAgcmV0dXJuIGNsYWltX25vZGUobm9kZXMsIChub2RlKSA9PiBub2RlLm5vZGVOYW1lID09PSBuYW1lLCAobm9kZSkgPT4ge1xuICAgICAgICBjb25zdCByZW1vdmUgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5vZGUuYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgIGlmICghYXR0cmlidXRlc1thdHRyaWJ1dGUubmFtZV0pIHtcbiAgICAgICAgICAgICAgICByZW1vdmUucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVtb3ZlLmZvckVhY2godiA9PiBub2RlLnJlbW92ZUF0dHJpYnV0ZSh2KSk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSwgKCkgPT4gY3JlYXRlX2VsZW1lbnQobmFtZSkpO1xufVxuZnVuY3Rpb24gY2xhaW1fZWxlbWVudChub2RlcywgbmFtZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIGVsZW1lbnQpO1xufVxuZnVuY3Rpb24gY2xhaW1fc3ZnX2VsZW1lbnQobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBzdmdfZWxlbWVudCk7XG59XG5mdW5jdGlvbiBjbGFpbV90ZXh0KG5vZGVzLCBkYXRhKSB7XG4gICAgcmV0dXJuIGNsYWltX25vZGUobm9kZXMsIChub2RlKSA9PiBub2RlLm5vZGVUeXBlID09PSAzLCAobm9kZSkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhU3RyID0gJycgKyBkYXRhO1xuICAgICAgICBpZiAobm9kZS5kYXRhLnN0YXJ0c1dpdGgoZGF0YVN0cikpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmRhdGEubGVuZ3RoICE9PSBkYXRhU3RyLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLnNwbGl0VGV4dChkYXRhU3RyLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBub2RlLmRhdGEgPSBkYXRhU3RyO1xuICAgICAgICB9XG4gICAgfSwgKCkgPT4gdGV4dChkYXRhKSwgdHJ1ZSAvLyBUZXh0IG5vZGVzIHNob3VsZCBub3QgdXBkYXRlIGxhc3QgaW5kZXggc2luY2UgaXQgaXMgbGlrZWx5IG5vdCB3b3J0aCBpdCB0byBlbGltaW5hdGUgYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBhY3R1YWwgZWxlbWVudHNcbiAgICApO1xufVxuZnVuY3Rpb24gY2xhaW1fc3BhY2Uobm9kZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fdGV4dChub2RlcywgJyAnKTtcbn1cbmZ1bmN0aW9uIGZpbmRfY29tbWVudChub2RlcywgdGV4dCwgc3RhcnQpIHtcbiAgICBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSA4IC8qIGNvbW1lbnQgbm9kZSAqLyAmJiBub2RlLnRleHRDb250ZW50LnRyaW0oKSA9PT0gdGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5vZGVzLmxlbmd0aDtcbn1cbmZ1bmN0aW9uIGNsYWltX2h0bWxfdGFnKG5vZGVzLCBpc19zdmcpIHtcbiAgICAvLyBmaW5kIGh0bWwgb3BlbmluZyB0YWdcbiAgICBjb25zdCBzdGFydF9pbmRleCA9IGZpbmRfY29tbWVudChub2RlcywgJ0hUTUxfVEFHX1NUQVJUJywgMCk7XG4gICAgY29uc3QgZW5kX2luZGV4ID0gZmluZF9jb21tZW50KG5vZGVzLCAnSFRNTF9UQUdfRU5EJywgc3RhcnRfaW5kZXgpO1xuICAgIGlmIChzdGFydF9pbmRleCA9PT0gZW5kX2luZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbih1bmRlZmluZWQsIGlzX3N2Zyk7XG4gICAgfVxuICAgIGluaXRfY2xhaW1faW5mbyhub2Rlcyk7XG4gICAgY29uc3QgaHRtbF90YWdfbm9kZXMgPSBub2Rlcy5zcGxpY2Uoc3RhcnRfaW5kZXgsIGVuZF9pbmRleCAtIHN0YXJ0X2luZGV4ICsgMSk7XG4gICAgZGV0YWNoKGh0bWxfdGFnX25vZGVzWzBdKTtcbiAgICBkZXRhY2goaHRtbF90YWdfbm9kZXNbaHRtbF90YWdfbm9kZXMubGVuZ3RoIC0gMV0pO1xuICAgIGNvbnN0IGNsYWltZWRfbm9kZXMgPSBodG1sX3RhZ19ub2Rlcy5zbGljZSgxLCBodG1sX3RhZ19ub2Rlcy5sZW5ndGggLSAxKTtcbiAgICBmb3IgKGNvbnN0IG4gb2YgY2xhaW1lZF9ub2Rlcykge1xuICAgICAgICBuLmNsYWltX29yZGVyID0gbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkO1xuICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQgKz0gMTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBIdG1sVGFnSHlkcmF0aW9uKGNsYWltZWRfbm9kZXMsIGlzX3N2Zyk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YSh0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgIT09IGRhdGEpXG4gICAgICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgaW5wdXQudmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF90eXBlKGlucHV0LCB0eXBlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaW5wdXQudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3R5bGUobm9kZSwga2V5LCB2YWx1ZSwgaW1wb3J0YW50KSB7XG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucmVtb3ZlUHJvcGVydHkoa2V5KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG5vZGUuc3R5bGUuc2V0UHJvcGVydHkoa2V5LCB2YWx1ZSwgaW1wb3J0YW50ID8gJ2ltcG9ydGFudCcgOiAnJyk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X29wdGlvbihzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgaWYgKG9wdGlvbi5fX3ZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZWxlY3Quc2VsZWN0ZWRJbmRleCA9IC0xOyAvLyBubyBvcHRpb24gc2hvdWxkIGJlIHNlbGVjdGVkXG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9ucyhzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gfnZhbHVlLmluZGV4T2Yob3B0aW9uLl9fdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF92YWx1ZShzZWxlY3QpIHtcbiAgICBjb25zdCBzZWxlY3RlZF9vcHRpb24gPSBzZWxlY3QucXVlcnlTZWxlY3RvcignOmNoZWNrZWQnKSB8fCBzZWxlY3Qub3B0aW9uc1swXTtcbiAgICByZXR1cm4gc2VsZWN0ZWRfb3B0aW9uICYmIHNlbGVjdGVkX29wdGlvbi5fX3ZhbHVlO1xufVxuZnVuY3Rpb24gc2VsZWN0X211bHRpcGxlX3ZhbHVlKHNlbGVjdCkge1xuICAgIHJldHVybiBbXS5tYXAuY2FsbChzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnOmNoZWNrZWQnKSwgb3B0aW9uID0+IG9wdGlvbi5fX3ZhbHVlKTtcbn1cbi8vIHVuZm9ydHVuYXRlbHkgdGhpcyBjYW4ndCBiZSBhIGNvbnN0YW50IGFzIHRoYXQgd291bGRuJ3QgYmUgdHJlZS1zaGFrZWFibGVcbi8vIHNvIHdlIGNhY2hlIHRoZSByZXN1bHQgaW5zdGVhZFxubGV0IGNyb3Nzb3JpZ2luO1xuZnVuY3Rpb24gaXNfY3Jvc3NvcmlnaW4oKSB7XG4gICAgaWYgKGNyb3Nzb3JpZ2luID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY3Jvc3NvcmlnaW4gPSBmYWxzZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdm9pZCB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY3Jvc3NvcmlnaW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcm9zc29yaWdpbjtcbn1cbmZ1bmN0aW9uIGFkZF9yZXNpemVfbGlzdGVuZXIobm9kZSwgZm4pIHtcbiAgICBjb25zdCBjb21wdXRlZF9zdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKGNvbXB1dGVkX3N0eWxlLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICB9XG4gICAgY29uc3QgaWZyYW1lID0gZWxlbWVudCgnaWZyYW1lJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyBsZWZ0OiAwOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyAnICtcbiAgICAgICAgJ292ZXJmbG93OiBoaWRkZW47IGJvcmRlcjogMDsgb3BhY2l0eTogMDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHotaW5kZXg6IC0xOycpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICBpZnJhbWUudGFiSW5kZXggPSAtMTtcbiAgICBjb25zdCBjcm9zc29yaWdpbiA9IGlzX2Nyb3Nzb3JpZ2luKCk7XG4gICAgbGV0IHVuc3Vic2NyaWJlO1xuICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICBpZnJhbWUuc3JjID0gXCJkYXRhOnRleHQvaHRtbCw8c2NyaXB0Pm9ucmVzaXplPWZ1bmN0aW9uKCl7cGFyZW50LnBvc3RNZXNzYWdlKDAsJyonKX08L3NjcmlwdD5cIjtcbiAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4od2luZG93LCAnbWVzc2FnZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpXG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJztcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKGlmcmFtZS5jb250ZW50V2luZG93LCAncmVzaXplJywgZm4pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhcHBlbmQobm9kZSwgaWZyYW1lKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodW5zdWJzY3JpYmUgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZGV0YWNoKGlmcmFtZSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZV9jbGFzcyhlbGVtZW50LCBuYW1lLCB0b2dnbGUpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdFt0b2dnbGUgPyAnYWRkJyA6ICdyZW1vdmUnXShuYW1lKTtcbn1cbmZ1bmN0aW9uIGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwsIHsgYnViYmxlcyA9IGZhbHNlLCBjYW5jZWxhYmxlID0gZmFsc2UgfSA9IHt9KSB7XG4gICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGJ1YmJsZXMsIGNhbmNlbGFibGUsIGRldGFpbCk7XG4gICAgcmV0dXJuIGU7XG59XG5mdW5jdGlvbiBxdWVyeV9zZWxlY3Rvcl9hbGwoc2VsZWN0b3IsIHBhcmVudCA9IGRvY3VtZW50LmJvZHkpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShwYXJlbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xufVxuY2xhc3MgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoaXNfc3ZnID0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5pc19zdmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc19zdmcgPSBpc19zdmc7XG4gICAgICAgIHRoaXMuZSA9IHRoaXMubiA9IG51bGw7XG4gICAgfVxuICAgIGMoaHRtbCkge1xuICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgfVxuICAgIG0oaHRtbCwgdGFyZ2V0LCBhbmNob3IgPSBudWxsKSB7XG4gICAgICAgIGlmICghdGhpcy5lKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc19zdmcpXG4gICAgICAgICAgICAgICAgdGhpcy5lID0gc3ZnX2VsZW1lbnQodGFyZ2V0Lm5vZGVOYW1lKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0aGlzLmUgPSBlbGVtZW50KHRhcmdldC5ub2RlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmMoaHRtbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pKGFuY2hvcik7XG4gICAgfVxuICAgIGgoaHRtbCkge1xuICAgICAgICB0aGlzLmUuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgdGhpcy5uID0gQXJyYXkuZnJvbSh0aGlzLmUuY2hpbGROb2Rlcyk7XG4gICAgfVxuICAgIGkoYW5jaG9yKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpbnNlcnQodGhpcy50LCB0aGlzLm5baV0sIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcChodG1sKSB7XG4gICAgICAgIHRoaXMuZCgpO1xuICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgICAgIHRoaXMuaSh0aGlzLmEpO1xuICAgIH1cbiAgICBkKCkge1xuICAgICAgICB0aGlzLm4uZm9yRWFjaChkZXRhY2gpO1xuICAgIH1cbn1cbmNsYXNzIEh0bWxUYWdIeWRyYXRpb24gZXh0ZW5kcyBIdG1sVGFnIHtcbiAgICBjb25zdHJ1Y3RvcihjbGFpbWVkX25vZGVzLCBpc19zdmcgPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihpc19zdmcpO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgICAgICB0aGlzLmwgPSBjbGFpbWVkX25vZGVzO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgaWYgKHRoaXMubCkge1xuICAgICAgICAgICAgdGhpcy5uID0gdGhpcy5sO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3VwZXIuYyhodG1sKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0X2h5ZHJhdGlvbih0aGlzLnQsIHRoaXMubltpXSwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZV90b19vYmplY3QoYXR0cmlidXRlcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgcmVzdWx0W2F0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZS52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMoZWxlbWVudCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHJlc3VsdFtub2RlLnNsb3QgfHwgJ2RlZmF1bHQnXSA9IHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gd2UgbmVlZCB0byBzdG9yZSB0aGUgaW5mb3JtYXRpb24gZm9yIG11bHRpcGxlIGRvY3VtZW50cyBiZWNhdXNlIGEgU3ZlbHRlIGFwcGxpY2F0aW9uIGNvdWxkIGFsc28gY29udGFpbiBpZnJhbWVzXG4vLyBodHRwczovL2dpdGh1Yi5jb20vc3ZlbHRlanMvc3ZlbHRlL2lzc3Vlcy8zNjI0XG5jb25zdCBtYW5hZ2VkX3N0eWxlcyA9IG5ldyBNYXAoKTtcbmxldCBhY3RpdmUgPSAwO1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Rhcmtza3lhcHAvc3RyaW5nLWhhc2gvYmxvYi9tYXN0ZXIvaW5kZXguanNcbmZ1bmN0aW9uIGhhc2goc3RyKSB7XG4gICAgbGV0IGhhc2ggPSA1MzgxO1xuICAgIGxldCBpID0gc3RyLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgXiBzdHIuY2hhckNvZGVBdChpKTtcbiAgICByZXR1cm4gaGFzaCA+Pj4gMDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zdHlsZV9pbmZvcm1hdGlvbihkb2MsIG5vZGUpIHtcbiAgICBjb25zdCBpbmZvID0geyBzdHlsZXNoZWV0OiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSwgcnVsZXM6IHt9IH07XG4gICAgbWFuYWdlZF9zdHlsZXMuc2V0KGRvYywgaW5mbyk7XG4gICAgcmV0dXJuIGluZm87XG59XG5mdW5jdGlvbiBjcmVhdGVfcnVsZShub2RlLCBhLCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2UsIGZuLCB1aWQgPSAwKSB7XG4gICAgY29uc3Qgc3RlcCA9IDE2LjY2NiAvIGR1cmF0aW9uO1xuICAgIGxldCBrZXlmcmFtZXMgPSAne1xcbic7XG4gICAgZm9yIChsZXQgcCA9IDA7IHAgPD0gMTsgcCArPSBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhICsgKGIgLSBhKSAqIGVhc2UocCk7XG4gICAgICAgIGtleWZyYW1lcyArPSBwICogMTAwICsgYCV7JHtmbih0LCAxIC0gdCl9fVxcbmA7XG4gICAgfVxuICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXMgKyBgMTAwJSB7JHtmbihiLCAxIC0gYil9fVxcbn1gO1xuICAgIGNvbnN0IG5hbWUgPSBgX19zdmVsdGVfJHtoYXNoKHJ1bGUpfV8ke3VpZH1gO1xuICAgIGNvbnN0IGRvYyA9IGdldF9yb290X2Zvcl9zdHlsZShub2RlKTtcbiAgICBjb25zdCB7IHN0eWxlc2hlZXQsIHJ1bGVzIH0gPSBtYW5hZ2VkX3N0eWxlcy5nZXQoZG9jKSB8fCBjcmVhdGVfc3R5bGVfaW5mb3JtYXRpb24oZG9jLCBub2RlKTtcbiAgICBpZiAoIXJ1bGVzW25hbWVdKSB7XG4gICAgICAgIHJ1bGVzW25hbWVdID0gdHJ1ZTtcbiAgICAgICAgc3R5bGVzaGVldC5pbnNlcnRSdWxlKGBAa2V5ZnJhbWVzICR7bmFtZX0gJHtydWxlfWAsIHN0eWxlc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbiAgICB9XG4gICAgY29uc3QgYW5pbWF0aW9uID0gbm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJyc7XG4gICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBgJHthbmltYXRpb24gPyBgJHthbmltYXRpb259LCBgIDogJyd9JHtuYW1lfSAke2R1cmF0aW9ufW1zIGxpbmVhciAke2RlbGF5fW1zIDEgYm90aGA7XG4gICAgYWN0aXZlICs9IDE7XG4gICAgcmV0dXJuIG5hbWU7XG59XG5mdW5jdGlvbiBkZWxldGVfcnVsZShub2RlLCBuYW1lKSB7XG4gICAgY29uc3QgcHJldmlvdXMgPSAobm9kZS5zdHlsZS5hbmltYXRpb24gfHwgJycpLnNwbGl0KCcsICcpO1xuICAgIGNvbnN0IG5leHQgPSBwcmV2aW91cy5maWx0ZXIobmFtZVxuICAgICAgICA/IGFuaW0gPT4gYW5pbS5pbmRleE9mKG5hbWUpIDwgMCAvLyByZW1vdmUgc3BlY2lmaWMgYW5pbWF0aW9uXG4gICAgICAgIDogYW5pbSA9PiBhbmltLmluZGV4T2YoJ19fc3ZlbHRlJykgPT09IC0xIC8vIHJlbW92ZSBhbGwgU3ZlbHRlIGFuaW1hdGlvbnNcbiAgICApO1xuICAgIGNvbnN0IGRlbGV0ZWQgPSBwcmV2aW91cy5sZW5ndGggLSBuZXh0Lmxlbmd0aDtcbiAgICBpZiAoZGVsZXRlZCkge1xuICAgICAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IG5leHQuam9pbignLCAnKTtcbiAgICAgICAgYWN0aXZlIC09IGRlbGV0ZWQ7XG4gICAgICAgIGlmICghYWN0aXZlKVxuICAgICAgICAgICAgY2xlYXJfcnVsZXMoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjbGVhcl9ydWxlcygpIHtcbiAgICByYWYoKCkgPT4ge1xuICAgICAgICBpZiAoYWN0aXZlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBtYW5hZ2VkX3N0eWxlcy5mb3JFYWNoKGluZm8gPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzdHlsZXNoZWV0IH0gPSBpbmZvO1xuICAgICAgICAgICAgbGV0IGkgPSBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICAgICAgc3R5bGVzaGVldC5kZWxldGVSdWxlKGkpO1xuICAgICAgICAgICAgaW5mby5ydWxlcyA9IHt9O1xuICAgICAgICB9KTtcbiAgICAgICAgbWFuYWdlZF9zdHlsZXMuY2xlYXIoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbicpO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwsIHsgY2FuY2VsYWJsZSA9IGZhbHNlIH0gPSB7fSkgPT4ge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSBjb21wb25lbnQuJCQuY2FsbGJhY2tzW3R5cGVdO1xuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICAvLyBUT0RPIGFyZSB0aGVyZSBzaXR1YXRpb25zIHdoZXJlIGV2ZW50cyBjb3VsZCBiZSBkaXNwYXRjaGVkXG4gICAgICAgICAgICAvLyBpbiBhIHNlcnZlciAobm9uLURPTSkgZW52aXJvbm1lbnQ/XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwsIHsgY2FuY2VsYWJsZSB9KTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiAhZXZlbnQuZGVmYXVsdFByZXZlbnRlZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2V0Q29udGV4dChrZXksIGNvbnRleHQpIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LnNldChrZXksIGNvbnRleHQpO1xuICAgIHJldHVybiBjb250ZXh0O1xufVxuZnVuY3Rpb24gZ2V0Q29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5nZXQoa2V5KTtcbn1cbmZ1bmN0aW9uIGdldEFsbENvbnRleHRzKCkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0O1xufVxuZnVuY3Rpb24gaGFzQ29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5oYXMoa2V5KTtcbn1cbi8vIFRPRE8gZmlndXJlIG91dCBpZiB3ZSBzdGlsbCB3YW50IHRvIHN1cHBvcnRcbi8vIHNob3J0aGFuZCBldmVudHMsIG9yIGlmIHdlIHdhbnQgdG8gaW1wbGVtZW50XG4vLyBhIHJlYWwgYnViYmxpbmcgbWVjaGFuaXNtXG5mdW5jdGlvbiBidWJibGUoY29tcG9uZW50LCBldmVudCkge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbZXZlbnQudHlwZV07XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4gZm4uY2FsbCh0aGlzLCBldmVudCkpO1xuICAgIH1cbn1cblxuY29uc3QgZGlydHlfY29tcG9uZW50cyA9IFtdO1xuY29uc3QgaW50cm9zID0geyBlbmFibGVkOiBmYWxzZSB9O1xuY29uc3QgYmluZGluZ19jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlbmRlcl9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IGZsdXNoX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVzb2x2ZWRfcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xubGV0IHVwZGF0ZV9zY2hlZHVsZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIHNjaGVkdWxlX3VwZGF0ZSgpIHtcbiAgICBpZiAoIXVwZGF0ZV9zY2hlZHVsZWQpIHtcbiAgICAgICAgdXBkYXRlX3NjaGVkdWxlZCA9IHRydWU7XG4gICAgICAgIHJlc29sdmVkX3Byb21pc2UudGhlbihmbHVzaCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdGljaygpIHtcbiAgICBzY2hlZHVsZV91cGRhdGUoKTtcbiAgICByZXR1cm4gcmVzb2x2ZWRfcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGFkZF9yZW5kZXJfY2FsbGJhY2soZm4pIHtcbiAgICByZW5kZXJfY2FsbGJhY2tzLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gYWRkX2ZsdXNoX2NhbGxiYWNrKGZuKSB7XG4gICAgZmx1c2hfY2FsbGJhY2tzLnB1c2goZm4pO1xufVxuLy8gZmx1c2goKSBjYWxscyBjYWxsYmFja3MgaW4gdGhpcyBvcmRlcjpcbi8vIDEuIEFsbCBiZWZvcmVVcGRhdGUgY2FsbGJhY2tzLCBpbiBvcmRlcjogcGFyZW50cyBiZWZvcmUgY2hpbGRyZW5cbi8vIDIuIEFsbCBiaW5kOnRoaXMgY2FsbGJhY2tzLCBpbiByZXZlcnNlIG9yZGVyOiBjaGlsZHJlbiBiZWZvcmUgcGFyZW50cy5cbi8vIDMuIEFsbCBhZnRlclVwZGF0ZSBjYWxsYmFja3MsIGluIG9yZGVyOiBwYXJlbnRzIGJlZm9yZSBjaGlsZHJlbi4gRVhDRVBUXG4vLyAgICBmb3IgYWZ0ZXJVcGRhdGVzIGNhbGxlZCBkdXJpbmcgdGhlIGluaXRpYWwgb25Nb3VudCwgd2hpY2ggYXJlIGNhbGxlZCBpblxuLy8gICAgcmV2ZXJzZSBvcmRlcjogY2hpbGRyZW4gYmVmb3JlIHBhcmVudHMuXG4vLyBTaW5jZSBjYWxsYmFja3MgbWlnaHQgdXBkYXRlIGNvbXBvbmVudCB2YWx1ZXMsIHdoaWNoIGNvdWxkIHRyaWdnZXIgYW5vdGhlclxuLy8gY2FsbCB0byBmbHVzaCgpLCB0aGUgZm9sbG93aW5nIHN0ZXBzIGd1YXJkIGFnYWluc3QgdGhpczpcbi8vIDEuIER1cmluZyBiZWZvcmVVcGRhdGUsIGFueSB1cGRhdGVkIGNvbXBvbmVudHMgd2lsbCBiZSBhZGRlZCB0byB0aGVcbi8vICAgIGRpcnR5X2NvbXBvbmVudHMgYXJyYXkgYW5kIHdpbGwgY2F1c2UgYSByZWVudHJhbnQgY2FsbCB0byBmbHVzaCgpLiBCZWNhdXNlXG4vLyAgICB0aGUgZmx1c2ggaW5kZXggaXMga2VwdCBvdXRzaWRlIHRoZSBmdW5jdGlvbiwgdGhlIHJlZW50cmFudCBjYWxsIHdpbGwgcGlja1xuLy8gICAgdXAgd2hlcmUgdGhlIGVhcmxpZXIgY2FsbCBsZWZ0IG9mZiBhbmQgZ28gdGhyb3VnaCBhbGwgZGlydHkgY29tcG9uZW50cy4gVGhlXG4vLyAgICBjdXJyZW50X2NvbXBvbmVudCB2YWx1ZSBpcyBzYXZlZCBhbmQgcmVzdG9yZWQgc28gdGhhdCB0aGUgcmVlbnRyYW50IGNhbGwgd2lsbFxuLy8gICAgbm90IGludGVyZmVyZSB3aXRoIHRoZSBcInBhcmVudFwiIGZsdXNoKCkgY2FsbC5cbi8vIDIuIGJpbmQ6dGhpcyBjYWxsYmFja3MgY2Fubm90IHRyaWdnZXIgbmV3IGZsdXNoKCkgY2FsbHMuXG4vLyAzLiBEdXJpbmcgYWZ0ZXJVcGRhdGUsIGFueSB1cGRhdGVkIGNvbXBvbmVudHMgd2lsbCBOT1QgaGF2ZSB0aGVpciBhZnRlclVwZGF0ZVxuLy8gICAgY2FsbGJhY2sgY2FsbGVkIGEgc2Vjb25kIHRpbWU7IHRoZSBzZWVuX2NhbGxiYWNrcyBzZXQsIG91dHNpZGUgdGhlIGZsdXNoKClcbi8vICAgIGZ1bmN0aW9uLCBndWFyYW50ZWVzIHRoaXMgYmVoYXZpb3IuXG5jb25zdCBzZWVuX2NhbGxiYWNrcyA9IG5ldyBTZXQoKTtcbmxldCBmbHVzaGlkeCA9IDA7IC8vIERvICpub3QqIG1vdmUgdGhpcyBpbnNpZGUgdGhlIGZsdXNoKCkgZnVuY3Rpb25cbmZ1bmN0aW9uIGZsdXNoKCkge1xuICAgIGNvbnN0IHNhdmVkX2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIGRvIHtcbiAgICAgICAgLy8gZmlyc3QsIGNhbGwgYmVmb3JlVXBkYXRlIGZ1bmN0aW9uc1xuICAgICAgICAvLyBhbmQgdXBkYXRlIGNvbXBvbmVudHNcbiAgICAgICAgd2hpbGUgKGZsdXNoaWR4IDwgZGlydHlfY29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGRpcnR5X2NvbXBvbmVudHNbZmx1c2hpZHhdO1xuICAgICAgICAgICAgZmx1c2hpZHgrKztcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGNvbXBvbmVudC4kJCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCA9IDA7XG4gICAgICAgIGZsdXNoaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGJpbmRpbmdfY2FsbGJhY2tzLmxlbmd0aClcbiAgICAgICAgICAgIGJpbmRpbmdfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgIC8vIHRoZW4sIG9uY2UgY29tcG9uZW50cyBhcmUgdXBkYXRlZCwgY2FsbFxuICAgICAgICAvLyBhZnRlclVwZGF0ZSBmdW5jdGlvbnMuIFRoaXMgbWF5IGNhdXNlXG4gICAgICAgIC8vIHN1YnNlcXVlbnQgdXBkYXRlcy4uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gcmVuZGVyX2NhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgIGlmICghc2Vlbl9jYWxsYmFja3MuaGFzKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICAgIC8vIC4uLnNvIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgbG9vcHNcbiAgICAgICAgICAgICAgICBzZWVuX2NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgIH0gd2hpbGUgKGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKTtcbiAgICB3aGlsZSAoZmx1c2hfY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICBmbHVzaF9jYWxsYmFja3MucG9wKCkoKTtcbiAgICB9XG4gICAgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIHNlZW5fY2FsbGJhY2tzLmNsZWFyKCk7XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHNhdmVkX2NvbXBvbmVudCk7XG59XG5mdW5jdGlvbiB1cGRhdGUoJCQpIHtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgJCQudXBkYXRlKCk7XG4gICAgICAgIHJ1bl9hbGwoJCQuYmVmb3JlX3VwZGF0ZSk7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gJCQuZGlydHk7XG4gICAgICAgICQkLmRpcnR5ID0gWy0xXTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQucCgkJC5jdHgsIGRpcnR5KTtcbiAgICAgICAgJCQuYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG4gICAgfVxufVxuXG5sZXQgcHJvbWlzZTtcbmZ1bmN0aW9uIHdhaXQoKSB7XG4gICAgaWYgKCFwcm9taXNlKSB7XG4gICAgICAgIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5mdW5jdGlvbiBkaXNwYXRjaChub2RlLCBkaXJlY3Rpb24sIGtpbmQpIHtcbiAgICBub2RlLmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KGAke2RpcmVjdGlvbiA/ICdpbnRybycgOiAnb3V0cm8nfSR7a2luZH1gKSk7XG59XG5jb25zdCBvdXRyb2luZyA9IG5ldyBTZXQoKTtcbmxldCBvdXRyb3M7XG5mdW5jdGlvbiBncm91cF9vdXRyb3MoKSB7XG4gICAgb3V0cm9zID0ge1xuICAgICAgICByOiAwLFxuICAgICAgICBjOiBbXSxcbiAgICAgICAgcDogb3V0cm9zIC8vIHBhcmVudCBncm91cFxuICAgIH07XG59XG5mdW5jdGlvbiBjaGVja19vdXRyb3MoKSB7XG4gICAgaWYgKCFvdXRyb3Mucikge1xuICAgICAgICBydW5fYWxsKG91dHJvcy5jKTtcbiAgICB9XG4gICAgb3V0cm9zID0gb3V0cm9zLnA7XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX2luKGJsb2NrLCBsb2NhbCkge1xuICAgIGlmIChibG9jayAmJiBibG9jay5pKSB7XG4gICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgIGJsb2NrLmkobG9jYWwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25fb3V0KGJsb2NrLCBsb2NhbCwgZGV0YWNoLCBjYWxsYmFjaykge1xuICAgIGlmIChibG9jayAmJiBibG9jay5vKSB7XG4gICAgICAgIGlmIChvdXRyb2luZy5oYXMoYmxvY2spKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvdXRyb2luZy5hZGQoYmxvY2spO1xuICAgICAgICBvdXRyb3MuYy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoZGV0YWNoKVxuICAgICAgICAgICAgICAgICAgICBibG9jay5kKDEpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBibG9jay5vKGxvY2FsKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICB9XG59XG5jb25zdCBudWxsX3RyYW5zaXRpb24gPSB7IGR1cmF0aW9uOiAwIH07XG5mdW5jdGlvbiBjcmVhdGVfaW5fdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSBmYWxzZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IHVpZCA9IDA7XG4gICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMCwgMSwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcywgdWlkKyspO1xuICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGlmICh0YXNrKVxuICAgICAgICAgICAgdGFzay5hYm9ydCgpO1xuICAgICAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCB0cnVlLCAnc3RhcnQnKSk7XG4gICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0KCkge1xuICAgICAgICAgICAgaWYgKHN0YXJ0ZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlKTtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oZ28pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW52YWxpZGF0ZSgpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBjb25zdCBncm91cCA9IG91dHJvcztcbiAgICBncm91cC5yICs9IDE7XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDEsIDAsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdzdGFydCcpKTtcbiAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghLS1ncm91cC5yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmVzdWx0IGluIGBlbmQoKWAgYmVpbmcgY2FsbGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgZG9uJ3QgbmVlZCB0byBjbGVhbiB1cCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKGdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEgLSB0LCB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBnbygpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBlbmQocmVzZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXNldCAmJiBjb25maWcudGljaykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy50aWNrKDEsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zLCBpbnRybykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCB0ID0gaW50cm8gPyAwIDogMTtcbiAgICBsZXQgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWUgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGNsZWFyX2FuaW1hdGlvbigpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbml0KHByb2dyYW0sIGR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGQgPSAocHJvZ3JhbS5iIC0gdCk7XG4gICAgICAgIGR1cmF0aW9uICo9IE1hdGguYWJzKGQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYTogdCxcbiAgICAgICAgICAgIGI6IHByb2dyYW0uYixcbiAgICAgICAgICAgIGQsXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIHN0YXJ0OiBwcm9ncmFtLnN0YXJ0LFxuICAgICAgICAgICAgZW5kOiBwcm9ncmFtLnN0YXJ0ICsgZHVyYXRpb24sXG4gICAgICAgICAgICBncm91cDogcHJvZ3JhbS5ncm91cFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbyhiKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSB7XG4gICAgICAgICAgICBzdGFydDogbm93KCkgKyBkZWxheSxcbiAgICAgICAgICAgIGJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFiKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgcHJvZ3JhbS5ncm91cCA9IG91dHJvcztcbiAgICAgICAgICAgIG91dHJvcy5yICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IHByb2dyYW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGludHJvLCBhbmQgdGhlcmUncyBhIGRlbGF5LCB3ZSBuZWVkIHRvIGRvXG4gICAgICAgICAgICAvLyBhbiBpbml0aWFsIHRpY2sgYW5kL29yIGFwcGx5IENTUyBhbmltYXRpb24gaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIGIsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGIpXG4gICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBiLCAnc3RhcnQnKSk7XG4gICAgICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdfcHJvZ3JhbSAmJiBub3cgPiBwZW5kaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwZW5kaW5nX3Byb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdzdGFydCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgcnVubmluZ19wcm9ncmFtLmIsIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbiwgMCwgZWFzaW5nLCBjb25maWcuY3NzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLmVuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0ID0gcnVubmluZ19wcm9ncmFtLmIsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtLmIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW50cm8g4oCUIHdlIGNhbiB0aWR5IHVwIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3V0cm8g4oCUIG5lZWRzIHRvIGJlIGNvb3JkaW5hdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghLS1ydW5uaW5nX3Byb2dyYW0uZ3JvdXAucilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwocnVubmluZ19wcm9ncmFtLmdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHJ1bm5pbmdfcHJvZ3JhbS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBydW5uaW5nX3Byb2dyYW0uYSArIHJ1bm5pbmdfcHJvZ3JhbS5kICogZWFzaW5nKHAgLyBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcnVuKGIpIHtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVfcHJvbWlzZShwcm9taXNlLCBpbmZvKSB7XG4gICAgY29uc3QgdG9rZW4gPSBpbmZvLnRva2VuID0ge307XG4gICAgZnVuY3Rpb24gdXBkYXRlKHR5cGUsIGluZGV4LCBrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmIChpbmZvLnRva2VuICE9PSB0b2tlbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHZhbHVlO1xuICAgICAgICBsZXQgY2hpbGRfY3R4ID0gaW5mby5jdHg7XG4gICAgICAgIGlmIChrZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2hpbGRfY3R4ID0gY2hpbGRfY3R4LnNsaWNlKCk7XG4gICAgICAgICAgICBjaGlsZF9jdHhba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJsb2NrID0gdHlwZSAmJiAoaW5mby5jdXJyZW50ID0gdHlwZSkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IG5lZWRzX2ZsdXNoID0gZmFsc2U7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrKSB7XG4gICAgICAgICAgICBpZiAoaW5mby5ibG9ja3MpIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaW5kZXggJiYgYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5ibG9ja3NbaV0gPT09IGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2NrLmQoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jKCk7XG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGJsb2NrLCAxKTtcbiAgICAgICAgICAgIGJsb2NrLm0oaW5mby5tb3VudCgpLCBpbmZvLmFuY2hvcik7XG4gICAgICAgICAgICBuZWVkc19mbHVzaCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5ibG9jayA9IGJsb2NrO1xuICAgICAgICBpZiAoaW5mby5ibG9ja3MpXG4gICAgICAgICAgICBpbmZvLmJsb2Nrc1tpbmRleF0gPSBibG9jaztcbiAgICAgICAgaWYgKG5lZWRzX2ZsdXNoKSB7XG4gICAgICAgICAgICBmbHVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChpc19wcm9taXNlKHByb21pc2UpKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgICAgIHByb21pc2UudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8uY2F0Y2gsIDIsIGluZm8uZXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgICAgIGlmICghaW5mby5oYXNDYXRjaCkge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gaWYgd2UgcHJldmlvdXNseSBoYWQgYSB0aGVuL2NhdGNoIGJsb2NrLCBkZXN0cm95IGl0XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8ucGVuZGluZykge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8ucGVuZGluZywgMCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby50aGVuKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSBwcm9taXNlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2goaW5mbywgY3R4LCBkaXJ0eSkge1xuICAgIGNvbnN0IGNoaWxkX2N0eCA9IGN0eC5zbGljZSgpO1xuICAgIGNvbnN0IHsgcmVzb2x2ZWQgfSA9IGluZm87XG4gICAgaWYgKGluZm8uY3VycmVudCA9PT0gaW5mby50aGVuKSB7XG4gICAgICAgIGNoaWxkX2N0eFtpbmZvLnZhbHVlXSA9IHJlc29sdmVkO1xuICAgIH1cbiAgICBpZiAoaW5mby5jdXJyZW50ID09PSBpbmZvLmNhdGNoKSB7XG4gICAgICAgIGNoaWxkX2N0eFtpbmZvLmVycm9yXSA9IHJlc29sdmVkO1xuICAgIH1cbiAgICBpbmZvLmJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG59XG5cbmNvbnN0IGdsb2JhbHMgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IHdpbmRvd1xuICAgIDogdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXG4gICAgICAgID8gZ2xvYmFsVGhpc1xuICAgICAgICA6IGdsb2JhbCk7XG5cbmZ1bmN0aW9uIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmQoMSk7XG4gICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xufVxuZnVuY3Rpb24gb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiB1cGRhdGVfa2V5ZWRfZWFjaChvbGRfYmxvY2tzLCBkaXJ0eSwgZ2V0X2tleSwgZHluYW1pYywgY3R4LCBsaXN0LCBsb29rdXAsIG5vZGUsIGRlc3Ryb3ksIGNyZWF0ZV9lYWNoX2Jsb2NrLCBuZXh0LCBnZXRfY29udGV4dCkge1xuICAgIGxldCBvID0gb2xkX2Jsb2Nrcy5sZW5ndGg7XG4gICAgbGV0IG4gPSBsaXN0Lmxlbmd0aDtcbiAgICBsZXQgaSA9IG87XG4gICAgY29uc3Qgb2xkX2luZGV4ZXMgPSB7fTtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBvbGRfaW5kZXhlc1tvbGRfYmxvY2tzW2ldLmtleV0gPSBpO1xuICAgIGNvbnN0IG5ld19ibG9ja3MgPSBbXTtcbiAgICBjb25zdCBuZXdfbG9va3VwID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGRlbHRhcyA9IG5ldyBNYXAoKTtcbiAgICBpID0gbjtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkX2N0eCA9IGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSk7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IGJsb2NrID0gbG9va3VwLmdldChrZXkpO1xuICAgICAgICBpZiAoIWJsb2NrKSB7XG4gICAgICAgICAgICBibG9jayA9IGNyZWF0ZV9lYWNoX2Jsb2NrKGtleSwgY2hpbGRfY3R4KTtcbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkeW5hbWljKSB7XG4gICAgICAgICAgICBibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xuICAgICAgICB9XG4gICAgICAgIG5ld19sb29rdXAuc2V0KGtleSwgbmV3X2Jsb2Nrc1tpXSA9IGJsb2NrKTtcbiAgICAgICAgaWYgKGtleSBpbiBvbGRfaW5kZXhlcylcbiAgICAgICAgICAgIGRlbHRhcy5zZXQoa2V5LCBNYXRoLmFicyhpIC0gb2xkX2luZGV4ZXNba2V5XSkpO1xuICAgIH1cbiAgICBjb25zdCB3aWxsX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgZGlkX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgZnVuY3Rpb24gaW5zZXJ0KGJsb2NrKSB7XG4gICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICBibG9jay5tKG5vZGUsIG5leHQpO1xuICAgICAgICBsb29rdXAuc2V0KGJsb2NrLmtleSwgYmxvY2spO1xuICAgICAgICBuZXh0ID0gYmxvY2suZmlyc3Q7XG4gICAgICAgIG4tLTtcbiAgICB9XG4gICAgd2hpbGUgKG8gJiYgbikge1xuICAgICAgICBjb25zdCBuZXdfYmxvY2sgPSBuZXdfYmxvY2tzW24gLSAxXTtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvIC0gMV07XG4gICAgICAgIGNvbnN0IG5ld19rZXkgPSBuZXdfYmxvY2sua2V5O1xuICAgICAgICBjb25zdCBvbGRfa2V5ID0gb2xkX2Jsb2NrLmtleTtcbiAgICAgICAgaWYgKG5ld19ibG9jayA9PT0gb2xkX2Jsb2NrKSB7XG4gICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICBuZXh0ID0gbmV3X2Jsb2NrLmZpcnN0O1xuICAgICAgICAgICAgby0tO1xuICAgICAgICAgICAgbi0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBibG9ja1xuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWxvb2t1cC5oYXMobmV3X2tleSkgfHwgd2lsbF9tb3ZlLmhhcyhuZXdfa2V5KSkge1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlkX21vdmUuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVsdGFzLmdldChuZXdfa2V5KSA+IGRlbHRhcy5nZXQob2xkX2tleSkpIHtcbiAgICAgICAgICAgIGRpZF9tb3ZlLmFkZChuZXdfa2V5KTtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgd2lsbF9tb3ZlLmFkZChvbGRfa2V5KTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAoby0tKSB7XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3Nbb107XG4gICAgICAgIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2Jsb2NrLmtleSkpXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICB9XG4gICAgd2hpbGUgKG4pXG4gICAgICAgIGluc2VydChuZXdfYmxvY2tzW24gLSAxXSk7XG4gICAgcmV0dXJuIG5ld19ibG9ja3M7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2tleXMoY3R4LCBsaXN0LCBnZXRfY29udGV4dCwgZ2V0X2tleSkge1xuICAgIGNvbnN0IGtleXMgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKSk7XG4gICAgICAgIGlmIChrZXlzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBoYXZlIGR1cGxpY2F0ZSBrZXlzIGluIGEga2V5ZWQgZWFjaCcpO1xuICAgICAgICB9XG4gICAgICAgIGtleXMuYWRkKGtleSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRfc3ByZWFkX3VwZGF0ZShsZXZlbHMsIHVwZGF0ZXMpIHtcbiAgICBjb25zdCB1cGRhdGUgPSB7fTtcbiAgICBjb25zdCB0b19udWxsX291dCA9IHt9O1xuICAgIGNvbnN0IGFjY291bnRlZF9mb3IgPSB7ICQkc2NvcGU6IDEgfTtcbiAgICBsZXQgaSA9IGxldmVscy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBvID0gbGV2ZWxzW2ldO1xuICAgICAgICBjb25zdCBuID0gdXBkYXRlc1tpXTtcbiAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gbikpXG4gICAgICAgICAgICAgICAgICAgIHRvX251bGxfb3V0W2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbikge1xuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudGVkX2ZvcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gbltrZXldO1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldmVsc1tpXSA9IG47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0b19udWxsX291dCkge1xuICAgICAgICBpZiAoIShrZXkgaW4gdXBkYXRlKSlcbiAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlO1xufVxuZnVuY3Rpb24gZ2V0X3NwcmVhZF9vYmplY3Qoc3ByZWFkX3Byb3BzKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBzcHJlYWRfcHJvcHMgPT09ICdvYmplY3QnICYmIHNwcmVhZF9wcm9wcyAhPT0gbnVsbCA/IHNwcmVhZF9wcm9wcyA6IHt9O1xufVxuXG4vLyBzb3VyY2U6IGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbFxuY29uc3QgYm9vbGVhbl9hdHRyaWJ1dGVzID0gbmV3IFNldChbXG4gICAgJ2FsbG93ZnVsbHNjcmVlbicsXG4gICAgJ2FsbG93cGF5bWVudHJlcXVlc3QnLFxuICAgICdhc3luYycsXG4gICAgJ2F1dG9mb2N1cycsXG4gICAgJ2F1dG9wbGF5JyxcbiAgICAnY2hlY2tlZCcsXG4gICAgJ2NvbnRyb2xzJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RlZmVyJyxcbiAgICAnZGlzYWJsZWQnLFxuICAgICdmb3Jtbm92YWxpZGF0ZScsXG4gICAgJ2hpZGRlbicsXG4gICAgJ2lzbWFwJyxcbiAgICAnbG9vcCcsXG4gICAgJ211bHRpcGxlJyxcbiAgICAnbXV0ZWQnLFxuICAgICdub21vZHVsZScsXG4gICAgJ25vdmFsaWRhdGUnLFxuICAgICdvcGVuJyxcbiAgICAncGxheXNpbmxpbmUnLFxuICAgICdyZWFkb25seScsXG4gICAgJ3JlcXVpcmVkJyxcbiAgICAncmV2ZXJzZWQnLFxuICAgICdzZWxlY3RlZCdcbl0pO1xuXG5jb25zdCB2b2lkX2VsZW1lbnRfbmFtZXMgPSAvXig/OmFyZWF8YmFzZXxicnxjb2x8Y29tbWFuZHxlbWJlZHxocnxpbWd8aW5wdXR8a2V5Z2VufGxpbmt8bWV0YXxwYXJhbXxzb3VyY2V8dHJhY2t8d2JyKSQvO1xuZnVuY3Rpb24gaXNfdm9pZChuYW1lKSB7XG4gICAgcmV0dXJuIHZvaWRfZWxlbWVudF9uYW1lcy50ZXN0KG5hbWUpIHx8IG5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJyFkb2N0eXBlJztcbn1cblxuY29uc3QgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIgPSAvW1xccydcIj4vPVxcdXtGREQwfS1cXHV7RkRFRn1cXHV7RkZGRX1cXHV7RkZGRn1cXHV7MUZGRkV9XFx1ezFGRkZGfVxcdXsyRkZGRX1cXHV7MkZGRkZ9XFx1ezNGRkZFfVxcdXszRkZGRn1cXHV7NEZGRkV9XFx1ezRGRkZGfVxcdXs1RkZGRX1cXHV7NUZGRkZ9XFx1ezZGRkZFfVxcdXs2RkZGRn1cXHV7N0ZGRkV9XFx1ezdGRkZGfVxcdXs4RkZGRX1cXHV7OEZGRkZ9XFx1ezlGRkZFfVxcdXs5RkZGRn1cXHV7QUZGRkV9XFx1e0FGRkZGfVxcdXtCRkZGRX1cXHV7QkZGRkZ9XFx1e0NGRkZFfVxcdXtDRkZGRn1cXHV7REZGRkV9XFx1e0RGRkZGfVxcdXtFRkZGRX1cXHV7RUZGRkZ9XFx1e0ZGRkZFfVxcdXtGRkZGRn1cXHV7MTBGRkZFfVxcdXsxMEZGRkZ9XS91O1xuLy8gaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2Uvc3ludGF4Lmh0bWwjYXR0cmlidXRlcy0yXG4vLyBodHRwczovL2luZnJhLnNwZWMud2hhdHdnLm9yZy8jbm9uY2hhcmFjdGVyXG5mdW5jdGlvbiBzcHJlYWQoYXJncywgYXR0cnNfdG9fYWRkKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IE9iamVjdC5hc3NpZ24oe30sIC4uLmFyZ3MpO1xuICAgIGlmIChhdHRyc190b19hZGQpIHtcbiAgICAgICAgY29uc3QgY2xhc3Nlc190b19hZGQgPSBhdHRyc190b19hZGQuY2xhc3NlcztcbiAgICAgICAgY29uc3Qgc3R5bGVzX3RvX2FkZCA9IGF0dHJzX3RvX2FkZC5zdHlsZXM7XG4gICAgICAgIGlmIChjbGFzc2VzX3RvX2FkZCkge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuY2xhc3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgKz0gJyAnICsgY2xhc3Nlc190b19hZGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0eWxlc190b19hZGQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLnN0eWxlID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhzdHlsZXNfdG9fYWRkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuc3R5bGUgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKG1lcmdlX3Nzcl9zdHlsZXMoYXR0cmlidXRlcy5zdHlsZSwgc3R5bGVzX3RvX2FkZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBzdHIgPSAnJztcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBpZiAoaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIudGVzdChuYW1lKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUgPT09IHRydWUpXG4gICAgICAgICAgICBzdHIgKz0gJyAnICsgbmFtZTtcbiAgICAgICAgZWxzZSBpZiAoYm9vbGVhbl9hdHRyaWJ1dGVzLmhhcyhuYW1lLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RyICs9IGAgJHtuYW1lfT1cIiR7dmFsdWV9XCJgO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHN0cjtcbn1cbmZ1bmN0aW9uIG1lcmdlX3Nzcl9zdHlsZXMoc3R5bGVfYXR0cmlidXRlLCBzdHlsZV9kaXJlY3RpdmUpIHtcbiAgICBjb25zdCBzdHlsZV9vYmplY3QgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGluZGl2aWR1YWxfc3R5bGUgb2Ygc3R5bGVfYXR0cmlidXRlLnNwbGl0KCc7JykpIHtcbiAgICAgICAgY29uc3QgY29sb25faW5kZXggPSBpbmRpdmlkdWFsX3N0eWxlLmluZGV4T2YoJzonKTtcbiAgICAgICAgY29uc3QgbmFtZSA9IGluZGl2aWR1YWxfc3R5bGUuc2xpY2UoMCwgY29sb25faW5kZXgpLnRyaW0oKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBpbmRpdmlkdWFsX3N0eWxlLnNsaWNlKGNvbG9uX2luZGV4ICsgMSkudHJpbSgpO1xuICAgICAgICBpZiAoIW5hbWUpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgc3R5bGVfb2JqZWN0W25hbWVdID0gdmFsdWU7XG4gICAgfVxuICAgIGZvciAoY29uc3QgbmFtZSBpbiBzdHlsZV9kaXJlY3RpdmUpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBzdHlsZV9kaXJlY3RpdmVbbmFtZV07XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgc3R5bGVfb2JqZWN0W25hbWVdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgc3R5bGVfb2JqZWN0W25hbWVdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdHlsZV9vYmplY3Q7XG59XG5jb25zdCBBVFRSX1JFR0VYID0gL1smXCJdL2c7XG5jb25zdCBDT05URU5UX1JFR0VYID0gL1smPF0vZztcbi8qKlxuICogTm90ZTogdGhpcyBtZXRob2QgaXMgcGVyZm9ybWFuY2Ugc2Vuc2l0aXZlIGFuZCBoYXMgYmVlbiBvcHRpbWl6ZWRcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zdmVsdGVqcy9zdmVsdGUvcHVsbC81NzAxXG4gKi9cbmZ1bmN0aW9uIGVzY2FwZSh2YWx1ZSwgaXNfYXR0ciA9IGZhbHNlKSB7XG4gICAgY29uc3Qgc3RyID0gU3RyaW5nKHZhbHVlKTtcbiAgICBjb25zdCBwYXR0ZXJuID0gaXNfYXR0ciA/IEFUVFJfUkVHRVggOiBDT05URU5UX1JFR0VYO1xuICAgIHBhdHRlcm4ubGFzdEluZGV4ID0gMDtcbiAgICBsZXQgZXNjYXBlZCA9ICcnO1xuICAgIGxldCBsYXN0ID0gMDtcbiAgICB3aGlsZSAocGF0dGVybi50ZXN0KHN0cikpIHtcbiAgICAgICAgY29uc3QgaSA9IHBhdHRlcm4ubGFzdEluZGV4IC0gMTtcbiAgICAgICAgY29uc3QgY2ggPSBzdHJbaV07XG4gICAgICAgIGVzY2FwZWQgKz0gc3RyLnN1YnN0cmluZyhsYXN0LCBpKSArIChjaCA9PT0gJyYnID8gJyZhbXA7JyA6IChjaCA9PT0gJ1wiJyA/ICcmcXVvdDsnIDogJyZsdDsnKSk7XG4gICAgICAgIGxhc3QgPSBpICsgMTtcbiAgICB9XG4gICAgcmV0dXJuIGVzY2FwZWQgKyBzdHIuc3Vic3RyaW5nKGxhc3QpO1xufVxuZnVuY3Rpb24gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSh2YWx1ZSkge1xuICAgIC8vIGtlZXAgYm9vbGVhbnMsIG51bGwsIGFuZCB1bmRlZmluZWQgZm9yIHRoZSBzYWtlIG9mIGBzcHJlYWRgXG4gICAgY29uc3Qgc2hvdWxkX2VzY2FwZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpO1xuICAgIHJldHVybiBzaG91bGRfZXNjYXBlID8gZXNjYXBlKHZhbHVlLCB0cnVlKSA6IHZhbHVlO1xufVxuZnVuY3Rpb24gZXNjYXBlX29iamVjdChvYmopIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlKG9ialtrZXldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGVhY2goaXRlbXMsIGZuKSB7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgc3RyICs9IGZuKGl0ZW1zW2ldLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmNvbnN0IG1pc3NpbmdfY29tcG9uZW50ID0ge1xuICAgICQkcmVuZGVyOiAoKSA9PiAnJ1xufTtcbmZ1bmN0aW9uIHZhbGlkYXRlX2NvbXBvbmVudChjb21wb25lbnQsIG5hbWUpIHtcbiAgICBpZiAoIWNvbXBvbmVudCB8fCAhY29tcG9uZW50LiQkcmVuZGVyKSB7XG4gICAgICAgIGlmIChuYW1lID09PSAnc3ZlbHRlOmNvbXBvbmVudCcpXG4gICAgICAgICAgICBuYW1lICs9ICcgdGhpcz17Li4ufSc7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPCR7bmFtZX0+IGlzIG5vdCBhIHZhbGlkIFNTUiBjb21wb25lbnQuIFlvdSBtYXkgbmVlZCB0byByZXZpZXcgeW91ciBidWlsZCBjb25maWcgdG8gZW5zdXJlIHRoYXQgZGVwZW5kZW5jaWVzIGFyZSBjb21waWxlZCwgcmF0aGVyIHRoYW4gaW1wb3J0ZWQgYXMgcHJlLWNvbXBpbGVkIG1vZHVsZXNgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGRlYnVnKGZpbGUsIGxpbmUsIGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgY29uc29sZS5sb2coYHtAZGVidWd9ICR7ZmlsZSA/IGZpbGUgKyAnICcgOiAnJ30oJHtsaW5lfToke2NvbHVtbn0pYCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiAnJztcbn1cbmxldCBvbl9kZXN0cm95O1xuZnVuY3Rpb24gY3JlYXRlX3Nzcl9jb21wb25lbnQoZm4pIHtcbiAgICBmdW5jdGlvbiAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMsIGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgICAgICBjb25zdCAkJCA9IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3ksXG4gICAgICAgICAgICBjb250ZXh0OiBuZXcgTWFwKGNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAgICAgLy8gdGhlc2Ugd2lsbCBiZSBpbW1lZGlhdGVseSBkaXNjYXJkZWRcbiAgICAgICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHsgJCQgfSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBmbihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMpO1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXI6IChwcm9wcyA9IHt9LCB7ICQkc2xvdHMgPSB7fSwgY29udGV4dCA9IG5ldyBNYXAoKSB9ID0ge30pID0+IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHsgdGl0bGU6ICcnLCBoZWFkOiAnJywgY3NzOiBuZXcgU2V0KCkgfTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCB7fSwgJCRzbG90cywgY29udGV4dCk7XG4gICAgICAgICAgICBydW5fYWxsKG9uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBodG1sLFxuICAgICAgICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBBcnJheS5mcm9tKHJlc3VsdC5jc3MpLm1hcChjc3MgPT4gY3NzLmNvZGUpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG51bGwgLy8gVE9ET1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGVhZDogcmVzdWx0LnRpdGxlICsgcmVzdWx0LmhlYWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgICQkcmVuZGVyXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGFkZF9hdHRyaWJ1dGUobmFtZSwgdmFsdWUsIGJvb2xlYW4pIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCAoYm9vbGVhbiAmJiAhdmFsdWUpKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgY29uc3QgYXNzaWdubWVudCA9IChib29sZWFuICYmIHZhbHVlID09PSB0cnVlKSA/ICcnIDogYD1cIiR7ZXNjYXBlKHZhbHVlLCB0cnVlKX1cImA7XG4gICAgcmV0dXJuIGAgJHtuYW1lfSR7YXNzaWdubWVudH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiAnJztcbn1cbmZ1bmN0aW9uIHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHN0eWxlX29iamVjdClcbiAgICAgICAgLmZpbHRlcihrZXkgPT4gc3R5bGVfb2JqZWN0W2tleV0pXG4gICAgICAgIC5tYXAoa2V5ID0+IGAke2tleX06ICR7c3R5bGVfb2JqZWN0W2tleV19O2ApXG4gICAgICAgIC5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBhZGRfc3R5bGVzKHN0eWxlX29iamVjdCkge1xuICAgIGNvbnN0IHN0eWxlcyA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KTtcbiAgICByZXR1cm4gc3R5bGVzID8gYCBzdHlsZT1cIiR7c3R5bGVzfVwiYCA6ICcnO1xufVxuXG5mdW5jdGlvbiBiaW5kKGNvbXBvbmVudCwgbmFtZSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBpbmRleCA9IGNvbXBvbmVudC4kJC5wcm9wc1tuYW1lXTtcbiAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb21wb25lbnQuJCQuYm91bmRbaW5kZXhdID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrKGNvbXBvbmVudC4kJC5jdHhbaW5kZXhdKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVfY29tcG9uZW50KGJsb2NrKSB7XG4gICAgYmxvY2sgJiYgYmxvY2suYygpO1xufVxuZnVuY3Rpb24gY2xhaW1fY29tcG9uZW50KGJsb2NrLCBwYXJlbnRfbm9kZXMpIHtcbiAgICBibG9jayAmJiBibG9jay5sKHBhcmVudF9ub2Rlcyk7XG59XG5mdW5jdGlvbiBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCB0YXJnZXQsIGFuY2hvciwgY3VzdG9tRWxlbWVudCkge1xuICAgIGNvbnN0IHsgZnJhZ21lbnQsIG9uX21vdW50LCBvbl9kZXN0cm95LCBhZnRlcl91cGRhdGUgfSA9IGNvbXBvbmVudC4kJDtcbiAgICBmcmFnbWVudCAmJiBmcmFnbWVudC5tKHRhcmdldCwgYW5jaG9yKTtcbiAgICBpZiAoIWN1c3RvbUVsZW1lbnQpIHtcbiAgICAgICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld19vbl9kZXN0cm95ID0gb25fbW91bnQubWFwKHJ1bikuZmlsdGVyKGlzX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICAgICAgb25fZGVzdHJveS5wdXNoKC4uLm5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEVkZ2UgY2FzZSAtIGNvbXBvbmVudCB3YXMgZGVzdHJveWVkIGltbWVkaWF0ZWx5LFxuICAgICAgICAgICAgICAgIC8vIG1vc3QgbGlrZWx5IGFzIGEgcmVzdWx0IG9mIGEgYmluZGluZyBpbml0aWFsaXNpbmdcbiAgICAgICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC4kJC5vbl9tb3VudCA9IFtdO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2NvbXBvbmVudChjb21wb25lbnQsIGRldGFjaGluZykge1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkO1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICBydW5fYWxsKCQkLm9uX2Rlc3Ryb3kpO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5kKGRldGFjaGluZyk7XG4gICAgICAgIC8vIFRPRE8gbnVsbCBvdXQgb3RoZXIgcmVmcywgaW5jbHVkaW5nIGNvbXBvbmVudC4kJCAoYnV0IG5lZWQgdG9cbiAgICAgICAgLy8gcHJlc2VydmUgZmluYWwgc3RhdGU/KVxuICAgICAgICAkJC5vbl9kZXN0cm95ID0gJCQuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICAkJC5jdHggPSBbXTtcbiAgICB9XG59XG5mdW5jdGlvbiBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSkge1xuICAgIGlmIChjb21wb25lbnQuJCQuZGlydHlbMF0gPT09IC0xKSB7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgICBzY2hlZHVsZV91cGRhdGUoKTtcbiAgICAgICAgY29tcG9uZW50LiQkLmRpcnR5LmZpbGwoMCk7XG4gICAgfVxuICAgIGNvbXBvbmVudC4kJC5kaXJ0eVsoaSAvIDMxKSB8IDBdIHw9ICgxIDw8IChpICUgMzEpKTtcbn1cbmZ1bmN0aW9uIGluaXQoY29tcG9uZW50LCBvcHRpb25zLCBpbnN0YW5jZSwgY3JlYXRlX2ZyYWdtZW50LCBub3RfZXF1YWwsIHByb3BzLCBhcHBlbmRfc3R5bGVzLCBkaXJ0eSA9IFstMV0pIHtcbiAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQgPSB7XG4gICAgICAgIGZyYWdtZW50OiBudWxsLFxuICAgICAgICBjdHg6IG51bGwsXG4gICAgICAgIC8vIHN0YXRlXG4gICAgICAgIHByb3BzLFxuICAgICAgICB1cGRhdGU6IG5vb3AsXG4gICAgICAgIG5vdF9lcXVhbCxcbiAgICAgICAgYm91bmQ6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICAvLyBsaWZlY3ljbGVcbiAgICAgICAgb25fbW91bnQ6IFtdLFxuICAgICAgICBvbl9kZXN0cm95OiBbXSxcbiAgICAgICAgb25fZGlzY29ubmVjdDogW10sXG4gICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICBhZnRlcl91cGRhdGU6IFtdLFxuICAgICAgICBjb250ZXh0OiBuZXcgTWFwKG9wdGlvbnMuY29udGV4dCB8fCAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSksXG4gICAgICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZVxuICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICBkaXJ0eSxcbiAgICAgICAgc2tpcF9ib3VuZDogZmFsc2UsXG4gICAgICAgIHJvb3Q6IG9wdGlvbnMudGFyZ2V0IHx8IHBhcmVudF9jb21wb25lbnQuJCQucm9vdFxuICAgIH07XG4gICAgYXBwZW5kX3N0eWxlcyAmJiBhcHBlbmRfc3R5bGVzKCQkLnJvb3QpO1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICQkLmN0eCA9IGluc3RhbmNlXG4gICAgICAgID8gaW5zdGFuY2UoY29tcG9uZW50LCBvcHRpb25zLnByb3BzIHx8IHt9LCAoaSwgcmV0LCAuLi5yZXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJlc3QubGVuZ3RoID8gcmVzdFswXSA6IHJldDtcbiAgICAgICAgICAgIGlmICgkJC5jdHggJiYgbm90X2VxdWFsKCQkLmN0eFtpXSwgJCQuY3R4W2ldID0gdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkJC5za2lwX2JvdW5kICYmICQkLmJvdW5kW2ldKVxuICAgICAgICAgICAgICAgICAgICAkJC5ib3VuZFtpXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlYWR5KVxuICAgICAgICAgICAgICAgICAgICBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KVxuICAgICAgICA6IFtdO1xuICAgICQkLnVwZGF0ZSgpO1xuICAgIHJlYWR5ID0gdHJ1ZTtcbiAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgIC8vIGBmYWxzZWAgYXMgYSBzcGVjaWFsIGNhc2Ugb2Ygbm8gRE9NIGNvbXBvbmVudFxuICAgICQkLmZyYWdtZW50ID0gY3JlYXRlX2ZyYWdtZW50ID8gY3JlYXRlX2ZyYWdtZW50KCQkLmN0eCkgOiBmYWxzZTtcbiAgICBpZiAob3B0aW9ucy50YXJnZXQpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaHlkcmF0ZSkge1xuICAgICAgICAgICAgc3RhcnRfaHlkcmF0aW5nKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGNoaWxkcmVuKG9wdGlvbnMudGFyZ2V0KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5sKG5vZGVzKTtcbiAgICAgICAgICAgIG5vZGVzLmZvckVhY2goZGV0YWNoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuaW50cm8pXG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGNvbXBvbmVudC4kJC5mcmFnbWVudCk7XG4gICAgICAgIG1vdW50X2NvbXBvbmVudChjb21wb25lbnQsIG9wdGlvbnMudGFyZ2V0LCBvcHRpb25zLmFuY2hvciwgb3B0aW9ucy5jdXN0b21FbGVtZW50KTtcbiAgICAgICAgZW5kX2h5ZHJhdGluZygpO1xuICAgICAgICBmbHVzaCgpO1xuICAgIH1cbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG59XG5sZXQgU3ZlbHRlRWxlbWVudDtcbmlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBTdmVsdGVFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgY29uc3QgeyBvbl9tb3VudCB9ID0gdGhpcy4kJDtcbiAgICAgICAgICAgIHRoaXMuJCQub25fZGlzY29ubmVjdCA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy4kJC5zbG90dGVkKSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHRoaXMuJCQuc2xvdHRlZFtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2soYXR0ciwgX29sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdGhpc1thdHRyXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgcnVuX2FsbCh0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QpO1xuICAgICAgICB9XG4gICAgICAgICRkZXN0cm95KCkge1xuICAgICAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICAgICAgfVxuICAgICAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIC8vIFRPRE8gc2hvdWxkIHRoaXMgZGVsZWdhdGUgdG8gYWRkRXZlbnRMaXN0ZW5lcj9cbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBTdmVsdGUgY29tcG9uZW50cy4gVXNlZCB3aGVuIGRldj1mYWxzZS5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgIH1cbiAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2hfZGV2KHR5cGUsIGRldGFpbCkge1xuICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KHR5cGUsIE9iamVjdC5hc3NpZ24oeyB2ZXJzaW9uOiAnMy40OS4wJyB9LCBkZXRhaWwpLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG59XG5mdW5jdGlvbiBpbnNlcnRfZGV2KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uX2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQodGFnKSB7XG4gICAgY29uc3QgaXNfc3RyaW5nID0gdHlwZW9mIHRhZyA9PT0gJ3N0cmluZyc7XG4gICAgaWYgKHRhZyAmJiAhaXNfc3RyaW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignPHN2ZWx0ZTplbGVtZW50PiBleHBlY3RzIFwidGhpc1wiIGF0dHJpYnV0ZSB0byBiZSBhIHN0cmluZy4nKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCh0YWcpIHtcbiAgICBpZiAodGFnICYmIGlzX3ZvaWQodGFnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDxzdmVsdGU6ZWxlbWVudCB0aGlzPVwiJHt0YWd9XCI+IGlzIHNlbGYtY2xvc2luZyBhbmQgY2Fubm90IGhhdmUgY29udGVudC5gKTtcbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwYXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBIdG1sVGFnSHlkcmF0aW9uLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3N0eWxlcywgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQsIGFwcGVuZF9oeWRyYXRpb24sIGFwcGVuZF9oeWRyYXRpb25fZGV2LCBhcHBlbmRfc3R5bGVzLCBhc3NpZ24sIGF0dHIsIGF0dHJfZGV2LCBhdHRyaWJ1dGVfdG9fb2JqZWN0LCBiZWZvcmVVcGRhdGUsIGJpbmQsIGJpbmRpbmdfY2FsbGJhY2tzLCBibGFua19vYmplY3QsIGJ1YmJsZSwgY2hlY2tfb3V0cm9zLCBjaGlsZHJlbiwgY2xhaW1fY29tcG9uZW50LCBjbGFpbV9lbGVtZW50LCBjbGFpbV9odG1sX3RhZywgY2xhaW1fc3BhY2UsIGNsYWltX3N2Z19lbGVtZW50LCBjbGFpbV90ZXh0LCBjbGVhcl9sb29wcywgY29tcG9uZW50X3N1YnNjcmliZSwgY29tcHV0ZV9yZXN0X3Byb3BzLCBjb21wdXRlX3Nsb3RzLCBjcmVhdGVFdmVudERpc3BhdGNoZXIsIGNyZWF0ZV9hbmltYXRpb24sIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24sIGNyZWF0ZV9jb21wb25lbnQsIGNyZWF0ZV9pbl90cmFuc2l0aW9uLCBjcmVhdGVfb3V0X3RyYW5zaXRpb24sIGNyZWF0ZV9zbG90LCBjcmVhdGVfc3NyX2NvbXBvbmVudCwgY3VycmVudF9jb21wb25lbnQsIGN1c3RvbV9ldmVudCwgZGF0YXNldF9kZXYsIGRlYnVnLCBkZXN0cm95X2Jsb2NrLCBkZXN0cm95X2NvbXBvbmVudCwgZGVzdHJveV9lYWNoLCBkZXRhY2gsIGRldGFjaF9hZnRlcl9kZXYsIGRldGFjaF9iZWZvcmVfZGV2LCBkZXRhY2hfYmV0d2Vlbl9kZXYsIGRldGFjaF9kZXYsIGRpcnR5X2NvbXBvbmVudHMsIGRpc3BhdGNoX2RldiwgZWFjaCwgZWxlbWVudCwgZWxlbWVudF9pcywgZW1wdHksIGVuZF9oeWRyYXRpbmcsIGVzY2FwZSwgZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSwgZXNjYXBlX29iamVjdCwgZXhjbHVkZV9pbnRlcm5hbF9wcm9wcywgZml4X2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfcG9zaXRpb24sIGZsdXNoLCBnZXRBbGxDb250ZXh0cywgZ2V0Q29udGV4dCwgZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlLCBnZXRfYmluZGluZ19ncm91cF92YWx1ZSwgZ2V0X2N1cnJlbnRfY29tcG9uZW50LCBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzLCBnZXRfcm9vdF9mb3Jfc3R5bGUsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW5zZXJ0X2h5ZHJhdGlvbiwgaW5zZXJ0X2h5ZHJhdGlvbl9kZXYsIGludHJvcywgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIsIGlzX2NsaWVudCwgaXNfY3Jvc3NvcmlnaW4sIGlzX2VtcHR5LCBpc19mdW5jdGlvbiwgaXNfcHJvbWlzZSwgaXNfdm9pZCwgbGlzdGVuLCBsaXN0ZW5fZGV2LCBsb29wLCBsb29wX2d1YXJkLCBtZXJnZV9zc3Jfc3R5bGVzLCBtaXNzaW5nX2NvbXBvbmVudCwgbW91bnRfY29tcG9uZW50LCBub29wLCBub3RfZXF1YWwsIG5vdywgbnVsbF90b19lbXB0eSwgb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcywgb25EZXN0cm95LCBvbk1vdW50LCBvbmNlLCBvdXRyb19hbmRfZGVzdHJveV9ibG9jaywgcHJldmVudF9kZWZhdWx0LCBwcm9wX2RldiwgcXVlcnlfc2VsZWN0b3JfYWxsLCByYWYsIHJ1biwgcnVuX2FsbCwgc2FmZV9ub3RfZXF1YWwsIHNjaGVkdWxlX3VwZGF0ZSwgc2VsZWN0X211bHRpcGxlX3ZhbHVlLCBzZWxlY3Rfb3B0aW9uLCBzZWxlY3Rfb3B0aW9ucywgc2VsZWN0X3ZhbHVlLCBzZWxmLCBzZXRDb250ZXh0LCBzZXRfYXR0cmlidXRlcywgc2V0X2N1cnJlbnRfY29tcG9uZW50LCBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YSwgc2V0X2RhdGEsIHNldF9kYXRhX2Rldiwgc2V0X2lucHV0X3R5cGUsIHNldF9pbnB1dF92YWx1ZSwgc2V0X25vdywgc2V0X3JhZiwgc2V0X3N0b3JlX3ZhbHVlLCBzZXRfc3R5bGUsIHNldF9zdmdfYXR0cmlidXRlcywgc3BhY2UsIHNwcmVhZCwgc3JjX3VybF9lcXVhbCwgc3RhcnRfaHlkcmF0aW5nLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB0cnVzdGVkLCB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoLCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X2Jhc2UsIHZhbGlkYXRlX2NvbXBvbmVudCwgdmFsaWRhdGVfZHluYW1pY19lbGVtZW50LCB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50LCB2YWxpZGF0ZV9lYWNoX2tleXMsIHZhbGlkYXRlX3Nsb3RzLCB2YWxpZGF0ZV9zdG9yZSwgdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQsIHhsaW5rX2F0dHIgfTtcbiIsIjxzY3JpcHQ+XG4gIGNvbnN0IGxlbiA9IDU7XG4gIGxldCBjb3VudCA9IDA7XG4gIGxldCBoYXNJbnRlcmFjdGVkID0gZmFsc2U7XG5cbiAgLy8gZnVuY3Rpb24gZm9yIHVwZGF0aW5nIGNvdW50IG9uIGlucHV0XG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBpZiAoIWhhc0ludGVyYWN0ZWQpIHtcbiAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKTtcbiAgfVxuPC9zY3JpcHQ+XG5cbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyOyBwYWRkaW5nLXRvcDogMWVtXCI+XG4gIDxpbWdcbiAgICBzcmM9XCJpbWFnZXMvdHJhamVjdG9yaWVze2NvdW50fS5zdmdcIlxuICAgIGFsdD1cIkludGVyYWN0aXZlIHBsb3QgZGlzcGxheWluZyB0aGUgdHJhamVjdG9yaWVzIG9mIHRoZSBSTCBhZ2VudCBvbiB0aGUgbWFwXCJcbiAgLz5cbiAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyO1wiPlxuICAgIDxwPlRyYWplY3RvcnkgYWZ0ZXIgY3VycmljdWx1bSBzdGVwIHtjb3VudCArIDF9PC9wPlxuICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBtaW49XCIwXCIgbWF4PVwie2xlbn1cIiB2YWx1ZT1cIjBcIiBvbjppbnB1dD17aW5wdXR9PlxuICAgIDxwIHN0eWxlPVwidHJhbnNpdGlvbjogMXMgb3BhY2l0eTsge2hhc0ludGVyYWN0ZWQgJiYgJ29wYWNpdHk6IDA7J31cIj5Nb3ZlIHRoZSBzbGlkZXIgdG8gY2hhbmdlIHRoZSBzdGVwITwvcD5cbiAgPC9kaXY+XG48L2Rpdj5cbiIsIjxzY3JpcHQ+XG4gIGNvbnN0IGxlbiA9IDk7XG4gIGxldCBjb3VudCA9IDE7XG4gIGxldCBoYXNJbnRlcmFjdGVkID0gZmFsc2U7XG5cbiAgLy8gZnVuY3Rpb24gZm9yIHVwZGF0aW5nIGNvdW50IG9uIGlucHV0XG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBpZiAoIWhhc0ludGVyYWN0ZWQpIHtcbiAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKTtcbiAgfVxuPC9zY3JpcHQ+XG5cbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPlxuICA8aW1nIFxuICAgIHNyYz1cImltYWdlcy8xNngxNl9iYWNre2NvdW50fV9zdWNjZXNzZXMuc3ZnXCJcbiAgICBhbHQ9XCJJbnRlcmFjdGl2ZSBwbG90IGRpc3BsYXlpbmcgdGhlIHN1Y2Nlc3MgcmF0ZSBvZiB0aGUgYmFjayBjdXJyaWN1bHVtIHBvbGljeSBvdmVyIHRoZSBudW1iZXIgb2YgY3VycmljdWx1bSBzdGVwc1wiXG4gIC8+IFxuICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXI7XCI+XG4gICAgPHA+eCA9IHtjb3VudH08L3A+XG4gICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIG1pbj1cIjFcIiBtYXg9XCJ7bGVufVwiIHZhbHVlPVwiMFwiIG9uOmlucHV0PXtpbnB1dH0+XG4gICAgPHAgc3R5bGU9XCJ0cmFuc2l0aW9uOiAxcyBvcGFjaXR5OyB7aGFzSW50ZXJhY3RlZCAmJiAnb3BhY2l0eTogMDsnfVwiPk1vdmUgdGhlIHNsaWRlciB0byBjaGFuZ2UgeCE8L3A+XG4gIDwvZGl2PiBcbjwvZGl2PlxuIiwiPHNjcmlwdD5cbiAgY29uc3QgbGVuID0gNDtcbiAgbGV0IGNvdW50ID0gMDtcbiAgbGV0IGhhc0ludGVyYWN0ZWQgPSBmYWxzZTtcblxuICAvLyBmdW5jdGlvbiBmb3IgdXBkYXRpbmcgY291bnQgb24gaW5wdXRcbiAgZnVuY3Rpb24gaW5wdXQoeCkge1xuICAgIGlmICghaGFzSW50ZXJhY3RlZCkge1xuICAgICAgaGFzSW50ZXJhY3RlZCA9IHRydWU7XG4gICAgfVxuICAgIGNvdW50ID0gcGFyc2VJbnQoeC50YXJnZXQudmFsdWUpXG4gIH1cbjwvc2NyaXB0PlxuXG48ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj4gXG4gIDxpbWcgXG4gICAgc3JjPVwiaW1hZ2VzLzE2eDE2X2luY3JlbWVudGFse2NvdW50fV9zdWNjZXNzZXMuc3ZnXCJcbiAgICBhbHQ9XCJJbnRlcmFjdGl2ZSBwbG90IGRpc3BsYXlpbmcgdGhlIHN1Y2Nlc3MgcmF0ZSBvZiB0aGUgaW5jcmVtZW50YWwgY3VycmljdWx1bSBwb2xpY3kgb3ZlciB0aGUgbnVtYmVyIG9mIGN1cnJpY3VsdW0gc3RlcHNcIlxuICAvPlxuICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjpjZW50ZXI7XCI+XG4gICAgPHA+eCA9IHtjb3VudH08L3A+XG4gICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIG1pbj1cIjBcIiBtYXg9XCJ7bGVufVwiIHZhbHVlPVwiMFwiIG9uOmlucHV0PXtpbnB1dH0+XG4gICAgPHAgc3R5bGU9XCJ0cmFuc2l0aW9uOiAxcyBvcGFjaXR5OyB7aGFzSW50ZXJhY3RlZCAmJiAnb3BhY2l0eTogMDsnfVwiPk1vdmUgdGhlIHNsaWRlciB0byBjaGFuZ2UgeCE8L3A+XG4gIDwvZGl2PlxuPC9kaXY+XG4iLCJpbXBvcnQgeyBub29wLCBzYWZlX25vdF9lcXVhbCwgc3Vic2NyaWJlLCBydW5fYWxsLCBpc19mdW5jdGlvbiB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5leHBvcnQgeyBnZXRfc3RvcmVfdmFsdWUgYXMgZ2V0IH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcblxuY29uc3Qgc3Vic2NyaWJlcl9xdWV1ZSA9IFtdO1xuLyoqXG4gKiBDcmVhdGVzIGEgYFJlYWRhYmxlYCBzdG9yZSB0aGF0IGFsbG93cyByZWFkaW5nIGJ5IHN1YnNjcmlwdGlvbi5cbiAqIEBwYXJhbSB2YWx1ZSBpbml0aWFsIHZhbHVlXG4gKiBAcGFyYW0ge1N0YXJ0U3RvcE5vdGlmaWVyfXN0YXJ0IHN0YXJ0IGFuZCBzdG9wIG5vdGlmaWNhdGlvbnMgZm9yIHN1YnNjcmlwdGlvbnNcbiAqL1xuZnVuY3Rpb24gcmVhZGFibGUodmFsdWUsIHN0YXJ0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3Vic2NyaWJlOiB3cml0YWJsZSh2YWx1ZSwgc3RhcnQpLnN1YnNjcmliZVxuICAgIH07XG59XG4vKipcbiAqIENyZWF0ZSBhIGBXcml0YWJsZWAgc3RvcmUgdGhhdCBhbGxvd3MgYm90aCB1cGRhdGluZyBhbmQgcmVhZGluZyBieSBzdWJzY3JpcHRpb24uXG4gKiBAcGFyYW0geyo9fXZhbHVlIGluaXRpYWwgdmFsdWVcbiAqIEBwYXJhbSB7U3RhcnRTdG9wTm90aWZpZXI9fXN0YXJ0IHN0YXJ0IGFuZCBzdG9wIG5vdGlmaWNhdGlvbnMgZm9yIHN1YnNjcmlwdGlvbnNcbiAqL1xuZnVuY3Rpb24gd3JpdGFibGUodmFsdWUsIHN0YXJ0ID0gbm9vcCkge1xuICAgIGxldCBzdG9wO1xuICAgIGNvbnN0IHN1YnNjcmliZXJzID0gbmV3IFNldCgpO1xuICAgIGZ1bmN0aW9uIHNldChuZXdfdmFsdWUpIHtcbiAgICAgICAgaWYgKHNhZmVfbm90X2VxdWFsKHZhbHVlLCBuZXdfdmFsdWUpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgICAgIGlmIChzdG9wKSB7IC8vIHN0b3JlIGlzIHJlYWR5XG4gICAgICAgICAgICAgICAgY29uc3QgcnVuX3F1ZXVlID0gIXN1YnNjcmliZXJfcXVldWUubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaWJlciBvZiBzdWJzY3JpYmVycykge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyWzFdKCk7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXJfcXVldWUucHVzaChzdWJzY3JpYmVyLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydW5fcXVldWUpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdWJzY3JpYmVyX3F1ZXVlLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyX3F1ZXVlW2ldWzBdKHN1YnNjcmliZXJfcXVldWVbaSArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyX3F1ZXVlLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZShmbikge1xuICAgICAgICBzZXQoZm4odmFsdWUpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc3Vic2NyaWJlKHJ1biwgaW52YWxpZGF0ZSA9IG5vb3ApIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaWJlciA9IFtydW4sIGludmFsaWRhdGVdO1xuICAgICAgICBzdWJzY3JpYmVycy5hZGQoc3Vic2NyaWJlcik7XG4gICAgICAgIGlmIChzdWJzY3JpYmVycy5zaXplID09PSAxKSB7XG4gICAgICAgICAgICBzdG9wID0gc3RhcnQoc2V0KSB8fCBub29wO1xuICAgICAgICB9XG4gICAgICAgIHJ1bih2YWx1ZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBzdWJzY3JpYmVycy5kZWxldGUoc3Vic2NyaWJlcik7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaWJlcnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHN0b3AoKTtcbiAgICAgICAgICAgICAgICBzdG9wID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc2V0LCB1cGRhdGUsIHN1YnNjcmliZSB9O1xufVxuZnVuY3Rpb24gZGVyaXZlZChzdG9yZXMsIGZuLCBpbml0aWFsX3ZhbHVlKSB7XG4gICAgY29uc3Qgc2luZ2xlID0gIUFycmF5LmlzQXJyYXkoc3RvcmVzKTtcbiAgICBjb25zdCBzdG9yZXNfYXJyYXkgPSBzaW5nbGVcbiAgICAgICAgPyBbc3RvcmVzXVxuICAgICAgICA6IHN0b3JlcztcbiAgICBjb25zdCBhdXRvID0gZm4ubGVuZ3RoIDwgMjtcbiAgICByZXR1cm4gcmVhZGFibGUoaW5pdGlhbF92YWx1ZSwgKHNldCkgPT4ge1xuICAgICAgICBsZXQgaW5pdGVkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgICAgICBsZXQgcGVuZGluZyA9IDA7XG4gICAgICAgIGxldCBjbGVhbnVwID0gbm9vcDtcbiAgICAgICAgY29uc3Qgc3luYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChwZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZm4oc2luZ2xlID8gdmFsdWVzWzBdIDogdmFsdWVzLCBzZXQpO1xuICAgICAgICAgICAgaWYgKGF1dG8pIHtcbiAgICAgICAgICAgICAgICBzZXQocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsZWFudXAgPSBpc19mdW5jdGlvbihyZXN1bHQpID8gcmVzdWx0IDogbm9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmVycyA9IHN0b3Jlc19hcnJheS5tYXAoKHN0b3JlLCBpKSA9PiBzdWJzY3JpYmUoc3RvcmUsICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdmFsdWVzW2ldID0gdmFsdWU7XG4gICAgICAgICAgICBwZW5kaW5nICY9IH4oMSA8PCBpKTtcbiAgICAgICAgICAgIGlmIChpbml0ZWQpIHtcbiAgICAgICAgICAgICAgICBzeW5jKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgIHBlbmRpbmcgfD0gKDEgPDwgaSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgaW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgc3luYygpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgICAgIHJ1bl9hbGwodW5zdWJzY3JpYmVycyk7XG4gICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCB7IGRlcml2ZWQsIHJlYWRhYmxlLCB3cml0YWJsZSB9O1xuIiwiZXhwb3J0IHsgaWRlbnRpdHkgYXMgbGluZWFyIH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcblxuLypcbkFkYXB0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vbWF0dGRlc2xcbkRpc3RyaWJ1dGVkIHVuZGVyIE1JVCBMaWNlbnNlIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXR0ZGVzbC9lYXNlcy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kXG4qL1xuZnVuY3Rpb24gYmFja0luT3V0KHQpIHtcbiAgICBjb25zdCBzID0gMS43MDE1OCAqIDEuNTI1O1xuICAgIGlmICgodCAqPSAyKSA8IDEpXG4gICAgICAgIHJldHVybiAwLjUgKiAodCAqIHQgKiAoKHMgKyAxKSAqIHQgLSBzKSk7XG4gICAgcmV0dXJuIDAuNSAqICgodCAtPSAyKSAqIHQgKiAoKHMgKyAxKSAqIHQgKyBzKSArIDIpO1xufVxuZnVuY3Rpb24gYmFja0luKHQpIHtcbiAgICBjb25zdCBzID0gMS43MDE1ODtcbiAgICByZXR1cm4gdCAqIHQgKiAoKHMgKyAxKSAqIHQgLSBzKTtcbn1cbmZ1bmN0aW9uIGJhY2tPdXQodCkge1xuICAgIGNvbnN0IHMgPSAxLjcwMTU4O1xuICAgIHJldHVybiAtLXQgKiB0ICogKChzICsgMSkgKiB0ICsgcykgKyAxO1xufVxuZnVuY3Rpb24gYm91bmNlT3V0KHQpIHtcbiAgICBjb25zdCBhID0gNC4wIC8gMTEuMDtcbiAgICBjb25zdCBiID0gOC4wIC8gMTEuMDtcbiAgICBjb25zdCBjID0gOS4wIC8gMTAuMDtcbiAgICBjb25zdCBjYSA9IDQzNTYuMCAvIDM2MS4wO1xuICAgIGNvbnN0IGNiID0gMzU0NDIuMCAvIDE4MDUuMDtcbiAgICBjb25zdCBjYyA9IDE2MDYxLjAgLyAxODA1LjA7XG4gICAgY29uc3QgdDIgPSB0ICogdDtcbiAgICByZXR1cm4gdCA8IGFcbiAgICAgICAgPyA3LjU2MjUgKiB0MlxuICAgICAgICA6IHQgPCBiXG4gICAgICAgICAgICA/IDkuMDc1ICogdDIgLSA5LjkgKiB0ICsgMy40XG4gICAgICAgICAgICA6IHQgPCBjXG4gICAgICAgICAgICAgICAgPyBjYSAqIHQyIC0gY2IgKiB0ICsgY2NcbiAgICAgICAgICAgICAgICA6IDEwLjggKiB0ICogdCAtIDIwLjUyICogdCArIDEwLjcyO1xufVxuZnVuY3Rpb24gYm91bmNlSW5PdXQodCkge1xuICAgIHJldHVybiB0IDwgMC41XG4gICAgICAgID8gMC41ICogKDEuMCAtIGJvdW5jZU91dCgxLjAgLSB0ICogMi4wKSlcbiAgICAgICAgOiAwLjUgKiBib3VuY2VPdXQodCAqIDIuMCAtIDEuMCkgKyAwLjU7XG59XG5mdW5jdGlvbiBib3VuY2VJbih0KSB7XG4gICAgcmV0dXJuIDEuMCAtIGJvdW5jZU91dCgxLjAgLSB0KTtcbn1cbmZ1bmN0aW9uIGNpcmNJbk91dCh0KSB7XG4gICAgaWYgKCh0ICo9IDIpIDwgMSlcbiAgICAgICAgcmV0dXJuIC0wLjUgKiAoTWF0aC5zcXJ0KDEgLSB0ICogdCkgLSAxKTtcbiAgICByZXR1cm4gMC41ICogKE1hdGguc3FydCgxIC0gKHQgLT0gMikgKiB0KSArIDEpO1xufVxuZnVuY3Rpb24gY2lyY0luKHQpIHtcbiAgICByZXR1cm4gMS4wIC0gTWF0aC5zcXJ0KDEuMCAtIHQgKiB0KTtcbn1cbmZ1bmN0aW9uIGNpcmNPdXQodCkge1xuICAgIHJldHVybiBNYXRoLnNxcnQoMSAtIC0tdCAqIHQpO1xufVxuZnVuY3Rpb24gY3ViaWNJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjUgPyA0LjAgKiB0ICogdCAqIHQgOiAwLjUgKiBNYXRoLnBvdygyLjAgKiB0IC0gMi4wLCAzLjApICsgMS4wO1xufVxuZnVuY3Rpb24gY3ViaWNJbih0KSB7XG4gICAgcmV0dXJuIHQgKiB0ICogdDtcbn1cbmZ1bmN0aW9uIGN1YmljT3V0KHQpIHtcbiAgICBjb25zdCBmID0gdCAtIDEuMDtcbiAgICByZXR1cm4gZiAqIGYgKiBmICsgMS4wO1xufVxuZnVuY3Rpb24gZWxhc3RpY0luT3V0KHQpIHtcbiAgICByZXR1cm4gdCA8IDAuNVxuICAgICAgICA/IDAuNSAqXG4gICAgICAgICAgICBNYXRoLnNpbigoKCsxMy4wICogTWF0aC5QSSkgLyAyKSAqIDIuMCAqIHQpICpcbiAgICAgICAgICAgIE1hdGgucG93KDIuMCwgMTAuMCAqICgyLjAgKiB0IC0gMS4wKSlcbiAgICAgICAgOiAwLjUgKlxuICAgICAgICAgICAgTWF0aC5zaW4oKCgtMTMuMCAqIE1hdGguUEkpIC8gMikgKiAoMi4wICogdCAtIDEuMCArIDEuMCkpICpcbiAgICAgICAgICAgIE1hdGgucG93KDIuMCwgLTEwLjAgKiAoMi4wICogdCAtIDEuMCkpICtcbiAgICAgICAgICAgIDEuMDtcbn1cbmZ1bmN0aW9uIGVsYXN0aWNJbih0KSB7XG4gICAgcmV0dXJuIE1hdGguc2luKCgxMy4wICogdCAqIE1hdGguUEkpIC8gMikgKiBNYXRoLnBvdygyLjAsIDEwLjAgKiAodCAtIDEuMCkpO1xufVxuZnVuY3Rpb24gZWxhc3RpY091dCh0KSB7XG4gICAgcmV0dXJuIChNYXRoLnNpbigoLTEzLjAgKiAodCArIDEuMCkgKiBNYXRoLlBJKSAvIDIpICogTWF0aC5wb3coMi4wLCAtMTAuMCAqIHQpICsgMS4wKTtcbn1cbmZ1bmN0aW9uIGV4cG9Jbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPT09IDAuMCB8fCB0ID09PSAxLjBcbiAgICAgICAgPyB0XG4gICAgICAgIDogdCA8IDAuNVxuICAgICAgICAgICAgPyArMC41ICogTWF0aC5wb3coMi4wLCAyMC4wICogdCAtIDEwLjApXG4gICAgICAgICAgICA6IC0wLjUgKiBNYXRoLnBvdygyLjAsIDEwLjAgLSB0ICogMjAuMCkgKyAxLjA7XG59XG5mdW5jdGlvbiBleHBvSW4odCkge1xuICAgIHJldHVybiB0ID09PSAwLjAgPyB0IDogTWF0aC5wb3coMi4wLCAxMC4wICogKHQgLSAxLjApKTtcbn1cbmZ1bmN0aW9uIGV4cG9PdXQodCkge1xuICAgIHJldHVybiB0ID09PSAxLjAgPyB0IDogMS4wIC0gTWF0aC5wb3coMi4wLCAtMTAuMCAqIHQpO1xufVxuZnVuY3Rpb24gcXVhZEluT3V0KHQpIHtcbiAgICB0IC89IDAuNTtcbiAgICBpZiAodCA8IDEpXG4gICAgICAgIHJldHVybiAwLjUgKiB0ICogdDtcbiAgICB0LS07XG4gICAgcmV0dXJuIC0wLjUgKiAodCAqICh0IC0gMikgLSAxKTtcbn1cbmZ1bmN0aW9uIHF1YWRJbih0KSB7XG4gICAgcmV0dXJuIHQgKiB0O1xufVxuZnVuY3Rpb24gcXVhZE91dCh0KSB7XG4gICAgcmV0dXJuIC10ICogKHQgLSAyLjApO1xufVxuZnVuY3Rpb24gcXVhcnRJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjVcbiAgICAgICAgPyArOC4wICogTWF0aC5wb3codCwgNC4wKVxuICAgICAgICA6IC04LjAgKiBNYXRoLnBvdyh0IC0gMS4wLCA0LjApICsgMS4wO1xufVxuZnVuY3Rpb24gcXVhcnRJbih0KSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHQsIDQuMCk7XG59XG5mdW5jdGlvbiBxdWFydE91dCh0KSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHQgLSAxLjAsIDMuMCkgKiAoMS4wIC0gdCkgKyAxLjA7XG59XG5mdW5jdGlvbiBxdWludEluT3V0KHQpIHtcbiAgICBpZiAoKHQgKj0gMikgPCAxKVxuICAgICAgICByZXR1cm4gMC41ICogdCAqIHQgKiB0ICogdCAqIHQ7XG4gICAgcmV0dXJuIDAuNSAqICgodCAtPSAyKSAqIHQgKiB0ICogdCAqIHQgKyAyKTtcbn1cbmZ1bmN0aW9uIHF1aW50SW4odCkge1xuICAgIHJldHVybiB0ICogdCAqIHQgKiB0ICogdDtcbn1cbmZ1bmN0aW9uIHF1aW50T3V0KHQpIHtcbiAgICByZXR1cm4gLS10ICogdCAqIHQgKiB0ICogdCArIDE7XG59XG5mdW5jdGlvbiBzaW5lSW5PdXQodCkge1xuICAgIHJldHVybiAtMC41ICogKE1hdGguY29zKE1hdGguUEkgKiB0KSAtIDEpO1xufVxuZnVuY3Rpb24gc2luZUluKHQpIHtcbiAgICBjb25zdCB2ID0gTWF0aC5jb3ModCAqIE1hdGguUEkgKiAwLjUpO1xuICAgIGlmIChNYXRoLmFicyh2KSA8IDFlLTE0KVxuICAgICAgICByZXR1cm4gMTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiAxIC0gdjtcbn1cbmZ1bmN0aW9uIHNpbmVPdXQodCkge1xuICAgIHJldHVybiBNYXRoLnNpbigodCAqIE1hdGguUEkpIC8gMik7XG59XG5cbmV4cG9ydCB7IGJhY2tJbiwgYmFja0luT3V0LCBiYWNrT3V0LCBib3VuY2VJbiwgYm91bmNlSW5PdXQsIGJvdW5jZU91dCwgY2lyY0luLCBjaXJjSW5PdXQsIGNpcmNPdXQsIGN1YmljSW4sIGN1YmljSW5PdXQsIGN1YmljT3V0LCBlbGFzdGljSW4sIGVsYXN0aWNJbk91dCwgZWxhc3RpY091dCwgZXhwb0luLCBleHBvSW5PdXQsIGV4cG9PdXQsIHF1YWRJbiwgcXVhZEluT3V0LCBxdWFkT3V0LCBxdWFydEluLCBxdWFydEluT3V0LCBxdWFydE91dCwgcXVpbnRJbiwgcXVpbnRJbk91dCwgcXVpbnRPdXQsIHNpbmVJbiwgc2luZUluT3V0LCBzaW5lT3V0IH07XG4iLCJpbXBvcnQgeyB3cml0YWJsZSB9IGZyb20gJy4uL3N0b3JlL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBub3csIGxvb3AsIGFzc2lnbiB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBsaW5lYXIgfSBmcm9tICcuLi9lYXNpbmcvaW5kZXgubWpzJztcblxuZnVuY3Rpb24gaXNfZGF0ZShvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cblxuZnVuY3Rpb24gdGlja19zcHJpbmcoY3R4LCBsYXN0X3ZhbHVlLCBjdXJyZW50X3ZhbHVlLCB0YXJnZXRfdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIGN1cnJlbnRfdmFsdWUgPT09ICdudW1iZXInIHx8IGlzX2RhdGUoY3VycmVudF92YWx1ZSkpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBkZWx0YSA9IHRhcmdldF92YWx1ZSAtIGN1cnJlbnRfdmFsdWU7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgdmVsb2NpdHkgPSAoY3VycmVudF92YWx1ZSAtIGxhc3RfdmFsdWUpIC8gKGN0eC5kdCB8fCAxIC8gNjApOyAvLyBndWFyZCBkaXYgYnkgMFxuICAgICAgICBjb25zdCBzcHJpbmcgPSBjdHgub3B0cy5zdGlmZm5lc3MgKiBkZWx0YTtcbiAgICAgICAgY29uc3QgZGFtcGVyID0gY3R4Lm9wdHMuZGFtcGluZyAqIHZlbG9jaXR5O1xuICAgICAgICBjb25zdCBhY2NlbGVyYXRpb24gPSAoc3ByaW5nIC0gZGFtcGVyKSAqIGN0eC5pbnZfbWFzcztcbiAgICAgICAgY29uc3QgZCA9ICh2ZWxvY2l0eSArIGFjY2VsZXJhdGlvbikgKiBjdHguZHQ7XG4gICAgICAgIGlmIChNYXRoLmFicyhkKSA8IGN0eC5vcHRzLnByZWNpc2lvbiAmJiBNYXRoLmFicyhkZWx0YSkgPCBjdHgub3B0cy5wcmVjaXNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXRfdmFsdWU7IC8vIHNldHRsZWRcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN0eC5zZXR0bGVkID0gZmFsc2U7IC8vIHNpZ25hbCBsb29wIHRvIGtlZXAgdGlja2luZ1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgcmV0dXJuIGlzX2RhdGUoY3VycmVudF92YWx1ZSkgP1xuICAgICAgICAgICAgICAgIG5ldyBEYXRlKGN1cnJlbnRfdmFsdWUuZ2V0VGltZSgpICsgZCkgOiBjdXJyZW50X3ZhbHVlICsgZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGN1cnJlbnRfdmFsdWUpKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRfdmFsdWUubWFwKChfLCBpKSA9PiB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWVbaV0sIGN1cnJlbnRfdmFsdWVbaV0sIHRhcmdldF92YWx1ZVtpXSkpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgY3VycmVudF92YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgY29uc3QgbmV4dF92YWx1ZSA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGsgaW4gY3VycmVudF92YWx1ZSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgbmV4dF92YWx1ZVtrXSA9IHRpY2tfc3ByaW5nKGN0eCwgbGFzdF92YWx1ZVtrXSwgY3VycmVudF92YWx1ZVtrXSwgdGFyZ2V0X3ZhbHVlW2tdKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBuZXh0X3ZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3Qgc3ByaW5nICR7dHlwZW9mIGN1cnJlbnRfdmFsdWV9IHZhbHVlc2ApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNwcmluZyh2YWx1ZSwgb3B0cyA9IHt9KSB7XG4gICAgY29uc3Qgc3RvcmUgPSB3cml0YWJsZSh2YWx1ZSk7XG4gICAgY29uc3QgeyBzdGlmZm5lc3MgPSAwLjE1LCBkYW1waW5nID0gMC44LCBwcmVjaXNpb24gPSAwLjAxIH0gPSBvcHRzO1xuICAgIGxldCBsYXN0X3RpbWU7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IGN1cnJlbnRfdG9rZW47XG4gICAgbGV0IGxhc3RfdmFsdWUgPSB2YWx1ZTtcbiAgICBsZXQgdGFyZ2V0X3ZhbHVlID0gdmFsdWU7XG4gICAgbGV0IGludl9tYXNzID0gMTtcbiAgICBsZXQgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSA9IDA7XG4gICAgbGV0IGNhbmNlbF90YXNrID0gZmFsc2U7XG4gICAgZnVuY3Rpb24gc2V0KG5ld192YWx1ZSwgb3B0cyA9IHt9KSB7XG4gICAgICAgIHRhcmdldF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBjdXJyZW50X3Rva2VuID0ge307XG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IG9wdHMuaGFyZCB8fCAoc3ByaW5nLnN0aWZmbmVzcyA+PSAxICYmIHNwcmluZy5kYW1waW5nID49IDEpKSB7XG4gICAgICAgICAgICBjYW5jZWxfdGFzayA9IHRydWU7IC8vIGNhbmNlbCBhbnkgcnVubmluZyBhbmltYXRpb25cbiAgICAgICAgICAgIGxhc3RfdGltZSA9IG5vdygpO1xuICAgICAgICAgICAgbGFzdF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IHRhcmdldF92YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0cy5zb2Z0KSB7XG4gICAgICAgICAgICBjb25zdCByYXRlID0gb3B0cy5zb2Z0ID09PSB0cnVlID8gLjUgOiArb3B0cy5zb2Z0O1xuICAgICAgICAgICAgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSA9IDEgLyAocmF0ZSAqIDYwKTtcbiAgICAgICAgICAgIGludl9tYXNzID0gMDsgLy8gaW5maW5pdGUgbWFzcywgdW5hZmZlY3RlZCBieSBzcHJpbmcgZm9yY2VzXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YXNrKSB7XG4gICAgICAgICAgICBsYXN0X3RpbWUgPSBub3coKTtcbiAgICAgICAgICAgIGNhbmNlbF90YXNrID0gZmFsc2U7XG4gICAgICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjYW5jZWxfdGFzaykge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWxfdGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0YXNrID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnZfbWFzcyA9IE1hdGgubWluKGludl9tYXNzICsgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSwgMSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3R4ID0ge1xuICAgICAgICAgICAgICAgICAgICBpbnZfbWFzcyxcbiAgICAgICAgICAgICAgICAgICAgb3B0czogc3ByaW5nLFxuICAgICAgICAgICAgICAgICAgICBzZXR0bGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBkdDogKG5vdyAtIGxhc3RfdGltZSkgKiA2MCAvIDEwMDBcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRfdmFsdWUgPSB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWUsIHZhbHVlLCB0YXJnZXRfdmFsdWUpO1xuICAgICAgICAgICAgICAgIGxhc3RfdGltZSA9IG5vdztcbiAgICAgICAgICAgICAgICBsYXN0X3ZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gbmV4dF92YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5zZXR0bGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gIWN0eC5zZXR0bGVkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bGZpbCA9PiB7XG4gICAgICAgICAgICB0YXNrLnByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRva2VuID09PSBjdXJyZW50X3Rva2VuKVxuICAgICAgICAgICAgICAgICAgICBmdWxmaWwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc3ByaW5nID0ge1xuICAgICAgICBzZXQsXG4gICAgICAgIHVwZGF0ZTogKGZuLCBvcHRzKSA9PiBzZXQoZm4odGFyZ2V0X3ZhbHVlLCB2YWx1ZSksIG9wdHMpLFxuICAgICAgICBzdWJzY3JpYmU6IHN0b3JlLnN1YnNjcmliZSxcbiAgICAgICAgc3RpZmZuZXNzLFxuICAgICAgICBkYW1waW5nLFxuICAgICAgICBwcmVjaXNpb25cbiAgICB9O1xuICAgIHJldHVybiBzcHJpbmc7XG59XG5cbmZ1bmN0aW9uIGdldF9pbnRlcnBvbGF0b3IoYSwgYikge1xuICAgIGlmIChhID09PSBiIHx8IGEgIT09IGEpXG4gICAgICAgIHJldHVybiAoKSA9PiBhO1xuICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgYTtcbiAgICBpZiAodHlwZSAhPT0gdHlwZW9mIGIgfHwgQXJyYXkuaXNBcnJheShhKSAhPT0gQXJyYXkuaXNBcnJheShiKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbnRlcnBvbGF0ZSB2YWx1ZXMgb2YgZGlmZmVyZW50IHR5cGUnKTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYSkpIHtcbiAgICAgICAgY29uc3QgYXJyID0gYi5tYXAoKGJpLCBpKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0X2ludGVycG9sYXRvcihhW2ldLCBiaSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdCA9PiBhcnIubWFwKGZuID0+IGZuKHQpKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmICghYSB8fCAhYilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT2JqZWN0IGNhbm5vdCBiZSBudWxsJyk7XG4gICAgICAgIGlmIChpc19kYXRlKGEpICYmIGlzX2RhdGUoYikpIHtcbiAgICAgICAgICAgIGEgPSBhLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGIgPSBiLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGRlbHRhID0gYiAtIGE7XG4gICAgICAgICAgICByZXR1cm4gdCA9PiBuZXcgRGF0ZShhICsgdCAqIGRlbHRhKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYik7XG4gICAgICAgIGNvbnN0IGludGVycG9sYXRvcnMgPSB7fTtcbiAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpbnRlcnBvbGF0b3JzW2tleV0gPSBnZXRfaW50ZXJwb2xhdG9yKGFba2V5XSwgYltrZXldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBpbnRlcnBvbGF0b3JzW2tleV0odCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICBjb25zdCBkZWx0YSA9IGIgLSBhO1xuICAgICAgICByZXR1cm4gdCA9PiBhICsgdCAqIGRlbHRhO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBpbnRlcnBvbGF0ZSAke3R5cGV9IHZhbHVlc2ApO1xufVxuZnVuY3Rpb24gdHdlZW5lZCh2YWx1ZSwgZGVmYXVsdHMgPSB7fSkge1xuICAgIGNvbnN0IHN0b3JlID0gd3JpdGFibGUodmFsdWUpO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCB0YXJnZXRfdmFsdWUgPSB2YWx1ZTtcbiAgICBmdW5jdGlvbiBzZXQobmV3X3ZhbHVlLCBvcHRzKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgbGV0IHByZXZpb3VzX3Rhc2sgPSB0YXNrO1xuICAgICAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gNDAwLCBlYXNpbmcgPSBsaW5lYXIsIGludGVycG9sYXRlID0gZ2V0X2ludGVycG9sYXRvciB9ID0gYXNzaWduKGFzc2lnbih7fSwgZGVmYXVsdHMpLCBvcHRzKTtcbiAgICAgICAgaWYgKGR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgICBpZiAocHJldmlvdXNfdGFzaykge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2suYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IHRhcmdldF92YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhcnQgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBsZXQgZm47XG4gICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAobm93IDwgc3RhcnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBpZiAoIXN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICBmbiA9IGludGVycG9sYXRlKHZhbHVlLCBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZHVyYXRpb24gPT09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24odmFsdWUsIG5ld192YWx1ZSk7XG4gICAgICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldmlvdXNfdGFzaykge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2suYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSBzdGFydDtcbiAgICAgICAgICAgIGlmIChlbGFwc2VkID4gZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IGZuKGVhc2luZyhlbGFwc2VkIC8gZHVyYXRpb24pKSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0YXNrLnByb21pc2U7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHNldCxcbiAgICAgICAgdXBkYXRlOiAoZm4sIG9wdHMpID0+IHNldChmbih0YXJnZXRfdmFsdWUsIHZhbHVlKSwgb3B0cyksXG4gICAgICAgIHN1YnNjcmliZTogc3RvcmUuc3Vic2NyaWJlXG4gICAgfTtcbn1cblxuZXhwb3J0IHsgc3ByaW5nLCB0d2VlbmVkIH07XG4iLCI8c2NyaXB0PlxyXG4gIGltcG9ydCB7IG9uTW91bnQgfSBmcm9tIFwic3ZlbHRlXCJcclxuXHJcbiAgZXhwb3J0IGxldCBzaXplID0gMTBcclxuICBleHBvcnQgbGV0IHggPSBbLTAuNSwgMC41XVxyXG4gIGV4cG9ydCBsZXQgeSA9IFswLjI1LCAxXVxyXG4gIGV4cG9ydCBsZXQgZHVyYXRpb24gPSAyMDAwXHJcbiAgZXhwb3J0IGxldCBpbmZpbml0ZSA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCBkZWxheSA9IFswLCA1MF1cclxuICBleHBvcnQgbGV0IGNvbG9yUmFuZ2UgPSBbMCwgMzYwXVxyXG4gIGV4cG9ydCBsZXQgY29sb3JBcnJheSA9IFtdXHJcbiAgZXhwb3J0IGxldCBhbW91bnQgPSA1MFxyXG4gIGV4cG9ydCBsZXQgaXRlcmF0aW9uQ291bnQgPSAxXHJcbiAgZXhwb3J0IGxldCBmYWxsRGlzdGFuY2UgPSBcIjEwMHB4XCJcclxuICBleHBvcnQgbGV0IHJvdW5kZWQgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgY29uZSA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCBub0dyYXZpdHkgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgeFNwcmVhZCA9IDAuMTVcclxuICBleHBvcnQgbGV0IGRlc3Ryb3lPbkNvbXBsZXRlID0gdHJ1ZVxyXG5cclxuICBsZXQgY29tcGxldGUgPSBmYWxzZVxyXG5cclxuICBvbk1vdW50KCgpID0+IHtcclxuICAgIGlmICghZGVzdHJveU9uQ29tcGxldGUgfHwgaW5maW5pdGUgfHwgaXRlcmF0aW9uQ291bnQgPT0gXCJpbmZpbml0ZVwiKSByZXR1cm5cclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IGNvbXBsZXRlID0gdHJ1ZSwgKGR1cmF0aW9uICsgZGVsYXlbMV0pICogaXRlcmF0aW9uQ291bnQpXHJcbiAgfSlcclxuXHJcbiAgZnVuY3Rpb24gcmFuZG9tQmV0d2VlbihtaW4sIG1heCkge1xyXG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0Q29sb3IoKSB7XHJcbiAgICBpZiAoY29sb3JBcnJheS5sZW5ndGgpIHJldHVybiBjb2xvckFycmF5W01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChjb2xvckFycmF5Lmxlbmd0aCAtIDEpKV1cclxuICAgIGVsc2UgcmV0dXJuIGBoc2woJHtNYXRoLnJvdW5kKHJhbmRvbUJldHdlZW4oY29sb3JSYW5nZVswXSwgY29sb3JSYW5nZVsxXSkpfSwgNzUlLCA1MCVgXHJcbiAgfVxyXG48L3NjcmlwdD5cclxuXHJcblxyXG5cclxueyNpZiAhY29tcGxldGV9XHJcbiAgPGRpdiBjbGFzcz1cImNvbmZldHRpLWhvbGRlclwiIGNsYXNzOnJvdW5kZWQgY2xhc3M6Y29uZSBjbGFzczpuby1ncmF2aXR5PXtub0dyYXZpdHl9PlxyXG4gICAgeyNlYWNoIHsgbGVuZ3RoOiBhbW91bnQgfSBhcyBffVxyXG4gICAgICA8ZGl2XHJcbiAgICAgICAgY2xhc3M9XCJjb25mZXR0aVwiXHJcbiAgICAgICAgc3R5bGU9XCJcclxuICAgICAgICAtLWZhbGwtZGlzdGFuY2U6IHtmYWxsRGlzdGFuY2V9O1xyXG4gICAgICAgIC0tc2l6ZToge3NpemV9cHg7XHJcbiAgICAgICAgLS1jb2xvcjoge2dldENvbG9yKCl9O1xyXG4gICAgICAgIC0tc2tldzoge3JhbmRvbUJldHdlZW4oLTQ1LCA0NSl9ZGVnLHtyYW5kb21CZXR3ZWVuKC00NSwgNDUpfWRlZztcclxuICAgICAgICAtLXJvdGF0aW9uLXh5ejoge3JhbmRvbUJldHdlZW4oLTEwLCAxMCl9LCB7cmFuZG9tQmV0d2VlbigtMTAsIDEwKX0sIHtyYW5kb21CZXR3ZWVuKC0xMCwgMTApfTtcclxuICAgICAgICAtLXJvdGF0aW9uLWRlZzoge3JhbmRvbUJldHdlZW4oMCwgMzYwKX1kZWc7XHJcbiAgICAgICAgLS10cmFuc2xhdGUteS1tdWx0aXBsaWVyOiB7cmFuZG9tQmV0d2Vlbih5WzBdLCB5WzFdKX07XHJcbiAgICAgICAgLS10cmFuc2xhdGUteC1tdWx0aXBsaWVyOiB7cmFuZG9tQmV0d2Vlbih4WzBdLCB4WzFdKX07XHJcbiAgICAgICAgLS1zY2FsZTogezAuMSAqIHJhbmRvbUJldHdlZW4oMiwgMTApfTtcclxuICAgICAgICAtLXRyYW5zaXRpb24tZHVyYXRpb246IHtpbmZpbml0ZSA/IGBjYWxjKCR7ZHVyYXRpb259bXMgKiB2YXIoLS1zY2FsZSkpYCA6IGAke2R1cmF0aW9ufW1zYH07XHJcbiAgICAgICAgLS10cmFuc2l0aW9uLWRlbGF5OiB7cmFuZG9tQmV0d2VlbihkZWxheVswXSwgZGVsYXlbMV0pfW1zO1xyXG4gICAgICAgIC0tdHJhbnNpdGlvbi1pdGVyYXRpb24tY291bnQ6IHtpbmZpbml0ZSA/ICdpbmZpbml0ZScgOiBpdGVyYXRpb25Db3VudH07XHJcbiAgICAgICAgLS14LXNwcmVhZDogeygxIC0geFNwcmVhZCl9XCIgLz5cclxuICAgIHsvZWFjaH1cclxuICA8L2Rpdj5cclxuey9pZn1cclxuXHJcblxyXG5cclxuPHN0eWxlPlxyXG4gIC5jb25mZXR0aS1ob2xkZXIge1xyXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIH1cclxuXHJcbiAgQGtleWZyYW1lcyByb3RhdGUge1xyXG4gICAgMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHNrZXcodmFyKC0tc2tldykpIHJvdGF0ZTNkKHZhcigtLWZ1bGwtcm90YXRpb24pKTtcclxuICAgIH1cclxuXHJcbiAgICAxMDAlIHtcclxuICAgICAgdHJhbnNmb3JtOiBza2V3KHZhcigtLXNrZXcpKSByb3RhdGUzZCh2YXIoLS1yb3RhdGlvbi14eXopLCBjYWxjKHZhcigtLXJvdGF0aW9uLWRlZykgKyAzNjBkZWcpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBrZXlmcmFtZXMgdHJhbnNsYXRlIHtcclxuICAgIDAlIHtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICA4JSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWShjYWxjKHZhcigtLXRyYW5zbGF0ZS15KSAqIDAuOTUpKSB0cmFuc2xhdGVYKGNhbGModmFyKC0tdHJhbnNsYXRlLXgpICogKHZhcigtLXgtc3ByZWFkKSAqIDAuOSkpKTtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICAxMiUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkodmFyKC0tdHJhbnNsYXRlLXkpKSB0cmFuc2xhdGVYKGNhbGModmFyKC0tdHJhbnNsYXRlLXgpICogKHZhcigtLXgtc3ByZWFkKSAqIDAuOTUpKSk7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgMTYlIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKHZhcigtLXRyYW5zbGF0ZS15KSkgdHJhbnNsYXRlWChjYWxjKHZhcigtLXRyYW5zbGF0ZS14KSAqIHZhcigtLXgtc3ByZWFkKSkpO1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoY2FsYyh2YXIoLS10cmFuc2xhdGUteSkgKyB2YXIoLS1mYWxsLWRpc3RhbmNlKSkpIHRyYW5zbGF0ZVgodmFyKC0tdHJhbnNsYXRlLXgpKTtcclxuICAgICAgb3BhY2l0eTogMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBrZXlmcmFtZXMgbm8tZ3Jhdml0eS10cmFuc2xhdGUge1xyXG4gICAgMCUge1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkodmFyKC0tdHJhbnNsYXRlLXkpKSB0cmFuc2xhdGVYKHZhcigtLXRyYW5zbGF0ZS14KSk7XHJcbiAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAuY29uZmV0dGkge1xyXG4gICAgLS10cmFuc2xhdGUteTogY2FsYygtMjAwcHggKiB2YXIoLS10cmFuc2xhdGUteS1tdWx0aXBsaWVyKSk7XHJcbiAgICAtLXRyYW5zbGF0ZS14OiBjYWxjKDIwMHB4ICogdmFyKC0tdHJhbnNsYXRlLXgtbXVsdGlwbGllcikpO1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgaGVpZ2h0OiBjYWxjKHZhcigtLXNpemUpICogdmFyKC0tc2NhbGUpKTtcclxuICAgIHdpZHRoOiBjYWxjKHZhcigtLXNpemUpICogdmFyKC0tc2NhbGUpKTtcclxuICAgIGFuaW1hdGlvbjogdHJhbnNsYXRlIHZhcigtLXRyYW5zaXRpb24tZHVyYXRpb24pIHZhcigtLXRyYW5zaXRpb24tZGVsYXkpIHZhcigtLXRyYW5zaXRpb24taXRlcmF0aW9uLWNvdW50KSBsaW5lYXI7XHJcbiAgICBvcGFjaXR5OiAwO1xyXG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XHJcbiAgfVxyXG5cclxuICAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICAtLWZ1bGwtcm90YXRpb246IHZhcigtLXJvdGF0aW9uLXh5eiksIHZhcigtLXJvdGF0aW9uLWRlZyk7XHJcbiAgICBjb250ZW50OiAnJztcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvcik7XHJcbiAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XHJcbiAgICB0cmFuc2Zvcm06IHNrZXcodmFyKC0tc2tldykpIHJvdGF0ZTNkKHZhcigtLWZ1bGwtcm90YXRpb24pKTtcclxuICAgIGFuaW1hdGlvbjogcm90YXRlIHZhcigtLXRyYW5zaXRpb24tZHVyYXRpb24pIHZhcigtLXRyYW5zaXRpb24tZGVsYXkpIHZhcigtLXRyYW5zaXRpb24taXRlcmF0aW9uLWNvdW50KSBsaW5lYXI7XHJcbiAgfVxyXG5cclxuICAucm91bmRlZCAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgfVxyXG5cclxuICAuY29uZSAuY29uZmV0dGkge1xyXG4gICAgLS10cmFuc2xhdGUteDogY2FsYygyMDBweCAqIHZhcigtLXRyYW5zbGF0ZS15LW11bHRpcGxpZXIpICogdmFyKC0tdHJhbnNsYXRlLXgtbXVsdGlwbGllcikpO1xyXG4gIH1cclxuXHJcbiAgLm5vLWdyYXZpdHkgLmNvbmZldHRpIHtcclxuICAgIGFuaW1hdGlvbi1uYW1lOiBuby1ncmF2aXR5LXRyYW5zbGF0ZTtcclxuICAgIGFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246IGVhc2Utb3V0O1xyXG4gIH1cclxuXHJcbiAgQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uKSB7XHJcbiAgICAuY29uZmV0dGksXHJcbiAgICAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICAgIGFuaW1hdGlvbjogbm9uZTtcclxuICAgIH1cclxuICB9XHJcbjwvc3R5bGU+XHJcbiIsIjxzY3JpcHQgY29udGV4dD1cIm1vZHVsZVwiPlxuICBleHBvcnQgY29uc3QgbWFwcyA9IHtcbiAgICAnc21hbGwnOiBbXG4gICAgICAnU0ZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRicsXG4gICAgICAnRkZIRkZGRkZGRicsXG4gICAgICAnSEZGRkZIRkZGRicsXG4gICAgICAnRkZIRkZGSEZGRicsXG4gICAgICAnSEZGRkZIRkZGRicsXG4gICAgICAnRkZIRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRicsXG4gICAgICAnRkZGR0ZGRkZGRidcbiAgICBdLFxuICAgICcxNngxNic6IFtcbiAgICAgICdISEZGRkZGRkZGRkZGRkhIJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGRkZIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkdGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZISEhISEhISEhIRkZGJyxcbiAgICAgICdGRkZGSEhISEhISEhGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRlNGRkZGRkZIJyxcbiAgICAgICdISEZGRkZGRkZGRkZGRkhIJ1xuICAgIF0sXG4gICAgJzMyeDMyJzogW1xuICAgICAgJ0hISEhISEZGRkZGRkZGRkZGRkZGRkZGSEhISEhISEhIJyxcbiAgICAgICdISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISEhISCcsXG4gICAgICAnRkZGRlNGRkZISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkgnLFxuICAgICAgJ0ZGRkZGRkZGRkhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hISEhIRkZGRkZGRkZGSEhISEhISEhGRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEhISEhISEhISEhISEhISEhISEZGRkZGRkZGRicsXG4gICAgICAnSEhISEhISEhISEhISEhISEhISEhISEZGRkZGRkZGRkYnLFxuICAgICAgJ0hIRkZISEhISEhISEhISEhGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGSEhISEhGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRkZGRkZGSEhGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEhGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISCcsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISEgnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhIRkZIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhIRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkdGRkZGRkZGSEZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhGRkhGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZIRkZGRkZGRkYnLFxuICAgICAgJ0hISEhISEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEhISEhISEhGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgXSxcbiAgfVxuICBleHBvcnQgY29uc3QgY29sb3JzID0ge1xuICAgICdIJzogJyMxOTc2ZDInLFxuICAgICdTJzogJyNlZjlhOWEnLFxuICAgICdGJzogJyNlMWY1ZmUnLFxuICAgICdHJzogJyM4MWM3ODQnLFxuICAgICdUJzogJyNmZmUwYjInXG4gIH1cbjwvc2NyaXB0PiIsIjxzY3JpcHQ+XG4gIGltcG9ydCB7IG9uTW91bnQsIHRpY2sgfSBmcm9tICdzdmVsdGUnO1xuICBpbXBvcnQgeyB0d2VlbmVkIH0gZnJvbSBcInN2ZWx0ZS9tb3Rpb25cIjtcbiAgaW1wb3J0IHsgY3ViaWNPdXQgfSBmcm9tIFwic3ZlbHRlL2Vhc2luZ1wiO1xuICBpbXBvcnQgeyBDb25mZXR0aSB9IGZyb20gXCJzdmVsdGUtY29uZmV0dGlcIjtcbiAgaW1wb3J0IHsgbWFwcywgY29sb3JzIH0gZnJvbSBcIi4vY29uc3RhbnRzLnN2ZWx0ZVwiXG5cbiAgbGV0IGNhbnZhcztcblxuICBsZXQgc2VsZWN0ZWRNYXA7XG4gIGxldCBzZWxlY3RlZFRlYWNoZXI7XG4gIGxldCBzZWxlY3RlZFJlc2V0O1xuXG4gIHZhciByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgdmFyIGxlZnRQcmVzc2VkID0gZmFsc2U7XG4gIHZhciB1cFByZXNzZWQgPSBmYWxzZTtcbiAgdmFyIGRvd25QcmVzc2VkID0gZmFsc2U7XG5cbiAgdmFyIG1hcENoYW5nZWQgPSB0cnVlO1xuXG4gIHZhciBwb3M7ICAvLyB0aGUgcG9zaXRpb24gd2hlcmUgdGhlIHBsYXllciBpcyBkaXNwbGF5ZWRcbiAgdmFyIHJlYWxQb3M7ICAvLyB0aGUgYWN0dWFsIHBvc2l0aW9uIG9mIHRoZSBwbGF5ZXIgKGFuaW1hdGlvbnMgZG9uJ3QgY2hhbmdlIHRoaXMpXG4gIHZhciBoaXN0b3J5ID0gW107ICAvLyB0aGUgaGlzdG9yeSBvZiBwbGF5ZXIgcG9zaXRpb25zXG5cbiAgdmFyIGhhc0ludGVyYWN0ZWQgPSBmYWxzZTsgIC8vIGhhcyB0aGUgcmVhZGVyIGludGVyYWN0ZWQgd2l0aCB0aGUgZ2FtZSB5ZXQ/XG4gIHZhciBzdGF0dXNNZXNzYWdlID0gJyc7ICAvLyBkaXNwbGF5ZWQgc3RhdHVzIG1lc3NhZ2VcbiAgdmFyIHN0YXR1c1RpbWVyID0gbnVsbDsgIC8vIHRpbWVyIGlkIGZvciBjbGVhcmluZyBvbGQgdGltZXJcblxuICB2YXIgY29uZmV0dGkgPSBmYWxzZTtcblxuICB2YXIgcGl4ZWxSYXRpbzsgLy8gYWRqdXN0IGdhbWUgcmVzb2x1dGlvbiB0byBoaWdoZXIgcmVzb2x1dGlvbiBkaXNwbGF5c1xuXG4gIC8vIGxvYWQgcm9ib3QgaW1hZ2VzIGZvciB0aGUgUkwgYWdlbnRcbiAgY29uc3Qgcm9ib3QgPSBuZXcgSW1hZ2UoKTtcbiAgcm9ib3Quc3JjID0gJy4vaW1hZ2VzL3JvYm90LnBuZyc7XG4gIGNvbnN0IHJvYm90RmxpcHBlZCA9IG5ldyBJbWFnZSgpO1xuICByb2JvdEZsaXBwZWQuc3JjID0gJy4vaW1hZ2VzL3JvYm90LWZsaXBwZWQucG5nJ1xuICB2YXIgZmxpcHBlZCA9IGZhbHNlO1xuXG4gIC8vIGluaXRpYWxpemUgc2NvcmVcbiAgdmFyIHNjb3JlID0gMDtcbiAgdmFyIGxhc3RTY29yZSA9IDA7XG5cbiAgb25Nb3VudCgoKSA9PiB7XG4gICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgcGl4ZWxSYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICAgIGN0eC5zY2FsZShwaXhlbFJhdGlvLCBwaXhlbFJhdGlvKTtcblxuICAgIHZhciB0aWxlU2l6ZTtcbiAgICB2YXIgbWFwO1xuICAgIHZhciBzdGFydDtcbiAgICB2YXIgbGFzdFBvc2l0aW9uO1xuICAgIHZhciB0ZWFjaGVyTWFwO1xuXG4gICAgZHJhd0Vudmlyb25tZW50KCk7XG5cbiAgICBmdW5jdGlvbiBvbmVTdGVwUmVhY2goYmFzZU1hc2spIHtcbiAgICAgIGxldCByb3dzID0gYmFzZU1hc2subGVuZ3RoO1xuICAgICAgbGV0IGNvbHMgPSBiYXNlTWFza1swXS5sZW5ndGg7XG5cbiAgICAgIGxldCBvbmVTdGVwTWFzayA9IG5ldyBBcnJheShyb3dzKS5maWxsKGZhbHNlKS5tYXAoKCkgPT4gbmV3IEFycmF5KGNvbHMpLmZpbGwoZmFsc2UpKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93czsgaSsrKSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY29sczsgaisrKSB7XG4gICAgICAgICAgdmFyIHJlcyA9IGZhbHNlO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaV1baisxXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzIHw9IGJhc2VNYXNrW2krMV1bal1cbiAgICAgICAgICB9IGNhdGNoKGUpIHt9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlcyB8PSBiYXNlTWFza1tpXVtqLTFdXG4gICAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaS0xXVtqXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cblxuICAgICAgICAgIG9uZVN0ZXBNYXNrW2ldW2pdID0gcmVzXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9uZVN0ZXBNYXNrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFRlYWNoZXIoYmFzZU1hcCwgZGlzdGFuY2UpIHtcblxuICAgICAgaWYgKGRpc3RhbmNlID09IDApIHtcbiAgICAgICAgcmV0dXJuIGJhc2VNYXBcbiAgICAgIH1cblxuICAgICAgdmFyIG5ld0Jhc2VNYXAgPSBuZXcgQXJyYXkoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIG5ld0Jhc2VNYXAucHVzaChtYXBbaV0uc3BsaXQoJycpKVxuICAgICAgfVxuXG4gICAgICBsZXQgYmFzZURhbmdlck1hc2sgPSBuZXdCYXNlTWFwLm1hcCgocm93KSA9PiB7XG4gICAgICAgIHJldHVybiByb3cubWFwKGVsZW1lbnQgPT4gZWxlbWVudCA9PSAnSCcpXG4gICAgICB9KVxuICAgICAgbGV0IGJhc2VFbXB0eU1hc2sgPSBuZXdCYXNlTWFwLm1hcCgocm93KSA9PiB7XG4gICAgICAgIHJldHVybiByb3cubWFwKGVsZW1lbnQgPT4gZWxlbWVudCA9PSAnRicpXG4gICAgICB9KVxuXG4gICAgICB2YXIgcHJldmlvdXNNYXNrID0gQXJyYXkuZnJvbShiYXNlRGFuZ2VyTWFzayk7XG4gICAgICB2YXIgcmVhY2hNYXNrXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpc3RhbmNlOyBpKyspIHtcbiAgICAgICAgcmVhY2hNYXNrID0gb25lU3RlcFJlYWNoKHByZXZpb3VzTWFzayk7XG4gICAgICAgIHByZXZpb3VzTWFzayA9IHJlYWNoTWFzay5tYXAoKHJvdywgaSkgPT4ge1xuICAgICAgICAgIHJldHVybiByb3cubWFwKChlbGVtZW50LCBqKSA9PiBlbGVtZW50IHx8IHByZXZpb3VzTWFza1tpXVtqXSlcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgdmFyIG5ld01hcCA9IEFycmF5LmZyb20obmV3QmFzZU1hcCk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5ld0Jhc2VNYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBuZXdCYXNlTWFwWzBdLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgaWYgKHJlYWNoTWFza1tpXVtqXSAmJiBiYXNlRW1wdHlNYXNrW2ldW2pdKSB7XG4gICAgICAgICAgICBuZXdNYXBbaV1bal0gPSAnVCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgbGV0IHRlYWNoZXJNYXAgPSBuZXcgQXJyYXkoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmFzZU1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0ZWFjaGVyTWFwLnB1c2gobmV3TWFwW2ldLmpvaW4oJycpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRlYWNoZXJNYXA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJhd0Vudmlyb25tZW50KCkge1xuICAgICAgbWFwID0gbWFwc1tzZWxlY3RlZE1hcF1cbiAgICAgIHRpbGVTaXplID0gY2FudmFzLmhlaWdodCAvIG1hcC5sZW5ndGg7XG4gICAgICB0ZWFjaGVyTWFwID0gYWRkVGVhY2hlcihtYXAsIHNlbGVjdGVkVGVhY2hlcik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWFwWzBdLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgbGV0IHN0YXRlID0gdGVhY2hlck1hcFtpXVtqXTtcblxuICAgICAgICAgIGlmIChzdGF0ZSA9PSAnUycpIHtcbiAgICAgICAgICAgIHN0YXJ0ID0gW2osIGldO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHggPSBqICogdGlsZVNpemU7XG4gICAgICAgICAgY29uc3QgeSA9IGkgKiB0aWxlU2l6ZTtcblxuICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICBjdHgucmVjdCh4LCB5LCB0aWxlU2l6ZSArIDEsIHRpbGVTaXplICsgMSk7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGNvbG9yc1tzdGF0ZV07XG4gICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7IFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZnVuY3Rpb24gZHJhd0FnZW50KCkge1xuICAgICAgY29uc3QgaW1hZ2UgPSBmbGlwcGVkID8gcm9ib3RGbGlwcGVkIDogcm9ib3Q7XG4gICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAkcG9zWzBdICogdGlsZVNpemUsICRwb3NbMV0gKiB0aWxlU2l6ZSwgdGlsZVNpemUsIHRpbGVTaXplKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtb3ZlQWdlbnQobmV3UG9zKSB7XG4gICAgICBwb3Muc2V0KG5ld1Bvcyk7XG4gICAgICByZWFsUG9zID0gbmV3UG9zO1xuICAgICAgaGlzdG9yeS5wdXNoKHJlYWxQb3MpO1xuICAgICAgc2NvcmUgLT0gMC4wMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldEFnZW50KCkge1xuICAgICAgaGlzdG9yeSA9IFtdO1xuICAgICAgbGFzdFNjb3JlID0gc2NvcmU7XG4gICAgICBtb3ZlQWdlbnQoc3RhcnQpO1xuICAgICAgc2NvcmUgPSAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRyYXcoKSB7XG5cbiAgICAgIGlmIChsZWZ0UHJlc3NlZCB8fCByaWdodFByZXNzZWQgfHwgdXBQcmVzc2VkIHx8IGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cbiAgICAgIGRyYXdFbnZpcm9ubWVudCgpO1xuXG4gICAgICBpZiAobWFwQ2hhbmdlZCkge1xuICAgICAgICBwb3MgPSB0d2VlbmVkKHN0YXJ0LCB7XG4gICAgICAgICAgZHVyYXRpb246IDE1MCxcbiAgICAgICAgICBlYXNpbmc6IGN1YmljT3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgc2NvcmUgPSAwO1xuICAgICAgICByZXNldEFnZW50KCk7XG4gICAgICB9XG5cbiAgICAgIGRyYXdBZ2VudCgpOyBcblxuICAgICAgLy8gc2xpcCB3aXRoIDIwJSBwcm9iYWJpbGl0eVxuICAgICAgY29uc3Qgcm5kID0gTWF0aC5yYW5kb20oKVxuICAgICAgaWYgKGxlZnRQcmVzc2VkIHx8IHJpZ2h0UHJlc3NlZCkge1xuICAgICAgICBpZiAocm5kIDwgMC4xKSB7XG4gICAgICAgICAgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICB1cFByZXNzZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHJuZCA8IDAuMikge1xuICAgICAgICAgIGxlZnRQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgZG93blByZXNzZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHVwUHJlc3NlZCB8fCBkb3duUHJlc3NlZCkge1xuICAgICAgICBpZiAocm5kIDwgMC4xKSB7XG4gICAgICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgZG93blByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBsZWZ0UHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocm5kIDwgMC4yKSB7XG4gICAgICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgZG93blByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICByaWdodFByZXNzZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAocm5kIDwgMC4yICYmICh1cFByZXNzZWQgfHwgZG93blByZXNzZWQgfHwgbGVmdFByZXNzZWQgfHwgcmlnaHRQcmVzc2VkKSkge1xuICAgICAgICBzaG93TWVzc2FnZSgnWW91IGp1c3Qgc2xpcHBlZC4nKVxuICAgICAgfVxuXG4gICAgICBpZiAobGVmdFByZXNzZWQpIGZsaXBwZWQgPSB0cnVlO1xuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCkgZmxpcHBlZCA9IGZhbHNlO1xuXG4gICAgICAvLyByZW1lbWJlciBsYXN0IHBvc2l0aW9uXG4gICAgICBsYXN0UG9zaXRpb24gPSBBcnJheS5mcm9tKHJlYWxQb3MpO1xuICAgICAgbGV0IFt4LCB5XSA9IEFycmF5LmZyb20obGFzdFBvc2l0aW9uKTtcblxuICAgICAgLy8gY2hhbmdlIHBsYXllciBwb3NcbiAgICAgIGlmIChyaWdodFByZXNzZWQpIHtcbiAgICAgICAgaWYgKHggPCBtYXBbMF0ubGVuZ3RoIC0gMSkgeCArPSAxXG4gICAgICB9IGVsc2UgaWYgKGxlZnRQcmVzc2VkKSB7XG4gICAgICAgIGlmICh4ID4gMCkgeCAtPSAxXG4gICAgICB9IGVsc2UgaWYgKHVwUHJlc3NlZCkge1xuICAgICAgICBpZiAoeSA+IDApIHkgLT0gMVxuICAgICAgfSBlbHNlIGlmIChkb3duUHJlc3NlZCkge1xuICAgICAgICBpZiAoeSA8IG1hcC5sZW5ndGggLSAxKSB5ICs9IDFcbiAgICAgIH1cblxuICAgICAgLy8gbW92ZSBpZiBidXR0b24gaXMgcHJlc3NlZFxuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCB8fCBsZWZ0UHJlc3NlZCB8fCBkb3duUHJlc3NlZCB8fCB1cFByZXNzZWQpIHtcbiAgICAgICAgbW92ZUFnZW50KFt4LCB5XSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIGNoZWNrIGZvciB3aW4gYW5kIGZhaWxcbiAgICAgIGlmIChtYXBbeV1beF0gPT0gJ0cnKSB7XG4gICAgICAgIGNvbmZldHRpID0gdHJ1ZTtcbiAgICAgICAgc2NvcmUgKz0gNjtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7Y29uZmV0dGkgPSBmYWxzZX0sIDMwMDApO1xuICAgICAgICBzaG93TWVzc2FnZSgnWW91IHdvbiEnKTtcbiAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgfSBlbHNlIGlmIChtYXBbeV1beF0gPT0gJ0gnKSB7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3UgZmFpbGVkLicpO1xuICAgICAgICBzY29yZSA9IDA7XG4gICAgICAgIHJlc2V0QWdlbnQoKTtcbiAgICAgIH1cblxuICAgICAgLy8gVGVhY2hlciBpbnRlcnZlbnRpb25zXG4gICAgICBlbHNlIGlmICh0ZWFjaGVyTWFwW3ldW3hdID09ICdUJykge1xuICAgICAgICBpZiAoc2VsZWN0ZWRSZXNldCA9PSAnSFInKSB7XG4gICAgICAgICAgLy8gaGFyZCByZXNldFxuICAgICAgICAgIGxldCB0bXBTY29yZSA9IHNjb3JlO1xuICAgICAgICAgIHJlc2V0QWdlbnQoKTtcbiAgICAgICAgICBzY29yZSA9IHRtcFNjb3JlO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkUmVzZXQgPT0gJ0I0Jykge1xuICAgICAgICAgIC8vIGJhY2sgNCByZXNldFxuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNCAmJiBoaXN0b3J5Lmxlbmd0aCA+IDE7IGkrKykge1xuICAgICAgICAgICAgaGlzdG9yeS5wb3AoKVxuICAgICAgICAgIH1cbiAgICAgICAgICBzY29yZSArPSAwLjAxO1xuICAgICAgICAgIG1vdmVBZ2VudChoaXN0b3J5W2hpc3RvcnkubGVuZ3RoLTFdKTtcbiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZFJlc2V0ID09ICdTUicpIHtcbiAgICAgICAgICAvLyBzb2Z0IHJlc2V0XG4gICAgICAgICAgc2NvcmUgKz0gMC4wMTtcbiAgICAgICAgICBtb3ZlQWdlbnQobGFzdFBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBzaG93TWVzc2FnZSgnVGhlIHRlYWNoZXIgc2V0IHlvdSBiYWNrLicpO1xuICAgICAgfVxuXG4gICAgICBtYXBDaGFuZ2VkID0gZmFsc2U7XG5cbiAgICAgIHJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgICAgIHVwUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgZG93blByZXNzZWQgPSBmYWxzZTtcblxuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGRyYXcpO1xuICAgIH1cblxuICAgIGRyYXcoKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gbWFwQ2hhbmdlZEhhbmRsZXIoKSB7XG4gICAgbWFwQ2hhbmdlZCA9IHRydWU7XG4gIH1cblxuICAvLyBoYW5kbGUga2V5IHByZXNzZXMgKHVwL2xlZnQvZG93bi9yaWdodCBvciB3L2Evcy9kKVxuICBmdW5jdGlvbiBrZXlEb3duSGFuZGxlcihlKSB7XG5cdFx0aWYoZS5rZXlDb2RlID09IDM5IHx8IGUua2V5ID09ICdkJykge1xuXHRcdFx0cmlnaHRQcmVzc2VkID0gdHJ1ZTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdFx0ZWxzZSBpZihlLmtleUNvZGUgPT0gMzcgfHwgZS5rZXkgPT0gJ2EnKSB7XG5cdFx0XHRsZWZ0UHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuICAgIGVsc2UgaWYoZS5rZXlDb2RlID09IDM4IHx8IGUua2V5ID09ICd3Jykge1xuICAgICAgdXBQcmVzc2VkID0gdHJ1ZTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgZWxzZSBpZihlLmtleUNvZGUgPT0gNDAgfHwgZS5rZXkgPT0gJ3MnKSB7XG4gICAgICBkb3duUHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXHR9XG5cbiAgZnVuY3Rpb24gc2hvd01lc3NhZ2UobXNnKSB7XG4gICAgLy8gc2hvdyBhIHN0YXR1cyBtZXNzYWdlIGJlbG93IHRoZSBtYXBcbiAgICBzdGF0dXNNZXNzYWdlID0gJyc7ICAvLyBjbGVhciBzdGF0dXMgbWVzc2FnZSBhbmQgY3NzIHRyYW5zaXRpb25cbiAgICBjbGVhclRpbWVvdXQoc3RhdHVzVGltZXIpOyAgLy8gcmVzZXQgcHJldmlvdXMgc3RhdHVzIG1lc3NhZ2UgY2xlYXJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtzdGF0dXNNZXNzYWdlID0gbXNnfSwgMSkgIC8vIHdhaXQgZm9yIHN0YXR1c01lc3NhZ2UgdG8gYmUgcmVzZXRcbiAgICBzdGF0dXNUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge3N0YXR1c01lc3NhZ2UgPSAnJ30sIDIwMDApICAvLyBjbGVhciBzdGF0dXMgbWVzc2FnZSBhZnRlciBzb21lIHRpbWVcbiAgfVxuPC9zY3JpcHQ+XG5cbjxzdmVsdGU6d2luZG93IG9uOmtleWRvd249e2tleURvd25IYW5kbGVyfS8+XG5cbjxkaXYgY2xhc3M9XCJnYW1lXCI+XG5cbiAgPGRpdiBjbGFzcz1cInZpZXdcIj5cbiAgICA8ZGl2IGNsYXNzPVwibWFwXCI+XG4gICAgICBcbiAgICAgIDxwPlNjb3JlOiB7c2NvcmUgPT0gMCA/IGxhc3RTY29yZS50b0ZpeGVkKDIpIDogc2NvcmUudG9GaXhlZCgyKSB9PC9wPlxuICBcbiAgICAgIDxjYW52YXNcbiAgICAgICAgYmluZDp0aGlzPXtjYW52YXN9XG4gICAgICAgIHdpZHRoPXs1MDAgKiBwaXhlbFJhdGlvfVxuICAgICAgICBoZWlnaHQ9ezUwMCAqIHBpeGVsUmF0aW99XG4gICAgICAgIHN0eWxlPVwibWF4LXdpZHRoOiAzMDBweDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTtcIlxuICAgICAgICBvbjpjbGljaz17KCkgPT4gc2hvd01lc3NhZ2UoJ1ByZXNzIHRoZSBhcnJvdyBrZXlzIHRvIG1vdmUuLi4nKX1cbiAgICAgID48L2NhbnZhcz5cbiAgXG4gICAgICB7I2lmIGNvbmZldHRpfVxuICAgICAgICA8Q29uZmV0dGkgY29uZSBkZWxheT17WzAsIDIwMF19IGFtb3VudD01MCB4PXtbLTAuNywgMC43XX0geT17WzAuNSwgMS41XX0gLz5cbiAgICAgIHsvaWZ9XG4gICAgPC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwibGVnZW5kXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29sb3JcIiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6IHtjb2xvcnNbJ0YnXX1cIj48L2Rpdj5cbiAgICAgIDxkaXY+U2FmZTwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImNvbG9yXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiB7Y29sb3JzWydHJ119XCI+PC9kaXY+XG4gICAgICA8ZGl2PkdvYWw8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2xvclwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjoge2NvbG9yc1snSCddfVwiPjwvZGl2PlxuICAgICAgPGRpdj5EYW5nZXI8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2xvclwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjoge2NvbG9yc1snUyddfVwiPjwvZGl2PlxuICAgICAgPGRpdj5TdGFydDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImNvbG9yXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiB7Y29sb3JzWydUJ119XCI+PC9kaXY+XG4gICAgICA8ZGl2PlRyaWdnZXI8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPGRpdiBjbGFzcz1cImNvbnRyb2xzXCI+XG5cbiAgICB7I2lmIGhhc0ludGVyYWN0ZWR9XG4gICAgICA8cCBjbGFzcz1cInN0YXR1c1wiIHN0eWxlPVwidHJhbnNpdGlvbjogY29sb3Ige3N0YXR1c01lc3NhZ2UgPyAyIDogMH1zOyB0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjogZWFzZS1pbjsgY29sb3I6IHtzdGF0dXNNZXNzYWdlID8gJ3doaXRlJyA6ICdibGFjayd9O1wiPntzdGF0dXNNZXNzYWdlfTwvcD5cbiAgICB7OmVsc2V9XG4gICAgICA8cCBjbGFzcz1cInN0YXR1c1wiPlByZXNzIHRoZSBhcnJvdyBrZXlzIHRvIG1vdmUuLi48L3A+XG4gICAgey9pZn1cblxuICAgIDxkaXYgY2xhc3M9XCJrZXlib2FyZFwiPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IHVwUHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTkzOzwvYnV0dG9uPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IGxlZnRQcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTI7PC9idXR0b24+XG4gICAgICA8YnV0dG9uIG9uOmNsaWNrPXsoKSA9PiBkb3duUHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTk1OzwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBvbjpjbGljaz17KCkgPT4gcmlnaHRQcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTQ7PC9idXR0b24+XG4gICAgPC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwibWVudVwiPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGZvcj1cIm1hcFwiPkNob29zZSBhIG1hcDo8L2xhYmVsPlxuICAgICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkTWFwfSBvbjpjaGFuZ2U9e21hcENoYW5nZWRIYW5kbGVyfSBuYW1lPVwibWFwXCIgaWQ9XCJtYXBcIj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwic21hbGxcIj5Gcm96ZW4gTGFrZTwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxNngxNlwiPkZyb3plbiBTbWlsZXk8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMzJ4MzJcIj5MYXJnZSBMYWtlPC9vcHRpb24+XG4gICAgICAgIDwvc2VsZWN0PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxsYWJlbCBmb3I9XCJ0ZWFjaGVyXCI+QWRkIGEgdGVhY2hlcjo8L2xhYmVsPlxuICAgICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkVGVhY2hlcn0gbmFtZT1cInRlYWNoZXJcIiBpZD1cInRlYWNoZXJcIj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMFwiPk5vIFRlYWNoZXI8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMVwiPkRpc3RhbmNlIDE8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPkRpc3RhbmNlIDI8L29wdGlvbj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGZvcj1cInJlc2V0XCI+UmVzZXQgc3RyYXRlZ3k6PC9sYWJlbD5cbiAgICAgICAgPHNlbGVjdCBiaW5kOnZhbHVlPXtzZWxlY3RlZFJlc2V0fSBuYW1lPVwicmVzZXRcIiBpZD1cInJlc2V0XCIgZGlzYWJsZWQ9e3NlbGVjdGVkVGVhY2hlcj09MH0+XG4gICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlNSXCI+U29mdCBSZXNldDwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJCNFwiPkJhY2sgNDwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJIUlwiPkhhcmQgUmVzZXQ8L29wdGlvbj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICA8L2Rpdj5cblxuPC9kaXY+XG5cbjxzdHlsZT5cblx0Y2FudmFzIHtcbiAgICBwYWRkaW5nLWJvdHRvbTogMWVtO1xuICAgIHBhZGRpbmctdG9wOiAxZW07XG4gIH1cblxuICAuZ2FtZSB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgcGFkZGluZy1ib3R0b206IDEuNWVtO1xuICB9XG5cbiAgLmNvbnRyb2xzIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBtYXgtd2lkdGg6IDM1MHB4O1xuICB9XG5cbiAgLnN0YXR1cyB7XG4gICAgaGVpZ2h0OiAxZW07XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgbWF4LXdpZHRoOiAzMDBweDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgdHJhbnNpdGlvbjogY29sb3IgMXM7XG4gICAgcGFkZGluZy10b3A6IDFlbTtcbiAgfVxuXG4gIC5tYXAge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLnZpZXcge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLm1hcCBwIHtcbiAgICBtYXJnaW46IDA7XG4gIH1cblxuICAubWVudSB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIGdhcDogMC4yZW07XG4gICAgb3ZlcmZsb3c6IGF1dG87XG4gICAgZmxleC13cmFwOiB3cmFwO1xuICB9XG5cbiAgLm1lbnUgZGl2IHtcbiAgICBtYXJnaW46IDAuM2VtO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgfVxuXG4gIC5rZXkge1xuXHRcdGJhY2tncm91bmQtY29sb3I6ICNlZWU7XG5cdFx0Ym9yZGVyLXJhZGl1czogNHB4O1xuXHRcdGZvbnQtc2l6ZTogMWVtO1xuXHRcdHBhZGRpbmc6IDAuNWVtIDAuNWVtO1xuXHRcdGJvcmRlci10b3A6IDVweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7XG5cdFx0Ym9yZGVyLWxlZnQ6IDVweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNSk7XG5cdFx0Ym9yZGVyLXJpZ2h0OiA1cHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjIpO1xuXHRcdGJvcmRlci1ib3R0b206IDVweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMik7XG5cdFx0Y29sb3I6ICM1NTU7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHdpZHRoOiA0ZW07XG4gICAgaGVpZ2h0OiA0ZW07XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuXHR9XG5cbiAgLmxlZ2VuZCB7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDEuNWVtIDFmciAxLjVlbSAxZnIgMS41ZW0gMWZyO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIG1heC13aWR0aDogMzAwcHg7XG4gICAgZ2FwOiAwLjVlbTtcbiAgfVxuXG4gIC5sZWdlbmQgZGl2IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyIGxlZnQ7XG4gIH1cblxuICBAbWVkaWEgKG1pbi13aWR0aDogMTAwMHB4KSB7XG4gICAgLnZpZXcge1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICB9XG4gICAgLmxlZ2VuZCB7XG4gICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDEuNWVtIDFmcjtcbiAgICAgIG1heC13aWR0aDogMTAwcHg7XG4gICAgICBwYWRkaW5nLWxlZnQ6IDFlbTtcbiAgICB9XG4gICAgLmNvbnRyb2xzIHtcbiAgICAgIG1heC13aWR0aDogMzUwcHg7XG4gICAgfVxuICB9XG5cbiAgQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSB7XG4gICAgLmdhbWUge1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICB9XG4gICAgLmNvbnRyb2xzIHtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICBtYXgtd2lkdGg6IDMwMHB4O1xuICAgIH1cbiAgICAubWVudSB7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIH1cbiAgICAubWVudSBkaXYge1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGdhcDogMTBweDtcbiAgICB9XG4gICAgLmtleSB7XG4gICAgICB3aWR0aDogM2VtO1xuICAgICAgaGVpZ2h0OiAzZW07XG4gICAgfVxuICB9XG5cbiAgLmtleWJvYXJkIHtcbiAgICBkaXNwbGF5OiBncmlkO1xuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogYXV0byBhdXRvIGF1dG87XG4gICAgZ3JpZC1nYXA6IDAuNWVtO1xuICAgIHBhZGRpbmctdG9wOiAxZW07XG4gICAgcGFkZGluZy1ib3R0b206IDFlbTtcbiAgfVxuXG4gIC5rZXk6YWN0aXZlIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGRkO1xuICB9XG4gICBcbiAgLmNvbG9yIHtcbiAgICB3aWR0aDogMS41ZW07XG4gICAgaGVpZ2h0OiAxLjVlbTtcbiAgfVxuPC9zdHlsZT5cbiIsIi8vIEhvdCByZWxvYWRpbmdcbmltcG9ydCAqIGFzIF91bnVzZWQgZnJvbSBcInJhdy1sb2FkZXIhLi9pbmRleC5lanNcIjtcbi8vIFRPRE86IGRpc2FibGUgYmVmb3JlIHB1Ymxpc2hpbmdcblxuaW1wb3J0IFRyYWplY3RvcmllcyBmcm9tIFwiLi9kaWFncmFtcy90cmFqZWN0b3JpZXMuc3ZlbHRlXCI7XG5pbXBvcnQgQmFjayBmcm9tIFwiLi9kaWFncmFtcy9iYWNrLnN2ZWx0ZVwiXG5pbXBvcnQgSW5jcmVtZW50YWwgZnJvbSBcIi4vZGlhZ3JhbXMvaW5jcmVtZW50YWwuc3ZlbHRlXCJcbmltcG9ydCBNaW5pZ2FtZSBmcm9tIFwiLi9kaWFncmFtcy9taW5pZ2FtZS5zdmVsdGVcIlxuXG4vLyBsYXppbHkgaW5pdGlhbGl6ZSBhbnkgZGlhZ3JhbSBiZWxvdyB0aGUgZm9sZC4gRS5HOlxuXG5jb25zdCB0cmFqZWN0b3JpZXNUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWplY3Rvcmllcy12aXN1YWxpemF0aW9uXCIpO1xubGV0IHRyYWplY3RvcmllcztcbnRyYWplY3Rvcmllc1RhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSB0cmFqZWN0b3JpZXNUYWcucXVlcnlTZWxlY3RvcihcIiN0cmFqZWN0b3JpZXMtdmlzdWFsaXphdGlvbi10YXJnZXRcIik7XG5cdHRyYWplY3RvcmllcyA9IG5ldyBUcmFqZWN0b3JpZXMoeyB0YXJnZXQgfSk7XG59KTtcblxuY29uc3QgYmFja1RhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFjay12aXN1YWxpemF0aW9uXCIpO1xubGV0IGJhY2s7XG5iYWNrVGFnLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XG5cdGNvbnN0IHRhcmdldCA9IGJhY2tUYWcucXVlcnlTZWxlY3RvcihcIiNiYWNrLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHRiYWNrID0gbmV3IEJhY2soeyB0YXJnZXQgfSk7XG59KTtcblxuY29uc3QgaW5jcmVtZW50YWxUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY3JlbWVudGFsLXZpc3VhbGl6YXRpb25cIik7XG5sZXQgaW5jcmVtZW50YWw7XG5pbmNyZW1lbnRhbFRhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSBpbmNyZW1lbnRhbFRhZy5xdWVyeVNlbGVjdG9yKFwiI2luY3JlbWVudGFsLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHRpbmNyZW1lbnRhbCA9IG5ldyBJbmNyZW1lbnRhbCh7IHRhcmdldCB9KTtcbn0pO1xuXG5jb25zdCBtaW5pZ2FtZVRhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWluaWdhbWVcIik7XG5sZXQgbWluaWdhbWU7XG5taW5pZ2FtZVRhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSBtaW5pZ2FtZVRhZy5xdWVyeVNlbGVjdG9yKFwiI21pbmlnYW1lLXRhcmdldFwiKTtcblx0bWluaWdhbWUgPSBuZXcgTWluaWdhbWUoeyB0YXJnZXQgfSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=