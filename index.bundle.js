!function(e){var t={};function F(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,F),o.l=!0,o.exports}F.m=e,F.c=t,F.d=function(e,t,n){F.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},F.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},F.t=function(e,t){if(1&t&&(e=F(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(F.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)F.d(n,o,function(t){return e[t]}.bind(null,o));return n},F.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return F.d(t,"a",t),t},F.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},F.p="",F(F.s=0)}([function(e,t,F){"use strict";F.r(t);function n(){}const o=e=>e;function r(e,t){for(const F in t)e[F]=t[F];return e}function i(e){return e()}function a(){return Object.create(null)}function l(e){e.forEach(i)}function s(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let u;function f(e,t){return u||(u=document.createElement("a")),u.href=t,e===u.href}function d(e){return 0===Object.keys(e).length}function p(e,...t){if(null==e)return n;const F=e.subscribe(...t);return F.unsubscribe?()=>F.unsubscribe():F}const m="undefined"!=typeof window;let v=m?()=>window.performance.now():()=>Date.now(),H=m?e=>requestAnimationFrame(e):n;const y=new Set;function g(e){y.forEach(t=>{t.c(e)||(y.delete(t),t.f())}),0!==y.size&&H(g)}function h(e){let t;return 0===y.size&&H(g),{promise:new Promise(F=>{y.add(t={c:e,f:F})}),abort(){y.delete(t)}}}let x=!1;function b(e,t){e.appendChild(t)}function w(e,t,F){const n=_(e);if(!n.getElementById(t)){const e=q("style");e.id=t,e.textContent=F,$(n,e)}}function _(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e,t){b(e.head||e,t)}function z(e,t,F){e.insertBefore(t,F||null)}function k(e){e.parentNode.removeChild(e)}function q(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function S(){return C(" ")}function E(e,t,F,n){return e.addEventListener(t,F,n),()=>e.removeEventListener(t,F,n)}function j(e,t,F){null==F?e.removeAttribute(t):e.getAttribute(t)!==F&&e.setAttribute(t,F)}function A(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function T(e,t,F,n){null===F?e.style.removeProperty(t):e.style.setProperty(t,F,n?"important":"")}function O(e,t){for(let F=0;F<e.options.length;F+=1){const n=e.options[F];if(n.__value===t)return void(n.selected=!0)}e.selectedIndex=-1}function P(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function D(e,t,F){e.classList[F?"add":"remove"](t)}new Map;let I;function R(e){I=e}function L(){if(!I)throw new Error("Function called outside component initialization");return I}function M(e){L().$$.on_mount.push(e)}const B=[],G=[],Y=[],N=[],X=Promise.resolve();let J=!1;function K(){J||(J=!0,X.then(W))}function Q(e){Y.push(e)}const U=new Set;let V=0;function W(){const e=I;do{for(;V<B.length;){const e=B[V];V++,R(e),Z(e.$$)}for(R(null),B.length=0,V=0;G.length;)G.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];U.has(t)||(U.add(t),t())}Y.length=0}while(B.length);for(;N.length;)N.pop()();J=!1,U.clear(),R(e)}function Z(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}const ee=new Set;let te;function Fe(){te={r:0,c:[],p:te}}function ne(){te.r||l(te.c),te=te.p}function oe(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function re(e,t,F,n){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.c.push(()=>{ee.delete(e),n&&(F&&e.d(1),n())}),e.o(t)}else n&&n()}const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let ae;function le(e,t,F,n){const{fragment:o,on_mount:r,on_destroy:a,after_update:c}=e.$$;o&&o.m(t,F),n||Q(()=>{const t=r.map(i).filter(s);a?a.push(...t):l(t),e.$$.on_mount=[]}),c.forEach(Q)}function se(e,t){const F=e.$$;null!==F.fragment&&(l(F.on_destroy),F.fragment&&F.fragment.d(t),F.on_destroy=F.fragment=null,F.ctx=[])}function ce(e,t,F,o,r,i,s,c=[-1]){const u=I;R(e);const f=e.$$={fragment:null,ctx:null,props:i,update:n,not_equal:r,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:a(),dirty:c,skip_bound:!1,root:t.target||u.$$.root};s&&s(f.root);let d=!1;if(f.ctx=F?F(e,t.props||{},(t,F,...n)=>{const o=n.length?n[0]:F;return f.ctx&&r(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),d&&function(e,t){-1===e.$$.dirty[0]&&(B.push(e),K(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),F}):[],f.update(),d=!0,l(f.before_update),f.fragment=!!o&&o(f.ctx),t.target){if(t.hydrate){x=!0;const e=(p=t.target,Array.from(p.childNodes));f.fragment&&f.fragment.l(e),e.forEach(k)}else f.fragment&&f.fragment.c();t.intro&&oe(e.$$.fragment),le(e,t.target,t.anchor,t.customElement),x=!1,W()}var p;R(u)}"function"==typeof HTMLElement&&(ae=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(i).filter(s);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,F){this[e]=F}disconnectedCallback(){l(this.$$.on_disconnect)}$destroy(){se(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!d(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ue{$destroy(){se(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!d(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function fe(e){let t,F,o,r,i,a,l,s,c,u,d,p=e[0]+1+"";return{c(){t=q("img"),o=S(),r=q("div"),i=q("p"),a=C("Trajectory after curriculum step "),l=C(p),s=S(),c=q("input"),f(t.src,F="images/trajectories"+e[0]+".svg")||j(t,"src",F),j(t,"alt","Interactive plot displaying the trajectories of the RL agent on the map"),j(t,"height","300px"),j(t,"width","300px"),j(c,"type","range"),j(c,"min","0"),j(c,"max",de),c.value="0",T(r,"width","300px"),T(r,"margin","auto"),T(r,"text-align","center")},m(F,n){z(F,t,n),z(F,o,n),z(F,r,n),b(r,i),b(i,a),b(i,l),b(r,s),b(r,c),u||(d=E(c,"input",e[1]),u=!0)},p(e,[n]){1&n&&!f(t.src,F="images/trajectories"+e[0]+".svg")&&j(t,"src",F),1&n&&p!==(p=e[0]+1+"")&&A(l,p)},i:n,o:n,d(e){e&&k(t),e&&k(o),e&&k(r),u=!1,d()}}}const de=5;function pe(e,t,F){let n=0;return[n,function(e){F(0,n=parseInt(e.target.value))}]}var me=class extends ue{constructor(e){super(),ce(this,e,pe,fe,c,{})}};function ve(e){let t,F,o,r,i,a,l,s,c,u,d,p;return{c(){t=q("div"),F=q("img"),r=S(),i=q("div"),a=q("p"),l=C("x = "),s=C(e[0]),c=S(),u=q("input"),f(F.src,o="images/16x16_back"+e[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the back curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","1"),j(u,"max",He),u.value="0",T(i,"width","300px"),T(i,"margin","auto"),T(i,"text-align","center"),T(t,"display","flex"),T(t,"flex-direction","column"),T(t,"align-items","center")},m(n,o){z(n,t,o),b(t,F),b(t,r),b(t,i),b(i,a),b(a,l),b(a,s),b(i,c),b(i,u),d||(p=E(u,"input",e[1]),d=!0)},p(e,[t]){1&t&&!f(F.src,o="images/16x16_back"+e[0]+"_successes.svg")&&j(F,"src",o),1&t&&A(s,e[0])},i:n,o:n,d(e){e&&k(t),d=!1,p()}}}const He=9;function ye(e,t,F){let n=1;return[n,function(e){F(0,n=parseInt(e.target.value))}]}var ge=class extends ue{constructor(e){super(),ce(this,e,ye,ve,c,{})}};function he(e){let t,F,o,r,i,a,l,s,c,u,d,p;return{c(){t=q("div"),F=q("img"),r=S(),i=q("div"),a=q("p"),l=C("x = "),s=C(e[0]),c=S(),u=q("input"),f(F.src,o="images/16x16_incremental"+e[0]+"_successes.svg")||j(F,"src",o),j(F,"alt","Interactive plot displaying the success rate of the incremental curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","0"),j(u,"max",xe),u.value="0",T(i,"width","300px"),T(i,"margin","auto"),T(i,"text-align","center"),T(t,"display","flex"),T(t,"flex-direction","column"),T(t,"align-items","center")},m(n,o){z(n,t,o),b(t,F),b(t,r),b(t,i),b(i,a),b(a,l),b(a,s),b(i,c),b(i,u),d||(p=E(u,"input",e[1]),d=!0)},p(e,[t]){1&t&&!f(F.src,o="images/16x16_incremental"+e[0]+"_successes.svg")&&j(F,"src",o),1&t&&A(s,e[0])},i:n,o:n,d(e){e&&k(t),d=!1,p()}}}const xe=4;function be(e,t,F){let n=0;return[n,function(e){F(0,n=parseInt(e.target.value))}]}var we=class extends ue{constructor(e){super(),ce(this,e,be,he,c,{})}};const _e=[];function $e(e,t=n){let F;const o=new Set;function r(t){if(c(e,t)&&(e=t,F)){const t=!_e.length;for(const t of o)t[1](),_e.push(t,e);if(t){for(let e=0;e<_e.length;e+=2)_e[e][0](_e[e+1]);_e.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,a=n){const l=[i,a];return o.add(l),1===o.size&&(F=t(r)||n),i(e),()=>{o.delete(l),0===o.size&&(F(),F=null)}}}}function ze(e){const t=e-1;return t*t*t+1}function ke(e){return"[object Date]"===Object.prototype.toString.call(e)}function qe(e,t){if(e===t||e!=e)return()=>e;const F=typeof e;if(F!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const F=t.map((t,F)=>qe(e[F],t));return e=>F.map(t=>t(e))}if("object"===F){if(!e||!t)throw new Error("Object cannot be null");if(ke(e)&&ke(t)){e=e.getTime();const F=(t=t.getTime())-e;return t=>new Date(e+t*F)}const F=Object.keys(t),n={};return F.forEach(F=>{n[F]=qe(e[F],t[F])}),e=>{const t={};return F.forEach(F=>{t[F]=n[F](e)}),t}}if("number"===F){const F=t-e;return t=>e+t*F}throw new Error(`Cannot interpolate ${F} values`)}function Ce(e){w(e,"svelte-io58ff",".confetti-holder.svelte-io58ff.svelte-io58ff{position:relative}@keyframes svelte-io58ff-rotate{0%{transform:skew(var(--skew)) rotate3d(var(--full-rotation))}100%{transform:skew(var(--skew)) rotate3d(var(--rotation-xyz), calc(var(--rotation-deg) + 360deg))}}@keyframes svelte-io58ff-translate{0%{opacity:1}8%{transform:translateY(calc(var(--translate-y) * 0.95)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.9)));opacity:1}12%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.95)));opacity:1}16%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * var(--x-spread)));opacity:1}100%{transform:translateY(calc(var(--translate-y) + var(--fall-distance))) translateX(var(--translate-x));opacity:0}}@keyframes svelte-io58ff-no-gravity-translate{0%{opacity:1}100%{transform:translateY(var(--translate-y)) translateX(var(--translate-x));opacity:0}}.confetti.svelte-io58ff.svelte-io58ff{--translate-y:calc(-200px * var(--translate-y-multiplier));--translate-x:calc(200px * var(--translate-x-multiplier));position:absolute;height:calc(var(--size) * var(--scale));width:calc(var(--size) * var(--scale));animation:svelte-io58ff-translate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;opacity:0;pointer-events:none}.confetti.svelte-io58ff.svelte-io58ff::before{--full-rotation:var(--rotation-xyz), var(--rotation-deg);content:'';display:block;width:100%;height:100%;background:var(--color);background-size:contain;transform:skew(var(--skew)) rotate3d(var(--full-rotation));animation:svelte-io58ff-rotate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear}.rounded.svelte-io58ff .confetti.svelte-io58ff::before{border-radius:50%}.cone.svelte-io58ff .confetti.svelte-io58ff{--translate-x:calc(200px * var(--translate-y-multiplier) * var(--translate-x-multiplier))}.no-gravity.svelte-io58ff .confetti.svelte-io58ff{animation-name:svelte-io58ff-no-gravity-translate;animation-timing-function:ease-out}@media(prefers-reduced-motion){.confetti.svelte-io58ff.svelte-io58ff,.confetti.svelte-io58ff.svelte-io58ff::before{animation:none}}")}function Se(e,t,F){const n=e.slice();return n[18]=t[F],n}function Ee(e){let t,F={length:e[6]},n=[];for(let t=0;t<F.length;t+=1)n[t]=je(Se(e,F,t));return{c(){t=q("div");for(let e=0;e<n.length;e+=1)n[e].c();j(t,"class","confetti-holder svelte-io58ff"),D(t,"rounded",e[9]),D(t,"cone",e[10]),D(t,"no-gravity",e[11])},m(e,F){z(e,t,F);for(let e=0;e<n.length;e+=1)n[e].m(t,null)},p(e,o){if(20991&o){let r;for(F={length:e[6]},r=0;r<F.length;r+=1){const i=Se(e,F,r);n[r]?n[r].p(i,o):(n[r]=je(i),n[r].c(),n[r].m(t,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=F.length}512&o&&D(t,"rounded",e[9]),1024&o&&D(t,"cone",e[10]),2048&o&&D(t,"no-gravity",e[11])},d(e){e&&k(t),function(e,t){for(let F=0;F<e.length;F+=1)e[F]&&e[F].d(t)}(n,e)}}}function je(e){let t;return{c(){t=q("div"),j(t,"class","confetti svelte-io58ff"),T(t,"--fall-distance",e[8]),T(t,"--size",e[0]+"px"),T(t,"--color",e[14]()),T(t,"--skew",Te(-45,45)+"deg,"+Te(-45,45)+"deg"),T(t,"--rotation-xyz",Te(-10,10)+", "+Te(-10,10)+", "+Te(-10,10)),T(t,"--rotation-deg",Te(0,360)+"deg"),T(t,"--translate-y-multiplier",Te(e[2][0],e[2][1])),T(t,"--translate-x-multiplier",Te(e[1][0],e[1][1])),T(t,"--scale",.1*Te(2,10)),T(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),T(t,"--transition-delay",Te(e[5][0],e[5][1])+"ms"),T(t,"--transition-iteration-count",e[4]?"infinite":e[7]),T(t,"--x-spread",1-e[12])},m(e,F){z(e,t,F)},p(e,F){256&F&&T(t,"--fall-distance",e[8]),1&F&&T(t,"--size",e[0]+"px"),4&F&&T(t,"--translate-y-multiplier",Te(e[2][0],e[2][1])),2&F&&T(t,"--translate-x-multiplier",Te(e[1][0],e[1][1])),24&F&&T(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),32&F&&T(t,"--transition-delay",Te(e[5][0],e[5][1])+"ms"),144&F&&T(t,"--transition-iteration-count",e[4]?"infinite":e[7]),4096&F&&T(t,"--x-spread",1-e[12])},d(e){e&&k(t)}}}function Ae(e){let t,F=!e[13]&&Ee(e);return{c(){F&&F.c(),t=C("")},m(e,n){F&&F.m(e,n),z(e,t,n)},p(e,[n]){e[13]?F&&(F.d(1),F=null):F?F.p(e,n):(F=Ee(e),F.c(),F.m(t.parentNode,t))},i:n,o:n,d(e){F&&F.d(e),e&&k(t)}}}function Te(e,t){return Math.random()*(t-e)+e}function Oe(e,t,F){let{size:n=10}=t,{x:o=[-.5,.5]}=t,{y:r=[.25,1]}=t,{duration:i=2e3}=t,{infinite:a=!1}=t,{delay:l=[0,50]}=t,{colorRange:s=[0,360]}=t,{colorArray:c=[]}=t,{amount:u=50}=t,{iterationCount:f=1}=t,{fallDistance:d="100px"}=t,{rounded:p=!1}=t,{cone:m=!1}=t,{noGravity:v=!1}=t,{xSpread:H=.15}=t,{destroyOnComplete:y=!0}=t,g=!1;return M(()=>{y&&!a&&"infinite"!=f&&setTimeout(()=>F(13,g=!0),(i+l[1])*f)}),e.$$set=e=>{"size"in e&&F(0,n=e.size),"x"in e&&F(1,o=e.x),"y"in e&&F(2,r=e.y),"duration"in e&&F(3,i=e.duration),"infinite"in e&&F(4,a=e.infinite),"delay"in e&&F(5,l=e.delay),"colorRange"in e&&F(15,s=e.colorRange),"colorArray"in e&&F(16,c=e.colorArray),"amount"in e&&F(6,u=e.amount),"iterationCount"in e&&F(7,f=e.iterationCount),"fallDistance"in e&&F(8,d=e.fallDistance),"rounded"in e&&F(9,p=e.rounded),"cone"in e&&F(10,m=e.cone),"noGravity"in e&&F(11,v=e.noGravity),"xSpread"in e&&F(12,H=e.xSpread),"destroyOnComplete"in e&&F(17,y=e.destroyOnComplete)},[n,o,r,i,a,l,u,f,d,p,m,v,H,g,function(){return c.length?c[Math.round(Math.random()*(c.length-1))]:`hsl(${Math.round(Te(s[0],s[1]))}, 75%, 50%`},s,c,y]}var Pe=class extends ue{constructor(e){super(),ce(this,e,Oe,Ae,c,{size:0,x:1,y:2,duration:3,infinite:4,delay:5,colorRange:15,colorArray:16,amount:6,iterationCount:7,fallDistance:8,rounded:9,cone:10,noGravity:11,xSpread:12,destroyOnComplete:17},Ce)}};const De={small:["SFFFFFFFFF","FFFFFFFFFF","HFFFFFFFFF","FFHFFFFFFF","HFFFFHFFFF","FFHFFFHFFF","HFFFFHFFFF","FFHFFFFFFF","HFFFFFFFFF","FFFGFFFFFF"],"16x16":["HHFFFFFFFFFFFFHH","HFFFFFFFFFFFFFFH","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHFFFFHHHFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFGFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHHHHHHHHFFF","FFFFHHHHHHHHFFFF","FFFFFFFFFFFFFFFF","HFFFFFFFSFFFFFFH","HHFFFFFFFFFFFFHH"],"32x32":["HHHHHHFFFFFFFFFFFFFFFFFHHHHHHHHH","HHFFFFFFFFFFFFFFFFFFFFFFHHHHHHHH","FFFFSFFFHHFFFFFFFFFFFFFFFFFFFFFH","FFFFFFFFFHFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHFFFFFFFFFHHHHHHHHFFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHHFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHFFFFFFFFFF","HHFFHHHHHHHHHHHHFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFHHHHHFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFHHFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHF","FFFFFFFFFFFFFFFFFFFFFFFFFFFHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFGFFFFFFFHFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFHFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHFFHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFFFFFFFFFHFFFFFFFF","HHHHHHHFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHHHHHHHHFFFFFFFFFFFFFFFFFFFF"]},Ie={H:"#1976d2",S:"#ef9a9a",F:"#e1f5fe",G:"#81c784",T:"#ffe0b2"};const{window:Re}=ie;function Le(e){w(e,"svelte-y0zxql","canvas.svelte-y0zxql.svelte-y0zxql{padding:1em\n  }.game.svelte-y0zxql.svelte-y0zxql{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-bottom:1.5em}.controls.svelte-y0zxql.svelte-y0zxql{display:flex;flex-direction:column;align-items:center}.status.svelte-y0zxql.svelte-y0zxql{height:1em;width:16em;text-align:center;transition:color 1s;padding-top:1em}.map.svelte-y0zxql.svelte-y0zxql{display:flex;flex-direction:column;align-items:center}.menu.svelte-y0zxql.svelte-y0zxql{display:flex;flex-direction:row;align-items:center}.key.svelte-y0zxql.svelte-y0zxql{background-color:#eee;border-radius:4px;font-size:1em;padding:0.5em 0.5em;border-top:5px solid rgba(255, 255, 255, 0.5);border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(0, 0, 0, 0.2);border-bottom:5px solid rgba(0, 0, 0, 0.2);color:#555;text-align:center;width:4em;height:4em;cursor:pointer}@media(min-width: 768px){.game.svelte-y0zxql.svelte-y0zxql{flex-direction:row}.controls.svelte-y0zxql.svelte-y0zxql{flex-direction:column}.menu.svelte-y0zxql.svelte-y0zxql{flex-direction:column}.key.svelte-y0zxql.svelte-y0zxql{width:3em;height:3em}}.menu.svelte-y0zxql select.svelte-y0zxql{margin:0.5em}.keyboard.svelte-y0zxql.svelte-y0zxql{display:grid;grid-template-columns:auto auto auto;grid-gap:0.5em;padding:1em}.key.svelte-y0zxql.svelte-y0zxql:active{background-color:#ddd}")}function Me(e){let t,F;return t=new Pe({props:{cone:!0,delay:[0,200],amount:"50",x:[-.7,.7],y:[.5,1.5]}}),{c(){var e;(e=t.$$.fragment)&&e.c()},m(e,n){le(t,e,n),F=!0},i(e){F||(oe(t.$$.fragment,e),F=!0)},o(e){re(t.$$.fragment,e),F=!1},d(e){se(t,e)}}}function Be(e){let t;return{c(){t=q("p"),t.textContent="Press the arrow keys to move...",j(t,"class","status svelte-y0zxql")},m(e,F){z(e,t,F)},p:n,d(e){e&&k(t)}}}function Ge(e){let t,F;return{c(){t=q("p"),F=C(e[10]),j(t,"class","status svelte-y0zxql"),T(t,"transition","color "+(e[10]?2:0)+"s"),T(t,"transition-timing-function","ease-in"),T(t,"color",e[10]?"white":"black")},m(e,n){z(e,t,n),b(t,F)},p(e,n){1024&n[0]&&A(F,e[10]),1024&n[0]&&T(t,"transition","color "+(e[10]?2:0)+"s"),1024&n[0]&&T(t,"color",e[10]?"white":"black")},d(e){e&&k(t)}}}function Ye(e){let t,F,n,o,r,i,a,s,c,u,d,p,m,v,H,y,g,h,x,w,_,$,C,A,P,D,I,R,L,M,B,G,Y,N,X,J,K,U,V,W,Z,ee,te,ie,ae=e[11]&&Me();function le(e,t){return e[9]?Ge:Be}let se=le(e),ce=se(e);return{c(){t=q("div"),F=q("div"),n=q("canvas"),i=S(),a=q("img"),c=S(),ae&&ae.c(),u=S(),d=q("div"),ce.c(),p=S(),m=q("div"),v=q("select"),H=q("option"),H.textContent="Frozen Lake",y=q("option"),y.textContent="Frozen Smiley",g=q("option"),g.textContent="Large Lake",h=S(),x=q("select"),w=q("option"),w.textContent="No Teacher",_=q("option"),_.textContent="Distance 1",$=q("option"),$.textContent="Distance 2",C=S(),A=q("select"),P=q("option"),P.textContent="Soft Reset",D=q("option"),D.textContent="Back 4",I=q("option"),I.textContent="Hard Reset",L=S(),M=q("div"),B=q("div"),G=S(),Y=q("button"),Y.textContent="↑",N=S(),X=q("div"),J=S(),K=q("button"),K.textContent="←",U=S(),V=q("button"),V.textContent="↓",W=S(),Z=q("button"),Z.textContent="→",j(n,"width",o=500*e[12]),j(n,"height",r=500*e[12]),T(n,"width","300px"),T(n,"height","300px"),j(n,"class","svelte-y0zxql"),j(a,"width","300"),j(a,"alt","Legend for the above mini-game"),f(a.src,s="./images/map_legend_stacked.svg")||j(a,"src","./images/map_legend_stacked.svg"),j(F,"class","map svelte-y0zxql"),H.__value="small",H.value=H.__value,y.__value="16x16",y.value=y.__value,g.__value="32x32",g.value=g.__value,j(v,"name","map"),j(v,"id","map"),j(v,"class","svelte-y0zxql"),void 0===e[1]&&Q(()=>e[18].call(v)),w.__value="0",w.value=w.__value,_.__value="1",_.value=_.__value,$.__value="2",$.value=$.__value,j(x,"name","teacher"),j(x,"id","teacher"),j(x,"class","svelte-y0zxql"),void 0===e[2]&&Q(()=>e[19].call(x)),P.__value="SR",P.value=P.__value,D.__value="B4",D.value=D.__value,I.__value="HR",I.value=I.__value,j(A,"name","reset"),j(A,"id","reset"),A.disabled=R=0==e[2],j(A,"class","svelte-y0zxql"),void 0===e[3]&&Q(()=>e[20].call(A)),j(m,"class","menu svelte-y0zxql"),j(Y,"class","key svelte-y0zxql"),j(K,"class","key svelte-y0zxql"),j(V,"class","key svelte-y0zxql"),j(Z,"class","key svelte-y0zxql"),j(M,"class","keyboard svelte-y0zxql"),j(d,"class","controls svelte-y0zxql"),j(t,"class","game svelte-y0zxql")},m(o,r){z(o,t,r),b(t,F),b(F,n),e[16](n),b(F,i),b(F,a),b(F,c),ae&&ae.m(F,null),b(t,u),b(t,d),ce.m(d,null),b(d,p),b(d,m),b(m,v),b(v,H),b(v,y),b(v,g),O(v,e[1]),b(m,h),b(m,x),b(x,w),b(x,_),b(x,$),O(x,e[2]),b(m,C),b(m,A),b(A,P),b(A,D),b(A,I),O(A,e[3]),b(d,L),b(d,M),b(M,B),b(M,G),b(M,Y),b(M,N),b(M,X),b(M,J),b(M,K),b(M,U),b(M,V),b(M,W),b(M,Z),ee=!0,te||(ie=[E(Re,"keydown",e[14]),E(n,"click",e[17]),E(v,"change",e[18]),E(v,"change",e[13]),E(x,"change",e[19]),E(A,"change",e[20]),E(Y,"click",e[21]),E(K,"click",e[22]),E(V,"click",e[23]),E(Z,"click",e[24])],te=!0)},p(e,t){(!ee||4096&t[0]&&o!==(o=500*e[12]))&&j(n,"width",o),(!ee||4096&t[0]&&r!==(r=500*e[12]))&&j(n,"height",r),e[11]?ae?2048&t[0]&&oe(ae,1):(ae=Me(),ae.c(),oe(ae,1),ae.m(F,null)):ae&&(Fe(),re(ae,1,1,()=>{ae=null}),ne()),se===(se=le(e))&&ce?ce.p(e,t):(ce.d(1),ce=se(e),ce&&(ce.c(),ce.m(d,p))),2&t[0]&&O(v,e[1]),4&t[0]&&O(x,e[2]),(!ee||4&t[0]&&R!==(R=0==e[2]))&&(A.disabled=R),8&t[0]&&O(A,e[3])},i(e){ee||(oe(ae),ee=!0)},o(e){re(ae),ee=!1},d(F){F&&k(t),e[16](null),ae&&ae.d(),ce.d(),te=!1,l(ie)}}}function Ne(e,t,F){let i,a,l,s,c,u=n;e.$$.on_destroy.push(()=>u());var f,d,m,H=!1,y=!1,g=!1,x=!1,b=!0,w=[],_=!1,$="",z=null,k=!1;const q=new Image;q.src="./images/robot.png";const C=new Image;C.src="./images/robot-flipped.png";var S=!1,E=q;function j(e){F(10,$=""),clearTimeout(z),setTimeout(()=>{F(10,$=e)},1),z=setTimeout(()=>{F(10,$="")},2e3)}M(()=>{const e=a.getContext("2d");var t,n,$,z,A;function T(e){let t=e.length,F=e[0].length,n=new Array(t).fill(!1).map(()=>new Array(F).fill(!1));for(let r=0;r<t;r++)for(let t=0;t<F;t++){var o=!1;try{o|=e[r][t+1]}catch(e){}try{o|=e[r+1][t]}catch(e){}try{o|=e[r][t-1]}catch(e){}try{o|=e[r-1][t]}catch(e){}n[r][t]=o}return n}function O(){n=De[l],t=a.height/n.length,A=function(e,t){if(0==t)return e;var F=new Array;for(let e=0;e<n.length;e++)F.push(n[e].split(""));let o=F.map(e=>e.map(e=>"H"==e)),r=F.map(e=>e.map(e=>"F"==e));var i,a=Array.from(o);for(let e=0;e<t;e++)i=T(a),a=i.map((e,t)=>e.map((e,F)=>e||a[t][F]));var l=Array.from(F);for(let e=0;e<F.length;e++)for(let t=0;t<F[0].length;t++)i[e][t]&&r[e][t]&&(l[e][t]="T");let s=new Array;for(let t=0;t<e.length;t++)s.push(l[t].join(""));return s}(n,s);for(let F=0;F<n.length;F++)for(let o=0;o<n[0].length;o++){let n=A[F][o];"S"==n&&($=[o,F]);let r=o*t,i=F*t;e.beginPath(),e.rect(r,i,t+1,t+1),e.fillStyle=Ie[n],e.fill(),e.closePath()}}function P(e){f.set(e),d=e,w.push(d)}function D(){w=[],P($)}F(12,m=window.devicePixelRatio),e.scale(m,m),O(),function l(){(y||H||g||x)&&F(9,_=!0),e.clearRect(0,0,a.width,a.height),O(),b&&(F(8,f=function(e,t={}){const F=$e(e);let n,i=e;function a(a,l){if(null==e)return F.set(e=a),Promise.resolve();i=a;let s=n,c=!1,{delay:u=0,duration:f=400,easing:d=o,interpolate:p=qe}=r(r({},t),l);if(0===f)return s&&(s.abort(),s=null),F.set(e=i),Promise.resolve();const m=v()+u;let H;return n=h(t=>{if(t<m)return!0;c||(H=p(e,a),"function"==typeof f&&(f=f(e,a)),c=!0),s&&(s.abort(),s=null);const n=t-m;return n>f?(F.set(e=a),!1):(F.set(e=H(d(n/f))),!0)}),n.promise}return{set:a,update:(t,F)=>a(t(i,e),F),subscribe:F.subscribe}}($,{duration:150,easing:ze})),u(),u=p(f,e=>F(33,i=e)),D()),async function(){E=S?C:q,e.drawImage(E,i[0]*t,i[1]*t,t,t)}();const s=Math.random();y||H?s<.1?(F(5,y=!1),F(4,H=!1),F(6,g=!0)):s<.2&&(F(5,y=!1),F(4,H=!1),F(7,x=!0)):(g||x)&&(s<.1?(F(6,g=!1),F(7,x=!1),F(5,y=!0)):s<.2&&(F(6,g=!1),F(7,x=!1),F(4,H=!0))),s<.2&&(g||x||y||H)&&j("You just slipped."),y&&(S=!0),H&&(S=!1),z=Array.from(d);let[m,T]=Array.from(z);if(H?m<n[0].length-1&&(m+=1):y?m>0&&(m-=1):g?T>0&&(T-=1):x&&T<n.length-1&&(T+=1),(H||y||x||g)&&P([m,T]),"G"==n[T][m])F(11,k=!0),setTimeout(()=>{F(11,k=!1)},3e3),j("You won!"),D();else if("H"==n[T][m])j("You failed."),D();else if("T"==A[T][m]){if("HR"==c)D();else if("B4"==c){for(let e=0;e<4&&w.length>1;e++)w.pop();P(w[w.length-1])}else"SR"==c&&P(z);j("The teacher set you back.")}b=!1,F(4,H=!1),F(5,y=!1),F(6,g=!1),F(7,x=!1),requestAnimationFrame(l)}()});return[a,l,s,c,H,y,g,x,f,_,$,k,m,function(){b=!0},function(e){39==e.keyCode||"d"==e.key?(F(4,H=!0),e.preventDefault()):37==e.keyCode||"a"==e.key?(F(5,y=!0),e.preventDefault()):38==e.keyCode||"w"==e.key?(F(6,g=!0),e.preventDefault()):40!=e.keyCode&&"s"!=e.key||(F(7,x=!0),e.preventDefault())},j,function(e){G[e?"unshift":"push"](()=>{a=e,F(0,a)})},()=>j("Press the arrow keys to move..."),function(){l=P(this),F(1,l)},function(){s=P(this),F(2,s)},function(){c=P(this),F(3,c)},()=>F(6,g=!0),()=>F(5,y=!0),()=>F(7,x=!0),()=>F(4,H=!0)]}var Xe=class extends ue{constructor(e){super(),ce(this,e,Ne,Ye,c,{},Le,[-1,-1])}},Je=document.getElementById("trajectories-visualization");Je.addEventListener("ready",(function(){var e=Je.querySelector("#trajectories-visualization-target");new me({target:e})}));var Ke=document.getElementById("back-visualization");Ke.addEventListener("ready",(function(){var e=Ke.querySelector("#back-visualization-target");new ge({target:e})}));var Qe=document.getElementById("incremental-visualization");Qe.addEventListener("ready",(function(){var e=Qe.querySelector("#incremental-visualization-target");new we({target:e})}));var Ue=document.getElementById("grid-visualization");Ue.addEventListener("ready",(function(){var e=Ue.querySelector("#grid-visualization-target");new Xe({target:e})}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vL3RyYWplY3Rvcmllcy5zdmVsdGUiLCJ3ZWJwYWNrOi8vL2JhY2suc3ZlbHRlIiwid2VicGFjazovLy9pbmNyZW1lbnRhbC5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9zdG9yZS9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9lYXNpbmcvaW5kZXgubWpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zdmVsdGUvbW90aW9uL2luZGV4Lm1qcyIsIndlYnBhY2s6Ly8vQ29uZmV0dGkuc3ZlbHRlIiwid2VicGFjazovLy9jb25zdGFudHMuc3ZlbHRlIiwid2VicGFjazovLy9ncmlkLnN2ZWx0ZSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJub29wIiwiaWRlbnRpdHkiLCJ4IiwidGFyIiwic3JjIiwiayIsImZuIiwiYmxhbmtfb2JqZWN0IiwicnVuX2FsbCIsImZucyIsImZvckVhY2giLCJpc19mdW5jdGlvbiIsInRoaW5nIiwic2FmZV9ub3RfZXF1YWwiLCJhIiwiYiIsInNyY191cmxfZXF1YWxfYW5jaG9yIiwic3JjX3VybF9lcXVhbCIsImVsZW1lbnRfc3JjIiwidXJsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaHJlZiIsImlzX2VtcHR5Iiwib2JqIiwia2V5cyIsImxlbmd0aCIsInN0b3JlIiwiY2FsbGJhY2tzIiwidW5zdWIiLCJzdWJzY3JpYmUiLCJ1bnN1YnNjcmliZSIsImlzX2NsaWVudCIsIndpbmRvdyIsIm5vdyIsInBlcmZvcm1hbmNlIiwiRGF0ZSIsInJhZiIsImNiIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidGFza3MiLCJTZXQiLCJydW5fdGFza3MiLCJ0YXNrIiwiZGVsZXRlIiwiZiIsInNpemUiLCJsb29wIiwiY2FsbGJhY2siLCJwcm9taXNlIiwiUHJvbWlzZSIsImZ1bGZpbGwiLCJhZGQiLCJpc19oeWRyYXRpbmciLCJhcHBlbmQiLCJ0YXJnZXQiLCJub2RlIiwiYXBwZW5kQ2hpbGQiLCJhcHBlbmRfc3R5bGVzIiwic3R5bGVfc2hlZXRfaWQiLCJzdHlsZXMiLCJhcHBlbmRfc3R5bGVzX3RvIiwiZ2V0X3Jvb3RfZm9yX3N0eWxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImlkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRfc3R5bGVzaGVldCIsInJvb3QiLCJnZXRSb290Tm9kZSIsIm93bmVyRG9jdW1lbnQiLCJob3N0IiwiaGVhZCIsImluc2VydCIsImFuY2hvciIsImluc2VydEJlZm9yZSIsImRldGFjaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRhdGEiLCJjcmVhdGVUZXh0Tm9kZSIsInNwYWNlIiwibGlzdGVuIiwiZXZlbnQiLCJoYW5kbGVyIiwib3B0aW9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYXR0ciIsImF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldF9kYXRhIiwidGV4dCIsIndob2xlVGV4dCIsInNldF9zdHlsZSIsImltcG9ydGFudCIsInJlbW92ZVByb3BlcnR5Iiwic2V0UHJvcGVydHkiLCJzZWxlY3Rfb3B0aW9uIiwic2VsZWN0Iiwib3B0aW9uIiwiX192YWx1ZSIsInNlbGVjdGVkIiwic2VsZWN0ZWRJbmRleCIsInNlbGVjdF92YWx1ZSIsInNlbGVjdGVkX29wdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2dnbGVfY2xhc3MiLCJlbGVtZW50IiwidG9nZ2xlIiwiY2xhc3NMaXN0IiwiTWFwIiwiY3VycmVudF9jb21wb25lbnQiLCJzZXRfY3VycmVudF9jb21wb25lbnQiLCJjb21wb25lbnQiLCJnZXRfY3VycmVudF9jb21wb25lbnQiLCJFcnJvciIsIm9uTW91bnQiLCIkJCIsIm9uX21vdW50IiwicHVzaCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwicmVzb2x2ZSIsInVwZGF0ZV9zY2hlZHVsZWQiLCJzY2hlZHVsZV91cGRhdGUiLCJ0aGVuIiwiZmx1c2giLCJhZGRfcmVuZGVyX2NhbGxiYWNrIiwic2Vlbl9jYWxsYmFja3MiLCJmbHVzaGlkeCIsInNhdmVkX2NvbXBvbmVudCIsInBvcCIsImhhcyIsImNsZWFyIiwiZnJhZ21lbnQiLCJ1cGRhdGUiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsIm91dHJvcyIsImdyb3VwX291dHJvcyIsImNoZWNrX291dHJvcyIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwidHJhbnNpdGlvbl9vdXQiLCJnbG9iYWxzIiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIlN2ZWx0ZUVsZW1lbnQiLCJtb3VudF9jb21wb25lbnQiLCJjdXN0b21FbGVtZW50Iiwib25fZGVzdHJveSIsIm5ld19vbl9kZXN0cm95IiwibWFwIiwiZmlsdGVyIiwiZGVzdHJveV9jb21wb25lbnQiLCJkZXRhY2hpbmciLCJpbml0IiwiaW5zdGFuY2UiLCJjcmVhdGVfZnJhZ21lbnQiLCJub3RfZXF1YWwiLCJwcm9wcyIsInBhcmVudF9jb21wb25lbnQiLCJib3VuZCIsIm9uX2Rpc2Nvbm5lY3QiLCJjb250ZXh0Iiwic2tpcF9ib3VuZCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGROb2RlcyIsImludHJvIiwiSFRNTEVsZW1lbnQiLCJzdXBlciIsInRoaXMiLCJhdHRhY2hTaGFkb3ciLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkJHByb3BzIiwiJCRzZXQiLCJTdmVsdGVDb21wb25lbnQiLCJsZW4iLCJjb3VudCIsInBhcnNlSW50Iiwic3Vic2NyaWJlcl9xdWV1ZSIsIndyaXRhYmxlIiwic3RhcnQiLCJzdG9wIiwic3Vic2NyaWJlcnMiLCJzZXQiLCJuZXdfdmFsdWUiLCJydW5fcXVldWUiLCJzdWJzY3JpYmVyIiwicnVuIiwiaW52YWxpZGF0ZSIsImN1YmljT3V0IiwiaXNfZGF0ZSIsInRvU3RyaW5nIiwiZ2V0X2ludGVycG9sYXRvciIsImlzQXJyYXkiLCJhcnIiLCJiaSIsImdldFRpbWUiLCJkZWx0YSIsImludGVycG9sYXRvcnMiLCJyZXN1bHQiLCJpdGVyYXRpb25zIiwicmFuZG9tQmV0d2VlbiIsIm1pbiIsIm1heCIsIk1hdGgiLCJyYW5kb20iLCJ5IiwiZHVyYXRpb24iLCJpbmZpbml0ZSIsImRlbGF5IiwiY29sb3JSYW5nZSIsImNvbG9yQXJyYXkiLCJhbW91bnQiLCJpdGVyYXRpb25Db3VudCIsImZhbGxEaXN0YW5jZSIsInJvdW5kZWQiLCJjb25lIiwibm9HcmF2aXR5IiwieFNwcmVhZCIsImRlc3Ryb3lPbkNvbXBsZXRlIiwiY29tcGxldGUiLCJzZXRUaW1lb3V0Iiwicm91bmQiLCJtYXBzIiwiY29sb3JzIiwiY2FudmFzIiwic2VsZWN0ZWRNYXAiLCJzZWxlY3RlZFRlYWNoZXIiLCJzZWxlY3RlZFJlc2V0IiwicG9zIiwicmVhbFBvcyIsInBpeGVsUmF0aW8iLCJyaWdodFByZXNzZWQiLCJsZWZ0UHJlc3NlZCIsInVwUHJlc3NlZCIsImRvd25QcmVzc2VkIiwibWFwQ2hhbmdlZCIsImhpc3RvcnkiLCJoYXNJbnRlcmFjdGVkIiwic3RhdHVzTWVzc2FnZSIsInN0YXR1c1RpbWVyIiwiY29uZmV0dGkiLCJyb2JvdCIsIkltYWdlIiwicm9ib3RGbGlwcGVkIiwiZmxpcHBlZCIsImltYWdlIiwic2hvd01lc3NhZ2UiLCJtc2ciLCJjbGVhclRpbWVvdXQiLCJnZXRDb250ZXh0IiwidGlsZVNpemUiLCJsYXN0UG9zaXRpb24iLCJ0ZWFjaGVyTWFwIiwib25lU3RlcFJlYWNoIiwiYmFzZU1hc2siLCJyb3dzIiwiY29scyIsIm9uZVN0ZXBNYXNrIiwiaiIsInJlcyIsImUiLCJkcmF3RW52aXJvbm1lbnQiLCJoZWlnaHQiLCJiYXNlTWFwIiwiZGlzdGFuY2UiLCJuZXdCYXNlTWFwIiwic3BsaXQiLCJiYXNlRGFuZ2VyTWFzayIsInJvdyIsImJhc2VFbXB0eU1hc2siLCJyZWFjaE1hc2siLCJwcmV2aW91c01hc2siLCJuZXdNYXAiLCJqb2luIiwiYWRkVGVhY2hlciIsInN0YXRlIiwiYmVnaW5QYXRoIiwicmVjdCIsImZpbGxTdHlsZSIsImNsb3NlUGF0aCIsIm1vdmVBZ2VudCIsIm5ld1BvcyIsInJlc2V0QWdlbnQiLCJkZXZpY2VQaXhlbFJhdGlvIiwic2NhbGUiLCJkcmF3IiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJkZWZhdWx0cyIsInRhcmdldF92YWx1ZSIsIm9wdHMiLCJwcmV2aW91c190YXNrIiwic3RhcnRlZCIsImVhc2luZyIsImludGVycG9sYXRlIiwiYWJvcnQiLCJlbGFwc2VkIiwidHdlZW5lZCIsImRyYXdJbWFnZSIsIiRwb3MiLCJkcmF3QWdlbnQiLCJybmQiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJ0cmFqZWN0b3JpZXNUYWciLCJUcmFqZWN0b3JpZXMiLCJiYWNrVGFnIiwiQmFjayIsImluY3JlbWVudGFsVGFnIiwiSW5jcmVtZW50YWwiLCJncmlkVGFnIiwiR3JpZCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcsV0FBWSxPQUFPSCxFQUNoRixJQUFJSSxFQUFLWCxPQUFPWSxPQUFPLE1BR3ZCLEdBRkExQixFQUFvQmtCLEVBQUVPLEdBQ3RC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QUFJbU8sR0FBSyxDQUFFeFIsY0FHbkIsSUFBTXlSLEdBQWlCNVQsU0FBUzJDLGVBQWUsNkJBRS9DaVIsR0FBZTFQLGlCQUFpQixTQUFTLFdBQ3hDLElBQU0vQixFQUFTeVIsR0FBZXBPLGNBQWMscUNBQzlCLElBQUlxTyxHQUFZLENBQUUxUixjQUdqQyxJQUFNMlIsR0FBVTlULFNBQVMyQyxlQUFlLHNCQUV4Q21SLEdBQVE1UCxpQkFBaUIsU0FBUyxXQUNqQyxJQUFNL0IsRUFBUzJSLEdBQVF0TyxjQUFjLDhCQUM5QixJQUFJdU8sR0FBSyxDQUFFNVIiLCJmaWxlIjoiaW5kZXguYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZnVuY3Rpb24gbm9vcCgpIHsgfVxuY29uc3QgaWRlbnRpdHkgPSB4ID0+IHg7XG5mdW5jdGlvbiBhc3NpZ24odGFyLCBzcmMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBrIGluIHNyYylcbiAgICAgICAgdGFyW2tdID0gc3JjW2tdO1xuICAgIHJldHVybiB0YXI7XG59XG5mdW5jdGlvbiBpc19wcm9taXNlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBhZGRfbG9jYXRpb24oZWxlbWVudCwgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyKSB7XG4gICAgZWxlbWVudC5fX3N2ZWx0ZV9tZXRhID0ge1xuICAgICAgICBsb2M6IHsgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gcnVuKGZuKSB7XG4gICAgcmV0dXJuIGZuKCk7XG59XG5mdW5jdGlvbiBibGFua19vYmplY3QoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG59XG5mdW5jdGlvbiBydW5fYWxsKGZucykge1xuICAgIGZucy5mb3JFYWNoKHJ1bik7XG59XG5mdW5jdGlvbiBpc19mdW5jdGlvbih0aGluZykge1xuICAgIHJldHVybiB0eXBlb2YgdGhpbmcgPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBzYWZlX25vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGIgfHwgKChhICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JykgfHwgdHlwZW9mIGEgPT09ICdmdW5jdGlvbicpO1xufVxubGV0IHNyY191cmxfZXF1YWxfYW5jaG9yO1xuZnVuY3Rpb24gc3JjX3VybF9lcXVhbChlbGVtZW50X3NyYywgdXJsKSB7XG4gICAgaWYgKCFzcmNfdXJsX2VxdWFsX2FuY2hvcikge1xuICAgICAgICBzcmNfdXJsX2VxdWFsX2FuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB9XG4gICAgc3JjX3VybF9lcXVhbF9hbmNob3IuaHJlZiA9IHVybDtcbiAgICByZXR1cm4gZWxlbWVudF9zcmMgPT09IHNyY191cmxfZXF1YWxfYW5jaG9yLmhyZWY7XG59XG5mdW5jdGlvbiBub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiO1xufVxuZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfc3RvcmUoc3RvcmUsIG5hbWUpIHtcbiAgICBpZiAoc3RvcmUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RvcmUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmFtZX0nIGlzIG5vdCBhIHN0b3JlIHdpdGggYSAnc3Vic2NyaWJlJyBtZXRob2RgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmUsIC4uLmNhbGxiYWNrcykge1xuICAgIGlmIChzdG9yZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBjb25zdCB1bnN1YiA9IHN0b3JlLnN1YnNjcmliZSguLi5jYWxsYmFja3MpO1xuICAgIHJldHVybiB1bnN1Yi51bnN1YnNjcmliZSA/ICgpID0+IHVuc3ViLnVuc3Vic2NyaWJlKCkgOiB1bnN1Yjtcbn1cbmZ1bmN0aW9uIGdldF9zdG9yZV92YWx1ZShzdG9yZSkge1xuICAgIGxldCB2YWx1ZTtcbiAgICBzdWJzY3JpYmUoc3RvcmUsIF8gPT4gdmFsdWUgPSBfKSgpO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGNvbXBvbmVudF9zdWJzY3JpYmUoY29tcG9uZW50LCBzdG9yZSwgY2FsbGJhY2spIHtcbiAgICBjb21wb25lbnQuJCQub25fZGVzdHJveS5wdXNoKHN1YnNjcmliZShzdG9yZSwgY2FsbGJhY2spKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zbG90KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICBjb25zdCBzbG90X2N0eCA9IGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbik7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uWzBdKHNsb3RfY3R4KTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblsxXSAmJiBmblxuICAgICAgICA/IGFzc2lnbigkJHNjb3BlLmN0eC5zbGljZSgpLCBkZWZpbml0aW9uWzFdKGZuKGN0eCkpKVxuICAgICAgICA6ICQkc2NvcGUuY3R4O1xufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY2hhbmdlcyhkZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvblsyXSAmJiBmbikge1xuICAgICAgICBjb25zdCBsZXRzID0gZGVmaW5pdGlvblsyXShmbihkaXJ0eSkpO1xuICAgICAgICBpZiAoJCRzY29wZS5kaXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxldHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGgubWF4KCQkc2NvcGUuZGlydHkubGVuZ3RoLCBsZXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkW2ldID0gJCRzY29wZS5kaXJ0eVtpXSB8IGxldHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkJHNjb3BlLmRpcnR5IHwgbGV0cztcbiAgICB9XG4gICAgcmV0dXJuICQkc2NvcGUuZGlydHk7XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdF9iYXNlKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBzbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBpZiAoc2xvdF9jaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY29udGV4dCA9IGdldF9zbG90X2NvbnRleHQoc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGdldF9zbG90X2NvbnRleHRfZm4pO1xuICAgICAgICBzbG90LnAoc2xvdF9jb250ZXh0LCBzbG90X2NoYW5nZXMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90KHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGNvbnN0IHNsb3RfY2hhbmdlcyA9IGdldF9zbG90X2NoYW5nZXMoc2xvdF9kZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbik7XG4gICAgdXBkYXRlX3Nsb3RfYmFzZShzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbn1cbmZ1bmN0aW9uIGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSgkJHNjb3BlKSB7XG4gICAgaWYgKCQkc2NvcGUuY3R4Lmxlbmd0aCA+IDMyKSB7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gW107XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9ICQkc2NvcGUuY3R4Lmxlbmd0aCAvIDMyO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkaXJ0eVtpXSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaXJ0eTtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gZXhjbHVkZV9pbnRlcm5hbF9wcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3VsdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Jlc3RfcHJvcHMocHJvcHMsIGtleXMpIHtcbiAgICBjb25zdCByZXN0ID0ge307XG4gICAga2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoIWtleXMuaGFzKGspICYmIGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3Rba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfc2xvdHMoc2xvdHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgbGV0IHJhbiA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICBpZiAocmFuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICBmbi5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuICAgIH07XG59XG5mdW5jdGlvbiBudWxsX3RvX2VtcHR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X3N0b3JlX3ZhbHVlKHN0b3JlLCByZXQsIHZhbHVlKSB7XG4gICAgc3RvcmUuc2V0KHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufVxuY29uc3QgaGFzX3Byb3AgPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbmZ1bmN0aW9uIGFjdGlvbl9kZXN0cm95ZXIoYWN0aW9uX3Jlc3VsdCkge1xuICAgIHJldHVybiBhY3Rpb25fcmVzdWx0ICYmIGlzX2Z1bmN0aW9uKGFjdGlvbl9yZXN1bHQuZGVzdHJveSkgPyBhY3Rpb25fcmVzdWx0LmRlc3Ryb3kgOiBub29wO1xufVxuXG5jb25zdCBpc19jbGllbnQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbmxldCBub3cgPSBpc19jbGllbnRcbiAgICA/ICgpID0+IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxuICAgIDogKCkgPT4gRGF0ZS5ub3coKTtcbmxldCByYWYgPSBpc19jbGllbnQgPyBjYiA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2IpIDogbm9vcDtcbi8vIHVzZWQgaW50ZXJuYWxseSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gc2V0X25vdyhmbikge1xuICAgIG5vdyA9IGZuO1xufVxuZnVuY3Rpb24gc2V0X3JhZihmbikge1xuICAgIHJhZiA9IGZuO1xufVxuXG5jb25zdCB0YXNrcyA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHJ1bl90YXNrcyhub3cpIHtcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBpZiAoIXRhc2suYyhub3cpKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgICAgICB0YXNrLmYoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0YXNrcy5zaXplICE9PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbn1cbi8qKlxuICogRm9yIHRlc3RpbmcgcHVycG9zZXMgb25seSFcbiAqL1xuZnVuY3Rpb24gY2xlYXJfbG9vcHMoKSB7XG4gICAgdGFza3MuY2xlYXIoKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXNrIHRoYXQgcnVucyBvbiBlYWNoIHJhZiBmcmFtZVxuICogdW50aWwgaXQgcmV0dXJucyBhIGZhbHN5IHZhbHVlIG9yIGlzIGFib3J0ZWRcbiAqL1xuZnVuY3Rpb24gbG9vcChjYWxsYmFjaykge1xuICAgIGxldCB0YXNrO1xuICAgIGlmICh0YXNrcy5zaXplID09PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBuZXcgUHJvbWlzZShmdWxmaWxsID0+IHtcbiAgICAgICAgICAgIHRhc2tzLmFkZCh0YXNrID0geyBjOiBjYWxsYmFjaywgZjogZnVsZmlsbCB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0KCkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gVHJhY2sgd2hpY2ggbm9kZXMgYXJlIGNsYWltZWQgZHVyaW5nIGh5ZHJhdGlvbi4gVW5jbGFpbWVkIG5vZGVzIGNhbiB0aGVuIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4vLyBhdCB0aGUgZW5kIG9mIGh5ZHJhdGlvbiB3aXRob3V0IHRvdWNoaW5nIHRoZSByZW1haW5pbmcgbm9kZXMuXG5sZXQgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG5mdW5jdGlvbiBzdGFydF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGVuZF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG59XG5mdW5jdGlvbiB1cHBlcl9ib3VuZChsb3csIGhpZ2gsIGtleSwgdmFsdWUpIHtcbiAgICAvLyBSZXR1cm4gZmlyc3QgaW5kZXggb2YgdmFsdWUgbGFyZ2VyIHRoYW4gaW5wdXQgdmFsdWUgaW4gdGhlIHJhbmdlIFtsb3csIGhpZ2gpXG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgICAgY29uc3QgbWlkID0gbG93ICsgKChoaWdoIC0gbG93KSA+PiAxKTtcbiAgICAgICAgaWYgKGtleShtaWQpIDw9IHZhbHVlKSB7XG4gICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaGlnaCA9IG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbG93O1xufVxuZnVuY3Rpb24gaW5pdF9oeWRyYXRlKHRhcmdldCkge1xuICAgIGlmICh0YXJnZXQuaHlkcmF0ZV9pbml0KVxuICAgICAgICByZXR1cm47XG4gICAgdGFyZ2V0Lmh5ZHJhdGVfaW5pdCA9IHRydWU7XG4gICAgLy8gV2Uga25vdyB0aGF0IGFsbCBjaGlsZHJlbiBoYXZlIGNsYWltX29yZGVyIHZhbHVlcyBzaW5jZSB0aGUgdW5jbGFpbWVkIGhhdmUgYmVlbiBkZXRhY2hlZCBpZiB0YXJnZXQgaXMgbm90IDxoZWFkPlxuICAgIGxldCBjaGlsZHJlbiA9IHRhcmdldC5jaGlsZE5vZGVzO1xuICAgIC8vIElmIHRhcmdldCBpcyA8aGVhZD4sIHRoZXJlIG1heSBiZSBjaGlsZHJlbiB3aXRob3V0IGNsYWltX29yZGVyXG4gICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ0hFQUQnKSB7XG4gICAgICAgIGNvbnN0IG15Q2hpbGRyZW4gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2xhaW1fb3JkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG15Q2hpbGRyZW4ucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjaGlsZHJlbiA9IG15Q2hpbGRyZW47XG4gICAgfVxuICAgIC8qXG4gICAgKiBSZW9yZGVyIGNsYWltZWQgY2hpbGRyZW4gb3B0aW1hbGx5LlxuICAgICogV2UgY2FuIHJlb3JkZXIgY2xhaW1lZCBjaGlsZHJlbiBvcHRpbWFsbHkgYnkgZmluZGluZyB0aGUgbG9uZ2VzdCBzdWJzZXF1ZW5jZSBvZlxuICAgICogbm9kZXMgdGhhdCBhcmUgYWxyZWFkeSBjbGFpbWVkIGluIG9yZGVyIGFuZCBvbmx5IG1vdmluZyB0aGUgcmVzdC4gVGhlIGxvbmdlc3RcbiAgICAqIHN1YnNlcXVlbmNlIHN1YnNlcXVlbmNlIG9mIG5vZGVzIHRoYXQgYXJlIGNsYWltZWQgaW4gb3JkZXIgY2FuIGJlIGZvdW5kIGJ5XG4gICAgKiBjb21wdXRpbmcgdGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiAuY2xhaW1fb3JkZXIgdmFsdWVzLlxuICAgICpcbiAgICAqIFRoaXMgYWxnb3JpdGhtIGlzIG9wdGltYWwgaW4gZ2VuZXJhdGluZyB0aGUgbGVhc3QgYW1vdW50IG9mIHJlb3JkZXIgb3BlcmF0aW9uc1xuICAgICogcG9zc2libGUuXG4gICAgKlxuICAgICogUHJvb2Y6XG4gICAgKiBXZSBrbm93IHRoYXQsIGdpdmVuIGEgc2V0IG9mIHJlb3JkZXJpbmcgb3BlcmF0aW9ucywgdGhlIG5vZGVzIHRoYXQgZG8gbm90IG1vdmVcbiAgICAqIGFsd2F5cyBmb3JtIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2UsIHNpbmNlIHRoZXkgZG8gbm90IG1vdmUgYW1vbmcgZWFjaCBvdGhlclxuICAgICogbWVhbmluZyB0aGF0IHRoZXkgbXVzdCBiZSBhbHJlYWR5IG9yZGVyZWQgYW1vbmcgZWFjaCBvdGhlci4gVGh1cywgdGhlIG1heGltYWxcbiAgICAqIHNldCBvZiBub2RlcyB0aGF0IGRvIG5vdCBtb3ZlIGZvcm0gYSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2UuXG4gICAgKi9cbiAgICAvLyBDb21wdXRlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZVxuICAgIC8vIG06IHN1YnNlcXVlbmNlIGxlbmd0aCBqID0+IGluZGV4IGsgb2Ygc21hbGxlc3QgdmFsdWUgdGhhdCBlbmRzIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgbGVuZ3RoIGpcbiAgICBjb25zdCBtID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoICsgMSk7XG4gICAgLy8gUHJlZGVjZXNzb3IgaW5kaWNlcyArIDFcbiAgICBjb25zdCBwID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoKTtcbiAgICBtWzBdID0gLTE7XG4gICAgbGV0IGxvbmdlc3QgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IGNoaWxkcmVuW2ldLmNsYWltX29yZGVyO1xuICAgICAgICAvLyBGaW5kIHRoZSBsYXJnZXN0IHN1YnNlcXVlbmNlIGxlbmd0aCBzdWNoIHRoYXQgaXQgZW5kcyBpbiBhIHZhbHVlIGxlc3MgdGhhbiBvdXIgY3VycmVudCB2YWx1ZVxuICAgICAgICAvLyB1cHBlcl9ib3VuZCByZXR1cm5zIGZpcnN0IGdyZWF0ZXIgdmFsdWUsIHNvIHdlIHN1YnRyYWN0IG9uZVxuICAgICAgICAvLyB3aXRoIGZhc3QgcGF0aCBmb3Igd2hlbiB3ZSBhcmUgb24gdGhlIGN1cnJlbnQgbG9uZ2VzdCBzdWJzZXF1ZW5jZVxuICAgICAgICBjb25zdCBzZXFMZW4gPSAoKGxvbmdlc3QgPiAwICYmIGNoaWxkcmVuW21bbG9uZ2VzdF1dLmNsYWltX29yZGVyIDw9IGN1cnJlbnQpID8gbG9uZ2VzdCArIDEgOiB1cHBlcl9ib3VuZCgxLCBsb25nZXN0LCBpZHggPT4gY2hpbGRyZW5bbVtpZHhdXS5jbGFpbV9vcmRlciwgY3VycmVudCkpIC0gMTtcbiAgICAgICAgcFtpXSA9IG1bc2VxTGVuXSArIDE7XG4gICAgICAgIGNvbnN0IG5ld0xlbiA9IHNlcUxlbiArIDE7XG4gICAgICAgIC8vIFdlIGNhbiBndWFyYW50ZWUgdGhhdCBjdXJyZW50IGlzIHRoZSBzbWFsbGVzdCB2YWx1ZS4gT3RoZXJ3aXNlLCB3ZSB3b3VsZCBoYXZlIGdlbmVyYXRlZCBhIGxvbmdlciBzZXF1ZW5jZS5cbiAgICAgICAgbVtuZXdMZW5dID0gaTtcbiAgICAgICAgbG9uZ2VzdCA9IE1hdGgubWF4KG5ld0xlbiwgbG9uZ2VzdCk7XG4gICAgfVxuICAgIC8vIFRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2Ygbm9kZXMgKGluaXRpYWxseSByZXZlcnNlZClcbiAgICBjb25zdCBsaXMgPSBbXTtcbiAgICAvLyBUaGUgcmVzdCBvZiB0aGUgbm9kZXMsIG5vZGVzIHRoYXQgd2lsbCBiZSBtb3ZlZFxuICAgIGNvbnN0IHRvTW92ZSA9IFtdO1xuICAgIGxldCBsYXN0ID0gY2hpbGRyZW4ubGVuZ3RoIC0gMTtcbiAgICBmb3IgKGxldCBjdXIgPSBtW2xvbmdlc3RdICsgMTsgY3VyICE9IDA7IGN1ciA9IHBbY3VyIC0gMV0pIHtcbiAgICAgICAgbGlzLnB1c2goY2hpbGRyZW5bY3VyIC0gMV0pO1xuICAgICAgICBmb3IgKDsgbGFzdCA+PSBjdXI7IGxhc3QtLSkge1xuICAgICAgICAgICAgdG9Nb3ZlLnB1c2goY2hpbGRyZW5bbGFzdF0pO1xuICAgICAgICB9XG4gICAgICAgIGxhc3QtLTtcbiAgICB9XG4gICAgZm9yICg7IGxhc3QgPj0gMDsgbGFzdC0tKSB7XG4gICAgICAgIHRvTW92ZS5wdXNoKGNoaWxkcmVuW2xhc3RdKTtcbiAgICB9XG4gICAgbGlzLnJldmVyc2UoKTtcbiAgICAvLyBXZSBzb3J0IHRoZSBub2RlcyBiZWluZyBtb3ZlZCB0byBndWFyYW50ZWUgdGhhdCB0aGVpciBpbnNlcnRpb24gb3JkZXIgbWF0Y2hlcyB0aGUgY2xhaW0gb3JkZXJcbiAgICB0b01vdmUuc29ydCgoYSwgYikgPT4gYS5jbGFpbV9vcmRlciAtIGIuY2xhaW1fb3JkZXIpO1xuICAgIC8vIEZpbmFsbHksIHdlIG1vdmUgdGhlIG5vZGVzXG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdG9Nb3ZlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHdoaWxlIChqIDwgbGlzLmxlbmd0aCAmJiB0b01vdmVbaV0uY2xhaW1fb3JkZXIgPj0gbGlzW2pdLmNsYWltX29yZGVyKSB7XG4gICAgICAgICAgICBqKys7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYW5jaG9yID0gaiA8IGxpcy5sZW5ndGggPyBsaXNbal0gOiBudWxsO1xuICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKHRvTW92ZVtpXSwgYW5jaG9yKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhcHBlbmQodGFyZ2V0LCBub2RlKSB7XG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX3N0eWxlcyh0YXJnZXQsIHN0eWxlX3NoZWV0X2lkLCBzdHlsZXMpIHtcbiAgICBjb25zdCBhcHBlbmRfc3R5bGVzX3RvID0gZ2V0X3Jvb3RfZm9yX3N0eWxlKHRhcmdldCk7XG4gICAgaWYgKCFhcHBlbmRfc3R5bGVzX3RvLmdldEVsZW1lbnRCeUlkKHN0eWxlX3NoZWV0X2lkKSkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHN0eWxlLmlkID0gc3R5bGVfc2hlZXRfaWQ7XG4gICAgICAgIHN0eWxlLnRleHRDb250ZW50ID0gc3R5bGVzO1xuICAgICAgICBhcHBlbmRfc3R5bGVzaGVldChhcHBlbmRfc3R5bGVzX3RvLCBzdHlsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUpXG4gICAgICAgIHJldHVybiBkb2N1bWVudDtcbiAgICBjb25zdCByb290ID0gbm9kZS5nZXRSb290Tm9kZSA/IG5vZGUuZ2V0Um9vdE5vZGUoKSA6IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICBpZiAocm9vdCAmJiByb290Lmhvc3QpIHtcbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQ7XG59XG5mdW5jdGlvbiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSB7XG4gICAgY29uc3Qgc3R5bGVfZWxlbWVudCA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgYXBwZW5kX3N0eWxlc2hlZXQoZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpLCBzdHlsZV9lbGVtZW50KTtcbiAgICByZXR1cm4gc3R5bGVfZWxlbWVudC5zaGVldDtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9zdHlsZXNoZWV0KG5vZGUsIHN0eWxlKSB7XG4gICAgYXBwZW5kKG5vZGUuaGVhZCB8fCBub2RlLCBzdHlsZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSkge1xuICAgIGlmIChpc19oeWRyYXRpbmcpIHtcbiAgICAgICAgaW5pdF9oeWRyYXRlKHRhcmdldCk7XG4gICAgICAgIGlmICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPT09IHVuZGVmaW5lZCkgfHwgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCAhPT0gbnVsbCkgJiYgKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLnBhcmVudEVsZW1lbnQgIT09IHRhcmdldCkpKSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IHRhcmdldC5maXJzdENoaWxkO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNraXAgbm9kZXMgb2YgdW5kZWZpbmVkIG9yZGVyaW5nXG4gICAgICAgIHdoaWxlICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgIT09IG51bGwpICYmICh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5jbGFpbV9vcmRlciA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5uZXh0U2libGluZztcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSAhPT0gdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQpIHtcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgaW5zZXJ0IGlmIHRoZSBvcmRlcmluZyBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlIG1vZGlmaWVkIG9yIHRoZSBwYXJlbnQgbm9kZSBpcyBub3QgdGFyZ2V0XG4gICAgICAgICAgICBpZiAobm9kZS5jbGFpbV9vcmRlciAhPT0gdW5kZWZpbmVkIHx8IG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPT0gbnVsbCkge1xuICAgICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgaWYgKGlzX2h5ZHJhdGluZyAmJiAhYW5jaG9yKSB7XG4gICAgICAgIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPSBhbmNob3IpIHtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoKG5vZGUpIHtcbiAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2VhY2goaXRlcmF0aW9ucywgZGV0YWNoaW5nKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpdGVyYXRpb25zW2ldKVxuICAgICAgICAgICAgaXRlcmF0aW9uc1tpXS5kKGRldGFjaGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBlbGVtZW50X2lzKG5hbWUsIGlzKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSwgeyBpcyB9KTtcbn1cbmZ1bmN0aW9uIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMob2JqLCBleGNsdWRlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgICBpZiAoaGFzX3Byb3Aob2JqLCBrKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgJiYgZXhjbHVkZS5pbmRleE9mKGspID09PSAtMSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGFyZ2V0W2tdID0gb2JqW2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBzdmdfZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBuYW1lKTtcbn1cbmZ1bmN0aW9uIHRleHQoZGF0YSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhKTtcbn1cbmZ1bmN0aW9uIHNwYWNlKCkge1xuICAgIHJldHVybiB0ZXh0KCcgJyk7XG59XG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgICByZXR1cm4gdGV4dCgnJyk7XG59XG5mdW5jdGlvbiBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJldmVudF9kZWZhdWx0KGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc3RvcF9wcm9wYWdhdGlvbihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZWxmKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoaXMpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdHJ1c3RlZChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQuaXNUcnVzdGVkKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgIGVsc2UgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgIT09IHZhbHVlKVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldF9hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgZGVzY3JpcHRvcnMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhub2RlLl9fcHJvdG9fXyk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYXR0cmlidXRlc1trZXldID09IG51bGwpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnX192YWx1ZScpIHtcbiAgICAgICAgICAgIG5vZGUudmFsdWUgPSBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzY3JpcHRvcnNba2V5XSAmJiBkZXNjcmlwdG9yc1trZXldLnNldCkge1xuICAgICAgICAgICAgbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3ZnX2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEobm9kZSwgcHJvcCwgdmFsdWUpIHtcbiAgICBpZiAocHJvcCBpbiBub2RlKSB7XG4gICAgICAgIG5vZGVbcHJvcF0gPSB0eXBlb2Ygbm9kZVtwcm9wXSA9PT0gJ2Jvb2xlYW4nICYmIHZhbHVlID09PSAnJyA/IHRydWUgOiB2YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGF0dHIobm9kZSwgcHJvcCwgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHhsaW5rX2F0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlKGdyb3VwLCBfX3ZhbHVlLCBjaGVja2VkKSB7XG4gICAgY29uc3QgdmFsdWUgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncm91cC5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoZ3JvdXBbaV0uY2hlY2tlZClcbiAgICAgICAgICAgIHZhbHVlLmFkZChncm91cFtpXS5fX3ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKCFjaGVja2VkKSB7XG4gICAgICAgIHZhbHVlLmRlbGV0ZShfX3ZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmZyb20odmFsdWUpO1xufVxuZnVuY3Rpb24gdG9fbnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJyA/IG51bGwgOiArdmFsdWU7XG59XG5mdW5jdGlvbiB0aW1lX3Jhbmdlc190b19hcnJheShyYW5nZXMpIHtcbiAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGFycmF5LnB1c2goeyBzdGFydDogcmFuZ2VzLnN0YXJ0KGkpLCBlbmQ6IHJhbmdlcy5lbmQoaSkgfSk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbn1cbmZ1bmN0aW9uIGNoaWxkcmVuKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpO1xufVxuZnVuY3Rpb24gaW5pdF9jbGFpbV9pbmZvKG5vZGVzKSB7XG4gICAgaWYgKG5vZGVzLmNsYWltX2luZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBub2Rlcy5jbGFpbV9pbmZvID0geyBsYXN0X2luZGV4OiAwLCB0b3RhbF9jbGFpbWVkOiAwIH07XG4gICAgfVxufVxuZnVuY3Rpb24gY2xhaW1fbm9kZShub2RlcywgcHJlZGljYXRlLCBwcm9jZXNzTm9kZSwgY3JlYXRlTm9kZSwgZG9udFVwZGF0ZUxhc3RJbmRleCA9IGZhbHNlKSB7XG4gICAgLy8gVHJ5IHRvIGZpbmQgbm9kZXMgaW4gYW4gb3JkZXIgc3VjaCB0aGF0IHdlIGxlbmd0aGVuIHRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2VcbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IHJlc3VsdE5vZGUgPSAoKCkgPT4ge1xuICAgICAgICAvLyBXZSBmaXJzdCB0cnkgdG8gZmluZCBhbiBlbGVtZW50IGFmdGVyIHRoZSBwcmV2aW91cyBvbmVcbiAgICAgICAgZm9yIChsZXQgaSA9IG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBwcm9jZXNzTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWRvbnRVcGRhdGVMYXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0cnkgdG8gZmluZCBvbmUgYmVmb3JlXG4gICAgICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBzbyB0aGF0IHdlIGRvbid0IGdvIHRvbyBmYXIgYmFja1xuICAgICAgICBmb3IgKGxldCBpID0gbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHByb2Nlc3NOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldID0gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9udFVwZGF0ZUxhc3RJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHdlIHNwbGljZWQgYmVmb3JlIHRoZSBsYXN0X2luZGV4LCB3ZSBkZWNyZWFzZSBpdFxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXgtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCBhbnkgbWF0Y2hpbmcgbm9kZSwgd2UgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgICByZXR1cm4gY3JlYXRlTm9kZSgpO1xuICAgIH0pKCk7XG4gICAgcmVzdWx0Tm9kZS5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQgKz0gMTtcbiAgICByZXR1cm4gcmVzdWx0Tm9kZTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgY3JlYXRlX2VsZW1lbnQpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZU5hbWUgPT09IG5hbWUsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG5vZGUuYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZS5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW1vdmUuZm9yRWFjaCh2ID0+IG5vZGUucmVtb3ZlQXR0cmlidXRlKHYpKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LCAoKSA9PiBjcmVhdGVfZWxlbWVudChuYW1lKSk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgZWxlbWVudCk7XG59XG5mdW5jdGlvbiBjbGFpbV9zdmdfZWxlbWVudChub2RlcywgbmFtZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIHN2Z19lbGVtZW50KTtcbn1cbmZ1bmN0aW9uIGNsYWltX3RleHQobm9kZXMsIGRhdGEpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IDMsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGFTdHIgPSAnJyArIGRhdGE7XG4gICAgICAgIGlmIChub2RlLmRhdGEuc3RhcnRzV2l0aChkYXRhU3RyKSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5sZW5ndGggIT09IGRhdGFTdHIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuc3BsaXRUZXh0KGRhdGFTdHIubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuZGF0YSA9IGRhdGFTdHI7XG4gICAgICAgIH1cbiAgICB9LCAoKSA9PiB0ZXh0KGRhdGEpLCB0cnVlIC8vIFRleHQgbm9kZXMgc2hvdWxkIG5vdCB1cGRhdGUgbGFzdCBpbmRleCBzaW5jZSBpdCBpcyBsaWtlbHkgbm90IHdvcnRoIGl0IHRvIGVsaW1pbmF0ZSBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIGFjdHVhbCBlbGVtZW50c1xuICAgICk7XG59XG5mdW5jdGlvbiBjbGFpbV9zcGFjZShub2Rlcykge1xuICAgIHJldHVybiBjbGFpbV90ZXh0KG5vZGVzLCAnICcpO1xufVxuZnVuY3Rpb24gZmluZF9jb21tZW50KG5vZGVzLCB0ZXh0LCBzdGFydCkge1xuICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDggLyogY29tbWVudCBub2RlICovICYmIG5vZGUudGV4dENvbnRlbnQudHJpbSgpID09PSB0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm9kZXMubGVuZ3RoO1xufVxuZnVuY3Rpb24gY2xhaW1faHRtbF90YWcobm9kZXMsIGlzX3N2Zykge1xuICAgIC8vIGZpbmQgaHRtbCBvcGVuaW5nIHRhZ1xuICAgIGNvbnN0IHN0YXJ0X2luZGV4ID0gZmluZF9jb21tZW50KG5vZGVzLCAnSFRNTF9UQUdfU1RBUlQnLCAwKTtcbiAgICBjb25zdCBlbmRfaW5kZXggPSBmaW5kX2NvbW1lbnQobm9kZXMsICdIVE1MX1RBR19FTkQnLCBzdGFydF9pbmRleCk7XG4gICAgaWYgKHN0YXJ0X2luZGV4ID09PSBlbmRfaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBIdG1sVGFnSHlkcmF0aW9uKHVuZGVmaW5lZCwgaXNfc3ZnKTtcbiAgICB9XG4gICAgaW5pdF9jbGFpbV9pbmZvKG5vZGVzKTtcbiAgICBjb25zdCBodG1sX3RhZ19ub2RlcyA9IG5vZGVzLnNwbGljZShzdGFydF9pbmRleCwgZW5kX2luZGV4IC0gc3RhcnRfaW5kZXggKyAxKTtcbiAgICBkZXRhY2goaHRtbF90YWdfbm9kZXNbMF0pO1xuICAgIGRldGFjaChodG1sX3RhZ19ub2Rlc1todG1sX3RhZ19ub2Rlcy5sZW5ndGggLSAxXSk7XG4gICAgY29uc3QgY2xhaW1lZF9ub2RlcyA9IGh0bWxfdGFnX25vZGVzLnNsaWNlKDEsIGh0bWxfdGFnX25vZGVzLmxlbmd0aCAtIDEpO1xuICAgIGZvciAoY29uc3QgbiBvZiBjbGFpbWVkX25vZGVzKSB7XG4gICAgICAgIG4uY2xhaW1fb3JkZXIgPSBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQ7XG4gICAgICAgIG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZCArPSAxO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEh0bWxUYWdIeWRyYXRpb24oY2xhaW1lZF9ub2RlcywgaXNfc3ZnKTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhKHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCAhPT0gZGF0YSlcbiAgICAgICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF92YWx1ZShpbnB1dCwgdmFsdWUpIHtcbiAgICBpbnB1dC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3R5cGUoaW5wdXQsIHR5cGUpIHtcbiAgICB0cnkge1xuICAgICAgICBpbnB1dC50eXBlID0gdHlwZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdHlsZShub2RlLCBrZXksIHZhbHVlLCBpbXBvcnRhbnQpIHtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShrZXkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9uKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBpZiAob3B0aW9uLl9fdmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdC5zZWxlY3RlZEluZGV4ID0gLTE7IC8vIG5vIG9wdGlvbiBzaG91bGQgYmUgc2VsZWN0ZWRcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb25zKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB+dmFsdWUuaW5kZXhPZihvcHRpb24uX192YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X3ZhbHVlKHNlbGVjdCkge1xuICAgIGNvbnN0IHNlbGVjdGVkX29wdGlvbiA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKCc6Y2hlY2tlZCcpIHx8IHNlbGVjdC5vcHRpb25zWzBdO1xuICAgIHJldHVybiBzZWxlY3RlZF9vcHRpb24gJiYgc2VsZWN0ZWRfb3B0aW9uLl9fdmFsdWU7XG59XG5mdW5jdGlvbiBzZWxlY3RfbXVsdGlwbGVfdmFsdWUoc2VsZWN0KSB7XG4gICAgcmV0dXJuIFtdLm1hcC5jYWxsKHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCc6Y2hlY2tlZCcpLCBvcHRpb24gPT4gb3B0aW9uLl9fdmFsdWUpO1xufVxuLy8gdW5mb3J0dW5hdGVseSB0aGlzIGNhbid0IGJlIGEgY29uc3RhbnQgYXMgdGhhdCB3b3VsZG4ndCBiZSB0cmVlLXNoYWtlYWJsZVxuLy8gc28gd2UgY2FjaGUgdGhlIHJlc3VsdCBpbnN0ZWFkXG5sZXQgY3Jvc3NvcmlnaW47XG5mdW5jdGlvbiBpc19jcm9zc29yaWdpbigpIHtcbiAgICBpZiAoY3Jvc3NvcmlnaW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjcm9zc29yaWdpbiA9IGZhbHNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICB2b2lkIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjcm9zc29yaWdpbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNyb3Nzb3JpZ2luO1xufVxuZnVuY3Rpb24gYWRkX3Jlc2l6ZV9saXN0ZW5lcihub2RlLCBmbikge1xuICAgIGNvbnN0IGNvbXB1dGVkX3N0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoY29tcHV0ZWRfc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgIH1cbiAgICBjb25zdCBpZnJhbWUgPSBlbGVtZW50KCdpZnJhbWUnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7ICcgK1xuICAgICAgICAnb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyOiAwOyBvcGFjaXR5OiAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgei1pbmRleDogLTE7Jyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgIGlmcmFtZS50YWJJbmRleCA9IC0xO1xuICAgIGNvbnN0IGNyb3Nzb3JpZ2luID0gaXNfY3Jvc3NvcmlnaW4oKTtcbiAgICBsZXQgdW5zdWJzY3JpYmU7XG4gICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSBcImRhdGE6dGV4dC9odG1sLDxzY3JpcHQ+b25yZXNpemU9ZnVuY3Rpb24oKXtwYXJlbnQucG9zdE1lc3NhZ2UoMCwnKicpfTwvc2NyaXB0PlwiO1xuICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3Rlbih3aW5kb3csICdtZXNzYWdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBpZnJhbWUuY29udGVudFdpbmRvdylcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnO1xuICAgICAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4oaWZyYW1lLmNvbnRlbnRXaW5kb3csICdyZXNpemUnLCBmbik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFwcGVuZChub2RlLCBpZnJhbWUpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bnN1YnNjcmliZSAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXRhY2goaWZyYW1lKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdG9nZ2xlX2NsYXNzKGVsZW1lbnQsIG5hbWUsIHRvZ2dsZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0W3RvZ2dsZSA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xufVxuZnVuY3Rpb24gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCwgeyBidWJibGVzID0gZmFsc2UsIGNhbmNlbGFibGUgPSBmYWxzZSB9ID0ge30pIHtcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgYnViYmxlcywgY2FuY2VsYWJsZSwgZGV0YWlsKTtcbiAgICByZXR1cm4gZTtcbn1cbmZ1bmN0aW9uIHF1ZXJ5X3NlbGVjdG9yX2FsbChzZWxlY3RvciwgcGFyZW50ID0gZG9jdW1lbnQuYm9keSkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XG59XG5jbGFzcyBIdG1sVGFnIHtcbiAgICBjb25zdHJ1Y3Rvcihpc19zdmcgPSBmYWxzZSkge1xuICAgICAgICB0aGlzLmlzX3N2ZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzX3N2ZyA9IGlzX3N2ZztcbiAgICAgICAgdGhpcy5lID0gdGhpcy5uID0gbnVsbDtcbiAgICB9XG4gICAgYyhodG1sKSB7XG4gICAgICAgIHRoaXMuaChodG1sKTtcbiAgICB9XG4gICAgbShodG1sLCB0YXJnZXQsIGFuY2hvciA9IG51bGwpIHtcbiAgICAgICAgaWYgKCF0aGlzLmUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzX3N2ZylcbiAgICAgICAgICAgICAgICB0aGlzLmUgPSBzdmdfZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRoaXMuZSA9IGVsZW1lbnQodGFyZ2V0Lm5vZGVOYW1lKTtcbiAgICAgICAgICAgIHRoaXMudCA9IHRhcmdldDtcbiAgICAgICAgICAgIHRoaXMuYyhodG1sKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmkoYW5jaG9yKTtcbiAgICB9XG4gICAgaChodG1sKSB7XG4gICAgICAgIHRoaXMuZS5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICB0aGlzLm4gPSBBcnJheS5mcm9tKHRoaXMuZS5jaGlsZE5vZGVzKTtcbiAgICB9XG4gICAgaShhbmNob3IpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGluc2VydCh0aGlzLnQsIHRoaXMubltpXSwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwKGh0bWwpIHtcbiAgICAgICAgdGhpcy5kKCk7XG4gICAgICAgIHRoaXMuaChodG1sKTtcbiAgICAgICAgdGhpcy5pKHRoaXMuYSk7XG4gICAgfVxuICAgIGQoKSB7XG4gICAgICAgIHRoaXMubi5mb3JFYWNoKGRldGFjaCk7XG4gICAgfVxufVxuY2xhc3MgSHRtbFRhZ0h5ZHJhdGlvbiBleHRlbmRzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGNsYWltZWRfbm9kZXMsIGlzX3N2ZyA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGlzX3N2Zyk7XG4gICAgICAgIHRoaXMuZSA9IHRoaXMubiA9IG51bGw7XG4gICAgICAgIHRoaXMubCA9IGNsYWltZWRfbm9kZXM7XG4gICAgfVxuICAgIGMoaHRtbCkge1xuICAgICAgICBpZiAodGhpcy5sKSB7XG4gICAgICAgICAgICB0aGlzLm4gPSB0aGlzLmw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdXBlci5jKGh0bWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGkoYW5jaG9yKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpbnNlcnRfaHlkcmF0aW9uKHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYXR0cmlidXRlX3RvX29iamVjdChhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgYXR0cmlidXRlcykge1xuICAgICAgICByZXN1bHRbYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0X2N1c3RvbV9lbGVtZW50c19zbG90cyhlbGVtZW50KSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZWxlbWVudC5jaGlsZE5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgcmVzdWx0W25vZGUuc2xvdCB8fCAnZGVmYXVsdCddID0gdHJ1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG4vLyB3ZSBuZWVkIHRvIHN0b3JlIHRoZSBpbmZvcm1hdGlvbiBmb3IgbXVsdGlwbGUgZG9jdW1lbnRzIGJlY2F1c2UgYSBTdmVsdGUgYXBwbGljYXRpb24gY291bGQgYWxzbyBjb250YWluIGlmcmFtZXNcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zdmVsdGVqcy9zdmVsdGUvaXNzdWVzLzM2MjRcbmNvbnN0IG1hbmFnZWRfc3R5bGVzID0gbmV3IE1hcCgpO1xubGV0IGFjdGl2ZSA9IDA7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vZGFya3NreWFwcC9zdHJpbmctaGFzaC9ibG9iL21hc3Rlci9pbmRleC5qc1xuZnVuY3Rpb24gaGFzaChzdHIpIHtcbiAgICBsZXQgaGFzaCA9IDUzODE7XG4gICAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBoYXNoID4+PiAwO1xufVxuZnVuY3Rpb24gY3JlYXRlX3N0eWxlX2luZm9ybWF0aW9uKGRvYywgbm9kZSkge1xuICAgIGNvbnN0IGluZm8gPSB7IHN0eWxlc2hlZXQ6IGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0KG5vZGUpLCBydWxlczoge30gfTtcbiAgICBtYW5hZ2VkX3N0eWxlcy5zZXQoZG9jLCBpbmZvKTtcbiAgICByZXR1cm4gaW5mbztcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9ydWxlKG5vZGUsIGEsIGIsIGR1cmF0aW9uLCBkZWxheSwgZWFzZSwgZm4sIHVpZCA9IDApIHtcbiAgICBjb25zdCBzdGVwID0gMTYuNjY2IC8gZHVyYXRpb247XG4gICAgbGV0IGtleWZyYW1lcyA9ICd7XFxuJztcbiAgICBmb3IgKGxldCBwID0gMDsgcCA8PSAxOyBwICs9IHN0ZXApIHtcbiAgICAgICAgY29uc3QgdCA9IGEgKyAoYiAtIGEpICogZWFzZShwKTtcbiAgICAgICAga2V5ZnJhbWVzICs9IHAgKiAxMDAgKyBgJXske2ZuKHQsIDEgLSB0KX19XFxuYDtcbiAgICB9XG4gICAgY29uc3QgcnVsZSA9IGtleWZyYW1lcyArIGAxMDAlIHske2ZuKGIsIDEgLSBiKX19XFxufWA7XG4gICAgY29uc3QgbmFtZSA9IGBfX3N2ZWx0ZV8ke2hhc2gocnVsZSl9XyR7dWlkfWA7XG4gICAgY29uc3QgZG9jID0gZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpO1xuICAgIGNvbnN0IHsgc3R5bGVzaGVldCwgcnVsZXMgfSA9IG1hbmFnZWRfc3R5bGVzLmdldChkb2MpIHx8IGNyZWF0ZV9zdHlsZV9pbmZvcm1hdGlvbihkb2MsIG5vZGUpO1xuICAgIGlmICghcnVsZXNbbmFtZV0pIHtcbiAgICAgICAgcnVsZXNbbmFtZV0gPSB0cnVlO1xuICAgICAgICBzdHlsZXNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtuYW1lfSAke3J1bGV9YCwgc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH1cbiAgICBjb25zdCBhbmltYXRpb24gPSBub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJztcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IGAke2FuaW1hdGlvbiA/IGAke2FuaW1hdGlvbn0sIGAgOiAnJ30ke25hbWV9ICR7ZHVyYXRpb259bXMgbGluZWFyICR7ZGVsYXl9bXMgMSBib3RoYDtcbiAgICBhY3RpdmUgKz0gMTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpIHtcbiAgICBjb25zdCBwcmV2aW91cyA9IChub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJykuc3BsaXQoJywgJyk7XG4gICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmZpbHRlcihuYW1lXG4gICAgICAgID8gYW5pbSA9PiBhbmltLmluZGV4T2YobmFtZSkgPCAwIC8vIHJlbW92ZSBzcGVjaWZpYyBhbmltYXRpb25cbiAgICAgICAgOiBhbmltID0+IGFuaW0uaW5kZXhPZignX19zdmVsdGUnKSA9PT0gLTEgLy8gcmVtb3ZlIGFsbCBTdmVsdGUgYW5pbWF0aW9uc1xuICAgICk7XG4gICAgY29uc3QgZGVsZXRlZCA9IHByZXZpb3VzLmxlbmd0aCAtIG5leHQubGVuZ3RoO1xuICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gbmV4dC5qb2luKCcsICcpO1xuICAgICAgICBhY3RpdmUgLT0gZGVsZXRlZDtcbiAgICAgICAgaWYgKCFhY3RpdmUpXG4gICAgICAgICAgICBjbGVhcl9ydWxlcygpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsZWFyX3J1bGVzKCkge1xuICAgIHJhZigoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG1hbmFnZWRfc3R5bGVzLmZvckVhY2goaW5mbyA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHN0eWxlc2hlZXQgfSA9IGluZm87XG4gICAgICAgICAgICBsZXQgaSA9IHN0eWxlc2hlZXQuY3NzUnVsZXMubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUgKGktLSlcbiAgICAgICAgICAgICAgICBzdHlsZXNoZWV0LmRlbGV0ZVJ1bGUoaSk7XG4gICAgICAgICAgICBpbmZvLnJ1bGVzID0ge307XG4gICAgICAgIH0pO1xuICAgICAgICBtYW5hZ2VkX3N0eWxlcy5jbGVhcigpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVfYW5pbWF0aW9uKG5vZGUsIGZyb20sIGZuLCBwYXJhbXMpIHtcbiAgICBpZiAoIWZyb20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHRvID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoZnJvbS5sZWZ0ID09PSB0by5sZWZ0ICYmIGZyb20ucmlnaHQgPT09IHRvLnJpZ2h0ICYmIGZyb20udG9wID09PSB0by50b3AgJiYgZnJvbS5ib3R0b20gPT09IHRvLmJvdHRvbSlcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgXG4gICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBzaG91bGQgdGhpcyBiZSBzZXBhcmF0ZWQgZnJvbSBkZXN0cnVjdHVyaW5nPyBPciBzdGFydC9lbmQgYWRkZWQgdG8gcHVibGljIGFwaSBhbmQgZG9jdW1lbnRhdGlvbj9cbiAgICBzdGFydDogc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzpcbiAgICBlbmQgPSBzdGFydF90aW1lICsgZHVyYXRpb24sIHRpY2sgPSBub29wLCBjc3MgfSA9IGZuKG5vZGUsIHsgZnJvbSwgdG8gfSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICBsZXQgbmFtZTtcbiAgICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVsYXkpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBuYW1lKTtcbiAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgIGlmICghc3RhcnRlZCAmJiBub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQgJiYgbm93ID49IGVuZCkge1xuICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgIHN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnRlZCkge1xuICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHN0YXJ0X3RpbWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gMCArIDEgKiBlYXNpbmcocCAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIHN0YXJ0KCk7XG4gICAgdGljaygwLCAxKTtcbiAgICByZXR1cm4gc3RvcDtcbn1cbmZ1bmN0aW9uIGZpeF9wb3NpdGlvbihub2RlKSB7XG4gICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgIGlmIChzdHlsZS5wb3NpdGlvbiAhPT0gJ2Fic29sdXRlJyAmJiBzdHlsZS5wb3NpdGlvbiAhPT0gJ2ZpeGVkJykge1xuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHN0eWxlO1xuICAgICAgICBjb25zdCBhID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIG5vZGUuc3R5bGUud2lkdGggPSB3aWR0aDtcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIGFkZF90cmFuc2Zvcm0obm9kZSwgYSk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkX3RyYW5zZm9ybShub2RlLCBhKSB7XG4gICAgY29uc3QgYiA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGEubGVmdCAhPT0gYi5sZWZ0IHx8IGEudG9wICE9PSBiLnRvcCkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IHN0eWxlLnRyYW5zZm9ybSA9PT0gJ25vbmUnID8gJycgOiBzdHlsZS50cmFuc2Zvcm07XG4gICAgICAgIG5vZGUuc3R5bGUudHJhbnNmb3JtID0gYCR7dHJhbnNmb3JtfSB0cmFuc2xhdGUoJHthLmxlZnQgLSBiLmxlZnR9cHgsICR7YS50b3AgLSBiLnRvcH1weClgO1xuICAgIH1cbn1cblxubGV0IGN1cnJlbnRfY29tcG9uZW50O1xuZnVuY3Rpb24gc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCkge1xuICAgIGN1cnJlbnRfY29tcG9uZW50ID0gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkge1xuICAgIGlmICghY3VycmVudF9jb21wb25lbnQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRnVuY3Rpb24gY2FsbGVkIG91dHNpZGUgY29tcG9uZW50IGluaXRpYWxpemF0aW9uJyk7XG4gICAgcmV0dXJuIGN1cnJlbnRfY29tcG9uZW50O1xufVxuZnVuY3Rpb24gYmVmb3JlVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYmVmb3JlX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uTW91bnQoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5vbl9tb3VudC5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFmdGVyVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYWZ0ZXJfdXBkYXRlLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gb25EZXN0cm95KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fZGVzdHJveS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpIHtcbiAgICBjb25zdCBjb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICByZXR1cm4gKHR5cGUsIGRldGFpbCwgeyBjYW5jZWxhYmxlID0gZmFsc2UgfSA9IHt9KSA9PiB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbdHlwZV07XG4gICAgICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgICAgIC8vIFRPRE8gYXJlIHRoZXJlIHNpdHVhdGlvbnMgd2hlcmUgZXZlbnRzIGNvdWxkIGJlIGRpc3BhdGNoZWRcbiAgICAgICAgICAgIC8vIGluIGEgc2VydmVyIChub24tRE9NKSBlbnZpcm9ubWVudD9cbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCwgeyBjYW5jZWxhYmxlIH0pO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbChjb21wb25lbnQsIGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG4gICAgcmV0dXJuIGNvbnRleHQ7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuZnVuY3Rpb24gZ2V0QWxsQ29udGV4dHMoKSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQ7XG59XG5mdW5jdGlvbiBoYXNDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmhhcyhrZXkpO1xufVxuLy8gVE9ETyBmaWd1cmUgb3V0IGlmIHdlIHN0aWxsIHdhbnQgdG8gc3VwcG9ydFxuLy8gc2hvcnRoYW5kIGV2ZW50cywgb3IgaWYgd2Ugd2FudCB0byBpbXBsZW1lbnRcbi8vIGEgcmVhbCBidWJibGluZyBtZWNoYW5pc21cbmZ1bmN0aW9uIGJ1YmJsZShjb21wb25lbnQsIGV2ZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiBmbi5jYWxsKHRoaXMsIGV2ZW50KSk7XG4gICAgfVxufVxuXG5jb25zdCBkaXJ0eV9jb21wb25lbnRzID0gW107XG5jb25zdCBpbnRyb3MgPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG5jb25zdCBiaW5kaW5nX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVuZGVyX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgZmx1c2hfY2FsbGJhY2tzID0gW107XG5jb25zdCByZXNvbHZlZF9wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5sZXQgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2NoZWR1bGVfdXBkYXRlKCkge1xuICAgIGlmICghdXBkYXRlX3NjaGVkdWxlZCkge1xuICAgICAgICB1cGRhdGVfc2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZWRfcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0aWNrKCkge1xuICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgIHJldHVybiByZXNvbHZlZF9wcm9taXNlO1xufVxuZnVuY3Rpb24gYWRkX3JlbmRlcl9jYWxsYmFjayhmbikge1xuICAgIHJlbmRlcl9jYWxsYmFja3MucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZGRfZmx1c2hfY2FsbGJhY2soZm4pIHtcbiAgICBmbHVzaF9jYWxsYmFja3MucHVzaChmbik7XG59XG4vLyBmbHVzaCgpIGNhbGxzIGNhbGxiYWNrcyBpbiB0aGlzIG9yZGVyOlxuLy8gMS4gQWxsIGJlZm9yZVVwZGF0ZSBjYWxsYmFja3MsIGluIG9yZGVyOiBwYXJlbnRzIGJlZm9yZSBjaGlsZHJlblxuLy8gMi4gQWxsIGJpbmQ6dGhpcyBjYWxsYmFja3MsIGluIHJldmVyc2Ugb3JkZXI6IGNoaWxkcmVuIGJlZm9yZSBwYXJlbnRzLlxuLy8gMy4gQWxsIGFmdGVyVXBkYXRlIGNhbGxiYWNrcywgaW4gb3JkZXI6IHBhcmVudHMgYmVmb3JlIGNoaWxkcmVuLiBFWENFUFRcbi8vICAgIGZvciBhZnRlclVwZGF0ZXMgY2FsbGVkIGR1cmluZyB0aGUgaW5pdGlhbCBvbk1vdW50LCB3aGljaCBhcmUgY2FsbGVkIGluXG4vLyAgICByZXZlcnNlIG9yZGVyOiBjaGlsZHJlbiBiZWZvcmUgcGFyZW50cy5cbi8vIFNpbmNlIGNhbGxiYWNrcyBtaWdodCB1cGRhdGUgY29tcG9uZW50IHZhbHVlcywgd2hpY2ggY291bGQgdHJpZ2dlciBhbm90aGVyXG4vLyBjYWxsIHRvIGZsdXNoKCksIHRoZSBmb2xsb3dpbmcgc3RlcHMgZ3VhcmQgYWdhaW5zdCB0aGlzOlxuLy8gMS4gRHVyaW5nIGJlZm9yZVVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIGJlIGFkZGVkIHRvIHRoZVxuLy8gICAgZGlydHlfY29tcG9uZW50cyBhcnJheSBhbmQgd2lsbCBjYXVzZSBhIHJlZW50cmFudCBjYWxsIHRvIGZsdXNoKCkuIEJlY2F1c2Vcbi8vICAgIHRoZSBmbHVzaCBpbmRleCBpcyBrZXB0IG91dHNpZGUgdGhlIGZ1bmN0aW9uLCB0aGUgcmVlbnRyYW50IGNhbGwgd2lsbCBwaWNrXG4vLyAgICB1cCB3aGVyZSB0aGUgZWFybGllciBjYWxsIGxlZnQgb2ZmIGFuZCBnbyB0aHJvdWdoIGFsbCBkaXJ0eSBjb21wb25lbnRzLiBUaGVcbi8vICAgIGN1cnJlbnRfY29tcG9uZW50IHZhbHVlIGlzIHNhdmVkIGFuZCByZXN0b3JlZCBzbyB0aGF0IHRoZSByZWVudHJhbnQgY2FsbCB3aWxsXG4vLyAgICBub3QgaW50ZXJmZXJlIHdpdGggdGhlIFwicGFyZW50XCIgZmx1c2goKSBjYWxsLlxuLy8gMi4gYmluZDp0aGlzIGNhbGxiYWNrcyBjYW5ub3QgdHJpZ2dlciBuZXcgZmx1c2goKSBjYWxscy5cbi8vIDMuIER1cmluZyBhZnRlclVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIE5PVCBoYXZlIHRoZWlyIGFmdGVyVXBkYXRlXG4vLyAgICBjYWxsYmFjayBjYWxsZWQgYSBzZWNvbmQgdGltZTsgdGhlIHNlZW5fY2FsbGJhY2tzIHNldCwgb3V0c2lkZSB0aGUgZmx1c2goKVxuLy8gICAgZnVuY3Rpb24sIGd1YXJhbnRlZXMgdGhpcyBiZWhhdmlvci5cbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xubGV0IGZsdXNoaWR4ID0gMDsgLy8gRG8gKm5vdCogbW92ZSB0aGlzIGluc2lkZSB0aGUgZmx1c2goKSBmdW5jdGlvblxuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgY29uc3Qgc2F2ZWRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgZG8ge1xuICAgICAgICAvLyBmaXJzdCwgY2FsbCBiZWZvcmVVcGRhdGUgZnVuY3Rpb25zXG4gICAgICAgIC8vIGFuZCB1cGRhdGUgY29tcG9uZW50c1xuICAgICAgICB3aGlsZSAoZmx1c2hpZHggPCBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZGlydHlfY29tcG9uZW50c1tmbHVzaGlkeF07XG4gICAgICAgICAgICBmbHVzaGlkeCsrO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoY29tcG9uZW50LiQkKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgZmx1c2hpZHggPSAwO1xuICAgICAgICB3aGlsZSAoYmluZGluZ19jYWxsYmFja3MubGVuZ3RoKVxuICAgICAgICAgICAgYmluZGluZ19jYWxsYmFja3MucG9wKCkoKTtcbiAgICAgICAgLy8gdGhlbiwgb25jZSBjb21wb25lbnRzIGFyZSB1cGRhdGVkLCBjYWxsXG4gICAgICAgIC8vIGFmdGVyVXBkYXRlIGZ1bmN0aW9ucy4gVGhpcyBtYXkgY2F1c2VcbiAgICAgICAgLy8gc3Vic2VxdWVudCB1cGRhdGVzLi4uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSByZW5kZXJfY2FsbGJhY2tzW2ldO1xuICAgICAgICAgICAgaWYgKCFzZWVuX2NhbGxiYWNrcy5oYXMoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgICAgLy8gLi4uc28gZ3VhcmQgYWdhaW5zdCBpbmZpbml0ZSBsb29wc1xuICAgICAgICAgICAgICAgIHNlZW5fY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aCA9IDA7XG4gICAgfSB3aGlsZSAoZGlydHlfY29tcG9uZW50cy5sZW5ndGgpO1xuICAgIHdoaWxlIChmbHVzaF9jYWxsYmFja3MubGVuZ3RoKSB7XG4gICAgICAgIGZsdXNoX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgIH1cbiAgICB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG4gICAgc2Vlbl9jYWxsYmFja3MuY2xlYXIoKTtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoc2F2ZWRfY29tcG9uZW50KTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZSgkJCkge1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAkJC51cGRhdGUoKTtcbiAgICAgICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAgICAgY29uc3QgZGlydHkgPSAkJC5kaXJ0eTtcbiAgICAgICAgJCQuZGlydHkgPSBbLTFdO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5wKCQkLmN0eCwgZGlydHkpO1xuICAgICAgICAkJC5hZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbiAgICB9XG59XG5cbmxldCBwcm9taXNlO1xuZnVuY3Rpb24gd2FpdCgpIHtcbiAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKG5vZGUsIGRpcmVjdGlvbiwga2luZCkge1xuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQoYCR7ZGlyZWN0aW9uID8gJ2ludHJvJyA6ICdvdXRybyd9JHtraW5kfWApKTtcbn1cbmNvbnN0IG91dHJvaW5nID0gbmV3IFNldCgpO1xubGV0IG91dHJvcztcbmZ1bmN0aW9uIGdyb3VwX291dHJvcygpIHtcbiAgICBvdXRyb3MgPSB7XG4gICAgICAgIHI6IDAsXG4gICAgICAgIGM6IFtdLFxuICAgICAgICBwOiBvdXRyb3MgLy8gcGFyZW50IGdyb3VwXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNoZWNrX291dHJvcygpIHtcbiAgICBpZiAoIW91dHJvcy5yKSB7XG4gICAgICAgIHJ1bl9hbGwob3V0cm9zLmMpO1xuICAgIH1cbiAgICBvdXRyb3MgPSBvdXRyb3MucDtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25faW4oYmxvY2ssIGxvY2FsKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLmkpIHtcbiAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suaShsb2NhbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9vdXQoYmxvY2ssIGxvY2FsLCBkZXRhY2gsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLm8pIHtcbiAgICAgICAgaWYgKG91dHJvaW5nLmhhcyhibG9jaykpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG91dHJvaW5nLmFkZChibG9jayk7XG4gICAgICAgIG91dHJvcy5jLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChkZXRhY2gpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmQoMSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJsb2NrLm8obG9jYWwpO1xuICAgIH1cbiAgICBlbHNlIGlmIChjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgIH1cbn1cbmNvbnN0IG51bGxfdHJhbnNpdGlvbiA9IHsgZHVyYXRpb246IDAgfTtcbmZ1bmN0aW9uIGNyZWF0ZV9pbl90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdWlkID0gMDtcbiAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzLCB1aWQrKyk7XG4gICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgaWYgKHRhc2spXG4gICAgICAgICAgICB0YXNrLmFib3J0KCk7XG4gICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIHRydWUsICdzdGFydCcpKTtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCB0cnVlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoc3RhcnRlZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbihnbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbnZhbGlkYXRlKCkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX291dF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGNvbnN0IGdyb3VwID0gb3V0cm9zO1xuICAgIGdyb3VwLnIgKz0gMTtcbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMSwgMCwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ3N0YXJ0JykpO1xuICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEtLWdyb3VwLnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCByZXN1bHQgaW4gYGVuZCgpYCBiZWluZyBjYWxsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkb24ndCBuZWVkIHRvIGNsZWFuIHVwIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwoZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSAtIHQsIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICBnbygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGdvKCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGVuZChyZXNldCkge1xuICAgICAgICAgICAgaWYgKHJlc2V0ICYmIGNvbmZpZy50aWNrKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnRpY2soMSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMsIGludHJvKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHQgPSBpbnRybyA/IDAgOiAxO1xuICAgIGxldCBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBhbmltYXRpb25fbmFtZSA9IG51bGw7XG4gICAgZnVuY3Rpb24gY2xlYXJfYW5pbWF0aW9uKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluaXQocHJvZ3JhbSwgZHVyYXRpb24pIHtcbiAgICAgICAgY29uc3QgZCA9IChwcm9ncmFtLmIgLSB0KTtcbiAgICAgICAgZHVyYXRpb24gKj0gTWF0aC5hYnMoZCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhOiB0LFxuICAgICAgICAgICAgYjogcHJvZ3JhbS5iLFxuICAgICAgICAgICAgZCxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3RhcnQ6IHByb2dyYW0uc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHByb2dyYW0uc3RhcnQgKyBkdXJhdGlvbixcbiAgICAgICAgICAgIGdyb3VwOiBwcm9ncmFtLmdyb3VwXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKGIpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgY29uc3QgcHJvZ3JhbSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBub3coKSArIGRlbGF5LFxuICAgICAgICAgICAgYlxuICAgICAgICB9O1xuICAgICAgICBpZiAoIWIpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBwcm9ncmFtLmdyb3VwID0gb3V0cm9zO1xuICAgICAgICAgICAgb3V0cm9zLnIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gcHJvZ3JhbTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYW4gaW50cm8sIGFuZCB0aGVyZSdzIGEgZGVsYXksIHdlIG5lZWQgdG8gZG9cbiAgICAgICAgICAgIC8vIGFuIGluaXRpYWwgdGljayBhbmQvb3IgYXBwbHkgQ1NTIGFuaW1hdGlvbiBpbW1lZGlhdGVseVxuICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGIsICdzdGFydCcpKTtcbiAgICAgICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ19wcm9ncmFtICYmIG5vdyA+IHBlbmRpbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHBlbmRpbmdfcHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ3N0YXJ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBydW5uaW5nX3Byb2dyYW0uYiwgcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uLCAwLCBlYXNpbmcsIGNvbmZpZy5jc3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQgPSBydW5uaW5nX3Byb2dyYW0uYiwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0uYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnRybyDigJQgd2UgY2FuIHRpZHkgdXAgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdXRybyDigJQgbmVlZHMgdG8gYmUgY29vcmRpbmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEtLXJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChydW5uaW5nX3Byb2dyYW0uZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gbm93IC0gcnVubmluZ19wcm9ncmFtLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHJ1bm5pbmdfcHJvZ3JhbS5hICsgcnVubmluZ19wcm9ncmFtLmQgKiBlYXNpbmcocCAvIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gISEocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBydW4oYikge1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZV9wcm9taXNlKHByb21pc2UsIGluZm8pIHtcbiAgICBjb25zdCB0b2tlbiA9IGluZm8udG9rZW4gPSB7fTtcbiAgICBmdW5jdGlvbiB1cGRhdGUodHlwZSwgaW5kZXgsIGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKGluZm8udG9rZW4gIT09IHRva2VuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpbmZvLnJlc29sdmVkID0gdmFsdWU7XG4gICAgICAgIGxldCBjaGlsZF9jdHggPSBpbmZvLmN0eDtcbiAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjaGlsZF9jdHggPSBjaGlsZF9jdHguc2xpY2UoKTtcbiAgICAgICAgICAgIGNoaWxkX2N0eFtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYmxvY2sgPSB0eXBlICYmIChpbmZvLmN1cnJlbnQgPSB0eXBlKShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgbmVlZHNfZmx1c2ggPSBmYWxzZTtcbiAgICAgICAgaWYgKGluZm8uYmxvY2spIHtcbiAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrcykge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzLmZvckVhY2goKGJsb2NrLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBpbmRleCAmJiBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uX291dChibG9jaywgMSwgMSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrc1tpXSA9PT0gYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5ibG9ja3NbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2suZCgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICAgICAgYmxvY2subShpbmZvLm1vdW50KCksIGluZm8uYW5jaG9yKTtcbiAgICAgICAgICAgIG5lZWRzX2ZsdXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLmJsb2NrID0gYmxvY2s7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrcylcbiAgICAgICAgICAgIGluZm8uYmxvY2tzW2luZGV4XSA9IGJsb2NrO1xuICAgICAgICBpZiAobmVlZHNfZmx1c2gpIHtcbiAgICAgICAgICAgIGZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzX3Byb21pc2UocHJvbWlzZSkpIHtcbiAgICAgICAgY29uc3QgY3VycmVudF9jb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5jYXRjaCwgMiwgaW5mby5lcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICAgICAgaWYgKCFpbmZvLmhhc0NhdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBpZiB3ZSBwcmV2aW91c2x5IGhhZCBhIHRoZW4vY2F0Y2ggYmxvY2ssIGRlc3Ryb3kgaXRcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby5wZW5kaW5nKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5wZW5kaW5nLCAwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHByb21pc2U7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaChpbmZvLCBjdHgsIGRpcnR5KSB7XG4gICAgY29uc3QgY2hpbGRfY3R4ID0gY3R4LnNsaWNlKCk7XG4gICAgY29uc3QgeyByZXNvbHZlZCB9ID0gaW5mbztcbiAgICBpZiAoaW5mby5jdXJyZW50ID09PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8udmFsdWVdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGlmIChpbmZvLmN1cnJlbnQgPT09IGluZm8uY2F0Y2gpIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8uZXJyb3JdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGluZm8uYmxvY2sucChjaGlsZF9jdHgsIGRpcnR5KTtcbn1cblxuY29uc3QgZ2xvYmFscyA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgID8gd2luZG93XG4gICAgOiB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBnbG9iYWxUaGlzXG4gICAgICAgIDogZ2xvYmFsKTtcblxuZnVuY3Rpb24gZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZCgxKTtcbiAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG59XG5mdW5jdGlvbiBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZml4X2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9rZXllZF9lYWNoKG9sZF9ibG9ja3MsIGRpcnR5LCBnZXRfa2V5LCBkeW5hbWljLCBjdHgsIGxpc3QsIGxvb2t1cCwgbm9kZSwgZGVzdHJveSwgY3JlYXRlX2VhY2hfYmxvY2ssIG5leHQsIGdldF9jb250ZXh0KSB7XG4gICAgbGV0IG8gPSBvbGRfYmxvY2tzLmxlbmd0aDtcbiAgICBsZXQgbiA9IGxpc3QubGVuZ3RoO1xuICAgIGxldCBpID0gbztcbiAgICBjb25zdCBvbGRfaW5kZXhlcyA9IHt9O1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIG9sZF9pbmRleGVzW29sZF9ibG9ja3NbaV0ua2V5XSA9IGk7XG4gICAgY29uc3QgbmV3X2Jsb2NrcyA9IFtdO1xuICAgIGNvbnN0IG5ld19sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgY29uc3QgZGVsdGFzID0gbmV3IE1hcCgpO1xuICAgIGkgPSBuO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRfY3R4ID0gZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKTtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgYmxvY2sgPSBsb29rdXAuZ2V0KGtleSk7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gY3JlYXRlX2VhY2hfYmxvY2soa2V5LCBjaGlsZF9jdHgpO1xuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5bmFtaWMpIHtcbiAgICAgICAgICAgIGJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2xvb2t1cC5zZXQoa2V5LCBuZXdfYmxvY2tzW2ldID0gYmxvY2spO1xuICAgICAgICBpZiAoa2V5IGluIG9sZF9pbmRleGVzKVxuICAgICAgICAgICAgZGVsdGFzLnNldChrZXksIE1hdGguYWJzKGkgLSBvbGRfaW5kZXhlc1trZXldKSk7XG4gICAgfVxuICAgIGNvbnN0IHdpbGxfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBjb25zdCBkaWRfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBpbnNlcnQoYmxvY2spIHtcbiAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgIGJsb2NrLm0obm9kZSwgbmV4dCk7XG4gICAgICAgIGxvb2t1cC5zZXQoYmxvY2sua2V5LCBibG9jayk7XG4gICAgICAgIG5leHQgPSBibG9jay5maXJzdDtcbiAgICAgICAgbi0tO1xuICAgIH1cbiAgICB3aGlsZSAobyAmJiBuKSB7XG4gICAgICAgIGNvbnN0IG5ld19ibG9jayA9IG5ld19ibG9ja3NbbiAtIDFdO1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW28gLSAxXTtcbiAgICAgICAgY29uc3QgbmV3X2tleSA9IG5ld19ibG9jay5rZXk7XG4gICAgICAgIGNvbnN0IG9sZF9rZXkgPSBvbGRfYmxvY2sua2V5O1xuICAgICAgICBpZiAobmV3X2Jsb2NrID09PSBvbGRfYmxvY2spIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIG5leHQgPSBuZXdfYmxvY2suZmlyc3Q7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgICAgICBuLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJsb2NrXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbG9va3VwLmhhcyhuZXdfa2V5KSB8fCB3aWxsX21vdmUuaGFzKG5ld19rZXkpKSB7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaWRfbW92ZS5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZWx0YXMuZ2V0KG5ld19rZXkpID4gZGVsdGFzLmdldChvbGRfa2V5KSkge1xuICAgICAgICAgICAgZGlkX21vdmUuYWRkKG5ld19rZXkpO1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsX21vdmUuYWRkKG9sZF9rZXkpO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChvLS0pIHtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvXTtcbiAgICAgICAgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfYmxvY2sua2V5KSlcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgIH1cbiAgICB3aGlsZSAobilcbiAgICAgICAgaW5zZXJ0KG5ld19ibG9ja3NbbiAtIDFdKTtcbiAgICByZXR1cm4gbmV3X2Jsb2Nrcztcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfa2V5cyhjdHgsIGxpc3QsIGdldF9jb250ZXh0LCBnZXRfa2V5KSB7XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpKTtcbiAgICAgICAgaWYgKGtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGhhdmUgZHVwbGljYXRlIGtleXMgaW4gYSBrZXllZCBlYWNoJyk7XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5hZGQoa2V5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9zcHJlYWRfdXBkYXRlKGxldmVscywgdXBkYXRlcykge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHt9O1xuICAgIGNvbnN0IHRvX251bGxfb3V0ID0ge307XG4gICAgY29uc3QgYWNjb3VudGVkX2ZvciA9IHsgJCRzY29wZTogMSB9O1xuICAgIGxldCBpID0gbGV2ZWxzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IG8gPSBsZXZlbHNbaV07XG4gICAgICAgIGNvbnN0IG4gPSB1cGRhdGVzW2ldO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBuKSlcbiAgICAgICAgICAgICAgICAgICAgdG9fbnVsbF9vdXRba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50ZWRfZm9yW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlW2tleV0gPSBuW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV2ZWxzW2ldID0gbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRvX251bGxfb3V0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiB1cGRhdGUpKVxuICAgICAgICAgICAgdXBkYXRlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGU7XG59XG5mdW5jdGlvbiBnZXRfc3ByZWFkX29iamVjdChzcHJlYWRfcHJvcHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHNwcmVhZF9wcm9wcyA9PT0gJ29iamVjdCcgJiYgc3ByZWFkX3Byb3BzICE9PSBudWxsID8gc3ByZWFkX3Byb3BzIDoge307XG59XG5cbi8vIHNvdXJjZTogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvaW5kaWNlcy5odG1sXG5jb25zdCBib29sZWFuX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KFtcbiAgICAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAnYWxsb3dwYXltZW50cmVxdWVzdCcsXG4gICAgJ2FzeW5jJyxcbiAgICAnYXV0b2ZvY3VzJyxcbiAgICAnYXV0b3BsYXknLFxuICAgICdjaGVja2VkJyxcbiAgICAnY29udHJvbHMnLFxuICAgICdkZWZhdWx0JyxcbiAgICAnZGVmZXInLFxuICAgICdkaXNhYmxlZCcsXG4gICAgJ2Zvcm1ub3ZhbGlkYXRlJyxcbiAgICAnaGlkZGVuJyxcbiAgICAnaXNtYXAnLFxuICAgICdsb29wJyxcbiAgICAnbXVsdGlwbGUnLFxuICAgICdtdXRlZCcsXG4gICAgJ25vbW9kdWxlJyxcbiAgICAnbm92YWxpZGF0ZScsXG4gICAgJ29wZW4nLFxuICAgICdwbGF5c2lubGluZScsXG4gICAgJ3JlYWRvbmx5JyxcbiAgICAncmVxdWlyZWQnLFxuICAgICdyZXZlcnNlZCcsXG4gICAgJ3NlbGVjdGVkJ1xuXSk7XG5cbmNvbnN0IHZvaWRfZWxlbWVudF9uYW1lcyA9IC9eKD86YXJlYXxiYXNlfGJyfGNvbHxjb21tYW5kfGVtYmVkfGhyfGltZ3xpbnB1dHxrZXlnZW58bGlua3xtZXRhfHBhcmFtfHNvdXJjZXx0cmFja3x3YnIpJC87XG5mdW5jdGlvbiBpc192b2lkKG5hbWUpIHtcbiAgICByZXR1cm4gdm9pZF9lbGVtZW50X25hbWVzLnRlc3QobmFtZSkgfHwgbmFtZS50b0xvd2VyQ2FzZSgpID09PSAnIWRvY3R5cGUnO1xufVxuXG5jb25zdCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciA9IC9bXFxzJ1wiPi89XFx1e0ZERDB9LVxcdXtGREVGfVxcdXtGRkZFfVxcdXtGRkZGfVxcdXsxRkZGRX1cXHV7MUZGRkZ9XFx1ezJGRkZFfVxcdXsyRkZGRn1cXHV7M0ZGRkV9XFx1ezNGRkZGfVxcdXs0RkZGRX1cXHV7NEZGRkZ9XFx1ezVGRkZFfVxcdXs1RkZGRn1cXHV7NkZGRkV9XFx1ezZGRkZGfVxcdXs3RkZGRX1cXHV7N0ZGRkZ9XFx1ezhGRkZFfVxcdXs4RkZGRn1cXHV7OUZGRkV9XFx1ezlGRkZGfVxcdXtBRkZGRX1cXHV7QUZGRkZ9XFx1e0JGRkZFfVxcdXtCRkZGRn1cXHV7Q0ZGRkV9XFx1e0NGRkZGfVxcdXtERkZGRX1cXHV7REZGRkZ9XFx1e0VGRkZFfVxcdXtFRkZGRn1cXHV7RkZGRkV9XFx1e0ZGRkZGfVxcdXsxMEZGRkV9XFx1ezEwRkZGRn1dL3U7XG4vLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNhdHRyaWJ1dGVzLTJcbi8vIGh0dHBzOi8vaW5mcmEuc3BlYy53aGF0d2cub3JnLyNub25jaGFyYWN0ZXJcbmZ1bmN0aW9uIHNwcmVhZChhcmdzLCBhdHRyc190b19hZGQpIHtcbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gT2JqZWN0LmFzc2lnbih7fSwgLi4uYXJncyk7XG4gICAgaWYgKGF0dHJzX3RvX2FkZCkge1xuICAgICAgICBjb25zdCBjbGFzc2VzX3RvX2FkZCA9IGF0dHJzX3RvX2FkZC5jbGFzc2VzO1xuICAgICAgICBjb25zdCBzdHlsZXNfdG9fYWRkID0gYXR0cnNfdG9fYWRkLnN0eWxlcztcbiAgICAgICAgaWYgKGNsYXNzZXNfdG9fYWRkKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyArPSAnICcgKyBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3R5bGVzX3RvX2FkZCkge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuc3R5bGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuc3R5bGUgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlc190b19hZGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlX29iamVjdF90b19zdHJpbmcobWVyZ2Vfc3NyX3N0eWxlcyhhdHRyaWJ1dGVzLnN0eWxlLCBzdHlsZXNfdG9fYWRkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgIGlmIChpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3Rlci50ZXN0KG5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICBlbHNlIGlmIChib29sZWFuX2F0dHJpYnV0ZXMuaGFzKG5hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAgICAgICAgICBzdHIgKz0gJyAnICsgbmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzdHIgKz0gYCAke25hbWV9PVwiJHt2YWx1ZX1cImA7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3RyO1xufVxuZnVuY3Rpb24gbWVyZ2Vfc3NyX3N0eWxlcyhzdHlsZV9hdHRyaWJ1dGUsIHN0eWxlX2RpcmVjdGl2ZSkge1xuICAgIGNvbnN0IHN0eWxlX29iamVjdCA9IHt9O1xuICAgIGZvciAoY29uc3QgaW5kaXZpZHVhbF9zdHlsZSBvZiBzdHlsZV9hdHRyaWJ1dGUuc3BsaXQoJzsnKSkge1xuICAgICAgICBjb25zdCBjb2xvbl9pbmRleCA9IGluZGl2aWR1YWxfc3R5bGUuaW5kZXhPZignOicpO1xuICAgICAgICBjb25zdCBuYW1lID0gaW5kaXZpZHVhbF9zdHlsZS5zbGljZSgwLCBjb2xvbl9pbmRleCkudHJpbSgpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGluZGl2aWR1YWxfc3R5bGUuc2xpY2UoY29sb25faW5kZXggKyAxKS50cmltKCk7XG4gICAgICAgIGlmICghbmFtZSlcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBzdHlsZV9vYmplY3RbbmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBuYW1lIGluIHN0eWxlX2RpcmVjdGl2ZSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHN0eWxlX2RpcmVjdGl2ZVtuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBzdHlsZV9vYmplY3RbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSBzdHlsZV9vYmplY3RbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0eWxlX29iamVjdDtcbn1cbmNvbnN0IEFUVFJfUkVHRVggPSAvWyZcIl0vZztcbmNvbnN0IENPTlRFTlRfUkVHRVggPSAvWyY8XS9nO1xuLyoqXG4gKiBOb3RlOiB0aGlzIG1ldGhvZCBpcyBwZXJmb3JtYW5jZSBzZW5zaXRpdmUgYW5kIGhhcyBiZWVuIG9wdGltaXplZFxuICogaHR0cHM6Ly9naXRodWIuY29tL3N2ZWx0ZWpzL3N2ZWx0ZS9wdWxsLzU3MDFcbiAqL1xuZnVuY3Rpb24gZXNjYXBlKHZhbHVlLCBpc19hdHRyID0gZmFsc2UpIHtcbiAgICBjb25zdCBzdHIgPSBTdHJpbmcodmFsdWUpO1xuICAgIGNvbnN0IHBhdHRlcm4gPSBpc19hdHRyID8gQVRUUl9SRUdFWCA6IENPTlRFTlRfUkVHRVg7XG4gICAgcGF0dGVybi5sYXN0SW5kZXggPSAwO1xuICAgIGxldCBlc2NhcGVkID0gJyc7XG4gICAgbGV0IGxhc3QgPSAwO1xuICAgIHdoaWxlIChwYXR0ZXJuLnRlc3Qoc3RyKSkge1xuICAgICAgICBjb25zdCBpID0gcGF0dGVybi5sYXN0SW5kZXggLSAxO1xuICAgICAgICBjb25zdCBjaCA9IHN0cltpXTtcbiAgICAgICAgZXNjYXBlZCArPSBzdHIuc3Vic3RyaW5nKGxhc3QsIGkpICsgKGNoID09PSAnJicgPyAnJmFtcDsnIDogKGNoID09PSAnXCInID8gJyZxdW90OycgOiAnJmx0OycpKTtcbiAgICAgICAgbGFzdCA9IGkgKyAxO1xuICAgIH1cbiAgICByZXR1cm4gZXNjYXBlZCArIHN0ci5zdWJzdHJpbmcobGFzdCk7XG59XG5mdW5jdGlvbiBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlKHZhbHVlKSB7XG4gICAgLy8ga2VlcCBib29sZWFucywgbnVsbCwgYW5kIHVuZGVmaW5lZCBmb3IgdGhlIHNha2Ugb2YgYHNwcmVhZGBcbiAgICBjb25zdCBzaG91bGRfZXNjYXBlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jyk7XG4gICAgcmV0dXJuIHNob3VsZF9lc2NhcGUgPyBlc2NhcGUodmFsdWUsIHRydWUpIDogdmFsdWU7XG59XG5mdW5jdGlvbiBlc2NhcGVfb2JqZWN0KG9iaikge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgICAgICByZXN1bHRba2V5XSA9IGVzY2FwZV9hdHRyaWJ1dGVfdmFsdWUob2JqW2tleV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZWFjaChpdGVtcywgZm4pIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBzdHIgKz0gZm4oaXRlbXNbaV0sIGkpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgbWlzc2luZ19jb21wb25lbnQgPSB7XG4gICAgJCRyZW5kZXI6ICgpID0+ICcnXG59O1xuZnVuY3Rpb24gdmFsaWRhdGVfY29tcG9uZW50KGNvbXBvbmVudCwgbmFtZSkge1xuICAgIGlmICghY29tcG9uZW50IHx8ICFjb21wb25lbnQuJCRyZW5kZXIpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50JylcbiAgICAgICAgICAgIG5hbWUgKz0gJyB0aGlzPXsuLi59JztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8JHtuYW1lfT4gaXMgbm90IGEgdmFsaWQgU1NSIGNvbXBvbmVudC4gWW91IG1heSBuZWVkIHRvIHJldmlldyB5b3VyIGJ1aWxkIGNvbmZpZyB0byBlbnN1cmUgdGhhdCBkZXBlbmRlbmNpZXMgYXJlIGNvbXBpbGVkLCByYXRoZXIgdGhhbiBpbXBvcnRlZCBhcyBwcmUtY29tcGlsZWQgbW9kdWxlc2ApO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZGVidWcoZmlsZSwgbGluZSwgY29sdW1uLCB2YWx1ZXMpIHtcbiAgICBjb25zb2xlLmxvZyhge0BkZWJ1Z30gJHtmaWxlID8gZmlsZSArICcgJyA6ICcnfSgke2xpbmV9OiR7Y29sdW1ufSlgKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2codmFsdWVzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuICcnO1xufVxubGV0IG9uX2Rlc3Ryb3k7XG5mdW5jdGlvbiBjcmVhdGVfc3NyX2NvbXBvbmVudChmbikge1xuICAgIGZ1bmN0aW9uICQkcmVuZGVyKHJlc3VsdCwgcHJvcHMsIGJpbmRpbmdzLCBzbG90cywgY29udGV4dCkge1xuICAgICAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgICAgIGNvbnN0ICQkID0ge1xuICAgICAgICAgICAgb25fZGVzdHJveSxcbiAgICAgICAgICAgIGNvbnRleHQ6IG5ldyBNYXAoY29udGV4dCB8fCAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSksXG4gICAgICAgICAgICAvLyB0aGVzZSB3aWxsIGJlIGltbWVkaWF0ZWx5IGRpc2NhcmRlZFxuICAgICAgICAgICAgb25fbW91bnQ6IFtdLFxuICAgICAgICAgICAgYmVmb3JlX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBhZnRlcl91cGRhdGU6IFtdLFxuICAgICAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKVxuICAgICAgICB9O1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoeyAkJCB9KTtcbiAgICAgICAgY29uc3QgaHRtbCA9IGZuKHJlc3VsdCwgcHJvcHMsIGJpbmRpbmdzLCBzbG90cyk7XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChwYXJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJlbmRlcjogKHByb3BzID0ge30sIHsgJCRzbG90cyA9IHt9LCBjb250ZXh0ID0gbmV3IE1hcCgpIH0gPSB7fSkgPT4ge1xuICAgICAgICAgICAgb25fZGVzdHJveSA9IFtdO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0geyB0aXRsZTogJycsIGhlYWQ6ICcnLCBjc3M6IG5ldyBTZXQoKSB9O1xuICAgICAgICAgICAgY29uc3QgaHRtbCA9ICQkcmVuZGVyKHJlc3VsdCwgcHJvcHMsIHt9LCAkJHNsb3RzLCBjb250ZXh0KTtcbiAgICAgICAgICAgIHJ1bl9hbGwob25fZGVzdHJveSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGh0bWwsXG4gICAgICAgICAgICAgICAgY3NzOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IEFycmF5LmZyb20ocmVzdWx0LmNzcykubWFwKGNzcyA9PiBjc3MuY29kZSkuam9pbignXFxuJyksXG4gICAgICAgICAgICAgICAgICAgIG1hcDogbnVsbCAvLyBUT0RPXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBoZWFkOiByZXN1bHQudGl0bGUgKyByZXN1bHQuaGVhZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgJCRyZW5kZXJcbiAgICB9O1xufVxuZnVuY3Rpb24gYWRkX2F0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgYm9vbGVhbikge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IChib29sZWFuICYmICF2YWx1ZSkpXG4gICAgICAgIHJldHVybiAnJztcbiAgICBjb25zdCBhc3NpZ25tZW50ID0gKGJvb2xlYW4gJiYgdmFsdWUgPT09IHRydWUpID8gJycgOiBgPVwiJHtlc2NhcGUodmFsdWUsIHRydWUpfVwiYDtcbiAgICByZXR1cm4gYCAke25hbWV9JHthc3NpZ25tZW50fWA7XG59XG5mdW5jdGlvbiBhZGRfY2xhc3NlcyhjbGFzc2VzKSB7XG4gICAgcmV0dXJuIGNsYXNzZXMgPyBgIGNsYXNzPVwiJHtjbGFzc2VzfVwiYCA6ICcnO1xufVxuZnVuY3Rpb24gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhzdHlsZV9vYmplY3QpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoc3R5bGVfb2JqZWN0KVxuICAgICAgICAuZmlsdGVyKGtleSA9PiBzdHlsZV9vYmplY3Rba2V5XSlcbiAgICAgICAgLm1hcChrZXkgPT4gYCR7a2V5fTogJHtzdHlsZV9vYmplY3Rba2V5XX07YClcbiAgICAgICAgLmpvaW4oJyAnKTtcbn1cbmZ1bmN0aW9uIGFkZF9zdHlsZXMoc3R5bGVfb2JqZWN0KSB7XG4gICAgY29uc3Qgc3R5bGVzID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhzdHlsZV9vYmplY3QpO1xuICAgIHJldHVybiBzdHlsZXMgPyBgIHN0eWxlPVwiJHtzdHlsZXN9XCJgIDogJyc7XG59XG5cbmZ1bmN0aW9uIGJpbmQoY29tcG9uZW50LCBuYW1lLCBjYWxsYmFjaykge1xuICAgIGNvbnN0IGluZGV4ID0gY29tcG9uZW50LiQkLnByb3BzW25hbWVdO1xuICAgIGlmIChpbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbXBvbmVudC4kJC5ib3VuZFtpbmRleF0gPSBjYWxsYmFjaztcbiAgICAgICAgY2FsbGJhY2soY29tcG9uZW50LiQkLmN0eFtpbmRleF0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZV9jb21wb25lbnQoYmxvY2spIHtcbiAgICBibG9jayAmJiBibG9jay5jKCk7XG59XG5mdW5jdGlvbiBjbGFpbV9jb21wb25lbnQoYmxvY2ssIHBhcmVudF9ub2Rlcykge1xuICAgIGJsb2NrICYmIGJsb2NrLmwocGFyZW50X25vZGVzKTtcbn1cbmZ1bmN0aW9uIG1vdW50X2NvbXBvbmVudChjb21wb25lbnQsIHRhcmdldCwgYW5jaG9yLCBjdXN0b21FbGVtZW50KSB7XG4gICAgY29uc3QgeyBmcmFnbWVudCwgb25fbW91bnQsIG9uX2Rlc3Ryb3ksIGFmdGVyX3VwZGF0ZSB9ID0gY29tcG9uZW50LiQkO1xuICAgIGZyYWdtZW50ICYmIGZyYWdtZW50Lm0odGFyZ2V0LCBhbmNob3IpO1xuICAgIGlmICghY3VzdG9tRWxlbWVudCkge1xuICAgICAgICAvLyBvbk1vdW50IGhhcHBlbnMgYmVmb3JlIHRoZSBpbml0aWFsIGFmdGVyVXBkYXRlXG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3X29uX2Rlc3Ryb3kgPSBvbl9tb3VudC5tYXAocnVuKS5maWx0ZXIoaXNfZnVuY3Rpb24pO1xuICAgICAgICAgICAgaWYgKG9uX2Rlc3Ryb3kpIHtcbiAgICAgICAgICAgICAgICBvbl9kZXN0cm95LnB1c2goLi4ubmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRWRnZSBjYXNlIC0gY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW1tZWRpYXRlbHksXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBsaWtlbHkgYXMgYSByZXN1bHQgb2YgYSBiaW5kaW5nIGluaXRpYWxpc2luZ1xuICAgICAgICAgICAgICAgIHJ1bl9hbGwobmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tcG9uZW50LiQkLm9uX21vdW50ID0gW107XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfY29tcG9uZW50KGNvbXBvbmVudCwgZGV0YWNoaW5nKSB7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQ7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJ1bl9hbGwoJCQub25fZGVzdHJveSk7XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmQoZGV0YWNoaW5nKTtcbiAgICAgICAgLy8gVE9ETyBudWxsIG91dCBvdGhlciByZWZzLCBpbmNsdWRpbmcgY29tcG9uZW50LiQkIChidXQgbmVlZCB0b1xuICAgICAgICAvLyBwcmVzZXJ2ZSBmaW5hbCBzdGF0ZT8pXG4gICAgICAgICQkLm9uX2Rlc3Ryb3kgPSAkJC5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgICQkLmN0eCA9IFtdO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKSB7XG4gICAgaWYgKGNvbXBvbmVudC4kJC5kaXJ0eVswXSA9PT0gLTEpIHtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgICAgICBjb21wb25lbnQuJCQuZGlydHkuZmlsbCgwKTtcbiAgICB9XG4gICAgY29tcG9uZW50LiQkLmRpcnR5WyhpIC8gMzEpIHwgMF0gfD0gKDEgPDwgKGkgJSAzMSkpO1xufVxuZnVuY3Rpb24gaW5pdChjb21wb25lbnQsIG9wdGlvbnMsIGluc3RhbmNlLCBjcmVhdGVfZnJhZ21lbnQsIG5vdF9lcXVhbCwgcHJvcHMsIGFwcGVuZF9zdHlsZXMsIGRpcnR5ID0gWy0xXSkge1xuICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJCA9IHtcbiAgICAgICAgZnJhZ21lbnQ6IG51bGwsXG4gICAgICAgIGN0eDogbnVsbCxcbiAgICAgICAgLy8gc3RhdGVcbiAgICAgICAgcHJvcHMsXG4gICAgICAgIHVwZGF0ZTogbm9vcCxcbiAgICAgICAgbm90X2VxdWFsLFxuICAgICAgICBib3VuZDogYmxhbmtfb2JqZWN0KCksXG4gICAgICAgIC8vIGxpZmVjeWNsZVxuICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgIG9uX2Rlc3Ryb3k6IFtdLFxuICAgICAgICBvbl9kaXNjb25uZWN0OiBbXSxcbiAgICAgICAgYmVmb3JlX3VwZGF0ZTogW10sXG4gICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgIGNvbnRleHQ6IG5ldyBNYXAob3B0aW9ucy5jb250ZXh0IHx8IChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pKSxcbiAgICAgICAgLy8gZXZlcnl0aGluZyBlbHNlXG4gICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KCksXG4gICAgICAgIGRpcnR5LFxuICAgICAgICBza2lwX2JvdW5kOiBmYWxzZSxcbiAgICAgICAgcm9vdDogb3B0aW9ucy50YXJnZXQgfHwgcGFyZW50X2NvbXBvbmVudC4kJC5yb290XG4gICAgfTtcbiAgICBhcHBlbmRfc3R5bGVzICYmIGFwcGVuZF9zdHlsZXMoJCQucm9vdCk7XG4gICAgbGV0IHJlYWR5ID0gZmFsc2U7XG4gICAgJCQuY3R4ID0gaW5zdGFuY2VcbiAgICAgICAgPyBpbnN0YW5jZShjb21wb25lbnQsIG9wdGlvbnMucHJvcHMgfHwge30sIChpLCByZXQsIC4uLnJlc3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmVzdC5sZW5ndGggPyByZXN0WzBdIDogcmV0O1xuICAgICAgICAgICAgaWYgKCQkLmN0eCAmJiBub3RfZXF1YWwoJCQuY3R4W2ldLCAkJC5jdHhbaV0gPSB2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoISQkLnNraXBfYm91bmQgJiYgJCQuYm91bmRbaV0pXG4gICAgICAgICAgICAgICAgICAgICQkLmJvdW5kW2ldKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVhZHkpXG4gICAgICAgICAgICAgICAgICAgIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pXG4gICAgICAgIDogW107XG4gICAgJCQudXBkYXRlKCk7XG4gICAgcmVhZHkgPSB0cnVlO1xuICAgIHJ1bl9hbGwoJCQuYmVmb3JlX3VwZGF0ZSk7XG4gICAgLy8gYGZhbHNlYCBhcyBhIHNwZWNpYWwgY2FzZSBvZiBubyBET00gY29tcG9uZW50XG4gICAgJCQuZnJhZ21lbnQgPSBjcmVhdGVfZnJhZ21lbnQgPyBjcmVhdGVfZnJhZ21lbnQoJCQuY3R4KSA6IGZhbHNlO1xuICAgIGlmIChvcHRpb25zLnRhcmdldCkge1xuICAgICAgICBpZiAob3B0aW9ucy5oeWRyYXRlKSB7XG4gICAgICAgICAgICBzdGFydF9oeWRyYXRpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gY2hpbGRyZW4ob3B0aW9ucy50YXJnZXQpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50Lmwobm9kZXMpO1xuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChkZXRhY2gpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5pbnRybylcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oY29tcG9uZW50LiQkLmZyYWdtZW50KTtcbiAgICAgICAgbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucy50YXJnZXQsIG9wdGlvbnMuYW5jaG9yLCBvcHRpb25zLmN1c3RvbUVsZW1lbnQpO1xuICAgICAgICBlbmRfaHlkcmF0aW5nKCk7XG4gICAgICAgIGZsdXNoKCk7XG4gICAgfVxuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChwYXJlbnRfY29tcG9uZW50KTtcbn1cbmxldCBTdmVsdGVFbGVtZW50O1xuaWYgKHR5cGVvZiBIVE1MRWxlbWVudCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIFN2ZWx0ZUVsZW1lbnQgPSBjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHtcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgdGhpcy5hdHRhY2hTaGFkb3coeyBtb2RlOiAnb3BlbicgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICBjb25zdCB7IG9uX21vdW50IH0gPSB0aGlzLiQkO1xuICAgICAgICAgICAgdGhpcy4kJC5vbl9kaXNjb25uZWN0ID0gb25fbW91bnQubWFwKHJ1bikuZmlsdGVyKGlzX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLiQkLnNsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy4kJC5zbG90dGVkW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhhdHRyLCBfb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzW2F0dHJdID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XG4gICAgICAgICAgICBydW5fYWxsKHRoaXMuJCQub25fZGlzY29ubmVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgJGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy8gVE9ETyBzaG91bGQgdGhpcyBkZWxlZ2F0ZSB0byBhZGRFdmVudExpc3RlbmVyP1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzLiBVc2VkIHdoZW4gZGV2PWZhbHNlLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnQge1xuICAgICRkZXN0cm95KCkge1xuICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgfVxuICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkaXNwYXRjaF9kZXYodHlwZSwgZGV0YWlsKSB7XG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQodHlwZSwgT2JqZWN0LmFzc2lnbih7IHZlcnNpb246ICczLjQ5LjAnIH0sIGRldGFpbCksIHsgYnViYmxlczogdHJ1ZSB9KSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfZGV2KHRhcmdldCwgbm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUgfSk7XG4gICAgYXBwZW5kKHRhcmdldCwgbm9kZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfaHlkcmF0aW9uX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9kZXYodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlLCBhbmNob3IgfSk7XG4gICAgaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9oeWRyYXRpb25fZGV2KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydF9oeWRyYXRpb24odGFyZ2V0LCBub2RlLCBhbmNob3IpO1xufVxuZnVuY3Rpb24gZGV0YWNoX2Rldihub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmUnLCB7IG5vZGUgfSk7XG4gICAgZGV0YWNoKG5vZGUpO1xufVxuZnVuY3Rpb24gZGV0YWNoX2JldHdlZW5fZGV2KGJlZm9yZSwgYWZ0ZXIpIHtcbiAgICB3aGlsZSAoYmVmb3JlLm5leHRTaWJsaW5nICYmIGJlZm9yZS5uZXh0U2libGluZyAhPT0gYWZ0ZXIpIHtcbiAgICAgICAgZGV0YWNoX2RldihiZWZvcmUubmV4dFNpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9iZWZvcmVfZGV2KGFmdGVyKSB7XG4gICAgd2hpbGUgKGFmdGVyLnByZXZpb3VzU2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGFmdGVyLnByZXZpb3VzU2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoX2FmdGVyX2RldihiZWZvcmUpIHtcbiAgICB3aGlsZSAoYmVmb3JlLm5leHRTaWJsaW5nKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBsaXN0ZW5fZGV2KG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zLCBoYXNfcHJldmVudF9kZWZhdWx0LCBoYXNfc3RvcF9wcm9wYWdhdGlvbikge1xuICAgIGNvbnN0IG1vZGlmaWVycyA9IG9wdGlvbnMgPT09IHRydWUgPyBbJ2NhcHR1cmUnXSA6IG9wdGlvbnMgPyBBcnJheS5mcm9tKE9iamVjdC5rZXlzKG9wdGlvbnMpKSA6IFtdO1xuICAgIGlmIChoYXNfcHJldmVudF9kZWZhdWx0KVxuICAgICAgICBtb2RpZmllcnMucHVzaCgncHJldmVudERlZmF1bHQnKTtcbiAgICBpZiAoaGFzX3N0b3BfcHJvcGFnYXRpb24pXG4gICAgICAgIG1vZGlmaWVycy5wdXNoKCdzdG9wUHJvcGFnYXRpb24nKTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUFkZEV2ZW50TGlzdGVuZXInLCB7IG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBtb2RpZmllcnMgfSk7XG4gICAgY29uc3QgZGlzcG9zZSA9IGxpc3Rlbihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgICAgICBkaXNwb3NlKCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHJfZGV2KG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBhdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpO1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZUF0dHJpYnV0ZScsIHsgbm9kZSwgYXR0cmlidXRlIH0pO1xuICAgIGVsc2VcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXRBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBwcm9wX2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0UHJvcGVydHknLCB7IG5vZGUsIHByb3BlcnR5LCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIGRhdGFzZXRfZGV2KG5vZGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIG5vZGUuZGF0YXNldFtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldERhdGFzZXQnLCB7IG5vZGUsIHByb3BlcnR5LCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhX2Rldih0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgPT09IGRhdGEpXG4gICAgICAgIHJldHVybjtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldERhdGEnLCB7IG5vZGU6IHRleHQsIGRhdGEgfSk7XG4gICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfYXJndW1lbnQoYXJnKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcgIT09ICdzdHJpbmcnICYmICEoYXJnICYmIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmICdsZW5ndGgnIGluIGFyZykpIHtcbiAgICAgICAgbGV0IG1zZyA9ICd7I2VhY2h9IG9ubHkgaXRlcmF0ZXMgb3ZlciBhcnJheS1saWtlIG9iamVjdHMuJztcbiAgICAgICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgYXJnICYmIFN5bWJvbC5pdGVyYXRvciBpbiBhcmcpIHtcbiAgICAgICAgICAgIG1zZyArPSAnIFlvdSBjYW4gdXNlIGEgc3ByZWFkIHRvIGNvbnZlcnQgdGhpcyBpdGVyYWJsZSBpbnRvIGFuIGFycmF5Lic7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfc2xvdHMobmFtZSwgc2xvdCwga2V5cykge1xuICAgIGZvciAoY29uc3Qgc2xvdF9rZXkgb2YgT2JqZWN0LmtleXMoc2xvdCkpIHtcbiAgICAgICAgaWYgKCF+a2V5cy5pbmRleE9mKHNsb3Rfa2V5KSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGA8JHtuYW1lfT4gcmVjZWl2ZWQgYW4gdW5leHBlY3RlZCBzbG90IFwiJHtzbG90X2tleX1cIi5gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2R5bmFtaWNfZWxlbWVudCh0YWcpIHtcbiAgICBjb25zdCBpc19zdHJpbmcgPSB0eXBlb2YgdGFnID09PSAnc3RyaW5nJztcbiAgICBpZiAodGFnICYmICFpc19zdHJpbmcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCc8c3ZlbHRlOmVsZW1lbnQ+IGV4cGVjdHMgXCJ0aGlzXCIgYXR0cmlidXRlIHRvIGJlIGEgc3RyaW5nLicpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3ZvaWRfZHluYW1pY19lbGVtZW50KHRhZykge1xuICAgIGlmICh0YWcgJiYgaXNfdm9pZCh0YWcpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPHN2ZWx0ZTplbGVtZW50IHRoaXM9XCIke3RhZ31cIj4gaXMgc2VsZi1jbG9zaW5nIGFuZCBjYW5ub3QgaGF2ZSBjb250ZW50LmApO1xuICAgIH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMgd2l0aCBzb21lIG1pbm9yIGRldi1lbmhhbmNlbWVudHMuIFVzZWQgd2hlbiBkZXY9dHJ1ZS5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50RGV2IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucyB8fCAoIW9wdGlvbnMudGFyZ2V0ICYmICFvcHRpb25zLiQkaW5saW5lKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ3RhcmdldCcgaXMgYSByZXF1aXJlZCBvcHRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLiRkZXN0cm95KCk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvbXBvbmVudCB3YXMgYWxyZWFkeSBkZXN0cm95ZWQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgIH07XG4gICAgfVxuICAgICRjYXB0dXJlX3N0YXRlKCkgeyB9XG4gICAgJGluamVjdF9zdGF0ZSgpIHsgfVxufVxuLyoqXG4gKiBCYXNlIGNsYXNzIHRvIGNyZWF0ZSBzdHJvbmdseSB0eXBlZCBTdmVsdGUgY29tcG9uZW50cy5cbiAqIFRoaXMgb25seSBleGlzdHMgZm9yIHR5cGluZyBwdXJwb3NlcyBhbmQgc2hvdWxkIGJlIHVzZWQgaW4gYC5kLnRzYCBmaWxlcy5cbiAqXG4gKiAjIyMgRXhhbXBsZTpcbiAqXG4gKiBZb3UgaGF2ZSBjb21wb25lbnQgbGlicmFyeSBvbiBucG0gY2FsbGVkIGBjb21wb25lbnQtbGlicmFyeWAsIGZyb20gd2hpY2hcbiAqIHlvdSBleHBvcnQgYSBjb21wb25lbnQgY2FsbGVkIGBNeUNvbXBvbmVudGAuIEZvciBTdmVsdGUrVHlwZVNjcmlwdCB1c2VycyxcbiAqIHlvdSB3YW50IHRvIHByb3ZpZGUgdHlwaW5ncy4gVGhlcmVmb3JlIHlvdSBjcmVhdGUgYSBgaW5kZXguZC50c2A6XG4gKiBgYGB0c1xuICogaW1wb3J0IHsgU3ZlbHRlQ29tcG9uZW50VHlwZWQgfSBmcm9tIFwic3ZlbHRlXCI7XG4gKiBleHBvcnQgY2xhc3MgTXlDb21wb25lbnQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnRUeXBlZDx7Zm9vOiBzdHJpbmd9PiB7fVxuICogYGBgXG4gKiBUeXBpbmcgdGhpcyBtYWtlcyBpdCBwb3NzaWJsZSBmb3IgSURFcyBsaWtlIFZTIENvZGUgd2l0aCB0aGUgU3ZlbHRlIGV4dGVuc2lvblxuICogdG8gcHJvdmlkZSBpbnRlbGxpc2Vuc2UgYW5kIHRvIHVzZSB0aGUgY29tcG9uZW50IGxpa2UgdGhpcyBpbiBhIFN2ZWx0ZSBmaWxlXG4gKiB3aXRoIFR5cGVTY3JpcHQ6XG4gKiBgYGBzdmVsdGVcbiAqIDxzY3JpcHQgbGFuZz1cInRzXCI+XG4gKiBcdGltcG9ydCB7IE15Q29tcG9uZW50IH0gZnJvbSBcImNvbXBvbmVudC1saWJyYXJ5XCI7XG4gKiA8L3NjcmlwdD5cbiAqIDxNeUNvbXBvbmVudCBmb289eydiYXInfSAvPlxuICogYGBgXG4gKlxuICogIyMjIyBXaHkgbm90IG1ha2UgdGhpcyBwYXJ0IG9mIGBTdmVsdGVDb21wb25lbnQoRGV2KWA/XG4gKiBCZWNhdXNlXG4gKiBgYGB0c1xuICogY2xhc3MgQVN1YmNsYXNzT2ZTdmVsdGVDb21wb25lbnQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGNvbnN0IGNvbXBvbmVudDogdHlwZW9mIFN2ZWx0ZUNvbXBvbmVudCA9IEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50O1xuICogYGBgXG4gKiB3aWxsIHRocm93IGEgdHlwZSBlcnJvciwgc28gd2UgbmVlZCB0byBzZXBhcmF0ZSB0aGUgbW9yZSBzdHJpY3RseSB0eXBlZCBjbGFzcy5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50VHlwZWQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnREZXYge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9vcF9ndWFyZCh0aW1lb3V0KSB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gc3RhcnQgPiB0aW1lb3V0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0luZmluaXRlIGxvb3AgZGV0ZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmV4cG9ydCB7IEh0bWxUYWcsIEh0bWxUYWdIeWRyYXRpb24sIFN2ZWx0ZUNvbXBvbmVudCwgU3ZlbHRlQ29tcG9uZW50RGV2LCBTdmVsdGVDb21wb25lbnRUeXBlZCwgU3ZlbHRlRWxlbWVudCwgYWN0aW9uX2Rlc3Ryb3llciwgYWRkX2F0dHJpYnV0ZSwgYWRkX2NsYXNzZXMsIGFkZF9mbHVzaF9jYWxsYmFjaywgYWRkX2xvY2F0aW9uLCBhZGRfcmVuZGVyX2NhbGxiYWNrLCBhZGRfcmVzaXplX2xpc3RlbmVyLCBhZGRfc3R5bGVzLCBhZGRfdHJhbnNmb3JtLCBhZnRlclVwZGF0ZSwgYXBwZW5kLCBhcHBlbmRfZGV2LCBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldCwgYXBwZW5kX2h5ZHJhdGlvbiwgYXBwZW5kX2h5ZHJhdGlvbl9kZXYsIGFwcGVuZF9zdHlsZXMsIGFzc2lnbiwgYXR0ciwgYXR0cl9kZXYsIGF0dHJpYnV0ZV90b19vYmplY3QsIGJlZm9yZVVwZGF0ZSwgYmluZCwgYmluZGluZ19jYWxsYmFja3MsIGJsYW5rX29iamVjdCwgYnViYmxlLCBjaGVja19vdXRyb3MsIGNoaWxkcmVuLCBjbGFpbV9jb21wb25lbnQsIGNsYWltX2VsZW1lbnQsIGNsYWltX2h0bWxfdGFnLCBjbGFpbV9zcGFjZSwgY2xhaW1fc3ZnX2VsZW1lbnQsIGNsYWltX3RleHQsIGNsZWFyX2xvb3BzLCBjb21wb25lbnRfc3Vic2NyaWJlLCBjb21wdXRlX3Jlc3RfcHJvcHMsIGNvbXB1dGVfc2xvdHMsIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciwgY3JlYXRlX2FuaW1hdGlvbiwgY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbiwgY3JlYXRlX2NvbXBvbmVudCwgY3JlYXRlX2luX3RyYW5zaXRpb24sIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbiwgY3JlYXRlX3Nsb3QsIGNyZWF0ZV9zc3JfY29tcG9uZW50LCBjdXJyZW50X2NvbXBvbmVudCwgY3VzdG9tX2V2ZW50LCBkYXRhc2V0X2RldiwgZGVidWcsIGRlc3Ryb3lfYmxvY2ssIGRlc3Ryb3lfY29tcG9uZW50LCBkZXN0cm95X2VhY2gsIGRldGFjaCwgZGV0YWNoX2FmdGVyX2RldiwgZGV0YWNoX2JlZm9yZV9kZXYsIGRldGFjaF9iZXR3ZWVuX2RldiwgZGV0YWNoX2RldiwgZGlydHlfY29tcG9uZW50cywgZGlzcGF0Y2hfZGV2LCBlYWNoLCBlbGVtZW50LCBlbGVtZW50X2lzLCBlbXB0eSwgZW5kX2h5ZHJhdGluZywgZXNjYXBlLCBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlLCBlc2NhcGVfb2JqZWN0LCBleGNsdWRlX2ludGVybmFsX3Byb3BzLCBmaXhfYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9wb3NpdGlvbiwgZmx1c2gsIGdldEFsbENvbnRleHRzLCBnZXRDb250ZXh0LCBnZXRfYWxsX2RpcnR5X2Zyb21fc2NvcGUsIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlLCBnZXRfY3VycmVudF9jb21wb25lbnQsIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMsIGdldF9yb290X2Zvcl9zdHlsZSwgZ2V0X3Nsb3RfY2hhbmdlcywgZ2V0X3NwcmVhZF9vYmplY3QsIGdldF9zcHJlYWRfdXBkYXRlLCBnZXRfc3RvcmVfdmFsdWUsIGdsb2JhbHMsIGdyb3VwX291dHJvcywgaGFuZGxlX3Byb21pc2UsIGhhc0NvbnRleHQsIGhhc19wcm9wLCBpZGVudGl0eSwgaW5pdCwgaW5zZXJ0LCBpbnNlcnRfZGV2LCBpbnNlcnRfaHlkcmF0aW9uLCBpbnNlcnRfaHlkcmF0aW9uX2RldiwgaW50cm9zLCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciwgaXNfY2xpZW50LCBpc19jcm9zc29yaWdpbiwgaXNfZW1wdHksIGlzX2Z1bmN0aW9uLCBpc19wcm9taXNlLCBpc192b2lkLCBsaXN0ZW4sIGxpc3Rlbl9kZXYsIGxvb3AsIGxvb3BfZ3VhcmQsIG1lcmdlX3Nzcl9zdHlsZXMsIG1pc3NpbmdfY29tcG9uZW50LCBtb3VudF9jb21wb25lbnQsIG5vb3AsIG5vdF9lcXVhbCwgbm93LCBudWxsX3RvX2VtcHR5LCBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzLCBvbkRlc3Ryb3ksIG9uTW91bnQsIG9uY2UsIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBwcmV2ZW50X2RlZmF1bHQsIHByb3BfZGV2LCBxdWVyeV9zZWxlY3Rvcl9hbGwsIHJhZiwgcnVuLCBydW5fYWxsLCBzYWZlX25vdF9lcXVhbCwgc2NoZWR1bGVfdXBkYXRlLCBzZWxlY3RfbXVsdGlwbGVfdmFsdWUsIHNlbGVjdF9vcHRpb24sIHNlbGVjdF9vcHRpb25zLCBzZWxlY3RfdmFsdWUsIHNlbGYsIHNldENvbnRleHQsIHNldF9hdHRyaWJ1dGVzLCBzZXRfY3VycmVudF9jb21wb25lbnQsIHNldF9jdXN0b21fZWxlbWVudF9kYXRhLCBzZXRfZGF0YSwgc2V0X2RhdGFfZGV2LCBzZXRfaW5wdXRfdHlwZSwgc2V0X2lucHV0X3ZhbHVlLCBzZXRfbm93LCBzZXRfcmFmLCBzZXRfc3RvcmVfdmFsdWUsIHNldF9zdHlsZSwgc2V0X3N2Z19hdHRyaWJ1dGVzLCBzcGFjZSwgc3ByZWFkLCBzcmNfdXJsX2VxdWFsLCBzdGFydF9oeWRyYXRpbmcsIHN0b3BfcHJvcGFnYXRpb24sIHN1YnNjcmliZSwgc3ZnX2VsZW1lbnQsIHRleHQsIHRpY2ssIHRpbWVfcmFuZ2VzX3RvX2FycmF5LCB0b19udW1iZXIsIHRvZ2dsZV9jbGFzcywgdHJhbnNpdGlvbl9pbiwgdHJhbnNpdGlvbl9vdXQsIHRydXN0ZWQsIHVwZGF0ZV9hd2FpdF9ibG9ja19icmFuY2gsIHVwZGF0ZV9rZXllZF9lYWNoLCB1cGRhdGVfc2xvdCwgdXBkYXRlX3Nsb3RfYmFzZSwgdmFsaWRhdGVfY29tcG9uZW50LCB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQsIHZhbGlkYXRlX2VhY2hfYXJndW1lbnQsIHZhbGlkYXRlX2VhY2hfa2V5cywgdmFsaWRhdGVfc2xvdHMsIHZhbGlkYXRlX3N0b3JlLCB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCwgeGxpbmtfYXR0ciB9O1xuIiwiPHNjcmlwdD5cbiAgY29uc3QgbGVuID0gNTtcbiAgbGV0IGNvdW50ID0gMDtcblxuICBmdW5jdGlvbiBpbnB1dCh4KSB7XG4gICAgY291bnQgPSBwYXJzZUludCh4LnRhcmdldC52YWx1ZSlcbiAgfVxuPC9zY3JpcHQ+XG5cbjxpbWcgXG4gIHNyYz1cImltYWdlcy90cmFqZWN0b3JpZXN7Y291bnR9LnN2Z1wiXG4gIGFsdD1cIkludGVyYWN0aXZlIHBsb3QgZGlzcGxheWluZyB0aGUgdHJhamVjdG9yaWVzIG9mIHRoZSBSTCBhZ2VudCBvbiB0aGUgbWFwXCJcbiAgaGVpZ2h0PVwiMzAwcHhcIlxuICB3aWR0aD1cIjMwMHB4XCJcbi8+XG48ZGl2IHN0eWxlPVwid2lkdGg6MzAwcHg7IG1hcmdpbjphdXRvOyB0ZXh0LWFsaWduOmNlbnRlcjtcIj5cbiAgPHA+VHJhamVjdG9yeSBhZnRlciBjdXJyaWN1bHVtIHN0ZXAge2NvdW50ICsgMX08L3A+XG4gIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBtaW49XCIwXCIgbWF4PVwie2xlbn1cIiB2YWx1ZT1cIjBcIiBvbjppbnB1dD17aW5wdXR9PlxuPC9kaXY+XG4iLCI8c2NyaXB0PlxuICBjb25zdCBsZW4gPSA5O1xuICBsZXQgY291bnQgPSAxO1xuXG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKVxuICB9XG48L3NjcmlwdD5cblxuPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+IFxuICA8aW1nIFxuICAgIHNyYz1cImltYWdlcy8xNngxNl9iYWNre2NvdW50fV9zdWNjZXNzZXMuc3ZnXCJcbiAgICBhbHQ9XCJJbnRlcmFjdGl2ZSBwbG90IGRpc3BsYXlpbmcgdGhlIHN1Y2Nlc3MgcmF0ZSBvZiB0aGUgYmFjayBjdXJyaWN1bHVtIHBvbGljeSBvdmVyIHRoZSBudW1iZXIgb2YgY3VycmljdWx1bSBzdGVwc1wiXG4gICAgaGVpZ2h0PVwiMzAwcHhcIlxuICAgIHdpZHRoPVwiNDAwcHhcIlxuICAvPiBcbiAgPGRpdiBzdHlsZT1cIndpZHRoOjMwMHB4OyBtYXJnaW46YXV0bzsgdGV4dC1hbGlnbjpjZW50ZXI7XCI+XG4gICAgPHA+eCA9IHtjb3VudH08L3A+XG4gICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIG1pbj1cIjFcIiBtYXg9XCJ7bGVufVwiIHZhbHVlPVwiMFwiIG9uOmlucHV0PXtpbnB1dH0+XG4gIDwvZGl2PiBcbjwvZGl2PiIsIjxzY3JpcHQ+XG4gIGNvbnN0IGxlbiA9IDQ7XG4gIGxldCBjb3VudCA9IDA7XG5cbiAgZnVuY3Rpb24gaW5wdXQoeCkge1xuICAgIGNvdW50ID0gcGFyc2VJbnQoeC50YXJnZXQudmFsdWUpXG4gIH1cbjwvc2NyaXB0PlxuXG48ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj4gXG4gIDxpbWcgXG4gICAgc3JjPVwiaW1hZ2VzLzE2eDE2X2luY3JlbWVudGFse2NvdW50fV9zdWNjZXNzZXMuc3ZnXCJcbiAgICBhbHQ9XCJJbnRlcmFjdGl2ZSBwbG90IGRpc3BsYXlpbmcgdGhlIHN1Y2Nlc3MgcmF0ZSBvZiB0aGUgaW5jcmVtZW50YWwgY3VycmljdWx1bSBwb2xpY3kgb3ZlciB0aGUgbnVtYmVyIG9mIGN1cnJpY3VsdW0gc3RlcHNcIlxuICAgIGhlaWdodD1cIjMwMHB4XCJcbiAgICB3aWR0aD1cIjQwMHB4XCJcbiAgLz5cbiAgPGRpdiBzdHlsZT1cIndpZHRoOjMwMHB4OyBtYXJnaW46YXV0bzsgdGV4dC1hbGlnbjpjZW50ZXI7XCI+XG4gICAgPHA+eCA9IHtjb3VudH08L3A+XG4gICAgPGlucHV0IHR5cGU9XCJyYW5nZVwiIG1pbj1cIjBcIiBtYXg9XCJ7bGVufVwiIHZhbHVlPVwiMFwiIG9uOmlucHV0PXtpbnB1dH0+XG4gIDwvZGl2PlxuPC9kaXY+IiwiaW1wb3J0IHsgbm9vcCwgc2FmZV9ub3RfZXF1YWwsIHN1YnNjcmliZSwgcnVuX2FsbCwgaXNfZnVuY3Rpb24gfSBmcm9tICcuLi9pbnRlcm5hbC9pbmRleC5tanMnO1xuZXhwb3J0IHsgZ2V0X3N0b3JlX3ZhbHVlIGFzIGdldCB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5cbmNvbnN0IHN1YnNjcmliZXJfcXVldWUgPSBbXTtcbi8qKlxuICogQ3JlYXRlcyBhIGBSZWFkYWJsZWAgc3RvcmUgdGhhdCBhbGxvd3MgcmVhZGluZyBieSBzdWJzY3JpcHRpb24uXG4gKiBAcGFyYW0gdmFsdWUgaW5pdGlhbCB2YWx1ZVxuICogQHBhcmFtIHtTdGFydFN0b3BOb3RpZmllcn1zdGFydCBzdGFydCBhbmQgc3RvcCBub3RpZmljYXRpb25zIGZvciBzdWJzY3JpcHRpb25zXG4gKi9cbmZ1bmN0aW9uIHJlYWRhYmxlKHZhbHVlLCBzdGFydCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHN1YnNjcmliZTogd3JpdGFibGUodmFsdWUsIHN0YXJ0KS5zdWJzY3JpYmVcbiAgICB9O1xufVxuLyoqXG4gKiBDcmVhdGUgYSBgV3JpdGFibGVgIHN0b3JlIHRoYXQgYWxsb3dzIGJvdGggdXBkYXRpbmcgYW5kIHJlYWRpbmcgYnkgc3Vic2NyaXB0aW9uLlxuICogQHBhcmFtIHsqPX12YWx1ZSBpbml0aWFsIHZhbHVlXG4gKiBAcGFyYW0ge1N0YXJ0U3RvcE5vdGlmaWVyPX1zdGFydCBzdGFydCBhbmQgc3RvcCBub3RpZmljYXRpb25zIGZvciBzdWJzY3JpcHRpb25zXG4gKi9cbmZ1bmN0aW9uIHdyaXRhYmxlKHZhbHVlLCBzdGFydCA9IG5vb3ApIHtcbiAgICBsZXQgc3RvcDtcbiAgICBjb25zdCBzdWJzY3JpYmVycyA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBzZXQobmV3X3ZhbHVlKSB7XG4gICAgICAgIGlmIChzYWZlX25vdF9lcXVhbCh2YWx1ZSwgbmV3X3ZhbHVlKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBuZXdfdmFsdWU7XG4gICAgICAgICAgICBpZiAoc3RvcCkgeyAvLyBzdG9yZSBpcyByZWFkeVxuICAgICAgICAgICAgICAgIGNvbnN0IHJ1bl9xdWV1ZSA9ICFzdWJzY3JpYmVyX3F1ZXVlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHN1YnNjcmliZXIgb2Ygc3Vic2NyaWJlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlclsxXSgpO1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyX3F1ZXVlLnB1c2goc3Vic2NyaWJlciwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocnVuX3F1ZXVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3Vic2NyaWJlcl9xdWV1ZS5sZW5ndGg7IGkgKz0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcl9xdWV1ZVtpXVswXShzdWJzY3JpYmVyX3F1ZXVlW2kgKyAxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlcl9xdWV1ZS5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGUoZm4pIHtcbiAgICAgICAgc2V0KGZuKHZhbHVlKSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHN1YnNjcmliZShydW4sIGludmFsaWRhdGUgPSBub29wKSB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmliZXIgPSBbcnVuLCBpbnZhbGlkYXRlXTtcbiAgICAgICAgc3Vic2NyaWJlcnMuYWRkKHN1YnNjcmliZXIpO1xuICAgICAgICBpZiAoc3Vic2NyaWJlcnMuc2l6ZSA9PT0gMSkge1xuICAgICAgICAgICAgc3RvcCA9IHN0YXJ0KHNldCkgfHwgbm9vcDtcbiAgICAgICAgfVxuICAgICAgICBydW4odmFsdWUpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgc3Vic2NyaWJlcnMuZGVsZXRlKHN1YnNjcmliZXIpO1xuICAgICAgICAgICAgaWYgKHN1YnNjcmliZXJzLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgICAgICAgICAgc3RvcCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7IHNldCwgdXBkYXRlLCBzdWJzY3JpYmUgfTtcbn1cbmZ1bmN0aW9uIGRlcml2ZWQoc3RvcmVzLCBmbiwgaW5pdGlhbF92YWx1ZSkge1xuICAgIGNvbnN0IHNpbmdsZSA9ICFBcnJheS5pc0FycmF5KHN0b3Jlcyk7XG4gICAgY29uc3Qgc3RvcmVzX2FycmF5ID0gc2luZ2xlXG4gICAgICAgID8gW3N0b3Jlc11cbiAgICAgICAgOiBzdG9yZXM7XG4gICAgY29uc3QgYXV0byA9IGZuLmxlbmd0aCA8IDI7XG4gICAgcmV0dXJuIHJlYWRhYmxlKGluaXRpYWxfdmFsdWUsIChzZXQpID0+IHtcbiAgICAgICAgbGV0IGluaXRlZCA9IGZhbHNlO1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgbGV0IHBlbmRpbmcgPSAwO1xuICAgICAgICBsZXQgY2xlYW51cCA9IG5vb3A7XG4gICAgICAgIGNvbnN0IHN5bmMgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAocGVuZGluZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGZuKHNpbmdsZSA/IHZhbHVlc1swXSA6IHZhbHVlcywgc2V0KTtcbiAgICAgICAgICAgIGlmIChhdXRvKSB7XG4gICAgICAgICAgICAgICAgc2V0KHJlc3VsdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwID0gaXNfZnVuY3Rpb24ocmVzdWx0KSA/IHJlc3VsdCA6IG5vb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlcnMgPSBzdG9yZXNfYXJyYXkubWFwKChzdG9yZSwgaSkgPT4gc3Vic2NyaWJlKHN0b3JlLCAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIHZhbHVlc1tpXSA9IHZhbHVlO1xuICAgICAgICAgICAgcGVuZGluZyAmPSB+KDEgPDwgaSk7XG4gICAgICAgICAgICBpZiAoaW5pdGVkKSB7XG4gICAgICAgICAgICAgICAgc3luYygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICBwZW5kaW5nIHw9ICgxIDw8IGkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIGluaXRlZCA9IHRydWU7XG4gICAgICAgIHN5bmMoKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgICAgICBydW5fYWxsKHVuc3Vic2NyaWJlcnMpO1xuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICB9O1xuICAgIH0pO1xufVxuXG5leHBvcnQgeyBkZXJpdmVkLCByZWFkYWJsZSwgd3JpdGFibGUgfTtcbiIsImV4cG9ydCB7IGlkZW50aXR5IGFzIGxpbmVhciB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5cbi8qXG5BZGFwdGVkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL21hdHRkZXNsXG5EaXN0cmlidXRlZCB1bmRlciBNSVQgTGljZW5zZSBodHRwczovL2dpdGh1Yi5jb20vbWF0dGRlc2wvZWFzZXMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZFxuKi9cbmZ1bmN0aW9uIGJhY2tJbk91dCh0KSB7XG4gICAgY29uc3QgcyA9IDEuNzAxNTggKiAxLjUyNTtcbiAgICBpZiAoKHQgKj0gMikgPCAxKVxuICAgICAgICByZXR1cm4gMC41ICogKHQgKiB0ICogKChzICsgMSkgKiB0IC0gcykpO1xuICAgIHJldHVybiAwLjUgKiAoKHQgLT0gMikgKiB0ICogKChzICsgMSkgKiB0ICsgcykgKyAyKTtcbn1cbmZ1bmN0aW9uIGJhY2tJbih0KSB7XG4gICAgY29uc3QgcyA9IDEuNzAxNTg7XG4gICAgcmV0dXJuIHQgKiB0ICogKChzICsgMSkgKiB0IC0gcyk7XG59XG5mdW5jdGlvbiBiYWNrT3V0KHQpIHtcbiAgICBjb25zdCBzID0gMS43MDE1ODtcbiAgICByZXR1cm4gLS10ICogdCAqICgocyArIDEpICogdCArIHMpICsgMTtcbn1cbmZ1bmN0aW9uIGJvdW5jZU91dCh0KSB7XG4gICAgY29uc3QgYSA9IDQuMCAvIDExLjA7XG4gICAgY29uc3QgYiA9IDguMCAvIDExLjA7XG4gICAgY29uc3QgYyA9IDkuMCAvIDEwLjA7XG4gICAgY29uc3QgY2EgPSA0MzU2LjAgLyAzNjEuMDtcbiAgICBjb25zdCBjYiA9IDM1NDQyLjAgLyAxODA1LjA7XG4gICAgY29uc3QgY2MgPSAxNjA2MS4wIC8gMTgwNS4wO1xuICAgIGNvbnN0IHQyID0gdCAqIHQ7XG4gICAgcmV0dXJuIHQgPCBhXG4gICAgICAgID8gNy41NjI1ICogdDJcbiAgICAgICAgOiB0IDwgYlxuICAgICAgICAgICAgPyA5LjA3NSAqIHQyIC0gOS45ICogdCArIDMuNFxuICAgICAgICAgICAgOiB0IDwgY1xuICAgICAgICAgICAgICAgID8gY2EgKiB0MiAtIGNiICogdCArIGNjXG4gICAgICAgICAgICAgICAgOiAxMC44ICogdCAqIHQgLSAyMC41MiAqIHQgKyAxMC43Mjtcbn1cbmZ1bmN0aW9uIGJvdW5jZUluT3V0KHQpIHtcbiAgICByZXR1cm4gdCA8IDAuNVxuICAgICAgICA/IDAuNSAqICgxLjAgLSBib3VuY2VPdXQoMS4wIC0gdCAqIDIuMCkpXG4gICAgICAgIDogMC41ICogYm91bmNlT3V0KHQgKiAyLjAgLSAxLjApICsgMC41O1xufVxuZnVuY3Rpb24gYm91bmNlSW4odCkge1xuICAgIHJldHVybiAxLjAgLSBib3VuY2VPdXQoMS4wIC0gdCk7XG59XG5mdW5jdGlvbiBjaXJjSW5PdXQodCkge1xuICAgIGlmICgodCAqPSAyKSA8IDEpXG4gICAgICAgIHJldHVybiAtMC41ICogKE1hdGguc3FydCgxIC0gdCAqIHQpIC0gMSk7XG4gICAgcmV0dXJuIDAuNSAqIChNYXRoLnNxcnQoMSAtICh0IC09IDIpICogdCkgKyAxKTtcbn1cbmZ1bmN0aW9uIGNpcmNJbih0KSB7XG4gICAgcmV0dXJuIDEuMCAtIE1hdGguc3FydCgxLjAgLSB0ICogdCk7XG59XG5mdW5jdGlvbiBjaXJjT3V0KHQpIHtcbiAgICByZXR1cm4gTWF0aC5zcXJ0KDEgLSAtLXQgKiB0KTtcbn1cbmZ1bmN0aW9uIGN1YmljSW5PdXQodCkge1xuICAgIHJldHVybiB0IDwgMC41ID8gNC4wICogdCAqIHQgKiB0IDogMC41ICogTWF0aC5wb3coMi4wICogdCAtIDIuMCwgMy4wKSArIDEuMDtcbn1cbmZ1bmN0aW9uIGN1YmljSW4odCkge1xuICAgIHJldHVybiB0ICogdCAqIHQ7XG59XG5mdW5jdGlvbiBjdWJpY091dCh0KSB7XG4gICAgY29uc3QgZiA9IHQgLSAxLjA7XG4gICAgcmV0dXJuIGYgKiBmICogZiArIDEuMDtcbn1cbmZ1bmN0aW9uIGVsYXN0aWNJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjVcbiAgICAgICAgPyAwLjUgKlxuICAgICAgICAgICAgTWF0aC5zaW4oKCgrMTMuMCAqIE1hdGguUEkpIC8gMikgKiAyLjAgKiB0KSAqXG4gICAgICAgICAgICBNYXRoLnBvdygyLjAsIDEwLjAgKiAoMi4wICogdCAtIDEuMCkpXG4gICAgICAgIDogMC41ICpcbiAgICAgICAgICAgIE1hdGguc2luKCgoLTEzLjAgKiBNYXRoLlBJKSAvIDIpICogKDIuMCAqIHQgLSAxLjAgKyAxLjApKSAqXG4gICAgICAgICAgICBNYXRoLnBvdygyLjAsIC0xMC4wICogKDIuMCAqIHQgLSAxLjApKSArXG4gICAgICAgICAgICAxLjA7XG59XG5mdW5jdGlvbiBlbGFzdGljSW4odCkge1xuICAgIHJldHVybiBNYXRoLnNpbigoMTMuMCAqIHQgKiBNYXRoLlBJKSAvIDIpICogTWF0aC5wb3coMi4wLCAxMC4wICogKHQgLSAxLjApKTtcbn1cbmZ1bmN0aW9uIGVsYXN0aWNPdXQodCkge1xuICAgIHJldHVybiAoTWF0aC5zaW4oKC0xMy4wICogKHQgKyAxLjApICogTWF0aC5QSSkgLyAyKSAqIE1hdGgucG93KDIuMCwgLTEwLjAgKiB0KSArIDEuMCk7XG59XG5mdW5jdGlvbiBleHBvSW5PdXQodCkge1xuICAgIHJldHVybiB0ID09PSAwLjAgfHwgdCA9PT0gMS4wXG4gICAgICAgID8gdFxuICAgICAgICA6IHQgPCAwLjVcbiAgICAgICAgICAgID8gKzAuNSAqIE1hdGgucG93KDIuMCwgMjAuMCAqIHQgLSAxMC4wKVxuICAgICAgICAgICAgOiAtMC41ICogTWF0aC5wb3coMi4wLCAxMC4wIC0gdCAqIDIwLjApICsgMS4wO1xufVxuZnVuY3Rpb24gZXhwb0luKHQpIHtcbiAgICByZXR1cm4gdCA9PT0gMC4wID8gdCA6IE1hdGgucG93KDIuMCwgMTAuMCAqICh0IC0gMS4wKSk7XG59XG5mdW5jdGlvbiBleHBvT3V0KHQpIHtcbiAgICByZXR1cm4gdCA9PT0gMS4wID8gdCA6IDEuMCAtIE1hdGgucG93KDIuMCwgLTEwLjAgKiB0KTtcbn1cbmZ1bmN0aW9uIHF1YWRJbk91dCh0KSB7XG4gICAgdCAvPSAwLjU7XG4gICAgaWYgKHQgPCAxKVxuICAgICAgICByZXR1cm4gMC41ICogdCAqIHQ7XG4gICAgdC0tO1xuICAgIHJldHVybiAtMC41ICogKHQgKiAodCAtIDIpIC0gMSk7XG59XG5mdW5jdGlvbiBxdWFkSW4odCkge1xuICAgIHJldHVybiB0ICogdDtcbn1cbmZ1bmN0aW9uIHF1YWRPdXQodCkge1xuICAgIHJldHVybiAtdCAqICh0IC0gMi4wKTtcbn1cbmZ1bmN0aW9uIHF1YXJ0SW5PdXQodCkge1xuICAgIHJldHVybiB0IDwgMC41XG4gICAgICAgID8gKzguMCAqIE1hdGgucG93KHQsIDQuMClcbiAgICAgICAgOiAtOC4wICogTWF0aC5wb3codCAtIDEuMCwgNC4wKSArIDEuMDtcbn1cbmZ1bmN0aW9uIHF1YXJ0SW4odCkge1xuICAgIHJldHVybiBNYXRoLnBvdyh0LCA0LjApO1xufVxuZnVuY3Rpb24gcXVhcnRPdXQodCkge1xuICAgIHJldHVybiBNYXRoLnBvdyh0IC0gMS4wLCAzLjApICogKDEuMCAtIHQpICsgMS4wO1xufVxuZnVuY3Rpb24gcXVpbnRJbk91dCh0KSB7XG4gICAgaWYgKCh0ICo9IDIpIDwgMSlcbiAgICAgICAgcmV0dXJuIDAuNSAqIHQgKiB0ICogdCAqIHQgKiB0O1xuICAgIHJldHVybiAwLjUgKiAoKHQgLT0gMikgKiB0ICogdCAqIHQgKiB0ICsgMik7XG59XG5mdW5jdGlvbiBxdWludEluKHQpIHtcbiAgICByZXR1cm4gdCAqIHQgKiB0ICogdCAqIHQ7XG59XG5mdW5jdGlvbiBxdWludE91dCh0KSB7XG4gICAgcmV0dXJuIC0tdCAqIHQgKiB0ICogdCAqIHQgKyAxO1xufVxuZnVuY3Rpb24gc2luZUluT3V0KHQpIHtcbiAgICByZXR1cm4gLTAuNSAqIChNYXRoLmNvcyhNYXRoLlBJICogdCkgLSAxKTtcbn1cbmZ1bmN0aW9uIHNpbmVJbih0KSB7XG4gICAgY29uc3QgdiA9IE1hdGguY29zKHQgKiBNYXRoLlBJICogMC41KTtcbiAgICBpZiAoTWF0aC5hYnModikgPCAxZS0xNClcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gMSAtIHY7XG59XG5mdW5jdGlvbiBzaW5lT3V0KHQpIHtcbiAgICByZXR1cm4gTWF0aC5zaW4oKHQgKiBNYXRoLlBJKSAvIDIpO1xufVxuXG5leHBvcnQgeyBiYWNrSW4sIGJhY2tJbk91dCwgYmFja091dCwgYm91bmNlSW4sIGJvdW5jZUluT3V0LCBib3VuY2VPdXQsIGNpcmNJbiwgY2lyY0luT3V0LCBjaXJjT3V0LCBjdWJpY0luLCBjdWJpY0luT3V0LCBjdWJpY091dCwgZWxhc3RpY0luLCBlbGFzdGljSW5PdXQsIGVsYXN0aWNPdXQsIGV4cG9JbiwgZXhwb0luT3V0LCBleHBvT3V0LCBxdWFkSW4sIHF1YWRJbk91dCwgcXVhZE91dCwgcXVhcnRJbiwgcXVhcnRJbk91dCwgcXVhcnRPdXQsIHF1aW50SW4sIHF1aW50SW5PdXQsIHF1aW50T3V0LCBzaW5lSW4sIHNpbmVJbk91dCwgc2luZU91dCB9O1xuIiwiaW1wb3J0IHsgd3JpdGFibGUgfSBmcm9tICcuLi9zdG9yZS9pbmRleC5tanMnO1xuaW1wb3J0IHsgbm93LCBsb29wLCBhc3NpZ24gfSBmcm9tICcuLi9pbnRlcm5hbC9pbmRleC5tanMnO1xuaW1wb3J0IHsgbGluZWFyIH0gZnJvbSAnLi4vZWFzaW5nL2luZGV4Lm1qcyc7XG5cbmZ1bmN0aW9uIGlzX2RhdGUob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopID09PSAnW29iamVjdCBEYXRlXSc7XG59XG5cbmZ1bmN0aW9uIHRpY2tfc3ByaW5nKGN0eCwgbGFzdF92YWx1ZSwgY3VycmVudF92YWx1ZSwgdGFyZ2V0X3ZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiBjdXJyZW50X3ZhbHVlID09PSAnbnVtYmVyJyB8fCBpc19kYXRlKGN1cnJlbnRfdmFsdWUpKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZGVsdGEgPSB0YXJnZXRfdmFsdWUgLSBjdXJyZW50X3ZhbHVlO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IHZlbG9jaXR5ID0gKGN1cnJlbnRfdmFsdWUgLSBsYXN0X3ZhbHVlKSAvIChjdHguZHQgfHwgMSAvIDYwKTsgLy8gZ3VhcmQgZGl2IGJ5IDBcbiAgICAgICAgY29uc3Qgc3ByaW5nID0gY3R4Lm9wdHMuc3RpZmZuZXNzICogZGVsdGE7XG4gICAgICAgIGNvbnN0IGRhbXBlciA9IGN0eC5vcHRzLmRhbXBpbmcgKiB2ZWxvY2l0eTtcbiAgICAgICAgY29uc3QgYWNjZWxlcmF0aW9uID0gKHNwcmluZyAtIGRhbXBlcikgKiBjdHguaW52X21hc3M7XG4gICAgICAgIGNvbnN0IGQgPSAodmVsb2NpdHkgKyBhY2NlbGVyYXRpb24pICogY3R4LmR0O1xuICAgICAgICBpZiAoTWF0aC5hYnMoZCkgPCBjdHgub3B0cy5wcmVjaXNpb24gJiYgTWF0aC5hYnMoZGVsdGEpIDwgY3R4Lm9wdHMucHJlY2lzaW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0X3ZhbHVlOyAvLyBzZXR0bGVkXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjdHguc2V0dGxlZCA9IGZhbHNlOyAvLyBzaWduYWwgbG9vcCB0byBrZWVwIHRpY2tpbmdcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHJldHVybiBpc19kYXRlKGN1cnJlbnRfdmFsdWUpID9cbiAgICAgICAgICAgICAgICBuZXcgRGF0ZShjdXJyZW50X3ZhbHVlLmdldFRpbWUoKSArIGQpIDogY3VycmVudF92YWx1ZSArIGQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjdXJyZW50X3ZhbHVlKSkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBjdXJyZW50X3ZhbHVlLm1hcCgoXywgaSkgPT4gdGlja19zcHJpbmcoY3R4LCBsYXN0X3ZhbHVlW2ldLCBjdXJyZW50X3ZhbHVlW2ldLCB0YXJnZXRfdmFsdWVbaV0pKTtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGN1cnJlbnRfdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGNvbnN0IG5leHRfdmFsdWUgPSB7fTtcbiAgICAgICAgZm9yIChjb25zdCBrIGluIGN1cnJlbnRfdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIG5leHRfdmFsdWVba10gPSB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWVba10sIGN1cnJlbnRfdmFsdWVba10sIHRhcmdldF92YWx1ZVtrXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gbmV4dF92YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHNwcmluZyAke3R5cGVvZiBjdXJyZW50X3ZhbHVlfSB2YWx1ZXNgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzcHJpbmcodmFsdWUsIG9wdHMgPSB7fSkge1xuICAgIGNvbnN0IHN0b3JlID0gd3JpdGFibGUodmFsdWUpO1xuICAgIGNvbnN0IHsgc3RpZmZuZXNzID0gMC4xNSwgZGFtcGluZyA9IDAuOCwgcHJlY2lzaW9uID0gMC4wMSB9ID0gb3B0cztcbiAgICBsZXQgbGFzdF90aW1lO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCBjdXJyZW50X3Rva2VuO1xuICAgIGxldCBsYXN0X3ZhbHVlID0gdmFsdWU7XG4gICAgbGV0IHRhcmdldF92YWx1ZSA9IHZhbHVlO1xuICAgIGxldCBpbnZfbWFzcyA9IDE7XG4gICAgbGV0IGludl9tYXNzX3JlY292ZXJ5X3JhdGUgPSAwO1xuICAgIGxldCBjYW5jZWxfdGFzayA9IGZhbHNlO1xuICAgIGZ1bmN0aW9uIHNldChuZXdfdmFsdWUsIG9wdHMgPSB7fSkge1xuICAgICAgICB0YXJnZXRfdmFsdWUgPSBuZXdfdmFsdWU7XG4gICAgICAgIGNvbnN0IHRva2VuID0gY3VycmVudF90b2tlbiA9IHt9O1xuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCBvcHRzLmhhcmQgfHwgKHNwcmluZy5zdGlmZm5lc3MgPj0gMSAmJiBzcHJpbmcuZGFtcGluZyA+PSAxKSkge1xuICAgICAgICAgICAgY2FuY2VsX3Rhc2sgPSB0cnVlOyAvLyBjYW5jZWwgYW55IHJ1bm5pbmcgYW5pbWF0aW9uXG4gICAgICAgICAgICBsYXN0X3RpbWUgPSBub3coKTtcbiAgICAgICAgICAgIGxhc3RfdmFsdWUgPSBuZXdfdmFsdWU7XG4gICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSB0YXJnZXRfdmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9wdHMuc29mdCkge1xuICAgICAgICAgICAgY29uc3QgcmF0ZSA9IG9wdHMuc29mdCA9PT0gdHJ1ZSA/IC41IDogK29wdHMuc29mdDtcbiAgICAgICAgICAgIGludl9tYXNzX3JlY292ZXJ5X3JhdGUgPSAxIC8gKHJhdGUgKiA2MCk7XG4gICAgICAgICAgICBpbnZfbWFzcyA9IDA7IC8vIGluZmluaXRlIG1hc3MsIHVuYWZmZWN0ZWQgYnkgc3ByaW5nIGZvcmNlc1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGFzaykge1xuICAgICAgICAgICAgbGFzdF90aW1lID0gbm93KCk7XG4gICAgICAgICAgICBjYW5jZWxfdGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsX3Rhc2spIHtcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsX3Rhc2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGFzayA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW52X21hc3MgPSBNYXRoLm1pbihpbnZfbWFzcyArIGludl9tYXNzX3JlY292ZXJ5X3JhdGUsIDEpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IHtcbiAgICAgICAgICAgICAgICAgICAgaW52X21hc3MsXG4gICAgICAgICAgICAgICAgICAgIG9wdHM6IHNwcmluZyxcbiAgICAgICAgICAgICAgICAgICAgc2V0dGxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZHQ6IChub3cgLSBsYXN0X3RpbWUpICogNjAgLyAxMDAwXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0X3ZhbHVlID0gdGlja19zcHJpbmcoY3R4LCBsYXN0X3ZhbHVlLCB2YWx1ZSwgdGFyZ2V0X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICBsYXN0X3RpbWUgPSBub3c7XG4gICAgICAgICAgICAgICAgbGFzdF92YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IG5leHRfdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChjdHguc2V0dGxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0YXNrID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICFjdHguc2V0dGxlZDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdWxmaWwgPT4ge1xuICAgICAgICAgICAgdGFzay5wcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0b2tlbiA9PT0gY3VycmVudF90b2tlbilcbiAgICAgICAgICAgICAgICAgICAgZnVsZmlsKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNwcmluZyA9IHtcbiAgICAgICAgc2V0LFxuICAgICAgICB1cGRhdGU6IChmbiwgb3B0cykgPT4gc2V0KGZuKHRhcmdldF92YWx1ZSwgdmFsdWUpLCBvcHRzKSxcbiAgICAgICAgc3Vic2NyaWJlOiBzdG9yZS5zdWJzY3JpYmUsXG4gICAgICAgIHN0aWZmbmVzcyxcbiAgICAgICAgZGFtcGluZyxcbiAgICAgICAgcHJlY2lzaW9uXG4gICAgfTtcbiAgICByZXR1cm4gc3ByaW5nO1xufVxuXG5mdW5jdGlvbiBnZXRfaW50ZXJwb2xhdG9yKGEsIGIpIHtcbiAgICBpZiAoYSA9PT0gYiB8fCBhICE9PSBhKVxuICAgICAgICByZXR1cm4gKCkgPT4gYTtcbiAgICBjb25zdCB0eXBlID0gdHlwZW9mIGE7XG4gICAgaWYgKHR5cGUgIT09IHR5cGVvZiBiIHx8IEFycmF5LmlzQXJyYXkoYSkgIT09IEFycmF5LmlzQXJyYXkoYikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaW50ZXJwb2xhdGUgdmFsdWVzIG9mIGRpZmZlcmVudCB0eXBlJyk7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGEpKSB7XG4gICAgICAgIGNvbnN0IGFyciA9IGIubWFwKChiaSwgaSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGdldF9pbnRlcnBvbGF0b3IoYVtpXSwgYmkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHQgPT4gYXJyLm1hcChmbiA9PiBmbih0KSk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAnb2JqZWN0Jykge1xuICAgICAgICBpZiAoIWEgfHwgIWIpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09iamVjdCBjYW5ub3QgYmUgbnVsbCcpO1xuICAgICAgICBpZiAoaXNfZGF0ZShhKSAmJiBpc19kYXRlKGIpKSB7XG4gICAgICAgICAgICBhID0gYS5nZXRUaW1lKCk7XG4gICAgICAgICAgICBiID0gYi5nZXRUaW1lKCk7XG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGIgLSBhO1xuICAgICAgICAgICAgcmV0dXJuIHQgPT4gbmV3IERhdGUoYSArIHQgKiBkZWx0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGIpO1xuICAgICAgICBjb25zdCBpbnRlcnBvbGF0b3JzID0ge307XG4gICAgICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgaW50ZXJwb2xhdG9yc1trZXldID0gZ2V0X2ludGVycG9sYXRvcihhW2tleV0sIGJba2V5XSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdCA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIGtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtrZXldID0gaW50ZXJwb2xhdG9yc1trZXldKHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgY29uc3QgZGVsdGEgPSBiIC0gYTtcbiAgICAgICAgcmV0dXJuIHQgPT4gYSArIHQgKiBkZWx0YTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgaW50ZXJwb2xhdGUgJHt0eXBlfSB2YWx1ZXNgKTtcbn1cbmZ1bmN0aW9uIHR3ZWVuZWQodmFsdWUsIGRlZmF1bHRzID0ge30pIHtcbiAgICBjb25zdCBzdG9yZSA9IHdyaXRhYmxlKHZhbHVlKTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdGFyZ2V0X3ZhbHVlID0gdmFsdWU7XG4gICAgZnVuY3Rpb24gc2V0KG5ld192YWx1ZSwgb3B0cykge1xuICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gbmV3X3ZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXRfdmFsdWUgPSBuZXdfdmFsdWU7XG4gICAgICAgIGxldCBwcmV2aW91c190YXNrID0gdGFzaztcbiAgICAgICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgbGV0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDQwMCwgZWFzaW5nID0gbGluZWFyLCBpbnRlcnBvbGF0ZSA9IGdldF9pbnRlcnBvbGF0b3IgfSA9IGFzc2lnbihhc3NpZ24oe30sIGRlZmF1bHRzKSwgb3B0cyk7XG4gICAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKHByZXZpb3VzX3Rhc2spIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNfdGFzayA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSB0YXJnZXRfdmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgbGV0IGZuO1xuICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKG5vdyA8IHN0YXJ0KVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgaWYgKCFzdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgZm4gPSBpbnRlcnBvbGF0ZSh2YWx1ZSwgbmV3X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGR1cmF0aW9uID09PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uKHZhbHVlLCBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZXZpb3VzX3Rhc2spIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNfdGFzayA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBlbGFwc2VkID0gbm93IC0gc3RhcnQ7XG4gICAgICAgICAgICBpZiAoZWxhcHNlZCA+IGR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gbmV3X3ZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBmbihlYXNpbmcoZWxhcHNlZCAvIGR1cmF0aW9uKSkpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGFzay5wcm9taXNlO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBzZXQsXG4gICAgICAgIHVwZGF0ZTogKGZuLCBvcHRzKSA9PiBzZXQoZm4odGFyZ2V0X3ZhbHVlLCB2YWx1ZSksIG9wdHMpLFxuICAgICAgICBzdWJzY3JpYmU6IHN0b3JlLnN1YnNjcmliZVxuICAgIH07XG59XG5cbmV4cG9ydCB7IHNwcmluZywgdHdlZW5lZCB9O1xuIiwiPHNjcmlwdD5cclxuICBpbXBvcnQgeyBvbk1vdW50IH0gZnJvbSBcInN2ZWx0ZVwiXHJcblxyXG4gIGV4cG9ydCBsZXQgc2l6ZSA9IDEwXHJcbiAgZXhwb3J0IGxldCB4ID0gWy0wLjUsIDAuNV1cclxuICBleHBvcnQgbGV0IHkgPSBbMC4yNSwgMV1cclxuICBleHBvcnQgbGV0IGR1cmF0aW9uID0gMjAwMFxyXG4gIGV4cG9ydCBsZXQgaW5maW5pdGUgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgZGVsYXkgPSBbMCwgNTBdXHJcbiAgZXhwb3J0IGxldCBjb2xvclJhbmdlID0gWzAsIDM2MF1cclxuICBleHBvcnQgbGV0IGNvbG9yQXJyYXkgPSBbXVxyXG4gIGV4cG9ydCBsZXQgYW1vdW50ID0gNTBcclxuICBleHBvcnQgbGV0IGl0ZXJhdGlvbkNvdW50ID0gMVxyXG4gIGV4cG9ydCBsZXQgZmFsbERpc3RhbmNlID0gXCIxMDBweFwiXHJcbiAgZXhwb3J0IGxldCByb3VuZGVkID0gZmFsc2VcclxuICBleHBvcnQgbGV0IGNvbmUgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgbm9HcmF2aXR5ID0gZmFsc2VcclxuICBleHBvcnQgbGV0IHhTcHJlYWQgPSAwLjE1XHJcbiAgZXhwb3J0IGxldCBkZXN0cm95T25Db21wbGV0ZSA9IHRydWVcclxuXHJcbiAgbGV0IGNvbXBsZXRlID0gZmFsc2VcclxuXHJcbiAgb25Nb3VudCgoKSA9PiB7XHJcbiAgICBpZiAoIWRlc3Ryb3lPbkNvbXBsZXRlIHx8IGluZmluaXRlIHx8IGl0ZXJhdGlvbkNvdW50ID09IFwiaW5maW5pdGVcIikgcmV0dXJuXHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiBjb21wbGV0ZSA9IHRydWUsIChkdXJhdGlvbiArIGRlbGF5WzFdKSAqIGl0ZXJhdGlvbkNvdW50KVxyXG4gIH0pXHJcblxyXG4gIGZ1bmN0aW9uIHJhbmRvbUJldHdlZW4obWluLCBtYXgpIHtcclxuICAgIHJldHVybiBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldENvbG9yKCkge1xyXG4gICAgaWYgKGNvbG9yQXJyYXkubGVuZ3RoKSByZXR1cm4gY29sb3JBcnJheVtNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoY29sb3JBcnJheS5sZW5ndGggLSAxKSldXHJcbiAgICBlbHNlIHJldHVybiBgaHNsKCR7TWF0aC5yb3VuZChyYW5kb21CZXR3ZWVuKGNvbG9yUmFuZ2VbMF0sIGNvbG9yUmFuZ2VbMV0pKX0sIDc1JSwgNTAlYFxyXG4gIH1cclxuPC9zY3JpcHQ+XHJcblxyXG5cclxuXHJcbnsjaWYgIWNvbXBsZXRlfVxyXG4gIDxkaXYgY2xhc3M9XCJjb25mZXR0aS1ob2xkZXJcIiBjbGFzczpyb3VuZGVkIGNsYXNzOmNvbmUgY2xhc3M6bm8tZ3Jhdml0eT17bm9HcmF2aXR5fT5cclxuICAgIHsjZWFjaCB7IGxlbmd0aDogYW1vdW50IH0gYXMgX31cclxuICAgICAgPGRpdlxyXG4gICAgICAgIGNsYXNzPVwiY29uZmV0dGlcIlxyXG4gICAgICAgIHN0eWxlPVwiXHJcbiAgICAgICAgLS1mYWxsLWRpc3RhbmNlOiB7ZmFsbERpc3RhbmNlfTtcclxuICAgICAgICAtLXNpemU6IHtzaXplfXB4O1xyXG4gICAgICAgIC0tY29sb3I6IHtnZXRDb2xvcigpfTtcclxuICAgICAgICAtLXNrZXc6IHtyYW5kb21CZXR3ZWVuKC00NSwgNDUpfWRlZyx7cmFuZG9tQmV0d2VlbigtNDUsIDQ1KX1kZWc7XHJcbiAgICAgICAgLS1yb3RhdGlvbi14eXo6IHtyYW5kb21CZXR3ZWVuKC0xMCwgMTApfSwge3JhbmRvbUJldHdlZW4oLTEwLCAxMCl9LCB7cmFuZG9tQmV0d2VlbigtMTAsIDEwKX07XHJcbiAgICAgICAgLS1yb3RhdGlvbi1kZWc6IHtyYW5kb21CZXR3ZWVuKDAsIDM2MCl9ZGVnO1xyXG4gICAgICAgIC0tdHJhbnNsYXRlLXktbXVsdGlwbGllcjoge3JhbmRvbUJldHdlZW4oeVswXSwgeVsxXSl9O1xyXG4gICAgICAgIC0tdHJhbnNsYXRlLXgtbXVsdGlwbGllcjoge3JhbmRvbUJldHdlZW4oeFswXSwgeFsxXSl9O1xyXG4gICAgICAgIC0tc2NhbGU6IHswLjEgKiByYW5kb21CZXR3ZWVuKDIsIDEwKX07XHJcbiAgICAgICAgLS10cmFuc2l0aW9uLWR1cmF0aW9uOiB7aW5maW5pdGUgPyBgY2FsYygke2R1cmF0aW9ufW1zICogdmFyKC0tc2NhbGUpKWAgOiBgJHtkdXJhdGlvbn1tc2B9O1xyXG4gICAgICAgIC0tdHJhbnNpdGlvbi1kZWxheToge3JhbmRvbUJldHdlZW4oZGVsYXlbMF0sIGRlbGF5WzFdKX1tcztcclxuICAgICAgICAtLXRyYW5zaXRpb24taXRlcmF0aW9uLWNvdW50OiB7aW5maW5pdGUgPyAnaW5maW5pdGUnIDogaXRlcmF0aW9uQ291bnR9O1xyXG4gICAgICAgIC0teC1zcHJlYWQ6IHsoMSAtIHhTcHJlYWQpfVwiIC8+XHJcbiAgICB7L2VhY2h9XHJcbiAgPC9kaXY+XHJcbnsvaWZ9XHJcblxyXG5cclxuXHJcbjxzdHlsZT5cclxuICAuY29uZmV0dGktaG9sZGVyIHtcclxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICB9XHJcblxyXG4gIEBrZXlmcmFtZXMgcm90YXRlIHtcclxuICAgIDAlIHtcclxuICAgICAgdHJhbnNmb3JtOiBza2V3KHZhcigtLXNrZXcpKSByb3RhdGUzZCh2YXIoLS1mdWxsLXJvdGF0aW9uKSk7XHJcbiAgICB9XHJcblxyXG4gICAgMTAwJSB7XHJcbiAgICAgIHRyYW5zZm9ybTogc2tldyh2YXIoLS1za2V3KSkgcm90YXRlM2QodmFyKC0tcm90YXRpb24teHl6KSwgY2FsYyh2YXIoLS1yb3RhdGlvbi1kZWcpICsgMzYwZGVnKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBAa2V5ZnJhbWVzIHRyYW5zbGF0ZSB7XHJcbiAgICAwJSB7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgOCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoY2FsYyh2YXIoLS10cmFuc2xhdGUteSkgKiAwLjk1KSkgdHJhbnNsYXRlWChjYWxjKHZhcigtLXRyYW5zbGF0ZS14KSAqICh2YXIoLS14LXNwcmVhZCkgKiAwLjkpKSk7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgMTIlIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKHZhcigtLXRyYW5zbGF0ZS15KSkgdHJhbnNsYXRlWChjYWxjKHZhcigtLXRyYW5zbGF0ZS14KSAqICh2YXIoLS14LXNwcmVhZCkgKiAwLjk1KSkpO1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDE2JSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSh2YXIoLS10cmFuc2xhdGUteSkpIHRyYW5zbGF0ZVgoY2FsYyh2YXIoLS10cmFuc2xhdGUteCkgKiB2YXIoLS14LXNwcmVhZCkpKTtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICAxMDAlIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKGNhbGModmFyKC0tdHJhbnNsYXRlLXkpICsgdmFyKC0tZmFsbC1kaXN0YW5jZSkpKSB0cmFuc2xhdGVYKHZhcigtLXRyYW5zbGF0ZS14KSk7XHJcbiAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBAa2V5ZnJhbWVzIG5vLWdyYXZpdHktdHJhbnNsYXRlIHtcclxuICAgIDAlIHtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICAxMDAlIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKHZhcigtLXRyYW5zbGF0ZS15KSkgdHJhbnNsYXRlWCh2YXIoLS10cmFuc2xhdGUteCkpO1xyXG4gICAgICBvcGFjaXR5OiAwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLmNvbmZldHRpIHtcclxuICAgIC0tdHJhbnNsYXRlLXk6IGNhbGMoLTIwMHB4ICogdmFyKC0tdHJhbnNsYXRlLXktbXVsdGlwbGllcikpO1xyXG4gICAgLS10cmFuc2xhdGUteDogY2FsYygyMDBweCAqIHZhcigtLXRyYW5zbGF0ZS14LW11bHRpcGxpZXIpKTtcclxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgIGhlaWdodDogY2FsYyh2YXIoLS1zaXplKSAqIHZhcigtLXNjYWxlKSk7XHJcbiAgICB3aWR0aDogY2FsYyh2YXIoLS1zaXplKSAqIHZhcigtLXNjYWxlKSk7XHJcbiAgICBhbmltYXRpb246IHRyYW5zbGF0ZSB2YXIoLS10cmFuc2l0aW9uLWR1cmF0aW9uKSB2YXIoLS10cmFuc2l0aW9uLWRlbGF5KSB2YXIoLS10cmFuc2l0aW9uLWl0ZXJhdGlvbi1jb3VudCkgbGluZWFyO1xyXG4gICAgb3BhY2l0eTogMDtcclxuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gIH1cclxuXHJcbiAgLmNvbmZldHRpOjpiZWZvcmUge1xyXG4gICAgLS1mdWxsLXJvdGF0aW9uOiB2YXIoLS1yb3RhdGlvbi14eXopLCB2YXIoLS1yb3RhdGlvbi1kZWcpO1xyXG4gICAgY29udGVudDogJyc7XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxuICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG4gICAgYmFja2dyb3VuZDogdmFyKC0tY29sb3IpO1xyXG4gICAgYmFja2dyb3VuZC1zaXplOiBjb250YWluO1xyXG4gICAgdHJhbnNmb3JtOiBza2V3KHZhcigtLXNrZXcpKSByb3RhdGUzZCh2YXIoLS1mdWxsLXJvdGF0aW9uKSk7XHJcbiAgICBhbmltYXRpb246IHJvdGF0ZSB2YXIoLS10cmFuc2l0aW9uLWR1cmF0aW9uKSB2YXIoLS10cmFuc2l0aW9uLWRlbGF5KSB2YXIoLS10cmFuc2l0aW9uLWl0ZXJhdGlvbi1jb3VudCkgbGluZWFyO1xyXG4gIH1cclxuXHJcbiAgLnJvdW5kZWQgLmNvbmZldHRpOjpiZWZvcmUge1xyXG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gIH1cclxuXHJcbiAgLmNvbmUgLmNvbmZldHRpIHtcclxuICAgIC0tdHJhbnNsYXRlLXg6IGNhbGMoMjAwcHggKiB2YXIoLS10cmFuc2xhdGUteS1tdWx0aXBsaWVyKSAqIHZhcigtLXRyYW5zbGF0ZS14LW11bHRpcGxpZXIpKTtcclxuICB9XHJcblxyXG4gIC5uby1ncmF2aXR5IC5jb25mZXR0aSB7XHJcbiAgICBhbmltYXRpb24tbmFtZTogbm8tZ3Jhdml0eS10cmFuc2xhdGU7XHJcbiAgICBhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOiBlYXNlLW91dDtcclxuICB9XHJcblxyXG4gIEBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbikge1xyXG4gICAgLmNvbmZldHRpLFxyXG4gICAgLmNvbmZldHRpOjpiZWZvcmUge1xyXG4gICAgICBhbmltYXRpb246IG5vbmU7XHJcbiAgICB9XHJcbiAgfVxyXG48L3N0eWxlPlxyXG4iLCI8c2NyaXB0IGNvbnRleHQ9XCJtb2R1bGVcIj5cbiAgZXhwb3J0IGNvbnN0IG1hcHMgPSB7XG4gICAgJ3NtYWxsJzogW1xuICAgICAgJ1NGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGRkYnLFxuICAgICAgJ0ZGSEZGRkZGRkYnLFxuICAgICAgJ0hGRkZGSEZGRkYnLFxuICAgICAgJ0ZGSEZGRkhGRkYnLFxuICAgICAgJ0hGRkZGSEZGRkYnLFxuICAgICAgJ0ZGSEZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkdGRkZGRkYnXG4gICAgXSxcbiAgICAnMTZ4MTYnOiBbXG4gICAgICAnSEhGRkZGRkZGRkZGRkZISCcsXG4gICAgICAnSEZGRkZGRkZGRkZGRkZGSCcsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGSEhIRkZGRkhISEZGRicsXG4gICAgICAnRkZGSEhIRkZGRkhISEZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZHRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGSEhIRkZGRkhISEZGRicsXG4gICAgICAnRkZGSEhISEhISEhISEZGRicsXG4gICAgICAnRkZGRkhISEhISEhIRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZTRkZGRkZGSCcsXG4gICAgICAnSEhGRkZGRkZGRkZGRkZISCdcbiAgICBdLFxuICAgICczMngzMic6IFtcbiAgICAgICdISEhISEhGRkZGRkZGRkZGRkZGRkZGRkhISEhISEhISCcsXG4gICAgICAnSEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEhISEgnLFxuICAgICAgJ0ZGRkZTRkZGSEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZIJyxcbiAgICAgICdGRkZGRkZGRkZIRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hIRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEZGRkZGRkZGRkhISEhISEhIRkZGRkZGRkZGRicsXG4gICAgICAnSEhISEhISEhISEhISEhISEhISEhISEhGRkZGRkZGRkYnLFxuICAgICAgJ0hISEhISEhISEhISEhISEhISEhISEhGRkZGRkZGRkZGJyxcbiAgICAgICdISEZGSEhISEhISEhISEhIRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRkZGRkhISEhIRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGRkZGRkZGRkhIRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhIRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhIRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhIRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEgnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEhIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEZGSCcsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZHRkZGRkZGRkhGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkhGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZIRkZIRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEZGRkZGRkZGJyxcbiAgICAgICdISEhISEhIRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEhISEhISEhISEhIRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgIF0sXG4gIH1cbiAgZXhwb3J0IGNvbnN0IGNvbG9ycyA9IHtcbiAgICAnSCc6ICcjMTk3NmQyJyxcbiAgICAnUyc6ICcjZWY5YTlhJyxcbiAgICAnRic6ICcjZTFmNWZlJyxcbiAgICAnRyc6ICcjODFjNzg0JyxcbiAgICAnVCc6ICcjZmZlMGIyJ1xuICB9XG48L3NjcmlwdD4iLCI8c2NyaXB0PlxuICBpbXBvcnQgeyBvbk1vdW50LCB0aWNrIH0gZnJvbSAnc3ZlbHRlJztcbiAgaW1wb3J0IHsgdHdlZW5lZCB9IGZyb20gXCJzdmVsdGUvbW90aW9uXCI7XG4gIGltcG9ydCB7IGN1YmljT3V0IH0gZnJvbSBcInN2ZWx0ZS9lYXNpbmdcIjtcbiAgaW1wb3J0IHsgQ29uZmV0dGkgfSBmcm9tIFwic3ZlbHRlLWNvbmZldHRpXCI7XG4gIGltcG9ydCB7IG1hcHMsIGNvbG9ycyB9IGZyb20gXCIuL2NvbnN0YW50cy5zdmVsdGVcIlxuXG4gIGxldCBjYW52YXM7XG5cbiAgbGV0IHNlbGVjdGVkTWFwO1xuICBsZXQgc2VsZWN0ZWRUZWFjaGVyO1xuICBsZXQgc2VsZWN0ZWRSZXNldDtcblxuICB2YXIgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG4gIHZhciBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICB2YXIgdXBQcmVzc2VkID0gZmFsc2U7XG4gIHZhciBkb3duUHJlc3NlZCA9IGZhbHNlO1xuXG4gIHZhciBtYXBDaGFuZ2VkID0gdHJ1ZTtcblxuICB2YXIgcG9zOyAgLy8gdGhlIHBvc2l0aW9uIHdoZXJlIHRoZSBwbGF5ZXIgaXMgZGlzcGxheWVkXG4gIHZhciByZWFsUG9zOyAgLy8gdGhlIGFjdHVhbCBwb3NpdGlvbiBvZiB0aGUgcGxheWVyIChhbmltYXRpb25zIGRvbid0IGNoYW5nZSB0aGlzKVxuICB2YXIgaGlzdG9yeSA9IFtdOyAgLy8gdGhlIGhpc3Rvcnkgb2YgcGxheWVyIHBvc2l0aW9uc1xuXG4gIHZhciBoYXNJbnRlcmFjdGVkID0gZmFsc2U7ICAvLyBoYXMgdGhlIHJlYWRlciBpbnRlcmFjdGVkIHdpdGggdGhlIGdhbWUgeWV0P1xuICB2YXIgc3RhdHVzTWVzc2FnZSA9ICcnOyAgLy8gZGlzcGxheWVkIHN0YXR1cyBtZXNzYWdlXG4gIHZhciBzdGF0dXNUaW1lciA9IG51bGw7ICAvLyB0aW1lciBpZCBmb3IgY2xlYXJpbmcgb2xkIHRpbWVyXG5cbiAgdmFyIGNvbmZldHRpID0gZmFsc2U7XG5cbiAgdmFyIHBpeGVsUmF0aW87IC8vIGFkanVzdCBnYW1lIHJlc29sdXRpb24gdG8gaGlnaGVyIHJlc29sdXRpb24gZGlzcGxheXNcblxuICBjb25zdCByb2JvdCA9IG5ldyBJbWFnZSgpO1xuICByb2JvdC5zcmMgPSAnLi9pbWFnZXMvcm9ib3QucG5nJztcblxuICBjb25zdCByb2JvdEZsaXBwZWQgPSBuZXcgSW1hZ2UoKTtcbiAgcm9ib3RGbGlwcGVkLnNyYyA9ICcuL2ltYWdlcy9yb2JvdC1mbGlwcGVkLnBuZydcblxuICB2YXIgZmxpcHBlZCA9IGZhbHNlO1xuICB2YXIgaW1hZ2UgPSByb2JvdDtcblxuICBvbk1vdW50KCgpID0+IHtcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBwaXhlbFJhdGlvID0gd2luZG93LmRldmljZVBpeGVsUmF0aW87XG4gICAgY3R4LnNjYWxlKHBpeGVsUmF0aW8sIHBpeGVsUmF0aW8pO1xuXG4gICAgdmFyIHRpbGVTaXplO1xuICAgIHZhciBtYXA7XG4gICAgdmFyIHN0YXJ0O1xuICAgIHZhciBsYXN0UG9zaXRpb247XG4gICAgdmFyIHRlYWNoZXJNYXA7XG5cbiAgICBkcmF3RW52aXJvbm1lbnQoKTtcblxuICAgIGZ1bmN0aW9uIG9uZVN0ZXBSZWFjaChiYXNlTWFzaykge1xuICAgICAgbGV0IHJvd3MgPSBiYXNlTWFzay5sZW5ndGg7XG4gICAgICBsZXQgY29scyA9IGJhc2VNYXNrWzBdLmxlbmd0aDtcblxuICAgICAgbGV0IG9uZVN0ZXBNYXNrID0gbmV3IEFycmF5KHJvd3MpLmZpbGwoZmFsc2UpLm1hcCgoKSA9PiBuZXcgQXJyYXkoY29scykuZmlsbChmYWxzZSkpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb3dzOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjb2xzOyBqKyspIHtcbiAgICAgICAgICB2YXIgcmVzID0gZmFsc2U7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlcyB8PSBiYXNlTWFza1tpXVtqKzFdXG4gICAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaSsxXVtqXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzIHw9IGJhc2VNYXNrW2ldW2otMV1cbiAgICAgICAgICB9IGNhdGNoKGUpIHt9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlcyB8PSBiYXNlTWFza1tpLTFdW2pdXG4gICAgICAgICAgfSBjYXRjaChlKSB7fVxuXG4gICAgICAgICAgb25lU3RlcE1hc2tbaV1bal0gPSByZXNcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gb25lU3RlcE1hc2s7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkVGVhY2hlcihiYXNlTWFwLCBkaXN0YW5jZSkge1xuXG4gICAgICBpZiAoZGlzdGFuY2UgPT0gMCkge1xuICAgICAgICByZXR1cm4gYmFzZU1hcFxuICAgICAgfVxuXG4gICAgICB2YXIgbmV3QmFzZU1hcCA9IG5ldyBBcnJheSgpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbmV3QmFzZU1hcC5wdXNoKG1hcFtpXS5zcGxpdCgnJykpXG4gICAgICB9XG5cbiAgICAgIGxldCBiYXNlRGFuZ2VyTWFzayA9IG5ld0Jhc2VNYXAubWFwKChyb3cpID0+IHtcbiAgICAgICAgcmV0dXJuIHJvdy5tYXAoZWxlbWVudCA9PiBlbGVtZW50ID09ICdIJylcbiAgICAgIH0pXG4gICAgICBsZXQgYmFzZUVtcHR5TWFzayA9IG5ld0Jhc2VNYXAubWFwKChyb3cpID0+IHtcbiAgICAgICAgcmV0dXJuIHJvdy5tYXAoZWxlbWVudCA9PiBlbGVtZW50ID09ICdGJylcbiAgICAgIH0pXG5cbiAgICAgIHZhciBwcmV2aW91c01hc2sgPSBBcnJheS5mcm9tKGJhc2VEYW5nZXJNYXNrKTtcbiAgICAgIHZhciByZWFjaE1hc2tcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlzdGFuY2U7IGkrKykge1xuICAgICAgICByZWFjaE1hc2sgPSBvbmVTdGVwUmVhY2gocHJldmlvdXNNYXNrKTtcbiAgICAgICAgcHJldmlvdXNNYXNrID0gcmVhY2hNYXNrLm1hcCgocm93LCBpKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHJvdy5tYXAoKGVsZW1lbnQsIGopID0+IGVsZW1lbnQgfHwgcHJldmlvdXNNYXNrW2ldW2pdKVxuICAgICAgICB9KVxuICAgICAgfVxuXG4gICAgICB2YXIgbmV3TWFwID0gQXJyYXkuZnJvbShuZXdCYXNlTWFwKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbmV3QmFzZU1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG5ld0Jhc2VNYXBbMF0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBpZiAocmVhY2hNYXNrW2ldW2pdICYmIGJhc2VFbXB0eU1hc2tbaV1bal0pIHtcbiAgICAgICAgICAgIG5ld01hcFtpXVtqXSA9ICdUJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsZXQgdGVhY2hlck1hcCA9IG5ldyBBcnJheSgpO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiYXNlTWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRlYWNoZXJNYXAucHVzaChuZXdNYXBbaV0uam9pbignJykpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGVhY2hlck1hcDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkcmF3RW52aXJvbm1lbnQoKSB7XG4gICAgICBtYXAgPSBtYXBzW3NlbGVjdGVkTWFwXVxuICAgICAgdGlsZVNpemUgPSBjYW52YXMuaGVpZ2h0IC8gbWFwLmxlbmd0aDtcbiAgICAgIHRlYWNoZXJNYXAgPSBhZGRUZWFjaGVyKG1hcCwgc2VsZWN0ZWRUZWFjaGVyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBtYXBbMF0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICBsZXQgc3RhdGUgPSB0ZWFjaGVyTWFwW2ldW2pdO1xuXG4gICAgICAgICAgaWYgKHN0YXRlID09ICdTJykge1xuICAgICAgICAgICAgc3RhcnQgPSBbaiwgaV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGV0IHggPSBqICogdGlsZVNpemU7XG4gICAgICAgICAgbGV0IHkgPSBpICogdGlsZVNpemU7XG5cbiAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgY3R4LnJlY3QoeCwgeSwgdGlsZVNpemUgKyAxLCB0aWxlU2l6ZSArIDEpO1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvcnNbc3RhdGVdO1xuICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgY3R4LmNsb3NlUGF0aCgpOyBcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGZ1bmN0aW9uIGRyYXdBZ2VudCgpIHtcbiAgICAgIGlmIChmbGlwcGVkKSB7XG4gICAgICAgIGltYWdlID0gcm9ib3RGbGlwcGVkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW1hZ2UgPSByb2JvdDtcbiAgICAgIH1cblxuICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgJHBvc1swXSAqIHRpbGVTaXplLCAkcG9zWzFdICogdGlsZVNpemUsIHRpbGVTaXplLCB0aWxlU2l6ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbW92ZUFnZW50KG5ld1Bvcykge1xuICAgICAgcG9zLnNldChuZXdQb3MpO1xuICAgICAgcmVhbFBvcyA9IG5ld1BvcztcbiAgICAgIGhpc3RvcnkucHVzaChyZWFsUG9zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZXNldEFnZW50KCkge1xuICAgICAgaGlzdG9yeSA9IFtdO1xuICAgICAgbW92ZUFnZW50KHN0YXJ0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkcmF3KCkge1xuXG4gICAgICBpZiAobGVmdFByZXNzZWQgfHwgcmlnaHRQcmVzc2VkIHx8IHVwUHJlc3NlZCB8fCBkb3duUHJlc3NlZCkge1xuICAgICAgICBoYXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICBkcmF3RW52aXJvbm1lbnQoKTtcblxuICAgICAgaWYgKG1hcENoYW5nZWQpIHtcbiAgICAgICAgcG9zID0gdHdlZW5lZChzdGFydCwge1xuICAgICAgICAgIGR1cmF0aW9uOiAxNTAsXG4gICAgICAgICAgZWFzaW5nOiBjdWJpY091dCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlc2V0QWdlbnQoKTtcbiAgICAgIH1cblxuICAgICAgZHJhd0FnZW50KCk7IFxuXG4gICAgICAvLyBzbGlwIHdpdGggMjAlIHByb2JhYmlsaXR5XG4gICAgICBjb25zdCBybmQgPSBNYXRoLnJhbmRvbSgpXG4gICAgICBpZiAobGVmdFByZXNzZWQgfHwgcmlnaHRQcmVzc2VkKSB7XG4gICAgICAgIGlmIChybmQgPCAwLjEpIHtcbiAgICAgICAgICBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHVwUHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocm5kIDwgMC4yKSB7XG4gICAgICAgICAgbGVmdFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHVwUHJlc3NlZCB8fCBkb3duUHJlc3NlZCkge1xuICAgICAgICBpZiAocm5kIDwgMC4xKSB7XG4gICAgICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgZG93blByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBsZWZ0UHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocm5kIDwgMC4yKSB7XG4gICAgICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgZG93blByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICByaWdodFByZXNzZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAocm5kIDwgMC4yICYmICh1cFByZXNzZWQgfHwgZG93blByZXNzZWQgfHwgbGVmdFByZXNzZWQgfHwgcmlnaHRQcmVzc2VkKSkge1xuICAgICAgICBzaG93TWVzc2FnZSgnWW91IGp1c3Qgc2xpcHBlZC4nKVxuICAgICAgfVxuXG4gICAgICBpZiAobGVmdFByZXNzZWQpIGZsaXBwZWQgPSB0cnVlO1xuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCkgZmxpcHBlZCA9IGZhbHNlO1xuXG4gICAgICAvLyByZW1lbWJlciBsYXN0IHBvc2l0aW9uXG4gICAgICBsYXN0UG9zaXRpb24gPSBBcnJheS5mcm9tKHJlYWxQb3MpO1xuICAgICAgbGV0IFt4LCB5XSA9IEFycmF5LmZyb20obGFzdFBvc2l0aW9uKTtcblxuICAgICAgLy8gY2hhbmdlIHBsYXllciBwb3NcbiAgICAgIGlmIChyaWdodFByZXNzZWQpIHtcbiAgICAgICAgaWYgKHggPCBtYXBbMF0ubGVuZ3RoIC0gMSkgeCArPSAxXG4gICAgICB9IGVsc2UgaWYgKGxlZnRQcmVzc2VkKSB7XG4gICAgICAgIGlmICh4ID4gMCkgeCAtPSAxXG4gICAgICB9IGVsc2UgaWYgKHVwUHJlc3NlZCkge1xuICAgICAgICBpZiAoeSA+IDApIHkgLT0gMVxuICAgICAgfSBlbHNlIGlmIChkb3duUHJlc3NlZCkge1xuICAgICAgICBpZiAoeSA8IG1hcC5sZW5ndGggLSAxKSB5ICs9IDFcbiAgICAgIH1cblxuICAgICAgLy8gbW92ZSBpZiBidXR0b24gaXMgcHJlc3NlZFxuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCB8fCBsZWZ0UHJlc3NlZCB8fCBkb3duUHJlc3NlZCB8fCB1cFByZXNzZWQpIHtcbiAgICAgICAgbW92ZUFnZW50KFt4LCB5XSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIGNoZWNrIGZvciB3aW4gYW5kIGZhaWxcbiAgICAgIGlmIChtYXBbeV1beF0gPT0gJ0cnKSB7XG4gICAgICAgIGNvbmZldHRpID0gdHJ1ZTtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7Y29uZmV0dGkgPSBmYWxzZX0sIDMwMDApO1xuICAgICAgICBzaG93TWVzc2FnZSgnWW91IHdvbiEnKTtcbiAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobWFwW3ldW3hdID09ICdIJykge1xuICAgICAgICBzaG93TWVzc2FnZSgnWW91IGZhaWxlZC4nKTtcbiAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgfVxuXG4gICAgICAvLyBUZWFjaGVyIGludGVydmVudGlvbnNcbiAgICAgIGVsc2UgaWYgKHRlYWNoZXJNYXBbeV1beF0gPT0gJ1QnKSB7XG4gICAgICAgIGlmIChzZWxlY3RlZFJlc2V0ID09ICdIUicpIHtcbiAgICAgICAgICAvLyBoYXJkIHJlc2V0XG4gICAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkUmVzZXQgPT0gJ0I0Jykge1xuICAgICAgICAgIC8vIGJhY2sgNCByZXNldFxuICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNCAmJiBoaXN0b3J5Lmxlbmd0aCA+IDE7IGkrKykge1xuICAgICAgICAgICAgaGlzdG9yeS5wb3AoKVxuICAgICAgICAgIH1cbiAgICAgICAgICBtb3ZlQWdlbnQoaGlzdG9yeVtoaXN0b3J5Lmxlbmd0aC0xXSk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRSZXNldCA9PSAnU1InKSB7XG4gICAgICAgICAgLy8gc29mdCByZXNldFxuICAgICAgICAgIG1vdmVBZ2VudChsYXN0UG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHNob3dNZXNzYWdlKCdUaGUgdGVhY2hlciBzZXQgeW91IGJhY2suJyk7XG4gICAgICB9XG5cbiAgICAgIG1hcENoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG4gICAgICBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgdXBQcmVzc2VkID0gZmFsc2U7XG4gICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHJhdyk7XG4gICAgfVxuXG4gICAgZHJhdygpO1xuICB9KTtcblxuICBmdW5jdGlvbiBtYXBDaGFuZ2VkSGFuZGxlcigpIHtcbiAgICBtYXBDaGFuZ2VkID0gdHJ1ZTtcbiAgfVxuICBcbiAgZnVuY3Rpb24ga2V5RG93bkhhbmRsZXIoZSkge1xuXHRcdGlmKGUua2V5Q29kZSA9PSAzOSB8fCBlLmtleSA9PSAnZCcpIHtcblx0XHRcdHJpZ2h0UHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHRcdGVsc2UgaWYoZS5rZXlDb2RlID09IDM3IHx8IGUua2V5ID09ICdhJykge1xuXHRcdFx0bGVmdFByZXNzZWQgPSB0cnVlO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdH1cbiAgICBlbHNlIGlmKGUua2V5Q29kZSA9PSAzOCB8fCBlLmtleSA9PSAndycpIHtcbiAgICAgIHVwUHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIGVsc2UgaWYoZS5rZXlDb2RlID09IDQwIHx8IGUua2V5ID09ICdzJykge1xuICAgICAgZG93blByZXNzZWQgPSB0cnVlO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblx0fVxuXG4gIGZ1bmN0aW9uIHNob3dNZXNzYWdlKG1zZykge1xuICAgIC8vIHNob3cgYSBzdGF0dXMgbWVzc2FnZSBiZWxvdyB0aGUgbWFwXG4gICAgc3RhdHVzTWVzc2FnZSA9ICcnOyAgLy8gY2xlYXIgc3RhdHVzIG1lc3NhZ2UgYW5kIGNzcyB0cmFuc2l0aW9uXG4gICAgY2xlYXJUaW1lb3V0KHN0YXR1c1RpbWVyKTsgIC8vIHJlc2V0IHByZXZpb3VzIHN0YXR1cyBtZXNzYWdlIGNsZWFyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7c3RhdHVzTWVzc2FnZSA9IG1zZ30sIDEpICAvLyB3YWl0IGZvciBzdGF0dXNNZXNzYWdlIHRvIGJlIHJlc2V0XG4gICAgc3RhdHVzVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtzdGF0dXNNZXNzYWdlID0gJyd9LCAyMDAwKSAgLy8gY2xlYXIgc3RhdHVzIG1lc3NhZ2UgYWZ0ZXIgc29tZSB0aW1lXG4gIH1cbjwvc2NyaXB0PlxuXG48c3ZlbHRlOndpbmRvdyBvbjprZXlkb3duPXtrZXlEb3duSGFuZGxlcn0vPlxuXG48ZGl2IGNsYXNzPVwiZ2FtZVwiPlxuXG4gIDxkaXYgY2xhc3M9XCJtYXBcIj5cbiAgICA8Y2FudmFzXG4gICAgICBiaW5kOnRoaXM9e2NhbnZhc31cbiAgICAgIHdpZHRoPXs1MDAgKiBwaXhlbFJhdGlvfVxuICAgICAgaGVpZ2h0PXs1MDAgKiBwaXhlbFJhdGlvfVxuICAgICAgc3R5bGU9XCJ3aWR0aDogMzAwcHg7IGhlaWdodDogMzAwcHg7XCJcbiAgICAgIG9uOmNsaWNrPXsoKSA9PiBzaG93TWVzc2FnZSgnUHJlc3MgdGhlIGFycm93IGtleXMgdG8gbW92ZS4uLicpfVxuICAgID48L2NhbnZhcz5cblxuICAgIDxpbWcgd2lkdGg9MzAwIGFsdD1cIkxlZ2VuZCBmb3IgdGhlIGFib3ZlIG1pbmktZ2FtZVwiIHNyYz1cIi4vaW1hZ2VzL21hcF9sZWdlbmRfc3RhY2tlZC5zdmdcIj5cblxuICAgIHsjaWYgY29uZmV0dGl9XG4gICAgICA8Q29uZmV0dGkgY29uZSBkZWxheT17WzAsIDIwMF19IGFtb3VudD01MCB4PXtbLTAuNywgMC43XX0geT17WzAuNSwgMS41XX0gLz5cbiAgICB7L2lmfVxuICA8L2Rpdj5cblxuICA8ZGl2IGNsYXNzPVwiY29udHJvbHNcIj5cblxuICAgIHsjaWYgaGFzSW50ZXJhY3RlZH1cbiAgICAgIDxwIGNsYXNzPVwic3RhdHVzXCIgc3R5bGU9XCJ0cmFuc2l0aW9uOiBjb2xvciB7c3RhdHVzTWVzc2FnZSA/IDIgOiAwfXM7IHRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOiBlYXNlLWluOyBjb2xvcjoge3N0YXR1c01lc3NhZ2UgPyAnd2hpdGUnIDogJ2JsYWNrJ307XCI+e3N0YXR1c01lc3NhZ2V9PC9wPlxuICAgIHs6ZWxzZX1cbiAgICAgIDxwIGNsYXNzPVwic3RhdHVzXCI+UHJlc3MgdGhlIGFycm93IGtleXMgdG8gbW92ZS4uLjwvcD5cbiAgICB7L2lmfVxuXG4gICAgPGRpdiBjbGFzcz1cIm1lbnVcIj5cbiAgICAgIDxzZWxlY3QgYmluZDp2YWx1ZT17c2VsZWN0ZWRNYXB9IG9uOmNoYW5nZT17bWFwQ2hhbmdlZEhhbmRsZXJ9IG5hbWU9XCJtYXBcIiBpZD1cIm1hcFwiPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwic21hbGxcIj5Gcm96ZW4gTGFrZTwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTZ4MTZcIj5Gcm96ZW4gU21pbGV5PC9vcHRpb24+XG4gICAgICAgIDxvcHRpb24gdmFsdWU9XCIzMngzMlwiPkxhcmdlIExha2U8L29wdGlvbj5cbiAgICAgIDwvc2VsZWN0PlxuXG4gICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkVGVhY2hlcn0gbmFtZT1cInRlYWNoZXJcIiBpZD1cInRlYWNoZXJcIj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjBcIj5ObyBUZWFjaGVyPC9vcHRpb24+XG4gICAgICAgIDxvcHRpb24gdmFsdWU9XCIxXCI+RGlzdGFuY2UgMTwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPkRpc3RhbmNlIDI8L29wdGlvbj5cbiAgICAgIDwvc2VsZWN0PlxuXG4gICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkUmVzZXR9IG5hbWU9XCJyZXNldFwiIGlkPVwicmVzZXRcIiBkaXNhYmxlZD17c2VsZWN0ZWRUZWFjaGVyPT0wfT5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlNSXCI+U29mdCBSZXNldDwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiQjRcIj5CYWNrIDQ8L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIkhSXCI+SGFyZCBSZXNldDwvb3B0aW9uPlxuICAgICAgPC9zZWxlY3Q+XG4gICAgPC9kaXY+XG5cbiAgICA8ZGl2IGNsYXNzPVwia2V5Ym9hcmRcIj5cbiAgICAgIDxkaXY+PC9kaXY+XG4gICAgICA8YnV0dG9uIG9uOmNsaWNrPXsoKSA9PiB1cFByZXNzZWQgPSB0cnVlfSBjbGFzcz1cImtleVwiPiYjODU5Mzs8L2J1dHRvbj5cbiAgICAgIDxkaXY+PC9kaXY+XG4gICAgICA8YnV0dG9uIG9uOmNsaWNrPXsoKSA9PiBsZWZ0UHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTkyOzwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBvbjpjbGljaz17KCkgPT4gZG93blByZXNzZWQgPSB0cnVlfSBjbGFzcz1cImtleVwiPiYjODU5NTs8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IHJpZ2h0UHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTk0OzwvYnV0dG9uPlxuICAgIDwvZGl2PlxuXG4gIDwvZGl2PlxuXG48L2Rpdj5cblxuPHN0eWxlPlxuXHRjYW52YXMge1xuICAgIHBhZGRpbmc6IDFlbVxuICB9XG5cbiAgLmdhbWUge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIHBhZGRpbmctYm90dG9tOiAxLjVlbTtcbiAgfVxuXG4gIC5jb250cm9scyB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIH1cblxuICAuc3RhdHVzIHtcbiAgICBoZWlnaHQ6IDFlbTtcbiAgICB3aWR0aDogMTZlbTtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgdHJhbnNpdGlvbjogY29sb3IgMXM7XG4gICAgcGFkZGluZy10b3A6IDFlbTtcbiAgfVxuXG4gIC5tYXAge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLm1lbnUge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICB9XG5cbiAgLmtleSB7XG5cdFx0YmFja2dyb3VuZC1jb2xvcjogI2VlZTtcblx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0cGFkZGluZzogMC41ZW0gMC41ZW07XG5cdFx0Ym9yZGVyLXRvcDogNXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTtcblx0XHRib3JkZXItbGVmdDogNXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTtcblx0XHRib3JkZXItcmlnaHQ6IDVweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMik7XG5cdFx0Ym9yZGVyLWJvdHRvbTogNXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4yKTtcblx0XHRjb2xvcjogIzU1NTtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgd2lkdGg6IDRlbTtcbiAgICBoZWlnaHQ6IDRlbTtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG5cdH1cblxuICBAbWVkaWEgKG1pbi13aWR0aDogNzY4cHgpIHtcbiAgICAuZ2FtZSB7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIH1cbiAgICAuY29udHJvbHMge1xuICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG4gICAgLm1lbnUge1xuICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG4gICAgLmtleSB7XG4gICAgICB3aWR0aDogM2VtO1xuICAgICAgaGVpZ2h0OiAzZW07XG4gICAgfVxuICB9XG5cbiAgLm1lbnUgc2VsZWN0IHtcbiAgICBtYXJnaW46IDAuNWVtO1xuICB9XG5cbiAgLmtleWJvYXJkIHtcbiAgICBkaXNwbGF5OiBncmlkO1xuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogYXV0byBhdXRvIGF1dG87XG4gICAgZ3JpZC1nYXA6IDAuNWVtO1xuICAgIHBhZGRpbmc6IDFlbTtcbiAgfVxuXG4gIC5rZXk6YWN0aXZlIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGRkO1xuICB9XG48L3N0eWxlPlxuIiwiLy8gSG90IHJlbG9hZGluZ1xuaW1wb3J0ICogYXMgX3VudXNlZCBmcm9tIFwicmF3LWxvYWRlciEuL2luZGV4LmVqc1wiO1xuLy8gVE9ETzogZGlzYWJsZSBiZWZvcmUgcHVibGlzaGluZ1xuXG5pbXBvcnQgVHJhamVjdG9yaWVzIGZyb20gXCIuL2RpYWdyYW1zL3RyYWplY3Rvcmllcy5zdmVsdGVcIjtcbmltcG9ydCBCYWNrIGZyb20gXCIuL2RpYWdyYW1zL2JhY2suc3ZlbHRlXCJcbmltcG9ydCBJbmNyZW1lbnRhbCBmcm9tIFwiLi9kaWFncmFtcy9pbmNyZW1lbnRhbC5zdmVsdGVcIlxuaW1wb3J0IEdyaWQgZnJvbSBcIi4vZGlhZ3JhbXMvZ3JpZC5zdmVsdGVcIlxuXG4vLyBsYXppbHkgaW5pdGlhbGl6ZSBhbnkgZGlhZ3JhbSBiZWxvdyB0aGUgZm9sZC4gRS5HOlxuXG5jb25zdCB0cmFqZWN0b3JpZXNUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRyYWplY3Rvcmllcy12aXN1YWxpemF0aW9uXCIpO1xubGV0IHRyYWplY3RvcmllcztcbnRyYWplY3Rvcmllc1RhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSB0cmFqZWN0b3JpZXNUYWcucXVlcnlTZWxlY3RvcihcIiN0cmFqZWN0b3JpZXMtdmlzdWFsaXphdGlvbi10YXJnZXRcIik7XG5cdHRyYWplY3RvcmllcyA9IG5ldyBUcmFqZWN0b3JpZXMoeyB0YXJnZXQgfSk7XG59KTtcblxuY29uc3QgYmFja1RhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFjay12aXN1YWxpemF0aW9uXCIpO1xubGV0IGJhY2s7XG5iYWNrVGFnLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XG5cdGNvbnN0IHRhcmdldCA9IGJhY2tUYWcucXVlcnlTZWxlY3RvcihcIiNiYWNrLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHRiYWNrID0gbmV3IEJhY2soeyB0YXJnZXQgfSk7XG59KTtcblxuY29uc3QgaW5jcmVtZW50YWxUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluY3JlbWVudGFsLXZpc3VhbGl6YXRpb25cIik7XG5sZXQgaW5jcmVtZW50YWw7XG5pbmNyZW1lbnRhbFRhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSBpbmNyZW1lbnRhbFRhZy5xdWVyeVNlbGVjdG9yKFwiI2luY3JlbWVudGFsLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHRpbmNyZW1lbnRhbCA9IG5ldyBJbmNyZW1lbnRhbCh7IHRhcmdldCB9KTtcbn0pO1xuXG5jb25zdCBncmlkVGFnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJncmlkLXZpc3VhbGl6YXRpb25cIik7XG5sZXQgZ3JpZDtcbmdyaWRUYWcuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5XCIsICgpID0+IHtcblx0Y29uc3QgdGFyZ2V0ID0gZ3JpZFRhZy5xdWVyeVNlbGVjdG9yKFwiI2dyaWQtdmlzdWFsaXphdGlvbi10YXJnZXRcIik7XG5cdGdyaWQgPSBuZXcgR3JpZCh7IHRhcmdldCB9KTtcbn0pOyJdLCJzb3VyY2VSb290IjoiIn0=