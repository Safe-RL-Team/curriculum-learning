!function(e){var t={};function F(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,F),r.l=!0,r.exports}F.m=e,F.c=t,F.d=function(e,t,n){F.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},F.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},F.t=function(e,t){if(1&t&&(e=F(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(F.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)F.d(n,r,function(t){return e[t]}.bind(null,r));return n},F.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return F.d(t,"a",t),t},F.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},F.p="",F(F.s=0)}([function(e,t,F){"use strict";F.r(t);function n(){}const r=e=>e;function o(e,t){for(const F in t)e[F]=t[F];return e}function i(e){return e()}function a(){return Object.create(null)}function s(e){e.forEach(i)}function c(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let u;function f(e,t){return u||(u=document.createElement("a")),u.href=t,e===u.href}function d(e){return 0===Object.keys(e).length}function p(e,...t){if(null==e)return n;const F=e.subscribe(...t);return F.unsubscribe?()=>F.unsubscribe():F}const m="undefined"!=typeof window;let v=m?()=>window.performance.now():()=>Date.now(),H=m?e=>requestAnimationFrame(e):n;const h=new Set;function g(e){h.forEach(t=>{t.c(e)||(h.delete(t),t.f())}),0!==h.size&&H(g)}function y(e){let t;return 0===h.size&&H(g),{promise:new Promise(F=>{h.add(t={c:e,f:F})}),abort(){h.delete(t)}}}let x=!1;function b(e,t){e.appendChild(t)}function w(e,t,F){const n=_(e);if(!n.getElementById(t)){const e=S("style");e.id=t,e.textContent=F,$(n,e)}}function _(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e,t){b(e.head||e,t)}function k(e,t,F){e.insertBefore(t,F||null)}function C(e){e.parentNode.removeChild(e)}function S(e){return document.createElement(e)}function z(e){return document.createTextNode(e)}function E(){return z(" ")}function A(e,t,F,n){return e.addEventListener(t,F,n),()=>e.removeEventListener(t,F,n)}function j(e,t,F){null==F?e.removeAttribute(t):e.getAttribute(t)!==F&&e.setAttribute(t,F)}function T(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function O(e,t,F,n){null===F?e.style.removeProperty(t):e.style.setProperty(t,F,n?"important":"")}function M(e,t){for(let F=0;F<e.options.length;F+=1){const n=e.options[F];if(n.__value===t)return void(n.selected=!0)}e.selectedIndex=-1}function P(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function R(e,t,F){e.classList[F?"add":"remove"](t)}new Map;let D;function I(e){D=e}function L(){if(!D)throw new Error("Function called outside component initialization");return D}function q(e){L().$$.on_mount.push(e)}const B=[],G=[],Y=[],N=[],X=Promise.resolve();let J=!1;function K(){J||(J=!0,X.then(W))}function Q(e){Y.push(e)}const U=new Set;let V=0;function W(){const e=D;do{for(;V<B.length;){const e=B[V];V++,I(e),Z(e.$$)}for(I(null),B.length=0,V=0;G.length;)G.pop()();for(let e=0;e<Y.length;e+=1){const t=Y[e];U.has(t)||(U.add(t),t())}Y.length=0}while(B.length);for(;N.length;)N.pop()();J=!1,U.clear(),I(e)}function Z(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Q)}}const ee=new Set;let te;function Fe(){te={r:0,c:[],p:te}}function ne(){te.r||s(te.c),te=te.p}function re(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function oe(e,t,F,n){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.c.push(()=>{ee.delete(e),n&&(F&&e.d(1),n())}),e.o(t)}else n&&n()}const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let ae;function se(e,t,F,n){const{fragment:r,on_mount:o,on_destroy:a,after_update:l}=e.$$;r&&r.m(t,F),n||Q(()=>{const t=o.map(i).filter(c);a?a.push(...t):s(t),e.$$.on_mount=[]}),l.forEach(Q)}function ce(e,t){const F=e.$$;null!==F.fragment&&(s(F.on_destroy),F.fragment&&F.fragment.d(t),F.on_destroy=F.fragment=null,F.ctx=[])}function le(e,t,F,r,o,i,c,l=[-1]){const u=D;I(e);const f=e.$$={fragment:null,ctx:null,props:i,update:n,not_equal:o,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:a(),dirty:l,skip_bound:!1,root:t.target||u.$$.root};c&&c(f.root);let d=!1;if(f.ctx=F?F(e,t.props||{},(t,F,...n)=>{const r=n.length?n[0]:F;return f.ctx&&o(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),d&&function(e,t){-1===e.$$.dirty[0]&&(B.push(e),K(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),F}):[],f.update(),d=!0,s(f.before_update),f.fragment=!!r&&r(f.ctx),t.target){if(t.hydrate){x=!0;const e=(p=t.target,Array.from(p.childNodes));f.fragment&&f.fragment.l(e),e.forEach(C)}else f.fragment&&f.fragment.c();t.intro&&re(e.$$.fragment),se(e,t.target,t.anchor,t.customElement),x=!1,W()}var p;I(u)}"function"==typeof HTMLElement&&(ae=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(i).filter(c);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,F){this[e]=F}disconnectedCallback(){s(this.$$.on_disconnect)}$destroy(){ce(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!d(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ue{$destroy(){ce(this,1),this.$destroy=n}$on(e,t){const F=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return F.push(t),()=>{const e=F.indexOf(t);-1!==e&&F.splice(e,1)}}$set(e){this.$$set&&!d(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function fe(e){let t,F,r,o,i,a,s,c,l,u,d,p,m,v,H,h,g=e[0]+1+"";return{c(){t=S("div"),F=S("img"),o=E(),i=S("div"),a=S("p"),s=z("Trajectory after curriculum step "),c=z(g),l=E(),u=S("input"),d=E(),p=S("p"),m=z("Move the slider to change the step!"),f(F.src,r="images/trajectories"+e[0]+".svg")||j(F,"src",r),j(F,"alt","Interactive plot displaying the trajectories of the RL agent on the map"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","0"),j(u,"max",de),u.value="0",j(p,"style",v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(t,"display","flex"),O(t,"flex-direction","column"),O(t,"align-items","center")},m(n,r){k(n,t,r),b(t,F),b(t,o),b(t,i),b(i,a),b(a,s),b(a,c),b(i,l),b(i,u),b(i,d),b(i,p),b(p,m),H||(h=A(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!f(F.src,r="images/trajectories"+e[0]+".svg")&&j(F,"src",r),1&t&&g!==(g=e[0]+1+"")&&T(c,g),2&t&&v!==(v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",v)},i:n,o:n,d(e){e&&C(t),H=!1,h()}}}const de=5;function pe(e,t,F){let n=0,r=!1;return[n,r,function(e){r||F(1,r=!0),F(0,n=parseInt(e.target.value))}]}var me=class extends ue{constructor(e){super(),le(this,e,pe,fe,l,{})}};function ve(e){let t,F,r,o,i,a,s,c,l,u,d,p,m,v,H,h;return{c(){t=S("div"),F=S("img"),o=E(),i=S("div"),a=S("p"),s=z("x = "),c=z(e[0]),l=E(),u=S("input"),d=E(),p=S("p"),m=z("Move the slider to change x!"),f(F.src,r="images/16x16_back"+e[0]+"_successes.svg")||j(F,"src",r),j(F,"alt","Interactive plot displaying the success rate of the back curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","1"),j(u,"max",He),u.value="0",j(p,"style",v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(t,"display","flex"),O(t,"flex-direction","column"),O(t,"align-items","center")},m(n,r){k(n,t,r),b(t,F),b(t,o),b(t,i),b(i,a),b(a,s),b(a,c),b(i,l),b(i,u),b(i,d),b(i,p),b(p,m),H||(h=A(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!f(F.src,r="images/16x16_back"+e[0]+"_successes.svg")&&j(F,"src",r),1&t&&T(c,e[0]),2&t&&v!==(v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",v)},i:n,o:n,d(e){e&&C(t),H=!1,h()}}}const He=9;function he(e,t,F){let n=1,r=!1;return[n,r,function(e){r||F(1,r=!0),F(0,n=parseInt(e.target.value))}]}var ge=class extends ue{constructor(e){super(),le(this,e,he,ve,l,{})}};function ye(e){let t,F,r,o,i,a,s,c,l,u,d,p,m,v,H,h;return{c(){t=S("div"),F=S("img"),o=E(),i=S("div"),a=S("p"),s=z("x = "),c=z(e[0]),l=E(),u=S("input"),d=E(),p=S("p"),m=z("Move the slider to change x!"),f(F.src,r="images/16x16_incremental"+e[0]+"_successes.svg")||j(F,"src",r),j(F,"alt","Interactive plot displaying the success rate of the incremental curriculum policy over the number of curriculum steps"),j(F,"height","300px"),j(F,"width","400px"),j(u,"type","range"),j(u,"min","0"),j(u,"max",xe),u.value="0",j(p,"style",v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;")),O(i,"width","300px"),O(i,"margin","auto"),O(i,"text-align","center"),O(t,"display","flex"),O(t,"flex-direction","column"),O(t,"align-items","center")},m(n,r){k(n,t,r),b(t,F),b(t,o),b(t,i),b(i,a),b(a,s),b(a,c),b(i,l),b(i,u),b(i,d),b(i,p),b(p,m),H||(h=A(u,"input",e[2]),H=!0)},p(e,[t]){1&t&&!f(F.src,r="images/16x16_incremental"+e[0]+"_successes.svg")&&j(F,"src",r),1&t&&T(c,e[0]),2&t&&v!==(v="height: 1em; transition: 1s opacity; "+(e[1]&&"opacity: 0;"))&&j(p,"style",v)},i:n,o:n,d(e){e&&C(t),H=!1,h()}}}const xe=4;function be(e,t,F){let n=0,r=!1;return[n,r,function(e){r||F(1,r=!0),F(0,n=parseInt(e.target.value))}]}var we=class extends ue{constructor(e){super(),le(this,e,be,ye,l,{})}};const _e=[];function $e(e,t=n){let F;const r=new Set;function o(t){if(l(e,t)&&(e=t,F)){const t=!_e.length;for(const t of r)t[1](),_e.push(t,e);if(t){for(let e=0;e<_e.length;e+=2)_e[e][0](_e[e+1]);_e.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,a=n){const s=[i,a];return r.add(s),1===r.size&&(F=t(o)||n),i(e),()=>{r.delete(s),0===r.size&&(F(),F=null)}}}}function ke(e){const t=e-1;return t*t*t+1}function Ce(e){return"[object Date]"===Object.prototype.toString.call(e)}function Se(e,t){if(e===t||e!=e)return()=>e;const F=typeof e;if(F!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const F=t.map((t,F)=>Se(e[F],t));return e=>F.map(t=>t(e))}if("object"===F){if(!e||!t)throw new Error("Object cannot be null");if(Ce(e)&&Ce(t)){e=e.getTime();const F=(t=t.getTime())-e;return t=>new Date(e+t*F)}const F=Object.keys(t),n={};return F.forEach(F=>{n[F]=Se(e[F],t[F])}),e=>{const t={};return F.forEach(F=>{t[F]=n[F](e)}),t}}if("number"===F){const F=t-e;return t=>e+t*F}throw new Error(`Cannot interpolate ${F} values`)}function ze(e){w(e,"svelte-io58ff",".confetti-holder.svelte-io58ff.svelte-io58ff{position:relative}@keyframes svelte-io58ff-rotate{0%{transform:skew(var(--skew)) rotate3d(var(--full-rotation))}100%{transform:skew(var(--skew)) rotate3d(var(--rotation-xyz), calc(var(--rotation-deg) + 360deg))}}@keyframes svelte-io58ff-translate{0%{opacity:1}8%{transform:translateY(calc(var(--translate-y) * 0.95)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.9)));opacity:1}12%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * (var(--x-spread) * 0.95)));opacity:1}16%{transform:translateY(var(--translate-y)) translateX(calc(var(--translate-x) * var(--x-spread)));opacity:1}100%{transform:translateY(calc(var(--translate-y) + var(--fall-distance))) translateX(var(--translate-x));opacity:0}}@keyframes svelte-io58ff-no-gravity-translate{0%{opacity:1}100%{transform:translateY(var(--translate-y)) translateX(var(--translate-x));opacity:0}}.confetti.svelte-io58ff.svelte-io58ff{--translate-y:calc(-200px * var(--translate-y-multiplier));--translate-x:calc(200px * var(--translate-x-multiplier));position:absolute;height:calc(var(--size) * var(--scale));width:calc(var(--size) * var(--scale));animation:svelte-io58ff-translate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear;opacity:0;pointer-events:none}.confetti.svelte-io58ff.svelte-io58ff::before{--full-rotation:var(--rotation-xyz), var(--rotation-deg);content:'';display:block;width:100%;height:100%;background:var(--color);background-size:contain;transform:skew(var(--skew)) rotate3d(var(--full-rotation));animation:svelte-io58ff-rotate var(--transition-duration) var(--transition-delay) var(--transition-iteration-count) linear}.rounded.svelte-io58ff .confetti.svelte-io58ff::before{border-radius:50%}.cone.svelte-io58ff .confetti.svelte-io58ff{--translate-x:calc(200px * var(--translate-y-multiplier) * var(--translate-x-multiplier))}.no-gravity.svelte-io58ff .confetti.svelte-io58ff{animation-name:svelte-io58ff-no-gravity-translate;animation-timing-function:ease-out}@media(prefers-reduced-motion){.confetti.svelte-io58ff.svelte-io58ff,.confetti.svelte-io58ff.svelte-io58ff::before{animation:none}}")}function Ee(e,t,F){const n=e.slice();return n[18]=t[F],n}function Ae(e){let t,F={length:e[6]},n=[];for(let t=0;t<F.length;t+=1)n[t]=je(Ee(e,F,t));return{c(){t=S("div");for(let e=0;e<n.length;e+=1)n[e].c();j(t,"class","confetti-holder svelte-io58ff"),R(t,"rounded",e[9]),R(t,"cone",e[10]),R(t,"no-gravity",e[11])},m(e,F){k(e,t,F);for(let e=0;e<n.length;e+=1)n[e].m(t,null)},p(e,r){if(20991&r){let o;for(F={length:e[6]},o=0;o<F.length;o+=1){const i=Ee(e,F,o);n[o]?n[o].p(i,r):(n[o]=je(i),n[o].c(),n[o].m(t,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=F.length}512&r&&R(t,"rounded",e[9]),1024&r&&R(t,"cone",e[10]),2048&r&&R(t,"no-gravity",e[11])},d(e){e&&C(t),function(e,t){for(let F=0;F<e.length;F+=1)e[F]&&e[F].d(t)}(n,e)}}}function je(e){let t;return{c(){t=S("div"),j(t,"class","confetti svelte-io58ff"),O(t,"--fall-distance",e[8]),O(t,"--size",e[0]+"px"),O(t,"--color",e[14]()),O(t,"--skew",Oe(-45,45)+"deg,"+Oe(-45,45)+"deg"),O(t,"--rotation-xyz",Oe(-10,10)+", "+Oe(-10,10)+", "+Oe(-10,10)),O(t,"--rotation-deg",Oe(0,360)+"deg"),O(t,"--translate-y-multiplier",Oe(e[2][0],e[2][1])),O(t,"--translate-x-multiplier",Oe(e[1][0],e[1][1])),O(t,"--scale",.1*Oe(2,10)),O(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),O(t,"--transition-delay",Oe(e[5][0],e[5][1])+"ms"),O(t,"--transition-iteration-count",e[4]?"infinite":e[7]),O(t,"--x-spread",1-e[12])},m(e,F){k(e,t,F)},p(e,F){256&F&&O(t,"--fall-distance",e[8]),1&F&&O(t,"--size",e[0]+"px"),4&F&&O(t,"--translate-y-multiplier",Oe(e[2][0],e[2][1])),2&F&&O(t,"--translate-x-multiplier",Oe(e[1][0],e[1][1])),24&F&&O(t,"--transition-duration",e[4]?`calc(${e[3]}ms * var(--scale))`:e[3]+"ms"),32&F&&O(t,"--transition-delay",Oe(e[5][0],e[5][1])+"ms"),144&F&&O(t,"--transition-iteration-count",e[4]?"infinite":e[7]),4096&F&&O(t,"--x-spread",1-e[12])},d(e){e&&C(t)}}}function Te(e){let t,F=!e[13]&&Ae(e);return{c(){F&&F.c(),t=z("")},m(e,n){F&&F.m(e,n),k(e,t,n)},p(e,[n]){e[13]?F&&(F.d(1),F=null):F?F.p(e,n):(F=Ae(e),F.c(),F.m(t.parentNode,t))},i:n,o:n,d(e){F&&F.d(e),e&&C(t)}}}function Oe(e,t){return Math.random()*(t-e)+e}function Me(e,t,F){let{size:n=10}=t,{x:r=[-.5,.5]}=t,{y:o=[.25,1]}=t,{duration:i=2e3}=t,{infinite:a=!1}=t,{delay:s=[0,50]}=t,{colorRange:c=[0,360]}=t,{colorArray:l=[]}=t,{amount:u=50}=t,{iterationCount:f=1}=t,{fallDistance:d="100px"}=t,{rounded:p=!1}=t,{cone:m=!1}=t,{noGravity:v=!1}=t,{xSpread:H=.15}=t,{destroyOnComplete:h=!0}=t,g=!1;return q(()=>{h&&!a&&"infinite"!=f&&setTimeout(()=>F(13,g=!0),(i+s[1])*f)}),e.$$set=e=>{"size"in e&&F(0,n=e.size),"x"in e&&F(1,r=e.x),"y"in e&&F(2,o=e.y),"duration"in e&&F(3,i=e.duration),"infinite"in e&&F(4,a=e.infinite),"delay"in e&&F(5,s=e.delay),"colorRange"in e&&F(15,c=e.colorRange),"colorArray"in e&&F(16,l=e.colorArray),"amount"in e&&F(6,u=e.amount),"iterationCount"in e&&F(7,f=e.iterationCount),"fallDistance"in e&&F(8,d=e.fallDistance),"rounded"in e&&F(9,p=e.rounded),"cone"in e&&F(10,m=e.cone),"noGravity"in e&&F(11,v=e.noGravity),"xSpread"in e&&F(12,H=e.xSpread),"destroyOnComplete"in e&&F(17,h=e.destroyOnComplete)},[n,r,o,i,a,s,u,f,d,p,m,v,H,g,function(){return l.length?l[Math.round(Math.random()*(l.length-1))]:`hsl(${Math.round(Oe(c[0],c[1]))}, 75%, 50%`},c,l,h]}var Pe=class extends ue{constructor(e){super(),le(this,e,Me,Te,l,{size:0,x:1,y:2,duration:3,infinite:4,delay:5,colorRange:15,colorArray:16,amount:6,iterationCount:7,fallDistance:8,rounded:9,cone:10,noGravity:11,xSpread:12,destroyOnComplete:17},ze)}};const Re={small:["SFFFFFFFFF","FFFFFFFFFF","HFFFFFFFFF","FFHFFFFFFF","HFFFFHFFFF","FFHFFFHFFF","HFFFFHFFFF","FFHFFFFFFF","HFFFFFFFFF","FFFGFFFFFF"],"16x16":["HHFFFFFFFFFFFFHH","HFFFFFFFFFFFFFFH","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHFFFFHHHFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFGFFFFFFF","FFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFF","FFFHHHFFFFHHHFFF","FFFHHHHHHHHHHFFF","FFFFHHHHHHHHFFFF","FFFFFFFFFFFFFFFF","HFFFFFFFSFFFFFFH","HHFFFFFFFFFFFFHH"],"32x32":["HHHHHHFFFFFFFFFFFFFFFFFHHHHHHHHH","HHFFFFFFFFFFFFFFFFFFFFFFHHHHHHHH","FFFFSFFFHHFFFFFFFFFFFFFFFFFFFFFH","FFFFFFFFFHFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHFFFFFFFFFHHHHHHHHFFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHHFFFFFFFFF","HHHHHHHHHHHHHHHHHHHHHHFFFFFFFFFF","HHFFHHHHHHHHHHHHFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFHHHHHFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFHHFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHHHFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHF","FFFFFFFFFFFFFFFFFFFFFFFFFFFHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHHHHH","FFFFFFFFFFFFFFFFFFFFFFFFFHHHHFFH","FFFFFFFFFFFFFFFFFFFFFFFFFFHHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFGFFFFFFFHFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFHFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFHFFHFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","HFFFFFFFFFFFFFFFFFFFFFFHFFFFFFFF","HHHHHHHFFFFFFFFFFFFFFFFFFFFFFFFF","HHHHHHHHHHHHFFFFFFFFFFFFFFFFFFFF"]},De={H:"#1976d2",S:"#ef9a9a",F:"#e1f5fe",G:"#81c784",T:"#ffe0b2"};const{window:Ie}=ie;function Le(e){w(e,"svelte-c3s6cr","canvas.svelte-c3s6cr.svelte-c3s6cr{padding:1em\n  }.game.svelte-c3s6cr.svelte-c3s6cr{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-bottom:1.5em}.controls.svelte-c3s6cr.svelte-c3s6cr{display:flex;flex-direction:column;align-items:center}.status.svelte-c3s6cr.svelte-c3s6cr{height:1em;width:16em;text-align:center;transition:color 1s;padding-top:1em}.map.svelte-c3s6cr.svelte-c3s6cr{display:flex;flex-direction:column;align-items:center}.menu.svelte-c3s6cr.svelte-c3s6cr{display:flex;flex-direction:row;align-items:center;padding:0.5em}.menu.svelte-c3s6cr div.svelte-c3s6cr{margin:0.3em;display:flex;flex-direction:column}.key.svelte-c3s6cr.svelte-c3s6cr{background-color:#eee;border-radius:4px;font-size:1em;padding:0.5em 0.5em;border-top:5px solid rgba(255, 255, 255, 0.5);border-left:5px solid rgba(255, 255, 255, 0.5);border-right:5px solid rgba(0, 0, 0, 0.2);border-bottom:5px solid rgba(0, 0, 0, 0.2);color:#555;text-align:center;width:4em;height:4em;cursor:pointer}@media(min-width: 768px){.game.svelte-c3s6cr.svelte-c3s6cr{flex-direction:row}.controls.svelte-c3s6cr.svelte-c3s6cr{flex-direction:column}.menu.svelte-c3s6cr.svelte-c3s6cr{flex-direction:column}.menu.svelte-c3s6cr div.svelte-c3s6cr{flex-direction:row;gap:10px}.key.svelte-c3s6cr.svelte-c3s6cr{width:3em;height:3em}}.keyboard.svelte-c3s6cr.svelte-c3s6cr{display:grid;grid-template-columns:auto auto auto;grid-gap:0.5em;padding:1em}.key.svelte-c3s6cr.svelte-c3s6cr:active{background-color:#ddd}")}function qe(e){let t,F;return t=new Pe({props:{cone:!0,delay:[0,200],amount:"50",x:[-.7,.7],y:[.5,1.5]}}),{c(){var e;(e=t.$$.fragment)&&e.c()},m(e,n){se(t,e,n),F=!0},i(e){F||(re(t.$$.fragment,e),F=!0)},o(e){oe(t.$$.fragment,e),F=!1},d(e){ce(t,e)}}}function Be(e){let t;return{c(){t=S("p"),t.textContent="Press the arrow keys to move...",j(t,"class","status svelte-c3s6cr")},m(e,F){k(e,t,F)},p:n,d(e){e&&C(t)}}}function Ge(e){let t,F;return{c(){t=S("p"),F=z(e[10]),j(t,"class","status svelte-c3s6cr"),O(t,"transition","color "+(e[10]?2:0)+"s"),O(t,"transition-timing-function","ease-in"),O(t,"color",e[10]?"white":"black")},m(e,n){k(e,t,n),b(t,F)},p(e,n){1024&n[0]&&T(F,e[10]),1024&n[0]&&O(t,"transition","color "+(e[10]?2:0)+"s"),1024&n[0]&&O(t,"color",e[10]?"white":"black")},d(e){e&&C(t)}}}function Ye(e){let t,F,n,r,o,i,a,c,l,u,d,p,m,v,H,h,g,y,x,w,_,$,z,T,P,R,D,I,L,q,B,G,Y,N,X,J,K,U,V,W,Z,ee,te,ie,ae,se,ce,le,ue,fe,de,pe,me,ve=e[11]&&qe();function He(e,t){return e[9]?Ge:Be}let he=He(e),ge=he(e);return{c(){t=S("div"),F=S("div"),n=S("canvas"),i=E(),a=S("img"),l=E(),ve&&ve.c(),u=E(),d=S("div"),ge.c(),p=E(),m=S("div"),v=S("div"),H=S("label"),H.textContent="Choose a map:",h=E(),g=S("select"),y=S("option"),y.textContent="Frozen Lake",x=S("option"),x.textContent="Frozen Smiley",w=S("option"),w.textContent="Large Lake",_=E(),$=S("div"),z=S("label"),z.textContent="Add a teacher:",T=E(),P=S("select"),R=S("option"),R.textContent="No Teacher",D=S("option"),D.textContent="Distance 1",I=S("option"),I.textContent="Distance 2",L=E(),q=S("div"),B=S("label"),B.textContent="Reset strategy:",G=E(),Y=S("select"),N=S("option"),N.textContent="Soft Reset",X=S("option"),X.textContent="Back 4",J=S("option"),J.textContent="Hard Reset",U=E(),V=S("div"),W=S("div"),Z=E(),ee=S("button"),ee.textContent="↑",te=E(),ie=S("div"),ae=E(),se=S("button"),se.textContent="←",ce=E(),le=S("button"),le.textContent="↓",ue=E(),fe=S("button"),fe.textContent="→",j(n,"width",r=500*e[12]),j(n,"height",o=500*e[12]),O(n,"width","300px"),O(n,"height","300px"),j(n,"class","svelte-c3s6cr"),j(a,"width","300"),j(a,"alt","Legend for the above mini-game"),f(a.src,c="./images/map_legend_stacked.svg")||j(a,"src","./images/map_legend_stacked.svg"),j(F,"class","map svelte-c3s6cr"),j(H,"for","map"),y.__value="small",y.value=y.__value,x.__value="16x16",x.value=x.__value,w.__value="32x32",w.value=w.__value,j(g,"name","map"),j(g,"id","map"),void 0===e[1]&&Q(()=>e[18].call(g)),j(v,"class","svelte-c3s6cr"),j(z,"for","teacher"),R.__value="0",R.value=R.__value,D.__value="1",D.value=D.__value,I.__value="2",I.value=I.__value,j(P,"name","teacher"),j(P,"id","teacher"),void 0===e[2]&&Q(()=>e[19].call(P)),j($,"class","svelte-c3s6cr"),j(B,"for","reset"),N.__value="SR",N.value=N.__value,X.__value="B4",X.value=X.__value,J.__value="HR",J.value=J.__value,j(Y,"name","reset"),j(Y,"id","reset"),Y.disabled=K=0==e[2],void 0===e[3]&&Q(()=>e[20].call(Y)),j(q,"class","svelte-c3s6cr"),j(m,"class","menu svelte-c3s6cr"),j(ee,"class","key svelte-c3s6cr"),j(se,"class","key svelte-c3s6cr"),j(le,"class","key svelte-c3s6cr"),j(fe,"class","key svelte-c3s6cr"),j(V,"class","keyboard svelte-c3s6cr"),j(d,"class","controls svelte-c3s6cr"),j(t,"class","game svelte-c3s6cr")},m(r,o){k(r,t,o),b(t,F),b(F,n),e[16](n),b(F,i),b(F,a),b(F,l),ve&&ve.m(F,null),b(t,u),b(t,d),ge.m(d,null),b(d,p),b(d,m),b(m,v),b(v,H),b(v,h),b(v,g),b(g,y),b(g,x),b(g,w),M(g,e[1]),b(m,_),b(m,$),b($,z),b($,T),b($,P),b(P,R),b(P,D),b(P,I),M(P,e[2]),b(m,L),b(m,q),b(q,B),b(q,G),b(q,Y),b(Y,N),b(Y,X),b(Y,J),M(Y,e[3]),b(d,U),b(d,V),b(V,W),b(V,Z),b(V,ee),b(V,te),b(V,ie),b(V,ae),b(V,se),b(V,ce),b(V,le),b(V,ue),b(V,fe),de=!0,pe||(me=[A(Ie,"keydown",e[14]),A(n,"click",e[17]),A(g,"change",e[18]),A(g,"change",e[13]),A(P,"change",e[19]),A(Y,"change",e[20]),A(ee,"click",e[21]),A(se,"click",e[22]),A(le,"click",e[23]),A(fe,"click",e[24])],pe=!0)},p(e,t){(!de||4096&t[0]&&r!==(r=500*e[12]))&&j(n,"width",r),(!de||4096&t[0]&&o!==(o=500*e[12]))&&j(n,"height",o),e[11]?ve?2048&t[0]&&re(ve,1):(ve=qe(),ve.c(),re(ve,1),ve.m(F,null)):ve&&(Fe(),oe(ve,1,1,()=>{ve=null}),ne()),he===(he=He(e))&&ge?ge.p(e,t):(ge.d(1),ge=he(e),ge&&(ge.c(),ge.m(d,p))),2&t[0]&&M(g,e[1]),4&t[0]&&M(P,e[2]),(!de||4&t[0]&&K!==(K=0==e[2]))&&(Y.disabled=K),8&t[0]&&M(Y,e[3])},i(e){de||(re(ve),de=!0)},o(e){oe(ve),de=!1},d(F){F&&C(t),e[16](null),ve&&ve.d(),ge.d(),pe=!1,s(me)}}}function Ne(e,t,F){let i,a,s,c,l,u=n;e.$$.on_destroy.push(()=>u());var f,d,m,H=!1,h=!1,g=!1,x=!1,b=!0,w=[],_=!1,$="",k=null,C=!1;const S=new Image;S.src="./images/robot.png";const z=new Image;z.src="./images/robot-flipped.png";var E=!1,A=S;function j(e){F(10,$=""),clearTimeout(k),setTimeout(()=>{F(10,$=e)},1),k=setTimeout(()=>{F(10,$="")},2e3)}q(()=>{const e=a.getContext("2d");var t,n,$,k,T;function O(e){let t=e.length,F=e[0].length,n=new Array(t).fill(!1).map(()=>new Array(F).fill(!1));for(let o=0;o<t;o++)for(let t=0;t<F;t++){var r=!1;try{r|=e[o][t+1]}catch(e){}try{r|=e[o+1][t]}catch(e){}try{r|=e[o][t-1]}catch(e){}try{r|=e[o-1][t]}catch(e){}n[o][t]=r}return n}function M(){n=Re[s],t=a.height/n.length,T=function(e,t){if(0==t)return e;var F=new Array;for(let e=0;e<n.length;e++)F.push(n[e].split(""));let r=F.map(e=>e.map(e=>"H"==e)),o=F.map(e=>e.map(e=>"F"==e));var i,a=Array.from(r);for(let e=0;e<t;e++)i=O(a),a=i.map((e,t)=>e.map((e,F)=>e||a[t][F]));var s=Array.from(F);for(let e=0;e<F.length;e++)for(let t=0;t<F[0].length;t++)i[e][t]&&o[e][t]&&(s[e][t]="T");let c=new Array;for(let t=0;t<e.length;t++)c.push(s[t].join(""));return c}(n,c);for(let F=0;F<n.length;F++)for(let r=0;r<n[0].length;r++){let n=T[F][r];"S"==n&&($=[r,F]);let o=r*t,i=F*t;e.beginPath(),e.rect(o,i,t+1,t+1),e.fillStyle=De[n],e.fill(),e.closePath()}}function P(e){f.set(e),d=e,w.push(d)}function R(){w=[],P($)}F(12,m=window.devicePixelRatio),e.scale(m,m),M(),function s(){(h||H||g||x)&&F(9,_=!0),e.clearRect(0,0,a.width,a.height),M(),b&&(F(8,f=function(e,t={}){const F=$e(e);let n,i=e;function a(a,s){if(null==e)return F.set(e=a),Promise.resolve();i=a;let c=n,l=!1,{delay:u=0,duration:f=400,easing:d=r,interpolate:p=Se}=o(o({},t),s);if(0===f)return c&&(c.abort(),c=null),F.set(e=i),Promise.resolve();const m=v()+u;let H;return n=y(t=>{if(t<m)return!0;l||(H=p(e,a),"function"==typeof f&&(f=f(e,a)),l=!0),c&&(c.abort(),c=null);const n=t-m;return n>f?(F.set(e=a),!1):(F.set(e=H(d(n/f))),!0)}),n.promise}return{set:a,update:(t,F)=>a(t(i,e),F),subscribe:F.subscribe}}($,{duration:150,easing:ke})),u(),u=p(f,e=>F(33,i=e)),R()),async function(){A=E?z:S,e.drawImage(A,i[0]*t,i[1]*t,t,t)}();const c=Math.random();h||H?c<.1?(F(5,h=!1),F(4,H=!1),F(6,g=!0)):c<.2&&(F(5,h=!1),F(4,H=!1),F(7,x=!0)):(g||x)&&(c<.1?(F(6,g=!1),F(7,x=!1),F(5,h=!0)):c<.2&&(F(6,g=!1),F(7,x=!1),F(4,H=!0))),c<.2&&(g||x||h||H)&&j("You just slipped."),h&&(E=!0),H&&(E=!1),k=Array.from(d);let[m,O]=Array.from(k);if(H?m<n[0].length-1&&(m+=1):h?m>0&&(m-=1):g?O>0&&(O-=1):x&&O<n.length-1&&(O+=1),(H||h||x||g)&&P([m,O]),"G"==n[O][m])F(11,C=!0),setTimeout(()=>{F(11,C=!1)},3e3),j("You won!"),R();else if("H"==n[O][m])j("You failed."),R();else if("T"==T[O][m]){if("HR"==l)R();else if("B4"==l){for(let e=0;e<4&&w.length>1;e++)w.pop();P(w[w.length-1])}else"SR"==l&&P(k);j("The teacher set you back.")}b=!1,F(4,H=!1),F(5,h=!1),F(6,g=!1),F(7,x=!1),requestAnimationFrame(s)}()});return[a,s,c,l,H,h,g,x,f,_,$,C,m,function(){b=!0},function(e){39==e.keyCode||"d"==e.key?(F(4,H=!0),e.preventDefault()):37==e.keyCode||"a"==e.key?(F(5,h=!0),e.preventDefault()):38==e.keyCode||"w"==e.key?(F(6,g=!0),e.preventDefault()):40!=e.keyCode&&"s"!=e.key||(F(7,x=!0),e.preventDefault())},j,function(e){G[e?"unshift":"push"](()=>{a=e,F(0,a)})},()=>j("Press the arrow keys to move..."),function(){s=P(this),F(1,s)},function(){c=P(this),F(2,c)},function(){l=P(this),F(3,l)},()=>F(6,g=!0),()=>F(5,h=!0),()=>F(7,x=!0),()=>F(4,H=!0)]}var Xe=class extends ue{constructor(e){super(),le(this,e,Ne,Ye,l,{},Le,[-1,-1])}},Je=document.getElementById("trajectories-visualization");Je.addEventListener("ready",(function(){var e=Je.querySelector("#trajectories-visualization-target");new me({target:e})}));var Ke=document.getElementById("back-visualization");Ke.addEventListener("ready",(function(){var e=Ke.querySelector("#back-visualization-target");new ge({target:e})}));var Qe=document.getElementById("incremental-visualization");Qe.addEventListener("ready",(function(){var e=Qe.querySelector("#incremental-visualization-target");new we({target:e})}));var Ue=document.getElementById("grid-visualization");Ue.addEventListener("ready",(function(){var e=Ue.querySelector("#grid-visualization-target");new Xe({target:e})}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vL3RyYWplY3Rvcmllcy5zdmVsdGUiLCJ3ZWJwYWNrOi8vL2JhY2suc3ZlbHRlIiwid2VicGFjazovLy9pbmNyZW1lbnRhbC5zdmVsdGUiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9zdG9yZS9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9lYXNpbmcvaW5kZXgubWpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9zdmVsdGUvbW90aW9uL2luZGV4Lm1qcyIsIndlYnBhY2s6Ly8vQ29uZmV0dGkuc3ZlbHRlIiwid2VicGFjazovLy9jb25zdGFudHMuc3ZlbHRlIiwid2VicGFjazovLy9ncmlkLnN2ZWx0ZSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJub29wIiwiaWRlbnRpdHkiLCJ4IiwidGFyIiwic3JjIiwiayIsImZuIiwiYmxhbmtfb2JqZWN0IiwicnVuX2FsbCIsImZucyIsImZvckVhY2giLCJpc19mdW5jdGlvbiIsInRoaW5nIiwic2FmZV9ub3RfZXF1YWwiLCJhIiwiYiIsInNyY191cmxfZXF1YWxfYW5jaG9yIiwic3JjX3VybF9lcXVhbCIsImVsZW1lbnRfc3JjIiwidXJsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaHJlZiIsImlzX2VtcHR5Iiwib2JqIiwia2V5cyIsImxlbmd0aCIsInN0b3JlIiwiY2FsbGJhY2tzIiwidW5zdWIiLCJzdWJzY3JpYmUiLCJ1bnN1YnNjcmliZSIsImlzX2NsaWVudCIsIndpbmRvdyIsIm5vdyIsInBlcmZvcm1hbmNlIiwiRGF0ZSIsInJhZiIsImNiIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidGFza3MiLCJTZXQiLCJydW5fdGFza3MiLCJ0YXNrIiwiZGVsZXRlIiwiZiIsInNpemUiLCJsb29wIiwiY2FsbGJhY2siLCJwcm9taXNlIiwiUHJvbWlzZSIsImZ1bGZpbGwiLCJhZGQiLCJpc19oeWRyYXRpbmciLCJhcHBlbmQiLCJ0YXJnZXQiLCJub2RlIiwiYXBwZW5kQ2hpbGQiLCJhcHBlbmRfc3R5bGVzIiwic3R5bGVfc2hlZXRfaWQiLCJzdHlsZXMiLCJhcHBlbmRfc3R5bGVzX3RvIiwiZ2V0X3Jvb3RfZm9yX3N0eWxlIiwiZ2V0RWxlbWVudEJ5SWQiLCJzdHlsZSIsImlkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRfc3R5bGVzaGVldCIsInJvb3QiLCJnZXRSb290Tm9kZSIsIm93bmVyRG9jdW1lbnQiLCJob3N0IiwiaGVhZCIsImluc2VydCIsImFuY2hvciIsImluc2VydEJlZm9yZSIsImRldGFjaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRhdGEiLCJjcmVhdGVUZXh0Tm9kZSIsInNwYWNlIiwibGlzdGVuIiwiZXZlbnQiLCJoYW5kbGVyIiwib3B0aW9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYXR0ciIsImF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldF9kYXRhIiwidGV4dCIsIndob2xlVGV4dCIsInNldF9zdHlsZSIsImltcG9ydGFudCIsInJlbW92ZVByb3BlcnR5Iiwic2V0UHJvcGVydHkiLCJzZWxlY3Rfb3B0aW9uIiwic2VsZWN0Iiwib3B0aW9uIiwiX192YWx1ZSIsInNlbGVjdGVkIiwic2VsZWN0ZWRJbmRleCIsInNlbGVjdF92YWx1ZSIsInNlbGVjdGVkX29wdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJ0b2dnbGVfY2xhc3MiLCJlbGVtZW50IiwidG9nZ2xlIiwiY2xhc3NMaXN0IiwiTWFwIiwiY3VycmVudF9jb21wb25lbnQiLCJzZXRfY3VycmVudF9jb21wb25lbnQiLCJjb21wb25lbnQiLCJnZXRfY3VycmVudF9jb21wb25lbnQiLCJFcnJvciIsIm9uTW91bnQiLCIkJCIsIm9uX21vdW50IiwicHVzaCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwicmVzb2x2ZSIsInVwZGF0ZV9zY2hlZHVsZWQiLCJzY2hlZHVsZV91cGRhdGUiLCJ0aGVuIiwiZmx1c2giLCJhZGRfcmVuZGVyX2NhbGxiYWNrIiwic2Vlbl9jYWxsYmFja3MiLCJmbHVzaGlkeCIsInNhdmVkX2NvbXBvbmVudCIsInBvcCIsImhhcyIsImNsZWFyIiwiZnJhZ21lbnQiLCJ1cGRhdGUiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsIm91dHJvcyIsImdyb3VwX291dHJvcyIsImNoZWNrX291dHJvcyIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwidHJhbnNpdGlvbl9vdXQiLCJnbG9iYWxzIiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIlN2ZWx0ZUVsZW1lbnQiLCJtb3VudF9jb21wb25lbnQiLCJjdXN0b21FbGVtZW50Iiwib25fZGVzdHJveSIsIm5ld19vbl9kZXN0cm95IiwibWFwIiwiZmlsdGVyIiwiZGVzdHJveV9jb21wb25lbnQiLCJkZXRhY2hpbmciLCJpbml0IiwiaW5zdGFuY2UiLCJjcmVhdGVfZnJhZ21lbnQiLCJub3RfZXF1YWwiLCJwcm9wcyIsInBhcmVudF9jb21wb25lbnQiLCJib3VuZCIsIm9uX2Rpc2Nvbm5lY3QiLCJjb250ZXh0Iiwic2tpcF9ib3VuZCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGROb2RlcyIsImludHJvIiwiSFRNTEVsZW1lbnQiLCJzdXBlciIsInRoaXMiLCJhdHRhY2hTaGFkb3ciLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkJHByb3BzIiwiJCRzZXQiLCJTdmVsdGVDb21wb25lbnQiLCJsZW4iLCJjb3VudCIsImhhc0ludGVyYWN0ZWQiLCJwYXJzZUludCIsInN1YnNjcmliZXJfcXVldWUiLCJ3cml0YWJsZSIsInN0YXJ0Iiwic3RvcCIsInN1YnNjcmliZXJzIiwic2V0IiwibmV3X3ZhbHVlIiwicnVuX3F1ZXVlIiwic3Vic2NyaWJlciIsInJ1biIsImludmFsaWRhdGUiLCJjdWJpY091dCIsImlzX2RhdGUiLCJ0b1N0cmluZyIsImdldF9pbnRlcnBvbGF0b3IiLCJpc0FycmF5IiwiYXJyIiwiYmkiLCJnZXRUaW1lIiwiZGVsdGEiLCJpbnRlcnBvbGF0b3JzIiwicmVzdWx0IiwiaXRlcmF0aW9ucyIsInJhbmRvbUJldHdlZW4iLCJtaW4iLCJtYXgiLCJNYXRoIiwicmFuZG9tIiwieSIsImR1cmF0aW9uIiwiaW5maW5pdGUiLCJkZWxheSIsImNvbG9yUmFuZ2UiLCJjb2xvckFycmF5IiwiYW1vdW50IiwiaXRlcmF0aW9uQ291bnQiLCJmYWxsRGlzdGFuY2UiLCJyb3VuZGVkIiwiY29uZSIsIm5vR3Jhdml0eSIsInhTcHJlYWQiLCJkZXN0cm95T25Db21wbGV0ZSIsImNvbXBsZXRlIiwic2V0VGltZW91dCIsInJvdW5kIiwibWFwcyIsImNvbG9ycyIsImNhbnZhcyIsInNlbGVjdGVkTWFwIiwic2VsZWN0ZWRUZWFjaGVyIiwic2VsZWN0ZWRSZXNldCIsInBvcyIsInJlYWxQb3MiLCJwaXhlbFJhdGlvIiwicmlnaHRQcmVzc2VkIiwibGVmdFByZXNzZWQiLCJ1cFByZXNzZWQiLCJkb3duUHJlc3NlZCIsIm1hcENoYW5nZWQiLCJoaXN0b3J5Iiwic3RhdHVzTWVzc2FnZSIsInN0YXR1c1RpbWVyIiwiY29uZmV0dGkiLCJyb2JvdCIsIkltYWdlIiwicm9ib3RGbGlwcGVkIiwiZmxpcHBlZCIsImltYWdlIiwic2hvd01lc3NhZ2UiLCJtc2ciLCJjbGVhclRpbWVvdXQiLCJnZXRDb250ZXh0IiwidGlsZVNpemUiLCJsYXN0UG9zaXRpb24iLCJ0ZWFjaGVyTWFwIiwib25lU3RlcFJlYWNoIiwiYmFzZU1hc2siLCJyb3dzIiwiY29scyIsIm9uZVN0ZXBNYXNrIiwiaiIsInJlcyIsImUiLCJkcmF3RW52aXJvbm1lbnQiLCJoZWlnaHQiLCJiYXNlTWFwIiwiZGlzdGFuY2UiLCJuZXdCYXNlTWFwIiwic3BsaXQiLCJiYXNlRGFuZ2VyTWFzayIsInJvdyIsImJhc2VFbXB0eU1hc2siLCJyZWFjaE1hc2siLCJwcmV2aW91c01hc2siLCJuZXdNYXAiLCJqb2luIiwiYWRkVGVhY2hlciIsInN0YXRlIiwiYmVnaW5QYXRoIiwicmVjdCIsImZpbGxTdHlsZSIsImNsb3NlUGF0aCIsIm1vdmVBZ2VudCIsIm5ld1BvcyIsInJlc2V0QWdlbnQiLCJkZXZpY2VQaXhlbFJhdGlvIiwic2NhbGUiLCJkcmF3IiwiY2xlYXJSZWN0Iiwid2lkdGgiLCJkZWZhdWx0cyIsInRhcmdldF92YWx1ZSIsIm9wdHMiLCJwcmV2aW91c190YXNrIiwic3RhcnRlZCIsImVhc2luZyIsImludGVycG9sYXRlIiwiYWJvcnQiLCJlbGFwc2VkIiwidHdlZW5lZCIsImRyYXdJbWFnZSIsIiRwb3MiLCJkcmF3QWdlbnQiLCJybmQiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJ0cmFqZWN0b3JpZXNUYWciLCJUcmFqZWN0b3JpZXMiLCJiYWNrVGFnIiwiQmFjayIsImluY3JlbWVudGFsVGFnIiwiSW5jcmVtZW50YWwiLCJncmlkVGFnIiwiR3JpZCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcsV0FBWSxPQUFPSCxFQUNoRixJQUFJSSxFQUFLWCxPQUFPWSxPQUFPLE1BR3ZCLEdBRkExQixFQUFvQmtCLEVBQUVPLEdBQ3RC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TSxJQUMzQmdSLEdBQWMsR0FDZHlCLEVBQUUyQyxtQix5Q0FtQlM5RSxFQUFNLEUsY0FJRHFCLEVBQVksbUMsV0FxQk5wQixFQUFXLFEsbUJBU1hDLEVBQWUsUSxtQkFTZkMsRUFBYSxRLGdCQVVYTSxHQUFZLEcsUUFFWkQsR0FBYyxHLFFBQ2RFLEdBQWMsRyxRQUNkSCxHQUFlLEksa0ZDbFh2Q3dFLEdBQWtCeFQsU0FBUzJDLGVBQWUsOEJBRWhENlEsR0FBZ0J0UCxpQkFBaUIsU0FBUyxXQUN6QyxJQUFNL0IsRUFBU3FSLEdBQWdCaE8sY0FBYyxzQ0FDOUIsSUFBSWlPLEdBQWEsQ0FBRXRSLGNBR25DLElBQU11UixHQUFVMVQsU0FBUzJDLGVBQWUsc0JBRXhDK1EsR0FBUXhQLGlCQUFpQixTQUFTLFdBQ2pDLElBQU0vQixFQUFTdVIsR0FBUWxPLGNBQWMsOEJBQzlCLElBQUltTyxHQUFLLENBQUV4UixjQUduQixJQUFNeVIsR0FBaUI1VCxTQUFTMkMsZUFBZSw2QkFFL0NpUixHQUFlMVAsaUJBQWlCLFNBQVMsV0FDeEMsSUFBTS9CLEVBQVN5UixHQUFlcE8sY0FBYyxxQ0FDOUIsSUFBSXFPLEdBQVksQ0FBRTFSLGNBR2pDLElBQU0yUixHQUFVOVQsU0FBUzJDLGVBQWUsc0JBRXhDbVIsR0FBUTVQLGlCQUFpQixTQUFTLFdBQ2pDLElBQU0vQixFQUFTMlIsR0FBUXRPLGNBQWMsOEJBQzlCLElBQUl1TyxHQUFLLENBQUU1UiIsImZpbGUiOiJpbmRleC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJmdW5jdGlvbiBub29wKCkgeyB9XG5jb25zdCBpZGVudGl0eSA9IHggPT4geDtcbmZ1bmN0aW9uIGFzc2lnbih0YXIsIHNyYykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IGsgaW4gc3JjKVxuICAgICAgICB0YXJba10gPSBzcmNba107XG4gICAgcmV0dXJuIHRhcjtcbn1cbmZ1bmN0aW9uIGlzX3Byb21pc2UodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIGFkZF9sb2NhdGlvbihlbGVtZW50LCBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIpIHtcbiAgICBlbGVtZW50Ll9fc3ZlbHRlX21ldGEgPSB7XG4gICAgICAgIGxvYzogeyBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIgfVxuICAgIH07XG59XG5mdW5jdGlvbiBydW4oZm4pIHtcbiAgICByZXR1cm4gZm4oKTtcbn1cbmZ1bmN0aW9uIGJsYW5rX29iamVjdCgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcbn1cbmZ1bmN0aW9uIHJ1bl9hbGwoZm5zKSB7XG4gICAgZm5zLmZvckVhY2gocnVuKTtcbn1cbmZ1bmN0aW9uIGlzX2Z1bmN0aW9uKHRoaW5nKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGluZyA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIHNhZmVfbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYiB8fCAoKGEgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnKSB8fCB0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5sZXQgc3JjX3VybF9lcXVhbF9hbmNob3I7XG5mdW5jdGlvbiBzcmNfdXJsX2VxdWFsKGVsZW1lbnRfc3JjLCB1cmwpIHtcbiAgICBpZiAoIXNyY191cmxfZXF1YWxfYW5jaG9yKSB7XG4gICAgICAgIHNyY191cmxfZXF1YWxfYW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIH1cbiAgICBzcmNfdXJsX2VxdWFsX2FuY2hvci5ocmVmID0gdXJsO1xuICAgIHJldHVybiBlbGVtZW50X3NyYyA9PT0gc3JjX3VybF9lcXVhbF9hbmNob3IuaHJlZjtcbn1cbmZ1bmN0aW9uIG5vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGI7XG59XG5mdW5jdGlvbiBpc19lbXB0eShvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zdG9yZShzdG9yZSwgbmFtZSkge1xuICAgIGlmIChzdG9yZSAhPSBudWxsICYmIHR5cGVvZiBzdG9yZS5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnJHtuYW1lfScgaXMgbm90IGEgc3RvcmUgd2l0aCBhICdzdWJzY3JpYmUnIG1ldGhvZGApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN1YnNjcmliZShzdG9yZSwgLi4uY2FsbGJhY2tzKSB7XG4gICAgaWYgKHN0b3JlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICAgIGNvbnN0IHVuc3ViID0gc3RvcmUuc3Vic2NyaWJlKC4uLmNhbGxiYWNrcyk7XG4gICAgcmV0dXJuIHVuc3ViLnVuc3Vic2NyaWJlID8gKCkgPT4gdW5zdWIudW5zdWJzY3JpYmUoKSA6IHVuc3ViO1xufVxuZnVuY3Rpb24gZ2V0X3N0b3JlX3ZhbHVlKHN0b3JlKSB7XG4gICAgbGV0IHZhbHVlO1xuICAgIHN1YnNjcmliZShzdG9yZSwgXyA9PiB2YWx1ZSA9IF8pKCk7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gY29tcG9uZW50X3N1YnNjcmliZShjb21wb25lbnQsIHN0b3JlLCBjYWxsYmFjaykge1xuICAgIGNvbXBvbmVudC4kJC5vbl9kZXN0cm95LnB1c2goc3Vic2NyaWJlKHN0b3JlLCBjYWxsYmFjaykpO1xufVxuZnVuY3Rpb24gY3JlYXRlX3Nsb3QoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY3R4ID0gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKTtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25bMF0oc2xvdF9jdHgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIHJldHVybiBkZWZpbml0aW9uWzFdICYmIGZuXG4gICAgICAgID8gYXNzaWduKCQkc2NvcGUuY3R4LnNsaWNlKCksIGRlZmluaXRpb25bMV0oZm4oY3R4KSkpXG4gICAgICAgIDogJCRzY29wZS5jdHg7XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jaGFuZ2VzKGRlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uWzJdICYmIGZuKSB7XG4gICAgICAgIGNvbnN0IGxldHMgPSBkZWZpbml0aW9uWzJdKGZuKGRpcnR5KSk7XG4gICAgICAgIGlmICgkJHNjb3BlLmRpcnR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBsZXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgbGV0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlZCA9IFtdO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gTWF0aC5tYXgoJCRzY29wZS5kaXJ0eS5sZW5ndGgsIGxldHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRbaV0gPSAkJHNjb3BlLmRpcnR5W2ldIHwgbGV0c1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtZXJnZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICQkc2NvcGUuZGlydHkgfCBsZXRzO1xuICAgIH1cbiAgICByZXR1cm4gJCRzY29wZS5kaXJ0eTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90X2Jhc2Uoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIHNsb3RfY2hhbmdlcywgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3Qoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGRpcnR5LCBnZXRfc2xvdF9jaGFuZ2VzX2ZuLCBnZXRfc2xvdF9jb250ZXh0X2ZuKSB7XG4gICAgY29uc3Qgc2xvdF9jaGFuZ2VzID0gZ2V0X3Nsb3RfY2hhbmdlcyhzbG90X2RlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBnZXRfc2xvdF9jaGFuZ2VzX2ZuKTtcbiAgICB1cGRhdGVfc2xvdF9iYXNlKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBzbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHRfZm4pO1xufVxuZnVuY3Rpb24gZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlKCQkc2NvcGUpIHtcbiAgICBpZiAoJCRzY29wZS5jdHgubGVuZ3RoID4gMzIpIHtcbiAgICAgICAgY29uc3QgZGlydHkgPSBbXTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gJCRzY29wZS5jdHgubGVuZ3RoIC8gMzI7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRpcnR5W2ldID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpcnR5O1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5mdW5jdGlvbiBleGNsdWRlX2ludGVybmFsX3Byb3BzKHByb3BzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoa1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdWx0W2tdID0gcHJvcHNba107XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfcmVzdF9wcm9wcyhwcm9wcywga2V5cykge1xuICAgIGNvbnN0IHJlc3QgPSB7fTtcbiAgICBrZXlzID0gbmV3IFNldChrZXlzKTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmICgha2V5cy5oYXMoaykgJiYga1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN0O1xufVxuZnVuY3Rpb24gY29tcHV0ZV9zbG90cyhzbG90cykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICBsZXQgcmFuID0gZmFsc2U7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgIGlmIChyYW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHJhbiA9IHRydWU7XG4gICAgICAgIGZuLmNhbGwodGhpcywgLi4uYXJncyk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIG51bGxfdG9fZW1wdHkodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRfc3RvcmVfdmFsdWUoc3RvcmUsIHJldCwgdmFsdWUpIHtcbiAgICBzdG9yZS5zZXQodmFsdWUpO1xuICAgIHJldHVybiByZXQ7XG59XG5jb25zdCBoYXNfcHJvcCA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xuZnVuY3Rpb24gYWN0aW9uX2Rlc3Ryb3llcihhY3Rpb25fcmVzdWx0KSB7XG4gICAgcmV0dXJuIGFjdGlvbl9yZXN1bHQgJiYgaXNfZnVuY3Rpb24oYWN0aW9uX3Jlc3VsdC5kZXN0cm95KSA/IGFjdGlvbl9yZXN1bHQuZGVzdHJveSA6IG5vb3A7XG59XG5cbmNvbnN0IGlzX2NsaWVudCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xubGV0IG5vdyA9IGlzX2NsaWVudFxuICAgID8gKCkgPT4gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXG4gICAgOiAoKSA9PiBEYXRlLm5vdygpO1xubGV0IHJhZiA9IGlzX2NsaWVudCA/IGNiID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShjYikgOiBub29wO1xuLy8gdXNlZCBpbnRlcm5hbGx5IGZvciB0ZXN0aW5nXG5mdW5jdGlvbiBzZXRfbm93KGZuKSB7XG4gICAgbm93ID0gZm47XG59XG5mdW5jdGlvbiBzZXRfcmFmKGZuKSB7XG4gICAgcmFmID0gZm47XG59XG5cbmNvbnN0IHRhc2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gcnVuX3Rhc2tzKG5vdykge1xuICAgIHRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGlmICghdGFzay5jKG5vdykpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgICAgIHRhc2suZigpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHRhc2tzLnNpemUgIT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xufVxuLyoqXG4gKiBGb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5IVxuICovXG5mdW5jdGlvbiBjbGVhcl9sb29wcygpIHtcbiAgICB0YXNrcy5jbGVhcigpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHRhc2sgdGhhdCBydW5zIG9uIGVhY2ggcmFmIGZyYW1lXG4gKiB1bnRpbCBpdCByZXR1cm5zIGEgZmFsc3kgdmFsdWUgb3IgaXMgYWJvcnRlZFxuICovXG5mdW5jdGlvbiBsb29wKGNhbGxiYWNrKSB7XG4gICAgbGV0IHRhc2s7XG4gICAgaWYgKHRhc2tzLnNpemUgPT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IG5ldyBQcm9taXNlKGZ1bGZpbGwgPT4ge1xuICAgICAgICAgICAgdGFza3MuYWRkKHRhc2sgPSB7IGM6IGNhbGxiYWNrLCBmOiBmdWxmaWxsIH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgYWJvcnQoKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vLyBUcmFjayB3aGljaCBub2RlcyBhcmUgY2xhaW1lZCBkdXJpbmcgaHlkcmF0aW9uLiBVbmNsYWltZWQgbm9kZXMgY2FuIHRoZW4gYmUgcmVtb3ZlZCBmcm9tIHRoZSBET01cbi8vIGF0IHRoZSBlbmQgb2YgaHlkcmF0aW9uIHdpdGhvdXQgdG91Y2hpbmcgdGhlIHJlbWFpbmluZyBub2Rlcy5cbmxldCBpc19oeWRyYXRpbmcgPSBmYWxzZTtcbmZ1bmN0aW9uIHN0YXJ0X2h5ZHJhdGluZygpIHtcbiAgICBpc19oeWRyYXRpbmcgPSB0cnVlO1xufVxuZnVuY3Rpb24gZW5kX2h5ZHJhdGluZygpIHtcbiAgICBpc19oeWRyYXRpbmcgPSBmYWxzZTtcbn1cbmZ1bmN0aW9uIHVwcGVyX2JvdW5kKGxvdywgaGlnaCwga2V5LCB2YWx1ZSkge1xuICAgIC8vIFJldHVybiBmaXJzdCBpbmRleCBvZiB2YWx1ZSBsYXJnZXIgdGhhbiBpbnB1dCB2YWx1ZSBpbiB0aGUgcmFuZ2UgW2xvdywgaGlnaClcbiAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgICBjb25zdCBtaWQgPSBsb3cgKyAoKGhpZ2ggLSBsb3cpID4+IDEpO1xuICAgICAgICBpZiAoa2V5KG1pZCkgPD0gdmFsdWUpIHtcbiAgICAgICAgICAgIGxvdyA9IG1pZCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoaWdoID0gbWlkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsb3c7XG59XG5mdW5jdGlvbiBpbml0X2h5ZHJhdGUodGFyZ2V0KSB7XG4gICAgaWYgKHRhcmdldC5oeWRyYXRlX2luaXQpXG4gICAgICAgIHJldHVybjtcbiAgICB0YXJnZXQuaHlkcmF0ZV9pbml0ID0gdHJ1ZTtcbiAgICAvLyBXZSBrbm93IHRoYXQgYWxsIGNoaWxkcmVuIGhhdmUgY2xhaW1fb3JkZXIgdmFsdWVzIHNpbmNlIHRoZSB1bmNsYWltZWQgaGF2ZSBiZWVuIGRldGFjaGVkIGlmIHRhcmdldCBpcyBub3QgPGhlYWQ+XG4gICAgbGV0IGNoaWxkcmVuID0gdGFyZ2V0LmNoaWxkTm9kZXM7XG4gICAgLy8gSWYgdGFyZ2V0IGlzIDxoZWFkPiwgdGhlcmUgbWF5IGJlIGNoaWxkcmVuIHdpdGhvdXQgY2xhaW1fb3JkZXJcbiAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lID09PSAnSEVBRCcpIHtcbiAgICAgICAgY29uc3QgbXlDaGlsZHJlbiA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gY2hpbGRyZW5baV07XG4gICAgICAgICAgICBpZiAobm9kZS5jbGFpbV9vcmRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXlDaGlsZHJlbi5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNoaWxkcmVuID0gbXlDaGlsZHJlbjtcbiAgICB9XG4gICAgLypcbiAgICAqIFJlb3JkZXIgY2xhaW1lZCBjaGlsZHJlbiBvcHRpbWFsbHkuXG4gICAgKiBXZSBjYW4gcmVvcmRlciBjbGFpbWVkIGNoaWxkcmVuIG9wdGltYWxseSBieSBmaW5kaW5nIHRoZSBsb25nZXN0IHN1YnNlcXVlbmNlIG9mXG4gICAgKiBub2RlcyB0aGF0IGFyZSBhbHJlYWR5IGNsYWltZWQgaW4gb3JkZXIgYW5kIG9ubHkgbW92aW5nIHRoZSByZXN0LiBUaGUgbG9uZ2VzdFxuICAgICogc3Vic2VxdWVuY2Ugc3Vic2VxdWVuY2Ugb2Ygbm9kZXMgdGhhdCBhcmUgY2xhaW1lZCBpbiBvcmRlciBjYW4gYmUgZm91bmQgYnlcbiAgICAqIGNvbXB1dGluZyB0aGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIC5jbGFpbV9vcmRlciB2YWx1ZXMuXG4gICAgKlxuICAgICogVGhpcyBhbGdvcml0aG0gaXMgb3B0aW1hbCBpbiBnZW5lcmF0aW5nIHRoZSBsZWFzdCBhbW91bnQgb2YgcmVvcmRlciBvcGVyYXRpb25zXG4gICAgKiBwb3NzaWJsZS5cbiAgICAqXG4gICAgKiBQcm9vZjpcbiAgICAqIFdlIGtub3cgdGhhdCwgZ2l2ZW4gYSBzZXQgb2YgcmVvcmRlcmluZyBvcGVyYXRpb25zLCB0aGUgbm9kZXMgdGhhdCBkbyBub3QgbW92ZVxuICAgICogYWx3YXlzIGZvcm0gYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSwgc2luY2UgdGhleSBkbyBub3QgbW92ZSBhbW9uZyBlYWNoIG90aGVyXG4gICAgKiBtZWFuaW5nIHRoYXQgdGhleSBtdXN0IGJlIGFscmVhZHkgb3JkZXJlZCBhbW9uZyBlYWNoIG90aGVyLiBUaHVzLCB0aGUgbWF4aW1hbFxuICAgICogc2V0IG9mIG5vZGVzIHRoYXQgZG8gbm90IG1vdmUgZm9ybSBhIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZS5cbiAgICAqL1xuICAgIC8vIENvbXB1dGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlXG4gICAgLy8gbTogc3Vic2VxdWVuY2UgbGVuZ3RoIGogPT4gaW5kZXggayBvZiBzbWFsbGVzdCB2YWx1ZSB0aGF0IGVuZHMgYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBsZW5ndGggalxuICAgIGNvbnN0IG0gPSBuZXcgSW50MzJBcnJheShjaGlsZHJlbi5sZW5ndGggKyAxKTtcbiAgICAvLyBQcmVkZWNlc3NvciBpbmRpY2VzICsgMVxuICAgIGNvbnN0IHAgPSBuZXcgSW50MzJBcnJheShjaGlsZHJlbi5sZW5ndGgpO1xuICAgIG1bMF0gPSAtMTtcbiAgICBsZXQgbG9uZ2VzdCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gY2hpbGRyZW5baV0uY2xhaW1fb3JkZXI7XG4gICAgICAgIC8vIEZpbmQgdGhlIGxhcmdlc3Qgc3Vic2VxdWVuY2UgbGVuZ3RoIHN1Y2ggdGhhdCBpdCBlbmRzIGluIGEgdmFsdWUgbGVzcyB0aGFuIG91ciBjdXJyZW50IHZhbHVlXG4gICAgICAgIC8vIHVwcGVyX2JvdW5kIHJldHVybnMgZmlyc3QgZ3JlYXRlciB2YWx1ZSwgc28gd2Ugc3VidHJhY3Qgb25lXG4gICAgICAgIC8vIHdpdGggZmFzdCBwYXRoIGZvciB3aGVuIHdlIGFyZSBvbiB0aGUgY3VycmVudCBsb25nZXN0IHN1YnNlcXVlbmNlXG4gICAgICAgIGNvbnN0IHNlcUxlbiA9ICgobG9uZ2VzdCA+IDAgJiYgY2hpbGRyZW5bbVtsb25nZXN0XV0uY2xhaW1fb3JkZXIgPD0gY3VycmVudCkgPyBsb25nZXN0ICsgMSA6IHVwcGVyX2JvdW5kKDEsIGxvbmdlc3QsIGlkeCA9PiBjaGlsZHJlblttW2lkeF1dLmNsYWltX29yZGVyLCBjdXJyZW50KSkgLSAxO1xuICAgICAgICBwW2ldID0gbVtzZXFMZW5dICsgMTtcbiAgICAgICAgY29uc3QgbmV3TGVuID0gc2VxTGVuICsgMTtcbiAgICAgICAgLy8gV2UgY2FuIGd1YXJhbnRlZSB0aGF0IGN1cnJlbnQgaXMgdGhlIHNtYWxsZXN0IHZhbHVlLiBPdGhlcndpc2UsIHdlIHdvdWxkIGhhdmUgZ2VuZXJhdGVkIGEgbG9uZ2VyIHNlcXVlbmNlLlxuICAgICAgICBtW25ld0xlbl0gPSBpO1xuICAgICAgICBsb25nZXN0ID0gTWF0aC5tYXgobmV3TGVuLCBsb25nZXN0KTtcbiAgICB9XG4gICAgLy8gVGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBub2RlcyAoaW5pdGlhbGx5IHJldmVyc2VkKVxuICAgIGNvbnN0IGxpcyA9IFtdO1xuICAgIC8vIFRoZSByZXN0IG9mIHRoZSBub2Rlcywgbm9kZXMgdGhhdCB3aWxsIGJlIG1vdmVkXG4gICAgY29uc3QgdG9Nb3ZlID0gW107XG4gICAgbGV0IGxhc3QgPSBjaGlsZHJlbi5sZW5ndGggLSAxO1xuICAgIGZvciAobGV0IGN1ciA9IG1bbG9uZ2VzdF0gKyAxOyBjdXIgIT0gMDsgY3VyID0gcFtjdXIgLSAxXSkge1xuICAgICAgICBsaXMucHVzaChjaGlsZHJlbltjdXIgLSAxXSk7XG4gICAgICAgIGZvciAoOyBsYXN0ID49IGN1cjsgbGFzdC0tKSB7XG4gICAgICAgICAgICB0b01vdmUucHVzaChjaGlsZHJlbltsYXN0XSk7XG4gICAgICAgIH1cbiAgICAgICAgbGFzdC0tO1xuICAgIH1cbiAgICBmb3IgKDsgbGFzdCA+PSAwOyBsYXN0LS0pIHtcbiAgICAgICAgdG9Nb3ZlLnB1c2goY2hpbGRyZW5bbGFzdF0pO1xuICAgIH1cbiAgICBsaXMucmV2ZXJzZSgpO1xuICAgIC8vIFdlIHNvcnQgdGhlIG5vZGVzIGJlaW5nIG1vdmVkIHRvIGd1YXJhbnRlZSB0aGF0IHRoZWlyIGluc2VydGlvbiBvcmRlciBtYXRjaGVzIHRoZSBjbGFpbSBvcmRlclxuICAgIHRvTW92ZS5zb3J0KChhLCBiKSA9PiBhLmNsYWltX29yZGVyIC0gYi5jbGFpbV9vcmRlcik7XG4gICAgLy8gRmluYWxseSwgd2UgbW92ZSB0aGUgbm9kZXNcbiAgICBmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPCB0b01vdmUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgd2hpbGUgKGogPCBsaXMubGVuZ3RoICYmIHRvTW92ZVtpXS5jbGFpbV9vcmRlciA+PSBsaXNbal0uY2xhaW1fb3JkZXIpIHtcbiAgICAgICAgICAgIGorKztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbmNob3IgPSBqIDwgbGlzLmxlbmd0aCA/IGxpc1tqXSA6IG51bGw7XG4gICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUodG9Nb3ZlW2ldLCBhbmNob3IpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFwcGVuZCh0YXJnZXQsIG5vZGUpIHtcbiAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfc3R5bGVzKHRhcmdldCwgc3R5bGVfc2hlZXRfaWQsIHN0eWxlcykge1xuICAgIGNvbnN0IGFwcGVuZF9zdHlsZXNfdG8gPSBnZXRfcm9vdF9mb3Jfc3R5bGUodGFyZ2V0KTtcbiAgICBpZiAoIWFwcGVuZF9zdHlsZXNfdG8uZ2V0RWxlbWVudEJ5SWQoc3R5bGVfc2hlZXRfaWQpKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gZWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgc3R5bGUuaWQgPSBzdHlsZV9zaGVldF9pZDtcbiAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBzdHlsZXM7XG4gICAgICAgIGFwcGVuZF9zdHlsZXNoZWV0KGFwcGVuZF9zdHlsZXNfdG8sIHN0eWxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSkge1xuICAgIGlmICghbm9kZSlcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgIGNvbnN0IHJvb3QgPSBub2RlLmdldFJvb3ROb2RlID8gbm9kZS5nZXRSb290Tm9kZSgpIDogbm9kZS5vd25lckRvY3VtZW50O1xuICAgIGlmIChyb290ICYmIHJvb3QuaG9zdCkge1xuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGUub3duZXJEb2N1bWVudDtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0KG5vZGUpIHtcbiAgICBjb25zdCBzdHlsZV9lbGVtZW50ID0gZWxlbWVudCgnc3R5bGUnKTtcbiAgICBhcHBlbmRfc3R5bGVzaGVldChnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSksIHN0eWxlX2VsZW1lbnQpO1xuICAgIHJldHVybiBzdHlsZV9lbGVtZW50LnNoZWV0O1xufVxuZnVuY3Rpb24gYXBwZW5kX3N0eWxlc2hlZXQobm9kZSwgc3R5bGUpIHtcbiAgICBhcHBlbmQobm9kZS5oZWFkIHx8IG5vZGUsIHN0eWxlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKSB7XG4gICAgaWYgKGlzX2h5ZHJhdGluZykge1xuICAgICAgICBpbml0X2h5ZHJhdGUodGFyZ2V0KTtcbiAgICAgICAgaWYgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9PT0gdW5kZWZpbmVkKSB8fCAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkICE9PSBudWxsKSAmJiAodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQucGFyZW50RWxlbWVudCAhPT0gdGFyZ2V0KSkpIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2tpcCBub2RlcyBvZiB1bmRlZmluZWQgb3JkZXJpbmdcbiAgICAgICAgd2hpbGUgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCAhPT0gbnVsbCkgJiYgKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLmNsYWltX29yZGVyID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLm5leHRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlICE9PSB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCkge1xuICAgICAgICAgICAgLy8gV2Ugb25seSBpbnNlcnQgaWYgdGhlIG9yZGVyaW5nIG9mIHRoaXMgbm9kZSBzaG91bGQgYmUgbW9kaWZpZWQgb3IgdGhlIHBhcmVudCBub2RlIGlzIG5vdCB0YXJnZXRcbiAgICAgICAgICAgIGlmIChub2RlLmNsYWltX29yZGVyICE9PSB1bmRlZmluZWQgfHwgbm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCB8fCBub2RlLm5leHRTaWJsaW5nICE9PSBudWxsKSB7XG4gICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIGFuY2hvciB8fCBudWxsKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9oeWRyYXRpb24odGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBpZiAoaXNfaHlkcmF0aW5nICYmICFhbmNob3IpIHtcbiAgICAgICAgYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpO1xuICAgIH1cbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCB8fCBub2RlLm5leHRTaWJsaW5nICE9IGFuY2hvcikge1xuICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIGFuY2hvciB8fCBudWxsKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2gobm9kZSkge1xuICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfZWFjaChpdGVyYXRpb25zLCBkZXRhY2hpbmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGl0ZXJhdGlvbnNbaV0pXG4gICAgICAgICAgICBpdGVyYXRpb25zW2ldLmQoZGV0YWNoaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTtcbn1cbmZ1bmN0aW9uIGVsZW1lbnRfaXMobmFtZSwgaXMpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lLCB7IGlzIH0pO1xufVxuZnVuY3Rpb24gb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcyhvYmosIGV4Y2x1ZGUpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgICAgIGlmIChoYXNfcHJvcChvYmosIGspXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAmJiBleGNsdWRlLmluZGV4T2YoaykgPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICB0YXJnZXRba10gPSBvYmpba107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIHN2Z19lbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIG5hbWUpO1xufVxuZnVuY3Rpb24gdGV4dChkYXRhKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRhdGEpO1xufVxuZnVuY3Rpb24gc3BhY2UoKSB7XG4gICAgcmV0dXJuIHRleHQoJyAnKTtcbn1cbmZ1bmN0aW9uIGVtcHR5KCkge1xuICAgIHJldHVybiB0ZXh0KCcnKTtcbn1cbmZ1bmN0aW9uIGxpc3Rlbihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgcmV0dXJuICgpID0+IG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG59XG5mdW5jdGlvbiBwcmV2ZW50X2RlZmF1bHQoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzdG9wX3Byb3BhZ2F0aW9uKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNlbGYoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcylcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiB0cnVzdGVkKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC5pc1RydXN0ZWQpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgZWxzZSBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSAhPT0gdmFsdWUpXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0X2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBkZXNjcmlwdG9ycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG5vZGUuX19wcm90b19fKTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2tleV0gPT0gbnVsbCkge1xuICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdfX3ZhbHVlJykge1xuICAgICAgICAgICAgbm9kZS52YWx1ZSA9IG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yc1trZXldICYmIGRlc2NyaXB0b3JzW2tleV0uc2V0KSB7XG4gICAgICAgICAgICBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdmdfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YShub2RlLCBwcm9wLCB2YWx1ZSkge1xuICAgIGlmIChwcm9wIGluIG5vZGUpIHtcbiAgICAgICAgbm9kZVtwcm9wXSA9IHR5cGVvZiBub2RlW3Byb3BdID09PSAnYm9vbGVhbicgJiYgdmFsdWUgPT09ICcnID8gdHJ1ZSA6IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXR0cihub2RlLCBwcm9wLCB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24geGxpbmtfYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUoZ3JvdXAsIF9fdmFsdWUsIGNoZWNrZWQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChncm91cFtpXS5jaGVja2VkKVxuICAgICAgICAgICAgdmFsdWUuYWRkKGdyb3VwW2ldLl9fdmFsdWUpO1xuICAgIH1cbiAgICBpZiAoIWNoZWNrZWQpIHtcbiAgICAgICAgdmFsdWUuZGVsZXRlKF9fdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbSh2YWx1ZSk7XG59XG5mdW5jdGlvbiB0b19udW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6ICt2YWx1ZTtcbn1cbmZ1bmN0aW9uIHRpbWVfcmFuZ2VzX3RvX2FycmF5KHJhbmdlcykge1xuICAgIGNvbnN0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYXJyYXkucHVzaCh7IHN0YXJ0OiByYW5nZXMuc3RhcnQoaSksIGVuZDogcmFuZ2VzLmVuZChpKSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gY2hpbGRyZW4oZWxlbWVudCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2Rlcyk7XG59XG5mdW5jdGlvbiBpbml0X2NsYWltX2luZm8obm9kZXMpIHtcbiAgICBpZiAobm9kZXMuY2xhaW1faW5mbyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5vZGVzLmNsYWltX2luZm8gPSB7IGxhc3RfaW5kZXg6IDAsIHRvdGFsX2NsYWltZWQ6IDAgfTtcbiAgICB9XG59XG5mdW5jdGlvbiBjbGFpbV9ub2RlKG5vZGVzLCBwcmVkaWNhdGUsIHByb2Nlc3NOb2RlLCBjcmVhdGVOb2RlLCBkb250VXBkYXRlTGFzdEluZGV4ID0gZmFsc2UpIHtcbiAgICAvLyBUcnkgdG8gZmluZCBub2RlcyBpbiBhbiBvcmRlciBzdWNoIHRoYXQgd2UgbGVuZ3RoZW4gdGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZVxuICAgIGluaXRfY2xhaW1faW5mbyhub2Rlcyk7XG4gICAgY29uc3QgcmVzdWx0Tm9kZSA9ICgoKSA9PiB7XG4gICAgICAgIC8vIFdlIGZpcnN0IHRyeSB0byBmaW5kIGFuIGVsZW1lbnQgYWZ0ZXIgdGhlIHByZXZpb3VzIG9uZVxuICAgICAgICBmb3IgKGxldCBpID0gbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4OyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHByb2Nlc3NOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldID0gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9udFVwZGF0ZUxhc3RJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPdGhlcndpc2UsIHdlIHRyeSB0byBmaW5kIG9uZSBiZWZvcmVcbiAgICAgICAgLy8gV2UgaXRlcmF0ZSBpbiByZXZlcnNlIHNvIHRoYXQgd2UgZG9uJ3QgZ28gdG9vIGZhciBiYWNrXG4gICAgICAgIGZvciAobGV0IGkgPSBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gcHJvY2Vzc05vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFkb250VXBkYXRlTGFzdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2Ugd2Ugc3BsaWNlZCBiZWZvcmUgdGhlIGxhc3RfaW5kZXgsIHdlIGRlY3JlYXNlIGl0XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSBjYW4ndCBmaW5kIGFueSBtYXRjaGluZyBub2RlLCB3ZSBjcmVhdGUgYSBuZXcgb25lXG4gICAgICAgIHJldHVybiBjcmVhdGVOb2RlKCk7XG4gICAgfSkoKTtcbiAgICByZXN1bHROb2RlLmNsYWltX29yZGVyID0gbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkO1xuICAgIG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZCArPSAxO1xuICAgIHJldHVybiByZXN1bHROb2RlO1xufVxuZnVuY3Rpb24gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBjcmVhdGVfZWxlbWVudCkge1xuICAgIHJldHVybiBjbGFpbV9ub2RlKG5vZGVzLCAobm9kZSkgPT4gbm9kZS5ub2RlTmFtZSA9PT0gbmFtZSwgKG5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVtb3ZlID0gW107XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbm9kZS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBub2RlLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZXNbYXR0cmlidXRlLm5hbWVdKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlLnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlbW92ZS5mb3JFYWNoKHYgPT4gbm9kZS5yZW1vdmVBdHRyaWJ1dGUodikpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0sICgpID0+IGNyZWF0ZV9lbGVtZW50KG5hbWUpKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnQobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBlbGVtZW50KTtcbn1cbmZ1bmN0aW9uIGNsYWltX3N2Z19lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgc3ZnX2VsZW1lbnQpO1xufVxuZnVuY3Rpb24gY2xhaW1fdGV4dChub2RlcywgZGF0YSkge1xuICAgIHJldHVybiBjbGFpbV9ub2RlKG5vZGVzLCAobm9kZSkgPT4gbm9kZS5ub2RlVHlwZSA9PT0gMywgKG5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YVN0ciA9ICcnICsgZGF0YTtcbiAgICAgICAgaWYgKG5vZGUuZGF0YS5zdGFydHNXaXRoKGRhdGFTdHIpKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhLmxlbmd0aCAhPT0gZGF0YVN0ci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5zcGxpdFRleHQoZGF0YVN0ci5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gZGF0YVN0cjtcbiAgICAgICAgfVxuICAgIH0sICgpID0+IHRleHQoZGF0YSksIHRydWUgLy8gVGV4dCBub2RlcyBzaG91bGQgbm90IHVwZGF0ZSBsYXN0IGluZGV4IHNpbmNlIGl0IGlzIGxpa2VseSBub3Qgd29ydGggaXQgdG8gZWxpbWluYXRlIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgYWN0dWFsIGVsZW1lbnRzXG4gICAgKTtcbn1cbmZ1bmN0aW9uIGNsYWltX3NwYWNlKG5vZGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX3RleHQobm9kZXMsICcgJyk7XG59XG5mdW5jdGlvbiBmaW5kX2NvbW1lbnQobm9kZXMsIHRleHQsIHN0YXJ0KSB7XG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgbm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gOCAvKiBjb21tZW50IG5vZGUgKi8gJiYgbm9kZS50ZXh0Q29udGVudC50cmltKCkgPT09IHRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBub2Rlcy5sZW5ndGg7XG59XG5mdW5jdGlvbiBjbGFpbV9odG1sX3RhZyhub2RlcywgaXNfc3ZnKSB7XG4gICAgLy8gZmluZCBodG1sIG9wZW5pbmcgdGFnXG4gICAgY29uc3Qgc3RhcnRfaW5kZXggPSBmaW5kX2NvbW1lbnQobm9kZXMsICdIVE1MX1RBR19TVEFSVCcsIDApO1xuICAgIGNvbnN0IGVuZF9pbmRleCA9IGZpbmRfY29tbWVudChub2RlcywgJ0hUTUxfVEFHX0VORCcsIHN0YXJ0X2luZGV4KTtcbiAgICBpZiAoc3RhcnRfaW5kZXggPT09IGVuZF9pbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IEh0bWxUYWdIeWRyYXRpb24odW5kZWZpbmVkLCBpc19zdmcpO1xuICAgIH1cbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IGh0bWxfdGFnX25vZGVzID0gbm9kZXMuc3BsaWNlKHN0YXJ0X2luZGV4LCBlbmRfaW5kZXggLSBzdGFydF9pbmRleCArIDEpO1xuICAgIGRldGFjaChodG1sX3RhZ19ub2Rlc1swXSk7XG4gICAgZGV0YWNoKGh0bWxfdGFnX25vZGVzW2h0bWxfdGFnX25vZGVzLmxlbmd0aCAtIDFdKTtcbiAgICBjb25zdCBjbGFpbWVkX25vZGVzID0gaHRtbF90YWdfbm9kZXMuc2xpY2UoMSwgaHRtbF90YWdfbm9kZXMubGVuZ3RoIC0gMSk7XG4gICAgZm9yIChjb25zdCBuIG9mIGNsYWltZWRfbm9kZXMpIHtcbiAgICAgICAgbi5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICAgICAgbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkICs9IDE7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbihjbGFpbWVkX25vZGVzLCBpc19zdmcpO1xufVxuZnVuY3Rpb24gc2V0X2RhdGEodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ICE9PSBkYXRhKVxuICAgICAgICB0ZXh0LmRhdGEgPSBkYXRhO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3ZhbHVlKGlucHV0LCB2YWx1ZSkge1xuICAgIGlucHV0LnZhbHVlID0gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdHlwZShpbnB1dCwgdHlwZSkge1xuICAgIHRyeSB7XG4gICAgICAgIGlucHV0LnR5cGUgPSB0eXBlO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X3N0eWxlKG5vZGUsIGtleSwgdmFsdWUsIGltcG9ydGFudCkge1xuICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICBub2RlLnN0eWxlLnJlbW92ZVByb3BlcnR5KGtleSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBub2RlLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsdWUsIGltcG9ydGFudCA/ICdpbXBvcnRhbnQnIDogJycpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb24oc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIGlmIChvcHRpb24uX192YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0LnNlbGVjdGVkSW5kZXggPSAtMTsgLy8gbm8gb3B0aW9uIHNob3VsZCBiZSBzZWxlY3RlZFxufVxuZnVuY3Rpb24gc2VsZWN0X29wdGlvbnMoc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IH52YWx1ZS5pbmRleE9mKG9wdGlvbi5fX3ZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3RfdmFsdWUoc2VsZWN0KSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRfb3B0aW9uID0gc2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJzpjaGVja2VkJykgfHwgc2VsZWN0Lm9wdGlvbnNbMF07XG4gICAgcmV0dXJuIHNlbGVjdGVkX29wdGlvbiAmJiBzZWxlY3RlZF9vcHRpb24uX192YWx1ZTtcbn1cbmZ1bmN0aW9uIHNlbGVjdF9tdWx0aXBsZV92YWx1ZShzZWxlY3QpIHtcbiAgICByZXR1cm4gW10ubWFwLmNhbGwoc2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJzpjaGVja2VkJyksIG9wdGlvbiA9PiBvcHRpb24uX192YWx1ZSk7XG59XG4vLyB1bmZvcnR1bmF0ZWx5IHRoaXMgY2FuJ3QgYmUgYSBjb25zdGFudCBhcyB0aGF0IHdvdWxkbid0IGJlIHRyZWUtc2hha2VhYmxlXG4vLyBzbyB3ZSBjYWNoZSB0aGUgcmVzdWx0IGluc3RlYWRcbmxldCBjcm9zc29yaWdpbjtcbmZ1bmN0aW9uIGlzX2Nyb3Nzb3JpZ2luKCkge1xuICAgIGlmIChjcm9zc29yaWdpbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNyb3Nzb3JpZ2luID0gZmFsc2U7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHZvaWQgd2luZG93LnBhcmVudC5kb2N1bWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNyb3Nzb3JpZ2luID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3Jvc3NvcmlnaW47XG59XG5mdW5jdGlvbiBhZGRfcmVzaXplX2xpc3RlbmVyKG5vZGUsIGZuKSB7XG4gICAgY29uc3QgY29tcHV0ZWRfc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgIGlmIChjb21wdXRlZF9zdHlsZS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgfVxuICAgIGNvbnN0IGlmcmFtZSA9IGVsZW1lbnQoJ2lmcmFtZScpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMDsgbGVmdDogMDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgJyArXG4gICAgICAgICdvdmVyZmxvdzogaGlkZGVuOyBib3JkZXI6IDA7IG9wYWNpdHk6IDA7IHBvaW50ZXItZXZlbnRzOiBub25lOyB6LWluZGV4OiAtMTsnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgaWZyYW1lLnRhYkluZGV4ID0gLTE7XG4gICAgY29uc3QgY3Jvc3NvcmlnaW4gPSBpc19jcm9zc29yaWdpbigpO1xuICAgIGxldCB1bnN1YnNjcmliZTtcbiAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgaWZyYW1lLnNyYyA9IFwiZGF0YTp0ZXh0L2h0bWwsPHNjcmlwdD5vbnJlc2l6ZT1mdW5jdGlvbigpe3BhcmVudC5wb3N0TWVzc2FnZSgwLCcqJyl9PC9zY3JpcHQ+XCI7XG4gICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKHdpbmRvdywgJ21lc3NhZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IGlmcmFtZS5jb250ZW50V2luZG93KVxuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWZyYW1lLnNyYyA9ICdhYm91dDpibGFuayc7XG4gICAgICAgIGlmcmFtZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3RlbihpZnJhbWUuY29udGVudFdpbmRvdywgJ3Jlc2l6ZScsIGZuKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXBwZW5kKG5vZGUsIGlmcmFtZSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHVuc3Vic2NyaWJlICYmIGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGRldGFjaChpZnJhbWUpO1xuICAgIH07XG59XG5mdW5jdGlvbiB0b2dnbGVfY2xhc3MoZWxlbWVudCwgbmFtZSwgdG9nZ2xlKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3RbdG9nZ2xlID8gJ2FkZCcgOiAncmVtb3ZlJ10obmFtZSk7XG59XG5mdW5jdGlvbiBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsLCB7IGJ1YmJsZXMgPSBmYWxzZSwgY2FuY2VsYWJsZSA9IGZhbHNlIH0gPSB7fSkge1xuICAgIGNvbnN0IGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBidWJibGVzLCBjYW5jZWxhYmxlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGlzX3N2ZyA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuaXNfc3ZnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNfc3ZnID0gaXNfc3ZnO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgIH1cbiAgICBtKGh0bWwsIHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBpZiAoIXRoaXMuZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNfc3ZnKVxuICAgICAgICAgICAgICAgIHRoaXMuZSA9IHN2Z19lbGVtZW50KHRhcmdldC5ub2RlTmFtZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5lID0gZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy50ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5jKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaShhbmNob3IpO1xuICAgIH1cbiAgICBoKGh0bWwpIHtcbiAgICAgICAgdGhpcy5lLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHRoaXMubiA9IEFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpO1xuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHAoaHRtbCkge1xuICAgICAgICB0aGlzLmQoKTtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB0aGlzLmkodGhpcy5hKTtcbiAgICB9XG4gICAgZCgpIHtcbiAgICAgICAgdGhpcy5uLmZvckVhY2goZGV0YWNoKTtcbiAgICB9XG59XG5jbGFzcyBIdG1sVGFnSHlkcmF0aW9uIGV4dGVuZHMgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoY2xhaW1lZF9ub2RlcywgaXNfc3ZnID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoaXNfc3ZnKTtcbiAgICAgICAgdGhpcy5lID0gdGhpcy5uID0gbnVsbDtcbiAgICAgICAgdGhpcy5sID0gY2xhaW1lZF9ub2RlcztcbiAgICB9XG4gICAgYyhodG1sKSB7XG4gICAgICAgIGlmICh0aGlzLmwpIHtcbiAgICAgICAgICAgIHRoaXMubiA9IHRoaXMubDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN1cGVyLmMoaHRtbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaShhbmNob3IpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGluc2VydF9oeWRyYXRpb24odGhpcy50LCB0aGlzLm5baV0sIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBhdHRyaWJ1dGVfdG9fb2JqZWN0KGF0dHJpYnV0ZXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHJlc3VsdFthdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzKGVsZW1lbnQpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBlbGVtZW50LmNoaWxkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICByZXN1bHRbbm9kZS5zbG90IHx8ICdkZWZhdWx0J10gPSB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIHdlIG5lZWQgdG8gc3RvcmUgdGhlIGluZm9ybWF0aW9uIGZvciBtdWx0aXBsZSBkb2N1bWVudHMgYmVjYXVzZSBhIFN2ZWx0ZSBhcHBsaWNhdGlvbiBjb3VsZCBhbHNvIGNvbnRhaW4gaWZyYW1lc1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL3N2ZWx0ZWpzL3N2ZWx0ZS9pc3N1ZXMvMzYyNFxuY29uc3QgbWFuYWdlZF9zdHlsZXMgPSBuZXcgTWFwKCk7XG5sZXQgYWN0aXZlID0gMDtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrc2t5YXBwL3N0cmluZy1oYXNoL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5mdW5jdGlvbiBoYXNoKHN0cikge1xuICAgIGxldCBoYXNoID0gNTM4MTtcbiAgICBsZXQgaSA9IHN0ci5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGhhc2ggPj4+IDA7XG59XG5mdW5jdGlvbiBjcmVhdGVfc3R5bGVfaW5mb3JtYXRpb24oZG9jLCBub2RlKSB7XG4gICAgY29uc3QgaW5mbyA9IHsgc3R5bGVzaGVldDogYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQobm9kZSksIHJ1bGVzOiB7fSB9O1xuICAgIG1hbmFnZWRfc3R5bGVzLnNldChkb2MsIGluZm8pO1xuICAgIHJldHVybiBpbmZvO1xufVxuZnVuY3Rpb24gY3JlYXRlX3J1bGUobm9kZSwgYSwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNlLCBmbiwgdWlkID0gMCkge1xuICAgIGNvbnN0IHN0ZXAgPSAxNi42NjYgLyBkdXJhdGlvbjtcbiAgICBsZXQga2V5ZnJhbWVzID0gJ3tcXG4nO1xuICAgIGZvciAobGV0IHAgPSAwOyBwIDw9IDE7IHAgKz0gc3RlcCkge1xuICAgICAgICBjb25zdCB0ID0gYSArIChiIC0gYSkgKiBlYXNlKHApO1xuICAgICAgICBrZXlmcmFtZXMgKz0gcCAqIDEwMCArIGAleyR7Zm4odCwgMSAtIHQpfX1cXG5gO1xuICAgIH1cbiAgICBjb25zdCBydWxlID0ga2V5ZnJhbWVzICsgYDEwMCUgeyR7Zm4oYiwgMSAtIGIpfX1cXG59YDtcbiAgICBjb25zdCBuYW1lID0gYF9fc3ZlbHRlXyR7aGFzaChydWxlKX1fJHt1aWR9YDtcbiAgICBjb25zdCBkb2MgPSBnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSk7XG4gICAgY29uc3QgeyBzdHlsZXNoZWV0LCBydWxlcyB9ID0gbWFuYWdlZF9zdHlsZXMuZ2V0KGRvYykgfHwgY3JlYXRlX3N0eWxlX2luZm9ybWF0aW9uKGRvYywgbm9kZSk7XG4gICAgaWYgKCFydWxlc1tuYW1lXSkge1xuICAgICAgICBydWxlc1tuYW1lXSA9IHRydWU7XG4gICAgICAgIHN0eWxlc2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke25hbWV9ICR7cnVsZX1gLCBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgfVxuICAgIGNvbnN0IGFuaW1hdGlvbiA9IG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnO1xuICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gYCR7YW5pbWF0aW9uID8gYCR7YW5pbWF0aW9ufSwgYCA6ICcnfSR7bmFtZX0gJHtkdXJhdGlvbn1tcyBsaW5lYXIgJHtkZWxheX1tcyAxIGJvdGhgO1xuICAgIGFjdGl2ZSArPSAxO1xuICAgIHJldHVybiBuYW1lO1xufVxuZnVuY3Rpb24gZGVsZXRlX3J1bGUobm9kZSwgbmFtZSkge1xuICAgIGNvbnN0IHByZXZpb3VzID0gKG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnKS5zcGxpdCgnLCAnKTtcbiAgICBjb25zdCBuZXh0ID0gcHJldmlvdXMuZmlsdGVyKG5hbWVcbiAgICAgICAgPyBhbmltID0+IGFuaW0uaW5kZXhPZihuYW1lKSA8IDAgLy8gcmVtb3ZlIHNwZWNpZmljIGFuaW1hdGlvblxuICAgICAgICA6IGFuaW0gPT4gYW5pbS5pbmRleE9mKCdfX3N2ZWx0ZScpID09PSAtMSAvLyByZW1vdmUgYWxsIFN2ZWx0ZSBhbmltYXRpb25zXG4gICAgKTtcbiAgICBjb25zdCBkZWxldGVkID0gcHJldmlvdXMubGVuZ3RoIC0gbmV4dC5sZW5ndGg7XG4gICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBuZXh0LmpvaW4oJywgJyk7XG4gICAgICAgIGFjdGl2ZSAtPSBkZWxldGVkO1xuICAgICAgICBpZiAoIWFjdGl2ZSlcbiAgICAgICAgICAgIGNsZWFyX3J1bGVzKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2xlYXJfcnVsZXMoKSB7XG4gICAgcmFmKCgpID0+IHtcbiAgICAgICAgaWYgKGFjdGl2ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgbWFuYWdlZF9zdHlsZXMuZm9yRWFjaChpbmZvID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgc3R5bGVzaGVldCB9ID0gaW5mbztcbiAgICAgICAgICAgIGxldCBpID0gc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKVxuICAgICAgICAgICAgICAgIHN0eWxlc2hlZXQuZGVsZXRlUnVsZShpKTtcbiAgICAgICAgICAgIGluZm8ucnVsZXMgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1hbmFnZWRfc3R5bGVzLmNsZWFyKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZV9hbmltYXRpb24obm9kZSwgZnJvbSwgZm4sIHBhcmFtcykge1xuICAgIGlmICghZnJvbSlcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgY29uc3QgdG8gPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChmcm9tLmxlZnQgPT09IHRvLmxlZnQgJiYgZnJvbS5yaWdodCA9PT0gdG8ucmlnaHQgJiYgZnJvbS50b3AgPT09IHRvLnRvcCAmJiBmcm9tLmJvdHRvbSA9PT0gdG8uYm90dG9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86IHNob3VsZCB0aGlzIGJlIHNlcGFyYXRlZCBmcm9tIGRlc3RydWN0dXJpbmc/IE9yIHN0YXJ0L2VuZCBhZGRlZCB0byBwdWJsaWMgYXBpIGFuZCBkb2N1bWVudGF0aW9uP1xuICAgIHN0YXJ0OiBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheSwgXG4gICAgLy8gQHRzLWlnbm9yZSB0b2RvOlxuICAgIGVuZCA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbiwgdGljayA9IG5vb3AsIGNzcyB9ID0gZm4obm9kZSwgeyBmcm9tLCB0byB9LCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgIGxldCBuYW1lO1xuICAgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICBuYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMCwgMSwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkZWxheSkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpO1xuICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgaWYgKCFzdGFydGVkICYmIG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnRlZCAmJiBub3cgPj0gZW5kKSB7XG4gICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgc3RvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcnVubmluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBwID0gbm93IC0gc3RhcnRfdGltZTtcbiAgICAgICAgICAgIGNvbnN0IHQgPSAwICsgMSAqIGVhc2luZyhwIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gICAgc3RhcnQoKTtcbiAgICB0aWNrKDAsIDEpO1xuICAgIHJldHVybiBzdG9wO1xufVxuZnVuY3Rpb24gZml4X3Bvc2l0aW9uKG5vZGUpIHtcbiAgICBjb25zdCBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKHN0eWxlLnBvc2l0aW9uICE9PSAnYWJzb2x1dGUnICYmIHN0eWxlLnBvc2l0aW9uICE9PSAnZml4ZWQnKSB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gc3R5bGU7XG4gICAgICAgIGNvbnN0IGEgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9IHdpZHRoO1xuICAgICAgICBub2RlLnN0eWxlLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgYWRkX3RyYW5zZm9ybShub2RlLCBhKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpIHtcbiAgICBjb25zdCBiID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoYS5sZWZ0ICE9PSBiLmxlZnQgfHwgYS50b3AgIT09IGIudG9wKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gc3R5bGUudHJhbnNmb3JtID09PSAnbm9uZScgPyAnJyA6IHN0eWxlLnRyYW5zZm9ybTtcbiAgICAgICAgbm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgJHt0cmFuc2Zvcm19IHRyYW5zbGF0ZSgke2EubGVmdCAtIGIubGVmdH1weCwgJHthLnRvcCAtIGIudG9wfXB4KWA7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudF9jb21wb25lbnQ7XG5mdW5jdGlvbiBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KSB7XG4gICAgY3VycmVudF9jb21wb25lbnQgPSBjb21wb25lbnQ7XG59XG5mdW5jdGlvbiBnZXRfY3VycmVudF9jb21wb25lbnQoKSB7XG4gICAgaWYgKCFjdXJyZW50X2NvbXBvbmVudClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGdW5jdGlvbiBjYWxsZWQgb3V0c2lkZSBjb21wb25lbnQgaW5pdGlhbGl6YXRpb24nKTtcbiAgICByZXR1cm4gY3VycmVudF9jb21wb25lbnQ7XG59XG5mdW5jdGlvbiBiZWZvcmVVcGRhdGUoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5iZWZvcmVfdXBkYXRlLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gb25Nb3VudChmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX21vdW50LnB1c2goZm4pO1xufVxuZnVuY3Rpb24gYWZ0ZXJVcGRhdGUoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5hZnRlcl91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbkRlc3Ryb3koZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5vbl9kZXN0cm95LnB1c2goZm4pO1xufVxuZnVuY3Rpb24gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCkge1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgIHJldHVybiAodHlwZSwgZGV0YWlsLCB7IGNhbmNlbGFibGUgPSBmYWxzZSB9ID0ge30pID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsLCB7IGNhbmNlbGFibGUgfSk7XG4gICAgICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IHtcbiAgICAgICAgICAgICAgICBmbi5jYWxsKGNvbXBvbmVudCwgZXZlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gIWV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNldENvbnRleHQoa2V5LCBjb250ZXh0KSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5zZXQoa2V5LCBjb250ZXh0KTtcbiAgICByZXR1cm4gY29udGV4dDtcbn1cbmZ1bmN0aW9uIGdldENvbnRleHQoa2V5KSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuZ2V0KGtleSk7XG59XG5mdW5jdGlvbiBnZXRBbGxDb250ZXh0cygpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dDtcbn1cbmZ1bmN0aW9uIGhhc0NvbnRleHQoa2V5KSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuaGFzKGtleSk7XG59XG4vLyBUT0RPIGZpZ3VyZSBvdXQgaWYgd2Ugc3RpbGwgd2FudCB0byBzdXBwb3J0XG4vLyBzaG9ydGhhbmQgZXZlbnRzLCBvciBpZiB3ZSB3YW50IHRvIGltcGxlbWVudFxuLy8gYSByZWFsIGJ1YmJsaW5nIG1lY2hhbmlzbVxuZnVuY3Rpb24gYnViYmxlKGNvbXBvbmVudCwgZXZlbnQpIHtcbiAgICBjb25zdCBjYWxsYmFja3MgPSBjb21wb25lbnQuJCQuY2FsbGJhY2tzW2V2ZW50LnR5cGVdO1xuICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IGZuLmNhbGwodGhpcywgZXZlbnQpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRpcnR5X2NvbXBvbmVudHMgPSBbXTtcbmNvbnN0IGludHJvcyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcbmNvbnN0IGJpbmRpbmdfY2FsbGJhY2tzID0gW107XG5jb25zdCByZW5kZXJfY2FsbGJhY2tzID0gW107XG5jb25zdCBmbHVzaF9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlc29sdmVkX3Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbmxldCB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzY2hlZHVsZV91cGRhdGUoKSB7XG4gICAgaWYgKCF1cGRhdGVfc2NoZWR1bGVkKSB7XG4gICAgICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlZF9wcm9taXNlLnRoZW4oZmx1c2gpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRpY2soKSB7XG4gICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgcmV0dXJuIHJlc29sdmVkX3Byb21pc2U7XG59XG5mdW5jdGlvbiBhZGRfcmVuZGVyX2NhbGxiYWNrKGZuKSB7XG4gICAgcmVuZGVyX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFkZF9mbHVzaF9jYWxsYmFjayhmbikge1xuICAgIGZsdXNoX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbi8vIGZsdXNoKCkgY2FsbHMgY2FsbGJhY2tzIGluIHRoaXMgb3JkZXI6XG4vLyAxLiBBbGwgYmVmb3JlVXBkYXRlIGNhbGxiYWNrcywgaW4gb3JkZXI6IHBhcmVudHMgYmVmb3JlIGNoaWxkcmVuXG4vLyAyLiBBbGwgYmluZDp0aGlzIGNhbGxiYWNrcywgaW4gcmV2ZXJzZSBvcmRlcjogY2hpbGRyZW4gYmVmb3JlIHBhcmVudHMuXG4vLyAzLiBBbGwgYWZ0ZXJVcGRhdGUgY2FsbGJhY2tzLCBpbiBvcmRlcjogcGFyZW50cyBiZWZvcmUgY2hpbGRyZW4uIEVYQ0VQVFxuLy8gICAgZm9yIGFmdGVyVXBkYXRlcyBjYWxsZWQgZHVyaW5nIHRoZSBpbml0aWFsIG9uTW91bnQsIHdoaWNoIGFyZSBjYWxsZWQgaW5cbi8vICAgIHJldmVyc2Ugb3JkZXI6IGNoaWxkcmVuIGJlZm9yZSBwYXJlbnRzLlxuLy8gU2luY2UgY2FsbGJhY2tzIG1pZ2h0IHVwZGF0ZSBjb21wb25lbnQgdmFsdWVzLCB3aGljaCBjb3VsZCB0cmlnZ2VyIGFub3RoZXJcbi8vIGNhbGwgdG8gZmx1c2goKSwgdGhlIGZvbGxvd2luZyBzdGVwcyBndWFyZCBhZ2FpbnN0IHRoaXM6XG4vLyAxLiBEdXJpbmcgYmVmb3JlVXBkYXRlLCBhbnkgdXBkYXRlZCBjb21wb25lbnRzIHdpbGwgYmUgYWRkZWQgdG8gdGhlXG4vLyAgICBkaXJ0eV9jb21wb25lbnRzIGFycmF5IGFuZCB3aWxsIGNhdXNlIGEgcmVlbnRyYW50IGNhbGwgdG8gZmx1c2goKS4gQmVjYXVzZVxuLy8gICAgdGhlIGZsdXNoIGluZGV4IGlzIGtlcHQgb3V0c2lkZSB0aGUgZnVuY3Rpb24sIHRoZSByZWVudHJhbnQgY2FsbCB3aWxsIHBpY2tcbi8vICAgIHVwIHdoZXJlIHRoZSBlYXJsaWVyIGNhbGwgbGVmdCBvZmYgYW5kIGdvIHRocm91Z2ggYWxsIGRpcnR5IGNvbXBvbmVudHMuIFRoZVxuLy8gICAgY3VycmVudF9jb21wb25lbnQgdmFsdWUgaXMgc2F2ZWQgYW5kIHJlc3RvcmVkIHNvIHRoYXQgdGhlIHJlZW50cmFudCBjYWxsIHdpbGxcbi8vICAgIG5vdCBpbnRlcmZlcmUgd2l0aCB0aGUgXCJwYXJlbnRcIiBmbHVzaCgpIGNhbGwuXG4vLyAyLiBiaW5kOnRoaXMgY2FsbGJhY2tzIGNhbm5vdCB0cmlnZ2VyIG5ldyBmbHVzaCgpIGNhbGxzLlxuLy8gMy4gRHVyaW5nIGFmdGVyVXBkYXRlLCBhbnkgdXBkYXRlZCBjb21wb25lbnRzIHdpbGwgTk9UIGhhdmUgdGhlaXIgYWZ0ZXJVcGRhdGVcbi8vICAgIGNhbGxiYWNrIGNhbGxlZCBhIHNlY29uZCB0aW1lOyB0aGUgc2Vlbl9jYWxsYmFja3Mgc2V0LCBvdXRzaWRlIHRoZSBmbHVzaCgpXG4vLyAgICBmdW5jdGlvbiwgZ3VhcmFudGVlcyB0aGlzIGJlaGF2aW9yLlxuY29uc3Qgc2Vlbl9jYWxsYmFja3MgPSBuZXcgU2V0KCk7XG5sZXQgZmx1c2hpZHggPSAwOyAvLyBEbyAqbm90KiBtb3ZlIHRoaXMgaW5zaWRlIHRoZSBmbHVzaCgpIGZ1bmN0aW9uXG5mdW5jdGlvbiBmbHVzaCgpIHtcbiAgICBjb25zdCBzYXZlZF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBkbyB7XG4gICAgICAgIC8vIGZpcnN0LCBjYWxsIGJlZm9yZVVwZGF0ZSBmdW5jdGlvbnNcbiAgICAgICAgLy8gYW5kIHVwZGF0ZSBjb21wb25lbnRzXG4gICAgICAgIHdoaWxlIChmbHVzaGlkeCA8IGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBkaXJ0eV9jb21wb25lbnRzW2ZsdXNoaWR4XTtcbiAgICAgICAgICAgIGZsdXNoaWR4Kys7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShjb21wb25lbnQuJCQpO1xuICAgICAgICB9XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5sZW5ndGggPSAwO1xuICAgICAgICBmbHVzaGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChiaW5kaW5nX2NhbGxiYWNrcy5sZW5ndGgpXG4gICAgICAgICAgICBiaW5kaW5nX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgICAgICAvLyB0aGVuLCBvbmNlIGNvbXBvbmVudHMgYXJlIHVwZGF0ZWQsIGNhbGxcbiAgICAgICAgLy8gYWZ0ZXJVcGRhdGUgZnVuY3Rpb25zLiBUaGlzIG1heSBjYXVzZVxuICAgICAgICAvLyBzdWJzZXF1ZW50IHVwZGF0ZXMuLi5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IHJlbmRlcl9jYWxsYmFja3NbaV07XG4gICAgICAgICAgICBpZiAoIXNlZW5fY2FsbGJhY2tzLmhhcyhjYWxsYmFjaykpIHtcbiAgICAgICAgICAgICAgICAvLyAuLi5zbyBndWFyZCBhZ2FpbnN0IGluZmluaXRlIGxvb3BzXG4gICAgICAgICAgICAgICAgc2Vlbl9jYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoID0gMDtcbiAgICB9IHdoaWxlIChkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCk7XG4gICAgd2hpbGUgKGZsdXNoX2NhbGxiYWNrcy5sZW5ndGgpIHtcbiAgICAgICAgZmx1c2hfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgfVxuICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSBmYWxzZTtcbiAgICBzZWVuX2NhbGxiYWNrcy5jbGVhcigpO1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChzYXZlZF9jb21wb25lbnQpO1xufVxuZnVuY3Rpb24gdXBkYXRlKCQkKSB7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgICQkLnVwZGF0ZSgpO1xuICAgICAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgICAgICBjb25zdCBkaXJ0eSA9ICQkLmRpcnR5O1xuICAgICAgICAkJC5kaXJ0eSA9IFstMV07XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LnAoJCQuY3R4LCBkaXJ0eSk7XG4gICAgICAgICQkLmFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xuICAgIH1cbn1cblxubGV0IHByb21pc2U7XG5mdW5jdGlvbiB3YWl0KCkge1xuICAgIGlmICghcHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gZGlzcGF0Y2gobm9kZSwgZGlyZWN0aW9uLCBraW5kKSB7XG4gICAgbm9kZS5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudChgJHtkaXJlY3Rpb24gPyAnaW50cm8nIDogJ291dHJvJ30ke2tpbmR9YCkpO1xufVxuY29uc3Qgb3V0cm9pbmcgPSBuZXcgU2V0KCk7XG5sZXQgb3V0cm9zO1xuZnVuY3Rpb24gZ3JvdXBfb3V0cm9zKCkge1xuICAgIG91dHJvcyA9IHtcbiAgICAgICAgcjogMCxcbiAgICAgICAgYzogW10sXG4gICAgICAgIHA6IG91dHJvcyAvLyBwYXJlbnQgZ3JvdXBcbiAgICB9O1xufVxuZnVuY3Rpb24gY2hlY2tfb3V0cm9zKCkge1xuICAgIGlmICghb3V0cm9zLnIpIHtcbiAgICAgICAgcnVuX2FsbChvdXRyb3MuYyk7XG4gICAgfVxuICAgIG91dHJvcyA9IG91dHJvcy5wO1xufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9pbihibG9jaywgbG9jYWwpIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2suaSkge1xuICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICBibG9jay5pKGxvY2FsKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX291dChibG9jaywgbG9jYWwsIGRldGFjaCwgY2FsbGJhY2spIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2subykge1xuICAgICAgICBpZiAob3V0cm9pbmcuaGFzKGJsb2NrKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb3V0cm9pbmcuYWRkKGJsb2NrKTtcbiAgICAgICAgb3V0cm9zLmMucHVzaCgoKSA9PiB7XG4gICAgICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRldGFjaClcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suZCgxKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2subyhsb2NhbCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgfVxufVxuY29uc3QgbnVsbF90cmFuc2l0aW9uID0geyBkdXJhdGlvbjogMCB9O1xuZnVuY3Rpb24gY3JlYXRlX2luX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gZmFsc2U7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCB1aWQgPSAwO1xuICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MsIHVpZCsrKTtcbiAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBpZiAodGFzaylcbiAgICAgICAgICAgIHRhc2suYWJvcnQoKTtcbiAgICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ3N0YXJ0JykpO1xuICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHRydWUsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGFydCgpIHtcbiAgICAgICAgICAgIGlmIChzdGFydGVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSk7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKGdvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGludmFsaWRhdGUoKSB7XG4gICAgICAgICAgICBzdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfb3V0X3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgY29uc3QgZ3JvdXAgPSBvdXRyb3M7XG4gICAgZ3JvdXAuciArPSAxO1xuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAxLCAwLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnc3RhcnQnKSk7XG4gICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIS0tZ3JvdXAucikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJlc3VsdCBpbiBgZW5kKClgIGJlaW5nIGNhbGxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIGRvbid0IG5lZWQgdG8gY2xlYW4gdXAgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxIC0gdCwgdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgIGdvKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZ28oKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZW5kKHJlc2V0KSB7XG4gICAgICAgICAgICBpZiAocmVzZXQgJiYgY29uZmlnLnRpY2spIHtcbiAgICAgICAgICAgICAgICBjb25maWcudGljaygxLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcywgaW50cm8pIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgdCA9IGludHJvID8gMCA6IDE7XG4gICAgbGV0IHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lID0gbnVsbDtcbiAgICBmdW5jdGlvbiBjbGVhcl9hbmltYXRpb24oKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5pdChwcm9ncmFtLCBkdXJhdGlvbikge1xuICAgICAgICBjb25zdCBkID0gKHByb2dyYW0uYiAtIHQpO1xuICAgICAgICBkdXJhdGlvbiAqPSBNYXRoLmFicyhkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGE6IHQsXG4gICAgICAgICAgICBiOiBwcm9ncmFtLmIsXG4gICAgICAgICAgICBkLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzdGFydDogcHJvZ3JhbS5zdGFydCxcbiAgICAgICAgICAgIGVuZDogcHJvZ3JhbS5zdGFydCArIGR1cmF0aW9uLFxuICAgICAgICAgICAgZ3JvdXA6IHByb2dyYW0uZ3JvdXBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oYikge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG5vdygpICsgZGVsYXksXG4gICAgICAgICAgICBiXG4gICAgICAgIH07XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIHByb2dyYW0uZ3JvdXAgPSBvdXRyb3M7XG4gICAgICAgICAgICBvdXRyb3MuciArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbnRybywgYW5kIHRoZXJlJ3MgYSBkZWxheSwgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgLy8gYW4gaW5pdGlhbCB0aWNrIGFuZC9vciBhcHBseSBDU1MgYW5pbWF0aW9uIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiKVxuICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHByb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgYiwgJ3N0YXJ0JykpO1xuICAgICAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nX3Byb2dyYW0gJiYgbm93ID4gcGVuZGluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocGVuZGluZ19wcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnc3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIHJ1bm5pbmdfcHJvZ3JhbS5iLCBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24sIDAsIGVhc2luZywgY29uZmlnLmNzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5lbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCA9IHJ1bm5pbmdfcHJvZ3JhbS5iLCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbS5iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludHJvIOKAlCB3ZSBjYW4gdGlkeSB1cCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG91dHJvIOKAlCBuZWVkcyB0byBiZSBjb29yZGluYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIS0tcnVubmluZ19wcm9ncmFtLmdyb3VwLnIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKHJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBydW5uaW5nX3Byb2dyYW0uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcnVubmluZ19wcm9ncmFtLmEgKyBydW5uaW5nX3Byb2dyYW0uZCAqIGVhc2luZyhwIC8gcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhIShydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJ1bihiKSB7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3Byb21pc2UocHJvbWlzZSwgaW5mbykge1xuICAgIGNvbnN0IHRva2VuID0gaW5mby50b2tlbiA9IHt9O1xuICAgIGZ1bmN0aW9uIHVwZGF0ZSh0eXBlLCBpbmRleCwga2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoaW5mby50b2tlbiAhPT0gdG9rZW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSB2YWx1ZTtcbiAgICAgICAgbGV0IGNoaWxkX2N0eCA9IGluZm8uY3R4O1xuICAgICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNoaWxkX2N0eCA9IGNoaWxkX2N0eC5zbGljZSgpO1xuICAgICAgICAgICAgY2hpbGRfY3R4W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgJiYgKGluZm8uY3VycmVudCA9IHR5cGUpKGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBuZWVkc19mbHVzaCA9IGZhbHNlO1xuICAgICAgICBpZiAoaW5mby5ibG9jaykge1xuICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IGluZGV4ICYmIGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzW2ldID09PSBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrc1tpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja19vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9jay5kKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgICAgICBibG9jay5tKGluZm8ubW91bnQoKSwgaW5mby5hbmNob3IpO1xuICAgICAgICAgICAgbmVlZHNfZmx1c2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uYmxvY2sgPSBibG9jaztcbiAgICAgICAgaWYgKGluZm8uYmxvY2tzKVxuICAgICAgICAgICAgaW5mby5ibG9ja3NbaW5kZXhdID0gYmxvY2s7XG4gICAgICAgIGlmIChuZWVkc19mbHVzaCkge1xuICAgICAgICAgICAgZmx1c2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNfcHJvbWlzZShwcm9taXNlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50X2NvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgICAgICBwcm9taXNlLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLmNhdGNoLCAyLCBpbmZvLmVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgICAgICBpZiAoIWluZm8uaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGlmIHdlIHByZXZpb3VzbHkgaGFkIGEgdGhlbi9jYXRjaCBibG9jaywgZGVzdHJveSBpdFxuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnBlbmRpbmcsIDApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8udGhlbikge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLnJlc29sdmVkID0gcHJvbWlzZTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoKGluZm8sIGN0eCwgZGlydHkpIHtcbiAgICBjb25zdCBjaGlsZF9jdHggPSBjdHguc2xpY2UoKTtcbiAgICBjb25zdCB7IHJlc29sdmVkIH0gPSBpbmZvO1xuICAgIGlmIChpbmZvLmN1cnJlbnQgPT09IGluZm8udGhlbikge1xuICAgICAgICBjaGlsZF9jdHhbaW5mby52YWx1ZV0gPSByZXNvbHZlZDtcbiAgICB9XG4gICAgaWYgKGluZm8uY3VycmVudCA9PT0gaW5mby5jYXRjaCkge1xuICAgICAgICBjaGlsZF9jdHhbaW5mby5lcnJvcl0gPSByZXNvbHZlZDtcbiAgICB9XG4gICAgaW5mby5ibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xufVxuXG5jb25zdCBnbG9iYWxzID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgPyB3aW5kb3dcbiAgICA6IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IGdsb2JhbFRoaXNcbiAgICAgICAgOiBnbG9iYWwpO1xuXG5mdW5jdGlvbiBkZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5kKDEpO1xuICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbn1cbmZ1bmN0aW9uIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICB0cmFuc2l0aW9uX291dChibG9jaywgMSwgMSwgKCkgPT4ge1xuICAgICAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBkZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApO1xufVxuZnVuY3Rpb24gZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApO1xufVxuZnVuY3Rpb24gdXBkYXRlX2tleWVkX2VhY2gob2xkX2Jsb2NrcywgZGlydHksIGdldF9rZXksIGR5bmFtaWMsIGN0eCwgbGlzdCwgbG9va3VwLCBub2RlLCBkZXN0cm95LCBjcmVhdGVfZWFjaF9ibG9jaywgbmV4dCwgZ2V0X2NvbnRleHQpIHtcbiAgICBsZXQgbyA9IG9sZF9ibG9ja3MubGVuZ3RoO1xuICAgIGxldCBuID0gbGlzdC5sZW5ndGg7XG4gICAgbGV0IGkgPSBvO1xuICAgIGNvbnN0IG9sZF9pbmRleGVzID0ge307XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgb2xkX2luZGV4ZXNbb2xkX2Jsb2Nrc1tpXS5rZXldID0gaTtcbiAgICBjb25zdCBuZXdfYmxvY2tzID0gW107XG4gICAgY29uc3QgbmV3X2xvb2t1cCA9IG5ldyBNYXAoKTtcbiAgICBjb25zdCBkZWx0YXMgPSBuZXcgTWFwKCk7XG4gICAgaSA9IG47XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBjaGlsZF9jdHggPSBnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpO1xuICAgICAgICBjb25zdCBrZXkgPSBnZXRfa2V5KGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBibG9jayA9IGxvb2t1cC5nZXQoa2V5KTtcbiAgICAgICAgaWYgKCFibG9jaykge1xuICAgICAgICAgICAgYmxvY2sgPSBjcmVhdGVfZWFjaF9ibG9jayhrZXksIGNoaWxkX2N0eCk7XG4gICAgICAgICAgICBibG9jay5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgYmxvY2sucChjaGlsZF9jdHgsIGRpcnR5KTtcbiAgICAgICAgfVxuICAgICAgICBuZXdfbG9va3VwLnNldChrZXksIG5ld19ibG9ja3NbaV0gPSBibG9jayk7XG4gICAgICAgIGlmIChrZXkgaW4gb2xkX2luZGV4ZXMpXG4gICAgICAgICAgICBkZWx0YXMuc2V0KGtleSwgTWF0aC5hYnMoaSAtIG9sZF9pbmRleGVzW2tleV0pKTtcbiAgICB9XG4gICAgY29uc3Qgd2lsbF9tb3ZlID0gbmV3IFNldCgpO1xuICAgIGNvbnN0IGRpZF9tb3ZlID0gbmV3IFNldCgpO1xuICAgIGZ1bmN0aW9uIGluc2VydChibG9jaykge1xuICAgICAgICB0cmFuc2l0aW9uX2luKGJsb2NrLCAxKTtcbiAgICAgICAgYmxvY2subShub2RlLCBuZXh0KTtcbiAgICAgICAgbG9va3VwLnNldChibG9jay5rZXksIGJsb2NrKTtcbiAgICAgICAgbmV4dCA9IGJsb2NrLmZpcnN0O1xuICAgICAgICBuLS07XG4gICAgfVxuICAgIHdoaWxlIChvICYmIG4pIHtcbiAgICAgICAgY29uc3QgbmV3X2Jsb2NrID0gbmV3X2Jsb2Nrc1tuIC0gMV07XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3NbbyAtIDFdO1xuICAgICAgICBjb25zdCBuZXdfa2V5ID0gbmV3X2Jsb2NrLmtleTtcbiAgICAgICAgY29uc3Qgb2xkX2tleSA9IG9sZF9ibG9jay5rZXk7XG4gICAgICAgIGlmIChuZXdfYmxvY2sgPT09IG9sZF9ibG9jaykge1xuICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgbmV4dCA9IG5ld19ibG9jay5maXJzdDtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgICAgIG4tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgYmxvY2tcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFsb29rdXAuaGFzKG5ld19rZXkpIHx8IHdpbGxfbW92ZS5oYXMobmV3X2tleSkpIHtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRpZF9tb3ZlLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlbHRhcy5nZXQobmV3X2tleSkgPiBkZWx0YXMuZ2V0KG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBkaWRfbW92ZS5hZGQobmV3X2tleSk7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdpbGxfbW92ZS5hZGQob2xkX2tleSk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICB9XG4gICAgd2hpbGUgKG8tLSkge1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW29dO1xuICAgICAgICBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9ibG9jay5rZXkpKVxuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgfVxuICAgIHdoaWxlIChuKVxuICAgICAgICBpbnNlcnQobmV3X2Jsb2Nrc1tuIC0gMV0pO1xuICAgIHJldHVybiBuZXdfYmxvY2tzO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfZWFjaF9rZXlzKGN0eCwgbGlzdCwgZ2V0X2NvbnRleHQsIGdldF9rZXkpIHtcbiAgICBjb25zdCBrZXlzID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSBnZXRfa2V5KGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSkpO1xuICAgICAgICBpZiAoa2V5cy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaGF2ZSBkdXBsaWNhdGUga2V5cyBpbiBhIGtleWVkIGVhY2gnKTtcbiAgICAgICAgfVxuICAgICAgICBrZXlzLmFkZChrZXkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0X3NwcmVhZF91cGRhdGUobGV2ZWxzLCB1cGRhdGVzKSB7XG4gICAgY29uc3QgdXBkYXRlID0ge307XG4gICAgY29uc3QgdG9fbnVsbF9vdXQgPSB7fTtcbiAgICBjb25zdCBhY2NvdW50ZWRfZm9yID0geyAkJHNjb3BlOiAxIH07XG4gICAgbGV0IGkgPSBsZXZlbHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgbyA9IGxldmVsc1tpXTtcbiAgICAgICAgY29uc3QgbiA9IHVwZGF0ZXNbaV07XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIG4pKVxuICAgICAgICAgICAgICAgICAgICB0b19udWxsX291dFtrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFjY291bnRlZF9mb3Jba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVba2V5XSA9IG5ba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXZlbHNbaV0gPSBuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdG9fbnVsbF9vdXQpIHtcbiAgICAgICAgaWYgKCEoa2V5IGluIHVwZGF0ZSkpXG4gICAgICAgICAgICB1cGRhdGVba2V5XSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZTtcbn1cbmZ1bmN0aW9uIGdldF9zcHJlYWRfb2JqZWN0KHNwcmVhZF9wcm9wcykge1xuICAgIHJldHVybiB0eXBlb2Ygc3ByZWFkX3Byb3BzID09PSAnb2JqZWN0JyAmJiBzcHJlYWRfcHJvcHMgIT09IG51bGwgPyBzcHJlYWRfcHJvcHMgOiB7fTtcbn1cblxuLy8gc291cmNlOiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9pbmRpY2VzLmh0bWxcbmNvbnN0IGJvb2xlYW5fYXR0cmlidXRlcyA9IG5ldyBTZXQoW1xuICAgICdhbGxvd2Z1bGxzY3JlZW4nLFxuICAgICdhbGxvd3BheW1lbnRyZXF1ZXN0JyxcbiAgICAnYXN5bmMnLFxuICAgICdhdXRvZm9jdXMnLFxuICAgICdhdXRvcGxheScsXG4gICAgJ2NoZWNrZWQnLFxuICAgICdjb250cm9scycsXG4gICAgJ2RlZmF1bHQnLFxuICAgICdkZWZlcicsXG4gICAgJ2Rpc2FibGVkJyxcbiAgICAnZm9ybW5vdmFsaWRhdGUnLFxuICAgICdoaWRkZW4nLFxuICAgICdpc21hcCcsXG4gICAgJ2xvb3AnLFxuICAgICdtdWx0aXBsZScsXG4gICAgJ211dGVkJyxcbiAgICAnbm9tb2R1bGUnLFxuICAgICdub3ZhbGlkYXRlJyxcbiAgICAnb3BlbicsXG4gICAgJ3BsYXlzaW5saW5lJyxcbiAgICAncmVhZG9ubHknLFxuICAgICdyZXF1aXJlZCcsXG4gICAgJ3JldmVyc2VkJyxcbiAgICAnc2VsZWN0ZWQnXG5dKTtcblxuY29uc3Qgdm9pZF9lbGVtZW50X25hbWVzID0gL14oPzphcmVhfGJhc2V8YnJ8Y29sfGNvbW1hbmR8ZW1iZWR8aHJ8aW1nfGlucHV0fGtleWdlbnxsaW5rfG1ldGF8cGFyYW18c291cmNlfHRyYWNrfHdicikkLztcbmZ1bmN0aW9uIGlzX3ZvaWQobmFtZSkge1xuICAgIHJldHVybiB2b2lkX2VsZW1lbnRfbmFtZXMudGVzdChuYW1lKSB8fCBuYW1lLnRvTG93ZXJDYXNlKCkgPT09ICchZG9jdHlwZSc7XG59XG5cbmNvbnN0IGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyID0gL1tcXHMnXCI+Lz1cXHV7RkREMH0tXFx1e0ZERUZ9XFx1e0ZGRkV9XFx1e0ZGRkZ9XFx1ezFGRkZFfVxcdXsxRkZGRn1cXHV7MkZGRkV9XFx1ezJGRkZGfVxcdXszRkZGRX1cXHV7M0ZGRkZ9XFx1ezRGRkZFfVxcdXs0RkZGRn1cXHV7NUZGRkV9XFx1ezVGRkZGfVxcdXs2RkZGRX1cXHV7NkZGRkZ9XFx1ezdGRkZFfVxcdXs3RkZGRn1cXHV7OEZGRkV9XFx1ezhGRkZGfVxcdXs5RkZGRX1cXHV7OUZGRkZ9XFx1e0FGRkZFfVxcdXtBRkZGRn1cXHV7QkZGRkV9XFx1e0JGRkZGfVxcdXtDRkZGRX1cXHV7Q0ZGRkZ9XFx1e0RGRkZFfVxcdXtERkZGRn1cXHV7RUZGRkV9XFx1e0VGRkZGfVxcdXtGRkZGRX1cXHV7RkZGRkZ9XFx1ezEwRkZGRX1cXHV7MTBGRkZGfV0vdTtcbi8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMlxuLy8gaHR0cHM6Ly9pbmZyYS5zcGVjLndoYXR3Zy5vcmcvI25vbmNoYXJhY3RlclxuZnVuY3Rpb24gc3ByZWFkKGFyZ3MsIGF0dHJzX3RvX2FkZCkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCAuLi5hcmdzKTtcbiAgICBpZiAoYXR0cnNfdG9fYWRkKSB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXNfdG9fYWRkID0gYXR0cnNfdG9fYWRkLmNsYXNzZXM7XG4gICAgICAgIGNvbnN0IHN0eWxlc190b19hZGQgPSBhdHRyc190b19hZGQuc3R5bGVzO1xuICAgICAgICBpZiAoY2xhc3Nlc190b19hZGQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmNsYXNzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3Nlc190b19hZGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9ICcgJyArIGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzdHlsZXNfdG9fYWRkKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5zdHlsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVzX3RvX2FkZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhtZXJnZV9zc3Jfc3R5bGVzKGF0dHJpYnV0ZXMuc3R5bGUsIHN0eWxlc190b19hZGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgc3RyID0gJyc7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgaWYgKGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLnRlc3QobmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKVxuICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke3ZhbHVlfVwiYDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzdHI7XG59XG5mdW5jdGlvbiBtZXJnZV9zc3Jfc3R5bGVzKHN0eWxlX2F0dHJpYnV0ZSwgc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgY29uc3Qgc3R5bGVfb2JqZWN0ID0ge307XG4gICAgZm9yIChjb25zdCBpbmRpdmlkdWFsX3N0eWxlIG9mIHN0eWxlX2F0dHJpYnV0ZS5zcGxpdCgnOycpKSB7XG4gICAgICAgIGNvbnN0IGNvbG9uX2luZGV4ID0gaW5kaXZpZHVhbF9zdHlsZS5pbmRleE9mKCc6Jyk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSBpbmRpdmlkdWFsX3N0eWxlLnNsaWNlKDAsIGNvbG9uX2luZGV4KS50cmltKCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gaW5kaXZpZHVhbF9zdHlsZS5zbGljZShjb2xvbl9pbmRleCArIDEpLnRyaW0oKTtcbiAgICAgICAgaWYgKCFuYW1lKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gc3R5bGVfZGlyZWN0aXZlW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIHN0eWxlX29iamVjdFtuYW1lXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3R5bGVfb2JqZWN0O1xufVxuY29uc3QgQVRUUl9SRUdFWCA9IC9bJlwiXS9nO1xuY29uc3QgQ09OVEVOVF9SRUdFWCA9IC9bJjxdL2c7XG4vKipcbiAqIE5vdGU6IHRoaXMgbWV0aG9kIGlzIHBlcmZvcm1hbmNlIHNlbnNpdGl2ZSBhbmQgaGFzIGJlZW4gb3B0aW1pemVkXG4gKiBodHRwczovL2dpdGh1Yi5jb20vc3ZlbHRlanMvc3ZlbHRlL3B1bGwvNTcwMVxuICovXG5mdW5jdGlvbiBlc2NhcGUodmFsdWUsIGlzX2F0dHIgPSBmYWxzZSkge1xuICAgIGNvbnN0IHN0ciA9IFN0cmluZyh2YWx1ZSk7XG4gICAgY29uc3QgcGF0dGVybiA9IGlzX2F0dHIgPyBBVFRSX1JFR0VYIDogQ09OVEVOVF9SRUdFWDtcbiAgICBwYXR0ZXJuLmxhc3RJbmRleCA9IDA7XG4gICAgbGV0IGVzY2FwZWQgPSAnJztcbiAgICBsZXQgbGFzdCA9IDA7XG4gICAgd2hpbGUgKHBhdHRlcm4udGVzdChzdHIpKSB7XG4gICAgICAgIGNvbnN0IGkgPSBwYXR0ZXJuLmxhc3RJbmRleCAtIDE7XG4gICAgICAgIGNvbnN0IGNoID0gc3RyW2ldO1xuICAgICAgICBlc2NhcGVkICs9IHN0ci5zdWJzdHJpbmcobGFzdCwgaSkgKyAoY2ggPT09ICcmJyA/ICcmYW1wOycgOiAoY2ggPT09ICdcIicgPyAnJnF1b3Q7JyA6ICcmbHQ7JykpO1xuICAgICAgICBsYXN0ID0gaSArIDE7XG4gICAgfVxuICAgIHJldHVybiBlc2NhcGVkICsgc3RyLnN1YnN0cmluZyhsYXN0KTtcbn1cbmZ1bmN0aW9uIGVzY2FwZV9hdHRyaWJ1dGVfdmFsdWUodmFsdWUpIHtcbiAgICAvLyBrZWVwIGJvb2xlYW5zLCBudWxsLCBhbmQgdW5kZWZpbmVkIGZvciB0aGUgc2FrZSBvZiBgc3ByZWFkYFxuICAgIGNvbnN0IHNob3VsZF9lc2NhcGUgPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8ICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKTtcbiAgICByZXR1cm4gc2hvdWxkX2VzY2FwZSA/IGVzY2FwZSh2YWx1ZSwgdHJ1ZSkgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGVzY2FwZV9vYmplY3Qob2JqKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZShvYmpba2V5XSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBlYWNoKGl0ZW1zLCBmbikge1xuICAgIGxldCBzdHIgPSAnJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHN0ciArPSBmbihpdGVtc1tpXSwgaSk7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5jb25zdCBtaXNzaW5nX2NvbXBvbmVudCA9IHtcbiAgICAkJHJlbmRlcjogKCkgPT4gJydcbn07XG5mdW5jdGlvbiB2YWxpZGF0ZV9jb21wb25lbnQoY29tcG9uZW50LCBuYW1lKSB7XG4gICAgaWYgKCFjb21wb25lbnQgfHwgIWNvbXBvbmVudC4kJHJlbmRlcikge1xuICAgICAgICBpZiAobmFtZSA9PT0gJ3N2ZWx0ZTpjb21wb25lbnQnKVxuICAgICAgICAgICAgbmFtZSArPSAnIHRoaXM9ey4uLn0nO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDwke25hbWV9PiBpcyBub3QgYSB2YWxpZCBTU1IgY29tcG9uZW50LiBZb3UgbWF5IG5lZWQgdG8gcmV2aWV3IHlvdXIgYnVpbGQgY29uZmlnIHRvIGVuc3VyZSB0aGF0IGRlcGVuZGVuY2llcyBhcmUgY29tcGlsZWQsIHJhdGhlciB0aGFuIGltcG9ydGVkIGFzIHByZS1jb21waWxlZCBtb2R1bGVzYCk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnQ7XG59XG5mdW5jdGlvbiBkZWJ1ZyhmaWxlLCBsaW5lLCBjb2x1bW4sIHZhbHVlcykge1xuICAgIGNvbnNvbGUubG9nKGB7QGRlYnVnfSAke2ZpbGUgPyBmaWxlICsgJyAnIDogJyd9KCR7bGluZX06JHtjb2x1bW59KWApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZyh2YWx1ZXMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICByZXR1cm4gJyc7XG59XG5sZXQgb25fZGVzdHJveTtcbmZ1bmN0aW9uIGNyZWF0ZV9zc3JfY29tcG9uZW50KGZuKSB7XG4gICAgZnVuY3Rpb24gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzLCBjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICAgICAgY29uc3QgJCQgPSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LFxuICAgICAgICAgICAgY29udGV4dDogbmV3IE1hcChjb250ZXh0IHx8IChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pKSxcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgYmUgaW1tZWRpYXRlbHkgZGlzY2FyZGVkXG4gICAgICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudCh7ICQkIH0pO1xuICAgICAgICBjb25zdCBodG1sID0gZm4ocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVuZGVyOiAocHJvcHMgPSB7fSwgeyAkJHNsb3RzID0ge30sIGNvbnRleHQgPSBuZXcgTWFwKCkgfSA9IHt9KSA9PiB7XG4gICAgICAgICAgICBvbl9kZXN0cm95ID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7IHRpdGxlOiAnJywgaGVhZDogJycsIGNzczogbmV3IFNldCgpIH07XG4gICAgICAgICAgICBjb25zdCBodG1sID0gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywge30sICQkc2xvdHMsIGNvbnRleHQpO1xuICAgICAgICAgICAgcnVuX2FsbChvbl9kZXN0cm95KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgICAgICBjc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogQXJyYXkuZnJvbShyZXN1bHQuY3NzKS5tYXAoY3NzID0+IGNzcy5jb2RlKS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBudWxsIC8vIFRPRE9cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhlYWQ6IHJlc3VsdC50aXRsZSArIHJlc3VsdC5oZWFkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAkJHJlbmRlclxuICAgIH07XG59XG5mdW5jdGlvbiBhZGRfYXR0cmlidXRlKG5hbWUsIHZhbHVlLCBib29sZWFuKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGJvb2xlYW4gJiYgIXZhbHVlKSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIGNvbnN0IGFzc2lnbm1lbnQgPSAoYm9vbGVhbiAmJiB2YWx1ZSA9PT0gdHJ1ZSkgPyAnJyA6IGA9XCIke2VzY2FwZSh2YWx1ZSwgdHJ1ZSl9XCJgO1xuICAgIHJldHVybiBgICR7bmFtZX0ke2Fzc2lnbm1lbnR9YDtcbn1cbmZ1bmN0aW9uIGFkZF9jbGFzc2VzKGNsYXNzZXMpIHtcbiAgICByZXR1cm4gY2xhc3NlcyA/IGAgY2xhc3M9XCIke2NsYXNzZXN9XCJgIDogJyc7XG59XG5mdW5jdGlvbiBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhzdHlsZV9vYmplY3QpXG4gICAgICAgIC5maWx0ZXIoa2V5ID0+IHN0eWxlX29iamVjdFtrZXldKVxuICAgICAgICAubWFwKGtleSA9PiBgJHtrZXl9OiAke3N0eWxlX29iamVjdFtrZXldfTtgKVxuICAgICAgICAuam9pbignICcpO1xufVxuZnVuY3Rpb24gYWRkX3N0eWxlcyhzdHlsZV9vYmplY3QpIHtcbiAgICBjb25zdCBzdHlsZXMgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCk7XG4gICAgcmV0dXJuIHN0eWxlcyA/IGAgc3R5bGU9XCIke3N0eWxlc31cImAgOiAnJztcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IsIGN1c3RvbUVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgaWYgKCFjdXN0b21FbGVtZW50KSB7XG4gICAgICAgIC8vIG9uTW91bnQgaGFwcGVucyBiZWZvcmUgdGhlIGluaXRpYWwgYWZ0ZXJVcGRhdGVcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICBpZiAob25fZGVzdHJveSkge1xuICAgICAgICAgICAgICAgIG9uX2Rlc3Ryb3kucHVzaCguLi5uZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBFZGdlIGNhc2UgLSBjb21wb25lbnQgd2FzIGRlc3Ryb3llZCBpbW1lZGlhdGVseSxcbiAgICAgICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICAgICAgcnVuX2FsbChuZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZGVzdHJveV9jb21wb25lbnQoY29tcG9uZW50LCBkZXRhY2hpbmcpIHtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJDtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgcnVuX2FsbCgkJC5vbl9kZXN0cm95KTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuZChkZXRhY2hpbmcpO1xuICAgICAgICAvLyBUT0RPIG51bGwgb3V0IG90aGVyIHJlZnMsIGluY2x1ZGluZyBjb21wb25lbnQuJCQgKGJ1dCBuZWVkIHRvXG4gICAgICAgIC8vIHByZXNlcnZlIGZpbmFsIHN0YXRlPylcbiAgICAgICAgJCQub25fZGVzdHJveSA9ICQkLmZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgJCQuY3R4ID0gW107XG4gICAgfVxufVxuZnVuY3Rpb24gbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpIHtcbiAgICBpZiAoY29tcG9uZW50LiQkLmRpcnR5WzBdID09PSAtMSkge1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgICAgIGNvbXBvbmVudC4kJC5kaXJ0eS5maWxsKDApO1xuICAgIH1cbiAgICBjb21wb25lbnQuJCQuZGlydHlbKGkgLyAzMSkgfCAwXSB8PSAoMSA8PCAoaSAlIDMxKSk7XG59XG5mdW5jdGlvbiBpbml0KGNvbXBvbmVudCwgb3B0aW9ucywgaW5zdGFuY2UsIGNyZWF0ZV9mcmFnbWVudCwgbm90X2VxdWFsLCBwcm9wcywgYXBwZW5kX3N0eWxlcywgZGlydHkgPSBbLTFdKSB7XG4gICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkID0ge1xuICAgICAgICBmcmFnbWVudDogbnVsbCxcbiAgICAgICAgY3R4OiBudWxsLFxuICAgICAgICAvLyBzdGF0ZVxuICAgICAgICBwcm9wcyxcbiAgICAgICAgdXBkYXRlOiBub29wLFxuICAgICAgICBub3RfZXF1YWwsXG4gICAgICAgIGJvdW5kOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgLy8gbGlmZWN5Y2xlXG4gICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgb25fZGVzdHJveTogW10sXG4gICAgICAgIG9uX2Rpc2Nvbm5lY3Q6IFtdLFxuICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgY29udGV4dDogbmV3IE1hcChvcHRpb25zLmNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAvLyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgZGlydHksXG4gICAgICAgIHNraXBfYm91bmQ6IGZhbHNlLFxuICAgICAgICByb290OiBvcHRpb25zLnRhcmdldCB8fCBwYXJlbnRfY29tcG9uZW50LiQkLnJvb3RcbiAgICB9O1xuICAgIGFwcGVuZF9zdHlsZXMgJiYgYXBwZW5kX3N0eWxlcygkJC5yb290KTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgb3B0aW9ucy5wcm9wcyB8fCB7fSwgKGksIHJldCwgLi4ucmVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXN0Lmxlbmd0aCA/IHJlc3RbMF0gOiByZXQ7XG4gICAgICAgICAgICBpZiAoJCQuY3R4ICYmIG5vdF9lcXVhbCgkJC5jdHhbaV0sICQkLmN0eFtpXSA9IHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICghJCQuc2tpcF9ib3VuZCAmJiAkJC5ib3VuZFtpXSlcbiAgICAgICAgICAgICAgICAgICAgJCQuYm91bmRbaV0odmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkeSlcbiAgICAgICAgICAgICAgICAgICAgbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXTtcbiAgICAkJC51cGRhdGUoKTtcbiAgICByZWFkeSA9IHRydWU7XG4gICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAvLyBgZmFsc2VgIGFzIGEgc3BlY2lhbCBjYXNlIG9mIG5vIERPTSBjb21wb25lbnRcbiAgICAkJC5mcmFnbWVudCA9IGNyZWF0ZV9mcmFnbWVudCA/IGNyZWF0ZV9mcmFnbWVudCgkJC5jdHgpIDogZmFsc2U7XG4gICAgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmh5ZHJhdGUpIHtcbiAgICAgICAgICAgIHN0YXJ0X2h5ZHJhdGluZygpO1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBjaGlsZHJlbihvcHRpb25zLnRhcmdldCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQubChub2Rlcyk7XG4gICAgICAgICAgICBub2Rlcy5mb3JFYWNoKGRldGFjaCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuYygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmludHJvKVxuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihjb21wb25lbnQuJCQuZnJhZ21lbnQpO1xuICAgICAgICBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCBvcHRpb25zLnRhcmdldCwgb3B0aW9ucy5hbmNob3IsIG9wdGlvbnMuY3VzdG9tRWxlbWVudCk7XG4gICAgICAgIGVuZF9oeWRyYXRpbmcoKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgb25fbW91bnQgfSA9IHRoaXMuJCQ7XG4gICAgICAgICAgICB0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QgPSBvbl9tb3VudC5tYXAocnVuKS5maWx0ZXIoaXNfZnVuY3Rpb24pO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuJCQuc2xvdHRlZCkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0aGlzLiQkLnNsb3R0ZWRba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGF0dHIsIF9vbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXNbYXR0cl0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIHJ1bl9hbGwodGhpcy4kJC5vbl9kaXNjb25uZWN0KTtcbiAgICAgICAgfVxuICAgICAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvLyBUT0RPIHNob3VsZCB0aGlzIGRlbGVnYXRlIHRvIGFkZEV2ZW50TGlzdGVuZXI/XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMuIFVzZWQgd2hlbiBkZXY9ZmFsc2UuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICB9XG4gICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc3BhdGNoX2Rldih0eXBlLCBkZXRhaWwpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudCh0eXBlLCBPYmplY3QuYXNzaWduKHsgdmVyc2lvbjogJzMuNDkuMCcgfSwgZGV0YWlsKSwgeyBidWJibGVzOiB0cnVlIH0pKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmQodGFyZ2V0LCBub2RlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9oeWRyYXRpb25fZGV2KHRhcmdldCwgbm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUgfSk7XG4gICAgYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlLCBhbmNob3IgfSk7XG4gICAgaW5zZXJ0X2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBkZXRhY2hfZGV2KG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZScsIHsgbm9kZSB9KTtcbiAgICBkZXRhY2gobm9kZSk7XG59XG5mdW5jdGlvbiBkZXRhY2hfYmV0d2Vlbl9kZXYoYmVmb3JlLCBhZnRlcikge1xuICAgIHdoaWxlIChiZWZvcmUubmV4dFNpYmxpbmcgJiYgYmVmb3JlLm5leHRTaWJsaW5nICE9PSBhZnRlcikge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoX2JlZm9yZV9kZXYoYWZ0ZXIpIHtcbiAgICB3aGlsZSAoYWZ0ZXIucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYWZ0ZXIucHJldmlvdXNTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYWZ0ZXJfZGV2KGJlZm9yZSkge1xuICAgIHdoaWxlIChiZWZvcmUubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihiZWZvcmUubmV4dFNpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxpc3Rlbl9kZXYobm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMsIGhhc19wcmV2ZW50X2RlZmF1bHQsIGhhc19zdG9wX3Byb3BhZ2F0aW9uKSB7XG4gICAgY29uc3QgbW9kaWZpZXJzID0gb3B0aW9ucyA9PT0gdHJ1ZSA/IFsnY2FwdHVyZSddIDogb3B0aW9ucyA/IEFycmF5LmZyb20oT2JqZWN0LmtleXMob3B0aW9ucykpIDogW107XG4gICAgaWYgKGhhc19wcmV2ZW50X2RlZmF1bHQpXG4gICAgICAgIG1vZGlmaWVycy5wdXNoKCdwcmV2ZW50RGVmYXVsdCcpO1xuICAgIGlmIChoYXNfc3RvcF9wcm9wYWdhdGlvbilcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3N0b3BQcm9wYWdhdGlvbicpO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NQWRkRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICBjb25zdCBkaXNwb3NlID0gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZUV2ZW50TGlzdGVuZXInLCB7IG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBtb2RpZmllcnMgfSk7XG4gICAgICAgIGRpc3Bvc2UoKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cl9kZXYobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSk7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlQXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUgfSk7XG4gICAgZWxzZVxuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldEF0dHJpYnV0ZScsIHsgbm9kZSwgYXR0cmlidXRlLCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHByb3BfZGV2KG5vZGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIG5vZGVbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXRQcm9wZXJ0eScsIHsgbm9kZSwgcHJvcGVydHksIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gZGF0YXNldF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZS5kYXRhc2V0W3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0RGF0YXNldCcsIHsgbm9kZSwgcHJvcGVydHksIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gc2V0X2RhdGFfZGV2KHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCA9PT0gZGF0YSlcbiAgICAgICAgcmV0dXJuO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0RGF0YScsIHsgbm9kZTogdGV4dCwgZGF0YSB9KTtcbiAgICB0ZXh0LmRhdGEgPSBkYXRhO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfZWFjaF9hcmd1bWVudChhcmcpIHtcbiAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ3N0cmluZycgJiYgIShhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgJ2xlbmd0aCcgaW4gYXJnKSkge1xuICAgICAgICBsZXQgbXNnID0gJ3sjZWFjaH0gb25seSBpdGVyYXRlcyBvdmVyIGFycmF5LWxpa2Ugb2JqZWN0cy4nO1xuICAgICAgICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBhcmcgJiYgU3ltYm9sLml0ZXJhdG9yIGluIGFyZykge1xuICAgICAgICAgICAgbXNnICs9ICcgWW91IGNhbiB1c2UgYSBzcHJlYWQgdG8gY29udmVydCB0aGlzIGl0ZXJhYmxlIGludG8gYW4gYXJyYXkuJztcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zbG90cyhuYW1lLCBzbG90LCBrZXlzKSB7XG4gICAgZm9yIChjb25zdCBzbG90X2tleSBvZiBPYmplY3Qua2V5cyhzbG90KSkge1xuICAgICAgICBpZiAoIX5rZXlzLmluZGV4T2Yoc2xvdF9rZXkpKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYDwke25hbWV9PiByZWNlaXZlZCBhbiB1bmV4cGVjdGVkIHNsb3QgXCIke3Nsb3Rfa2V5fVwiLmApO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfZHluYW1pY19lbGVtZW50KHRhZykge1xuICAgIGNvbnN0IGlzX3N0cmluZyA9IHR5cGVvZiB0YWcgPT09ICdzdHJpbmcnO1xuICAgIGlmICh0YWcgJiYgIWlzX3N0cmluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJzxzdmVsdGU6ZWxlbWVudD4gZXhwZWN0cyBcInRoaXNcIiBhdHRyaWJ1dGUgdG8gYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQodGFnKSB7XG4gICAgaWYgKHRhZyAmJiBpc192b2lkKHRhZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8c3ZlbHRlOmVsZW1lbnQgdGhpcz1cIiR7dGFnfVwiPiBpcyBzZWxmLWNsb3NpbmcgYW5kIGNhbm5vdCBoYXZlIGNvbnRlbnQuYCk7XG4gICAgfVxufVxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBTdmVsdGUgY29tcG9uZW50cyB3aXRoIHNvbWUgbWlub3IgZGV2LWVuaGFuY2VtZW50cy4gVXNlZCB3aGVuIGRldj10cnVlLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnREZXYgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFvcHRpb25zIHx8ICghb3B0aW9ucy50YXJnZXQgJiYgIW9wdGlvbnMuJCRpbmxpbmUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIndGFyZ2V0JyBpcyBhIHJlcXVpcmVkIG9wdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuJGRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignQ29tcG9uZW50IHdhcyBhbHJlYWR5IGRlc3Ryb3llZCcpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJGNhcHR1cmVfc3RhdGUoKSB7IH1cbiAgICAkaW5qZWN0X3N0YXRlKCkgeyB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgdG8gY3JlYXRlIHN0cm9uZ2x5IHR5cGVkIFN2ZWx0ZSBjb21wb25lbnRzLlxuICogVGhpcyBvbmx5IGV4aXN0cyBmb3IgdHlwaW5nIHB1cnBvc2VzIGFuZCBzaG91bGQgYmUgdXNlZCBpbiBgLmQudHNgIGZpbGVzLlxuICpcbiAqICMjIyBFeGFtcGxlOlxuICpcbiAqIFlvdSBoYXZlIGNvbXBvbmVudCBsaWJyYXJ5IG9uIG5wbSBjYWxsZWQgYGNvbXBvbmVudC1saWJyYXJ5YCwgZnJvbSB3aGljaFxuICogeW91IGV4cG9ydCBhIGNvbXBvbmVudCBjYWxsZWQgYE15Q29tcG9uZW50YC4gRm9yIFN2ZWx0ZStUeXBlU2NyaXB0IHVzZXJzLFxuICogeW91IHdhbnQgdG8gcHJvdmlkZSB0eXBpbmdzLiBUaGVyZWZvcmUgeW91IGNyZWF0ZSBhIGBpbmRleC5kLnRzYDpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTdmVsdGVDb21wb25lbnRUeXBlZCB9IGZyb20gXCJzdmVsdGVcIjtcbiAqIGV4cG9ydCBjbGFzcyBNeUNvbXBvbmVudCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkPHtmb286IHN0cmluZ30+IHt9XG4gKiBgYGBcbiAqIFR5cGluZyB0aGlzIG1ha2VzIGl0IHBvc3NpYmxlIGZvciBJREVzIGxpa2UgVlMgQ29kZSB3aXRoIHRoZSBTdmVsdGUgZXh0ZW5zaW9uXG4gKiB0byBwcm92aWRlIGludGVsbGlzZW5zZSBhbmQgdG8gdXNlIHRoZSBjb21wb25lbnQgbGlrZSB0aGlzIGluIGEgU3ZlbHRlIGZpbGVcbiAqIHdpdGggVHlwZVNjcmlwdDpcbiAqIGBgYHN2ZWx0ZVxuICogPHNjcmlwdCBsYW5nPVwidHNcIj5cbiAqIFx0aW1wb3J0IHsgTXlDb21wb25lbnQgfSBmcm9tIFwiY29tcG9uZW50LWxpYnJhcnlcIjtcbiAqIDwvc2NyaXB0PlxuICogPE15Q29tcG9uZW50IGZvbz17J2Jhcid9IC8+XG4gKiBgYGBcbiAqXG4gKiAjIyMjIFdoeSBub3QgbWFrZSB0aGlzIHBhcnQgb2YgYFN2ZWx0ZUNvbXBvbmVudChEZXYpYD9cbiAqIEJlY2F1c2VcbiAqIGBgYHRzXG4gKiBjbGFzcyBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudDx7Zm9vOiBzdHJpbmd9PiB7fVxuICogY29uc3QgY29tcG9uZW50OiB0eXBlb2YgU3ZlbHRlQ29tcG9uZW50ID0gQVN1YmNsYXNzT2ZTdmVsdGVDb21wb25lbnQ7XG4gKiBgYGBcbiAqIHdpbGwgdGhyb3cgYSB0eXBlIGVycm9yLCBzbyB3ZSBuZWVkIHRvIHNlcGFyYXRlIHRoZSBtb3JlIHN0cmljdGx5IHR5cGVkIGNsYXNzLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnRUeXBlZCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudERldiB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBzdXBlcihvcHRpb25zKTtcbiAgICB9XG59XG5mdW5jdGlvbiBsb29wX2d1YXJkKHRpbWVvdXQpIHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+IHRpbWVvdXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW5maW5pdGUgbG9vcCBkZXRlY3RlZCcpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IHsgSHRtbFRhZywgSHRtbFRhZ0h5ZHJhdGlvbiwgU3ZlbHRlQ29tcG9uZW50LCBTdmVsdGVDb21wb25lbnREZXYsIFN2ZWx0ZUNvbXBvbmVudFR5cGVkLCBTdmVsdGVFbGVtZW50LCBhY3Rpb25fZGVzdHJveWVyLCBhZGRfYXR0cmlidXRlLCBhZGRfY2xhc3NlcywgYWRkX2ZsdXNoX2NhbGxiYWNrLCBhZGRfbG9jYXRpb24sIGFkZF9yZW5kZXJfY2FsbGJhY2ssIGFkZF9yZXNpemVfbGlzdGVuZXIsIGFkZF9zdHlsZXMsIGFkZF90cmFuc2Zvcm0sIGFmdGVyVXBkYXRlLCBhcHBlbmQsIGFwcGVuZF9kZXYsIGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0LCBhcHBlbmRfaHlkcmF0aW9uLCBhcHBlbmRfaHlkcmF0aW9uX2RldiwgYXBwZW5kX3N0eWxlcywgYXNzaWduLCBhdHRyLCBhdHRyX2RldiwgYXR0cmlidXRlX3RvX29iamVjdCwgYmVmb3JlVXBkYXRlLCBiaW5kLCBiaW5kaW5nX2NhbGxiYWNrcywgYmxhbmtfb2JqZWN0LCBidWJibGUsIGNoZWNrX291dHJvcywgY2hpbGRyZW4sIGNsYWltX2NvbXBvbmVudCwgY2xhaW1fZWxlbWVudCwgY2xhaW1faHRtbF90YWcsIGNsYWltX3NwYWNlLCBjbGFpbV9zdmdfZWxlbWVudCwgY2xhaW1fdGV4dCwgY2xlYXJfbG9vcHMsIGNvbXBvbmVudF9zdWJzY3JpYmUsIGNvbXB1dGVfcmVzdF9wcm9wcywgY29tcHV0ZV9zbG90cywgY3JlYXRlRXZlbnREaXNwYXRjaGVyLCBjcmVhdGVfYW5pbWF0aW9uLCBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uLCBjcmVhdGVfY29tcG9uZW50LCBjcmVhdGVfaW5fdHJhbnNpdGlvbiwgY3JlYXRlX291dF90cmFuc2l0aW9uLCBjcmVhdGVfc2xvdCwgY3JlYXRlX3Nzcl9jb21wb25lbnQsIGN1cnJlbnRfY29tcG9uZW50LCBjdXN0b21fZXZlbnQsIGRhdGFzZXRfZGV2LCBkZWJ1ZywgZGVzdHJveV9ibG9jaywgZGVzdHJveV9jb21wb25lbnQsIGRlc3Ryb3lfZWFjaCwgZGV0YWNoLCBkZXRhY2hfYWZ0ZXJfZGV2LCBkZXRhY2hfYmVmb3JlX2RldiwgZGV0YWNoX2JldHdlZW5fZGV2LCBkZXRhY2hfZGV2LCBkaXJ0eV9jb21wb25lbnRzLCBkaXNwYXRjaF9kZXYsIGVhY2gsIGVsZW1lbnQsIGVsZW1lbnRfaXMsIGVtcHR5LCBlbmRfaHlkcmF0aW5nLCBlc2NhcGUsIGVzY2FwZV9hdHRyaWJ1dGVfdmFsdWUsIGVzY2FwZV9vYmplY3QsIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMsIGZpeF9hbmRfZGVzdHJveV9ibG9jaywgZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jaywgZml4X3Bvc2l0aW9uLCBmbHVzaCwgZ2V0QWxsQ29udGV4dHMsIGdldENvbnRleHQsIGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSwgZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUsIGdldF9jdXJyZW50X2NvbXBvbmVudCwgZ2V0X2N1c3RvbV9lbGVtZW50c19zbG90cywgZ2V0X3Jvb3RfZm9yX3N0eWxlLCBnZXRfc2xvdF9jaGFuZ2VzLCBnZXRfc3ByZWFkX29iamVjdCwgZ2V0X3NwcmVhZF91cGRhdGUsIGdldF9zdG9yZV92YWx1ZSwgZ2xvYmFscywgZ3JvdXBfb3V0cm9zLCBoYW5kbGVfcHJvbWlzZSwgaGFzQ29udGV4dCwgaGFzX3Byb3AsIGlkZW50aXR5LCBpbml0LCBpbnNlcnQsIGluc2VydF9kZXYsIGluc2VydF9oeWRyYXRpb24sIGluc2VydF9oeWRyYXRpb25fZGV2LCBpbnRyb3MsIGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLCBpc19jbGllbnQsIGlzX2Nyb3Nzb3JpZ2luLCBpc19lbXB0eSwgaXNfZnVuY3Rpb24sIGlzX3Byb21pc2UsIGlzX3ZvaWQsIGxpc3RlbiwgbGlzdGVuX2RldiwgbG9vcCwgbG9vcF9ndWFyZCwgbWVyZ2Vfc3NyX3N0eWxlcywgbWlzc2luZ19jb21wb25lbnQsIG1vdW50X2NvbXBvbmVudCwgbm9vcCwgbm90X2VxdWFsLCBub3csIG51bGxfdG9fZW1wdHksIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMsIG9uRGVzdHJveSwgb25Nb3VudCwgb25jZSwgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIHByZXZlbnRfZGVmYXVsdCwgcHJvcF9kZXYsIHF1ZXJ5X3NlbGVjdG9yX2FsbCwgcmFmLCBydW4sIHJ1bl9hbGwsIHNhZmVfbm90X2VxdWFsLCBzY2hlZHVsZV91cGRhdGUsIHNlbGVjdF9tdWx0aXBsZV92YWx1ZSwgc2VsZWN0X29wdGlvbiwgc2VsZWN0X29wdGlvbnMsIHNlbGVjdF92YWx1ZSwgc2VsZiwgc2V0Q29udGV4dCwgc2V0X2F0dHJpYnV0ZXMsIHNldF9jdXJyZW50X2NvbXBvbmVudCwgc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEsIHNldF9kYXRhLCBzZXRfZGF0YV9kZXYsIHNldF9pbnB1dF90eXBlLCBzZXRfaW5wdXRfdmFsdWUsIHNldF9ub3csIHNldF9yYWYsIHNldF9zdG9yZV92YWx1ZSwgc2V0X3N0eWxlLCBzZXRfc3ZnX2F0dHJpYnV0ZXMsIHNwYWNlLCBzcHJlYWQsIHNyY191cmxfZXF1YWwsIHN0YXJ0X2h5ZHJhdGluZywgc3RvcF9wcm9wYWdhdGlvbiwgc3Vic2NyaWJlLCBzdmdfZWxlbWVudCwgdGV4dCwgdGljaywgdGltZV9yYW5nZXNfdG9fYXJyYXksIHRvX251bWJlciwgdG9nZ2xlX2NsYXNzLCB0cmFuc2l0aW9uX2luLCB0cmFuc2l0aW9uX291dCwgdHJ1c3RlZCwgdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaCwgdXBkYXRlX2tleWVkX2VhY2gsIHVwZGF0ZV9zbG90LCB1cGRhdGVfc2xvdF9iYXNlLCB2YWxpZGF0ZV9jb21wb25lbnQsIHZhbGlkYXRlX2R5bmFtaWNfZWxlbWVudCwgdmFsaWRhdGVfZWFjaF9hcmd1bWVudCwgdmFsaWRhdGVfZWFjaF9rZXlzLCB2YWxpZGF0ZV9zbG90cywgdmFsaWRhdGVfc3RvcmUsIHZhbGlkYXRlX3ZvaWRfZHluYW1pY19lbGVtZW50LCB4bGlua19hdHRyIH07XG4iLCI8c2NyaXB0PlxuICBjb25zdCBsZW4gPSA1O1xuICBsZXQgY291bnQgPSAwO1xuICBsZXQgaGFzSW50ZXJhY3RlZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGlucHV0KHgpIHtcbiAgICBpZiAoIWhhc0ludGVyYWN0ZWQpIHtcbiAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb3VudCA9IHBhcnNlSW50KHgudGFyZ2V0LnZhbHVlKTtcbiAgfVxuPC9zY3JpcHQ+XG5cbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPlxuICA8aW1nXG4gICAgc3JjPVwiaW1hZ2VzL3RyYWplY3Rvcmllc3tjb3VudH0uc3ZnXCJcbiAgICBhbHQ9XCJJbnRlcmFjdGl2ZSBwbG90IGRpc3BsYXlpbmcgdGhlIHRyYWplY3RvcmllcyBvZiB0aGUgUkwgYWdlbnQgb24gdGhlIG1hcFwiXG4gICAgaGVpZ2h0PVwiMzAwcHhcIlxuICAgIHdpZHRoPVwiNDAwcHhcIlxuICAvPlxuICA8ZGl2IHN0eWxlPVwid2lkdGg6MzAwcHg7IG1hcmdpbjphdXRvOyB0ZXh0LWFsaWduOmNlbnRlcjtcIj5cbiAgICA8cD5UcmFqZWN0b3J5IGFmdGVyIGN1cnJpY3VsdW0gc3RlcCB7Y291bnQgKyAxfTwvcD5cbiAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgbWluPVwiMFwiIG1heD1cIntsZW59XCIgdmFsdWU9XCIwXCIgb246aW5wdXQ9e2lucHV0fT5cbiAgICA8cCBzdHlsZT1cImhlaWdodDogMWVtOyB0cmFuc2l0aW9uOiAxcyBvcGFjaXR5OyB7aGFzSW50ZXJhY3RlZCAmJiAnb3BhY2l0eTogMDsnfVwiPk1vdmUgdGhlIHNsaWRlciB0byBjaGFuZ2UgdGhlIHN0ZXAhPC9wPlxuICA8L2Rpdj5cbjwvZGl2PlxuIiwiPHNjcmlwdD5cbiAgY29uc3QgbGVuID0gOTtcbiAgbGV0IGNvdW50ID0gMTtcbiAgbGV0IGhhc0ludGVyYWN0ZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBpbnB1dCh4KSB7XG4gICAgaWYgKCFoYXNJbnRlcmFjdGVkKSB7XG4gICAgICBoYXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgY291bnQgPSBwYXJzZUludCh4LnRhcmdldC52YWx1ZSk7XG4gIH1cbjwvc2NyaXB0PlxuXG48ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj4gXG4gIDxpbWcgXG4gICAgc3JjPVwiaW1hZ2VzLzE2eDE2X2JhY2t7Y291bnR9X3N1Y2Nlc3Nlcy5zdmdcIlxuICAgIGFsdD1cIkludGVyYWN0aXZlIHBsb3QgZGlzcGxheWluZyB0aGUgc3VjY2VzcyByYXRlIG9mIHRoZSBiYWNrIGN1cnJpY3VsdW0gcG9saWN5IG92ZXIgdGhlIG51bWJlciBvZiBjdXJyaWN1bHVtIHN0ZXBzXCJcbiAgICBoZWlnaHQ9XCIzMDBweFwiXG4gICAgd2lkdGg9XCI0MDBweFwiXG4gIC8+IFxuICA8ZGl2IHN0eWxlPVwid2lkdGg6MzAwcHg7IG1hcmdpbjphdXRvOyB0ZXh0LWFsaWduOmNlbnRlcjtcIj5cbiAgICA8cD54ID0ge2NvdW50fTwvcD5cbiAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgbWluPVwiMVwiIG1heD1cIntsZW59XCIgdmFsdWU9XCIwXCIgb246aW5wdXQ9e2lucHV0fT5cbiAgICA8cCBzdHlsZT1cImhlaWdodDogMWVtOyB0cmFuc2l0aW9uOiAxcyBvcGFjaXR5OyB7aGFzSW50ZXJhY3RlZCAmJiAnb3BhY2l0eTogMDsnfVwiPk1vdmUgdGhlIHNsaWRlciB0byBjaGFuZ2UgeCE8L3A+XG4gIDwvZGl2PiBcbjwvZGl2PlxuIiwiPHNjcmlwdD5cbiAgY29uc3QgbGVuID0gNDtcbiAgbGV0IGNvdW50ID0gMDtcbiAgbGV0IGhhc0ludGVyYWN0ZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBpbnB1dCh4KSB7XG4gICAgaWYgKCFoYXNJbnRlcmFjdGVkKSB7XG4gICAgICBoYXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgY291bnQgPSBwYXJzZUludCh4LnRhcmdldC52YWx1ZSlcbiAgfVxuPC9zY3JpcHQ+XG5cbjxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBhbGlnbi1pdGVtczogY2VudGVyO1wiPiBcbiAgPGltZyBcbiAgICBzcmM9XCJpbWFnZXMvMTZ4MTZfaW5jcmVtZW50YWx7Y291bnR9X3N1Y2Nlc3Nlcy5zdmdcIlxuICAgIGFsdD1cIkludGVyYWN0aXZlIHBsb3QgZGlzcGxheWluZyB0aGUgc3VjY2VzcyByYXRlIG9mIHRoZSBpbmNyZW1lbnRhbCBjdXJyaWN1bHVtIHBvbGljeSBvdmVyIHRoZSBudW1iZXIgb2YgY3VycmljdWx1bSBzdGVwc1wiXG4gICAgaGVpZ2h0PVwiMzAwcHhcIlxuICAgIHdpZHRoPVwiNDAwcHhcIlxuICAvPlxuICA8ZGl2IHN0eWxlPVwid2lkdGg6MzAwcHg7IG1hcmdpbjphdXRvOyB0ZXh0LWFsaWduOmNlbnRlcjtcIj5cbiAgICA8cD54ID0ge2NvdW50fTwvcD5cbiAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgbWluPVwiMFwiIG1heD1cIntsZW59XCIgdmFsdWU9XCIwXCIgb246aW5wdXQ9e2lucHV0fT5cbiAgICA8cCBzdHlsZT1cImhlaWdodDogMWVtOyB0cmFuc2l0aW9uOiAxcyBvcGFjaXR5OyB7aGFzSW50ZXJhY3RlZCAmJiAnb3BhY2l0eTogMDsnfVwiPk1vdmUgdGhlIHNsaWRlciB0byBjaGFuZ2UgeCE8L3A+XG4gIDwvZGl2PlxuPC9kaXY+XG4iLCJpbXBvcnQgeyBub29wLCBzYWZlX25vdF9lcXVhbCwgc3Vic2NyaWJlLCBydW5fYWxsLCBpc19mdW5jdGlvbiB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5leHBvcnQgeyBnZXRfc3RvcmVfdmFsdWUgYXMgZ2V0IH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcblxuY29uc3Qgc3Vic2NyaWJlcl9xdWV1ZSA9IFtdO1xuLyoqXG4gKiBDcmVhdGVzIGEgYFJlYWRhYmxlYCBzdG9yZSB0aGF0IGFsbG93cyByZWFkaW5nIGJ5IHN1YnNjcmlwdGlvbi5cbiAqIEBwYXJhbSB2YWx1ZSBpbml0aWFsIHZhbHVlXG4gKiBAcGFyYW0ge1N0YXJ0U3RvcE5vdGlmaWVyfXN0YXJ0IHN0YXJ0IGFuZCBzdG9wIG5vdGlmaWNhdGlvbnMgZm9yIHN1YnNjcmlwdGlvbnNcbiAqL1xuZnVuY3Rpb24gcmVhZGFibGUodmFsdWUsIHN0YXJ0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3Vic2NyaWJlOiB3cml0YWJsZSh2YWx1ZSwgc3RhcnQpLnN1YnNjcmliZVxuICAgIH07XG59XG4vKipcbiAqIENyZWF0ZSBhIGBXcml0YWJsZWAgc3RvcmUgdGhhdCBhbGxvd3MgYm90aCB1cGRhdGluZyBhbmQgcmVhZGluZyBieSBzdWJzY3JpcHRpb24uXG4gKiBAcGFyYW0geyo9fXZhbHVlIGluaXRpYWwgdmFsdWVcbiAqIEBwYXJhbSB7U3RhcnRTdG9wTm90aWZpZXI9fXN0YXJ0IHN0YXJ0IGFuZCBzdG9wIG5vdGlmaWNhdGlvbnMgZm9yIHN1YnNjcmlwdGlvbnNcbiAqL1xuZnVuY3Rpb24gd3JpdGFibGUodmFsdWUsIHN0YXJ0ID0gbm9vcCkge1xuICAgIGxldCBzdG9wO1xuICAgIGNvbnN0IHN1YnNjcmliZXJzID0gbmV3IFNldCgpO1xuICAgIGZ1bmN0aW9uIHNldChuZXdfdmFsdWUpIHtcbiAgICAgICAgaWYgKHNhZmVfbm90X2VxdWFsKHZhbHVlLCBuZXdfdmFsdWUpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgICAgIGlmIChzdG9wKSB7IC8vIHN0b3JlIGlzIHJlYWR5XG4gICAgICAgICAgICAgICAgY29uc3QgcnVuX3F1ZXVlID0gIXN1YnNjcmliZXJfcXVldWUubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc3Vic2NyaWJlciBvZiBzdWJzY3JpYmVycykge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyWzFdKCk7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXJfcXVldWUucHVzaChzdWJzY3JpYmVyLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydW5fcXVldWUpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdWJzY3JpYmVyX3F1ZXVlLmxlbmd0aDsgaSArPSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyX3F1ZXVlW2ldWzBdKHN1YnNjcmliZXJfcXVldWVbaSArIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyX3F1ZXVlLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZShmbikge1xuICAgICAgICBzZXQoZm4odmFsdWUpKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc3Vic2NyaWJlKHJ1biwgaW52YWxpZGF0ZSA9IG5vb3ApIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaWJlciA9IFtydW4sIGludmFsaWRhdGVdO1xuICAgICAgICBzdWJzY3JpYmVycy5hZGQoc3Vic2NyaWJlcik7XG4gICAgICAgIGlmIChzdWJzY3JpYmVycy5zaXplID09PSAxKSB7XG4gICAgICAgICAgICBzdG9wID0gc3RhcnQoc2V0KSB8fCBub29wO1xuICAgICAgICB9XG4gICAgICAgIHJ1bih2YWx1ZSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBzdWJzY3JpYmVycy5kZWxldGUoc3Vic2NyaWJlcik7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaWJlcnMuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHN0b3AoKTtcbiAgICAgICAgICAgICAgICBzdG9wID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc2V0LCB1cGRhdGUsIHN1YnNjcmliZSB9O1xufVxuZnVuY3Rpb24gZGVyaXZlZChzdG9yZXMsIGZuLCBpbml0aWFsX3ZhbHVlKSB7XG4gICAgY29uc3Qgc2luZ2xlID0gIUFycmF5LmlzQXJyYXkoc3RvcmVzKTtcbiAgICBjb25zdCBzdG9yZXNfYXJyYXkgPSBzaW5nbGVcbiAgICAgICAgPyBbc3RvcmVzXVxuICAgICAgICA6IHN0b3JlcztcbiAgICBjb25zdCBhdXRvID0gZm4ubGVuZ3RoIDwgMjtcbiAgICByZXR1cm4gcmVhZGFibGUoaW5pdGlhbF92YWx1ZSwgKHNldCkgPT4ge1xuICAgICAgICBsZXQgaW5pdGVkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgICAgICBsZXQgcGVuZGluZyA9IDA7XG4gICAgICAgIGxldCBjbGVhbnVwID0gbm9vcDtcbiAgICAgICAgY29uc3Qgc3luYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmIChwZW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gZm4oc2luZ2xlID8gdmFsdWVzWzBdIDogdmFsdWVzLCBzZXQpO1xuICAgICAgICAgICAgaWYgKGF1dG8pIHtcbiAgICAgICAgICAgICAgICBzZXQocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsZWFudXAgPSBpc19mdW5jdGlvbihyZXN1bHQpID8gcmVzdWx0IDogbm9vcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmVycyA9IHN0b3Jlc19hcnJheS5tYXAoKHN0b3JlLCBpKSA9PiBzdWJzY3JpYmUoc3RvcmUsICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdmFsdWVzW2ldID0gdmFsdWU7XG4gICAgICAgICAgICBwZW5kaW5nICY9IH4oMSA8PCBpKTtcbiAgICAgICAgICAgIGlmIChpbml0ZWQpIHtcbiAgICAgICAgICAgICAgICBzeW5jKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgIHBlbmRpbmcgfD0gKDEgPDwgaSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgaW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgc3luYygpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgICAgIHJ1bl9hbGwodW5zdWJzY3JpYmVycyk7XG4gICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgIH07XG4gICAgfSk7XG59XG5cbmV4cG9ydCB7IGRlcml2ZWQsIHJlYWRhYmxlLCB3cml0YWJsZSB9O1xuIiwiZXhwb3J0IHsgaWRlbnRpdHkgYXMgbGluZWFyIH0gZnJvbSAnLi4vaW50ZXJuYWwvaW5kZXgubWpzJztcblxuLypcbkFkYXB0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vbWF0dGRlc2xcbkRpc3RyaWJ1dGVkIHVuZGVyIE1JVCBMaWNlbnNlIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXR0ZGVzbC9lYXNlcy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kXG4qL1xuZnVuY3Rpb24gYmFja0luT3V0KHQpIHtcbiAgICBjb25zdCBzID0gMS43MDE1OCAqIDEuNTI1O1xuICAgIGlmICgodCAqPSAyKSA8IDEpXG4gICAgICAgIHJldHVybiAwLjUgKiAodCAqIHQgKiAoKHMgKyAxKSAqIHQgLSBzKSk7XG4gICAgcmV0dXJuIDAuNSAqICgodCAtPSAyKSAqIHQgKiAoKHMgKyAxKSAqIHQgKyBzKSArIDIpO1xufVxuZnVuY3Rpb24gYmFja0luKHQpIHtcbiAgICBjb25zdCBzID0gMS43MDE1ODtcbiAgICByZXR1cm4gdCAqIHQgKiAoKHMgKyAxKSAqIHQgLSBzKTtcbn1cbmZ1bmN0aW9uIGJhY2tPdXQodCkge1xuICAgIGNvbnN0IHMgPSAxLjcwMTU4O1xuICAgIHJldHVybiAtLXQgKiB0ICogKChzICsgMSkgKiB0ICsgcykgKyAxO1xufVxuZnVuY3Rpb24gYm91bmNlT3V0KHQpIHtcbiAgICBjb25zdCBhID0gNC4wIC8gMTEuMDtcbiAgICBjb25zdCBiID0gOC4wIC8gMTEuMDtcbiAgICBjb25zdCBjID0gOS4wIC8gMTAuMDtcbiAgICBjb25zdCBjYSA9IDQzNTYuMCAvIDM2MS4wO1xuICAgIGNvbnN0IGNiID0gMzU0NDIuMCAvIDE4MDUuMDtcbiAgICBjb25zdCBjYyA9IDE2MDYxLjAgLyAxODA1LjA7XG4gICAgY29uc3QgdDIgPSB0ICogdDtcbiAgICByZXR1cm4gdCA8IGFcbiAgICAgICAgPyA3LjU2MjUgKiB0MlxuICAgICAgICA6IHQgPCBiXG4gICAgICAgICAgICA/IDkuMDc1ICogdDIgLSA5LjkgKiB0ICsgMy40XG4gICAgICAgICAgICA6IHQgPCBjXG4gICAgICAgICAgICAgICAgPyBjYSAqIHQyIC0gY2IgKiB0ICsgY2NcbiAgICAgICAgICAgICAgICA6IDEwLjggKiB0ICogdCAtIDIwLjUyICogdCArIDEwLjcyO1xufVxuZnVuY3Rpb24gYm91bmNlSW5PdXQodCkge1xuICAgIHJldHVybiB0IDwgMC41XG4gICAgICAgID8gMC41ICogKDEuMCAtIGJvdW5jZU91dCgxLjAgLSB0ICogMi4wKSlcbiAgICAgICAgOiAwLjUgKiBib3VuY2VPdXQodCAqIDIuMCAtIDEuMCkgKyAwLjU7XG59XG5mdW5jdGlvbiBib3VuY2VJbih0KSB7XG4gICAgcmV0dXJuIDEuMCAtIGJvdW5jZU91dCgxLjAgLSB0KTtcbn1cbmZ1bmN0aW9uIGNpcmNJbk91dCh0KSB7XG4gICAgaWYgKCh0ICo9IDIpIDwgMSlcbiAgICAgICAgcmV0dXJuIC0wLjUgKiAoTWF0aC5zcXJ0KDEgLSB0ICogdCkgLSAxKTtcbiAgICByZXR1cm4gMC41ICogKE1hdGguc3FydCgxIC0gKHQgLT0gMikgKiB0KSArIDEpO1xufVxuZnVuY3Rpb24gY2lyY0luKHQpIHtcbiAgICByZXR1cm4gMS4wIC0gTWF0aC5zcXJ0KDEuMCAtIHQgKiB0KTtcbn1cbmZ1bmN0aW9uIGNpcmNPdXQodCkge1xuICAgIHJldHVybiBNYXRoLnNxcnQoMSAtIC0tdCAqIHQpO1xufVxuZnVuY3Rpb24gY3ViaWNJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjUgPyA0LjAgKiB0ICogdCAqIHQgOiAwLjUgKiBNYXRoLnBvdygyLjAgKiB0IC0gMi4wLCAzLjApICsgMS4wO1xufVxuZnVuY3Rpb24gY3ViaWNJbih0KSB7XG4gICAgcmV0dXJuIHQgKiB0ICogdDtcbn1cbmZ1bmN0aW9uIGN1YmljT3V0KHQpIHtcbiAgICBjb25zdCBmID0gdCAtIDEuMDtcbiAgICByZXR1cm4gZiAqIGYgKiBmICsgMS4wO1xufVxuZnVuY3Rpb24gZWxhc3RpY0luT3V0KHQpIHtcbiAgICByZXR1cm4gdCA8IDAuNVxuICAgICAgICA/IDAuNSAqXG4gICAgICAgICAgICBNYXRoLnNpbigoKCsxMy4wICogTWF0aC5QSSkgLyAyKSAqIDIuMCAqIHQpICpcbiAgICAgICAgICAgIE1hdGgucG93KDIuMCwgMTAuMCAqICgyLjAgKiB0IC0gMS4wKSlcbiAgICAgICAgOiAwLjUgKlxuICAgICAgICAgICAgTWF0aC5zaW4oKCgtMTMuMCAqIE1hdGguUEkpIC8gMikgKiAoMi4wICogdCAtIDEuMCArIDEuMCkpICpcbiAgICAgICAgICAgIE1hdGgucG93KDIuMCwgLTEwLjAgKiAoMi4wICogdCAtIDEuMCkpICtcbiAgICAgICAgICAgIDEuMDtcbn1cbmZ1bmN0aW9uIGVsYXN0aWNJbih0KSB7XG4gICAgcmV0dXJuIE1hdGguc2luKCgxMy4wICogdCAqIE1hdGguUEkpIC8gMikgKiBNYXRoLnBvdygyLjAsIDEwLjAgKiAodCAtIDEuMCkpO1xufVxuZnVuY3Rpb24gZWxhc3RpY091dCh0KSB7XG4gICAgcmV0dXJuIChNYXRoLnNpbigoLTEzLjAgKiAodCArIDEuMCkgKiBNYXRoLlBJKSAvIDIpICogTWF0aC5wb3coMi4wLCAtMTAuMCAqIHQpICsgMS4wKTtcbn1cbmZ1bmN0aW9uIGV4cG9Jbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPT09IDAuMCB8fCB0ID09PSAxLjBcbiAgICAgICAgPyB0XG4gICAgICAgIDogdCA8IDAuNVxuICAgICAgICAgICAgPyArMC41ICogTWF0aC5wb3coMi4wLCAyMC4wICogdCAtIDEwLjApXG4gICAgICAgICAgICA6IC0wLjUgKiBNYXRoLnBvdygyLjAsIDEwLjAgLSB0ICogMjAuMCkgKyAxLjA7XG59XG5mdW5jdGlvbiBleHBvSW4odCkge1xuICAgIHJldHVybiB0ID09PSAwLjAgPyB0IDogTWF0aC5wb3coMi4wLCAxMC4wICogKHQgLSAxLjApKTtcbn1cbmZ1bmN0aW9uIGV4cG9PdXQodCkge1xuICAgIHJldHVybiB0ID09PSAxLjAgPyB0IDogMS4wIC0gTWF0aC5wb3coMi4wLCAtMTAuMCAqIHQpO1xufVxuZnVuY3Rpb24gcXVhZEluT3V0KHQpIHtcbiAgICB0IC89IDAuNTtcbiAgICBpZiAodCA8IDEpXG4gICAgICAgIHJldHVybiAwLjUgKiB0ICogdDtcbiAgICB0LS07XG4gICAgcmV0dXJuIC0wLjUgKiAodCAqICh0IC0gMikgLSAxKTtcbn1cbmZ1bmN0aW9uIHF1YWRJbih0KSB7XG4gICAgcmV0dXJuIHQgKiB0O1xufVxuZnVuY3Rpb24gcXVhZE91dCh0KSB7XG4gICAgcmV0dXJuIC10ICogKHQgLSAyLjApO1xufVxuZnVuY3Rpb24gcXVhcnRJbk91dCh0KSB7XG4gICAgcmV0dXJuIHQgPCAwLjVcbiAgICAgICAgPyArOC4wICogTWF0aC5wb3codCwgNC4wKVxuICAgICAgICA6IC04LjAgKiBNYXRoLnBvdyh0IC0gMS4wLCA0LjApICsgMS4wO1xufVxuZnVuY3Rpb24gcXVhcnRJbih0KSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHQsIDQuMCk7XG59XG5mdW5jdGlvbiBxdWFydE91dCh0KSB7XG4gICAgcmV0dXJuIE1hdGgucG93KHQgLSAxLjAsIDMuMCkgKiAoMS4wIC0gdCkgKyAxLjA7XG59XG5mdW5jdGlvbiBxdWludEluT3V0KHQpIHtcbiAgICBpZiAoKHQgKj0gMikgPCAxKVxuICAgICAgICByZXR1cm4gMC41ICogdCAqIHQgKiB0ICogdCAqIHQ7XG4gICAgcmV0dXJuIDAuNSAqICgodCAtPSAyKSAqIHQgKiB0ICogdCAqIHQgKyAyKTtcbn1cbmZ1bmN0aW9uIHF1aW50SW4odCkge1xuICAgIHJldHVybiB0ICogdCAqIHQgKiB0ICogdDtcbn1cbmZ1bmN0aW9uIHF1aW50T3V0KHQpIHtcbiAgICByZXR1cm4gLS10ICogdCAqIHQgKiB0ICogdCArIDE7XG59XG5mdW5jdGlvbiBzaW5lSW5PdXQodCkge1xuICAgIHJldHVybiAtMC41ICogKE1hdGguY29zKE1hdGguUEkgKiB0KSAtIDEpO1xufVxuZnVuY3Rpb24gc2luZUluKHQpIHtcbiAgICBjb25zdCB2ID0gTWF0aC5jb3ModCAqIE1hdGguUEkgKiAwLjUpO1xuICAgIGlmIChNYXRoLmFicyh2KSA8IDFlLTE0KVxuICAgICAgICByZXR1cm4gMTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiAxIC0gdjtcbn1cbmZ1bmN0aW9uIHNpbmVPdXQodCkge1xuICAgIHJldHVybiBNYXRoLnNpbigodCAqIE1hdGguUEkpIC8gMik7XG59XG5cbmV4cG9ydCB7IGJhY2tJbiwgYmFja0luT3V0LCBiYWNrT3V0LCBib3VuY2VJbiwgYm91bmNlSW5PdXQsIGJvdW5jZU91dCwgY2lyY0luLCBjaXJjSW5PdXQsIGNpcmNPdXQsIGN1YmljSW4sIGN1YmljSW5PdXQsIGN1YmljT3V0LCBlbGFzdGljSW4sIGVsYXN0aWNJbk91dCwgZWxhc3RpY091dCwgZXhwb0luLCBleHBvSW5PdXQsIGV4cG9PdXQsIHF1YWRJbiwgcXVhZEluT3V0LCBxdWFkT3V0LCBxdWFydEluLCBxdWFydEluT3V0LCBxdWFydE91dCwgcXVpbnRJbiwgcXVpbnRJbk91dCwgcXVpbnRPdXQsIHNpbmVJbiwgc2luZUluT3V0LCBzaW5lT3V0IH07XG4iLCJpbXBvcnQgeyB3cml0YWJsZSB9IGZyb20gJy4uL3N0b3JlL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBub3csIGxvb3AsIGFzc2lnbiB9IGZyb20gJy4uL2ludGVybmFsL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBsaW5lYXIgfSBmcm9tICcuLi9lYXNpbmcvaW5kZXgubWpzJztcblxuZnVuY3Rpb24gaXNfZGF0ZShvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cblxuZnVuY3Rpb24gdGlja19zcHJpbmcoY3R4LCBsYXN0X3ZhbHVlLCBjdXJyZW50X3ZhbHVlLCB0YXJnZXRfdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIGN1cnJlbnRfdmFsdWUgPT09ICdudW1iZXInIHx8IGlzX2RhdGUoY3VycmVudF92YWx1ZSkpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBkZWx0YSA9IHRhcmdldF92YWx1ZSAtIGN1cnJlbnRfdmFsdWU7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgdmVsb2NpdHkgPSAoY3VycmVudF92YWx1ZSAtIGxhc3RfdmFsdWUpIC8gKGN0eC5kdCB8fCAxIC8gNjApOyAvLyBndWFyZCBkaXYgYnkgMFxuICAgICAgICBjb25zdCBzcHJpbmcgPSBjdHgub3B0cy5zdGlmZm5lc3MgKiBkZWx0YTtcbiAgICAgICAgY29uc3QgZGFtcGVyID0gY3R4Lm9wdHMuZGFtcGluZyAqIHZlbG9jaXR5O1xuICAgICAgICBjb25zdCBhY2NlbGVyYXRpb24gPSAoc3ByaW5nIC0gZGFtcGVyKSAqIGN0eC5pbnZfbWFzcztcbiAgICAgICAgY29uc3QgZCA9ICh2ZWxvY2l0eSArIGFjY2VsZXJhdGlvbikgKiBjdHguZHQ7XG4gICAgICAgIGlmIChNYXRoLmFicyhkKSA8IGN0eC5vcHRzLnByZWNpc2lvbiAmJiBNYXRoLmFicyhkZWx0YSkgPCBjdHgub3B0cy5wcmVjaXNpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXRfdmFsdWU7IC8vIHNldHRsZWRcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGN0eC5zZXR0bGVkID0gZmFsc2U7IC8vIHNpZ25hbCBsb29wIHRvIGtlZXAgdGlja2luZ1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgcmV0dXJuIGlzX2RhdGUoY3VycmVudF92YWx1ZSkgP1xuICAgICAgICAgICAgICAgIG5ldyBEYXRlKGN1cnJlbnRfdmFsdWUuZ2V0VGltZSgpICsgZCkgOiBjdXJyZW50X3ZhbHVlICsgZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChBcnJheS5pc0FycmF5KGN1cnJlbnRfdmFsdWUpKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRfdmFsdWUubWFwKChfLCBpKSA9PiB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWVbaV0sIGN1cnJlbnRfdmFsdWVbaV0sIHRhcmdldF92YWx1ZVtpXSkpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgY3VycmVudF92YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgY29uc3QgbmV4dF92YWx1ZSA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGsgaW4gY3VycmVudF92YWx1ZSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgbmV4dF92YWx1ZVtrXSA9IHRpY2tfc3ByaW5nKGN0eCwgbGFzdF92YWx1ZVtrXSwgY3VycmVudF92YWx1ZVtrXSwgdGFyZ2V0X3ZhbHVlW2tdKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBuZXh0X3ZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3Qgc3ByaW5nICR7dHlwZW9mIGN1cnJlbnRfdmFsdWV9IHZhbHVlc2ApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNwcmluZyh2YWx1ZSwgb3B0cyA9IHt9KSB7XG4gICAgY29uc3Qgc3RvcmUgPSB3cml0YWJsZSh2YWx1ZSk7XG4gICAgY29uc3QgeyBzdGlmZm5lc3MgPSAwLjE1LCBkYW1waW5nID0gMC44LCBwcmVjaXNpb24gPSAwLjAxIH0gPSBvcHRzO1xuICAgIGxldCBsYXN0X3RpbWU7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IGN1cnJlbnRfdG9rZW47XG4gICAgbGV0IGxhc3RfdmFsdWUgPSB2YWx1ZTtcbiAgICBsZXQgdGFyZ2V0X3ZhbHVlID0gdmFsdWU7XG4gICAgbGV0IGludl9tYXNzID0gMTtcbiAgICBsZXQgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSA9IDA7XG4gICAgbGV0IGNhbmNlbF90YXNrID0gZmFsc2U7XG4gICAgZnVuY3Rpb24gc2V0KG5ld192YWx1ZSwgb3B0cyA9IHt9KSB7XG4gICAgICAgIHRhcmdldF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBjdXJyZW50X3Rva2VuID0ge307XG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IG9wdHMuaGFyZCB8fCAoc3ByaW5nLnN0aWZmbmVzcyA+PSAxICYmIHNwcmluZy5kYW1waW5nID49IDEpKSB7XG4gICAgICAgICAgICBjYW5jZWxfdGFzayA9IHRydWU7IC8vIGNhbmNlbCBhbnkgcnVubmluZyBhbmltYXRpb25cbiAgICAgICAgICAgIGxhc3RfdGltZSA9IG5vdygpO1xuICAgICAgICAgICAgbGFzdF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IHRhcmdldF92YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob3B0cy5zb2Z0KSB7XG4gICAgICAgICAgICBjb25zdCByYXRlID0gb3B0cy5zb2Z0ID09PSB0cnVlID8gLjUgOiArb3B0cy5zb2Z0O1xuICAgICAgICAgICAgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSA9IDEgLyAocmF0ZSAqIDYwKTtcbiAgICAgICAgICAgIGludl9tYXNzID0gMDsgLy8gaW5maW5pdGUgbWFzcywgdW5hZmZlY3RlZCBieSBzcHJpbmcgZm9yY2VzXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0YXNrKSB7XG4gICAgICAgICAgICBsYXN0X3RpbWUgPSBub3coKTtcbiAgICAgICAgICAgIGNhbmNlbF90YXNrID0gZmFsc2U7XG4gICAgICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjYW5jZWxfdGFzaykge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWxfdGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0YXNrID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnZfbWFzcyA9IE1hdGgubWluKGludl9tYXNzICsgaW52X21hc3NfcmVjb3ZlcnlfcmF0ZSwgMSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY3R4ID0ge1xuICAgICAgICAgICAgICAgICAgICBpbnZfbWFzcyxcbiAgICAgICAgICAgICAgICAgICAgb3B0czogc3ByaW5nLFxuICAgICAgICAgICAgICAgICAgICBzZXR0bGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBkdDogKG5vdyAtIGxhc3RfdGltZSkgKiA2MCAvIDEwMDBcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRfdmFsdWUgPSB0aWNrX3NwcmluZyhjdHgsIGxhc3RfdmFsdWUsIHZhbHVlLCB0YXJnZXRfdmFsdWUpO1xuICAgICAgICAgICAgICAgIGxhc3RfdGltZSA9IG5vdztcbiAgICAgICAgICAgICAgICBsYXN0X3ZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgc3RvcmUuc2V0KHZhbHVlID0gbmV4dF92YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGN0eC5zZXR0bGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gIWN0eC5zZXR0bGVkO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bGZpbCA9PiB7XG4gICAgICAgICAgICB0YXNrLnByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRva2VuID09PSBjdXJyZW50X3Rva2VuKVxuICAgICAgICAgICAgICAgICAgICBmdWxmaWwoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc3ByaW5nID0ge1xuICAgICAgICBzZXQsXG4gICAgICAgIHVwZGF0ZTogKGZuLCBvcHRzKSA9PiBzZXQoZm4odGFyZ2V0X3ZhbHVlLCB2YWx1ZSksIG9wdHMpLFxuICAgICAgICBzdWJzY3JpYmU6IHN0b3JlLnN1YnNjcmliZSxcbiAgICAgICAgc3RpZmZuZXNzLFxuICAgICAgICBkYW1waW5nLFxuICAgICAgICBwcmVjaXNpb25cbiAgICB9O1xuICAgIHJldHVybiBzcHJpbmc7XG59XG5cbmZ1bmN0aW9uIGdldF9pbnRlcnBvbGF0b3IoYSwgYikge1xuICAgIGlmIChhID09PSBiIHx8IGEgIT09IGEpXG4gICAgICAgIHJldHVybiAoKSA9PiBhO1xuICAgIGNvbnN0IHR5cGUgPSB0eXBlb2YgYTtcbiAgICBpZiAodHlwZSAhPT0gdHlwZW9mIGIgfHwgQXJyYXkuaXNBcnJheShhKSAhPT0gQXJyYXkuaXNBcnJheShiKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbnRlcnBvbGF0ZSB2YWx1ZXMgb2YgZGlmZmVyZW50IHR5cGUnKTtcbiAgICB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYSkpIHtcbiAgICAgICAgY29uc3QgYXJyID0gYi5tYXAoKGJpLCBpKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0X2ludGVycG9sYXRvcihhW2ldLCBiaSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdCA9PiBhcnIubWFwKGZuID0+IGZuKHQpKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmICghYSB8fCAhYilcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT2JqZWN0IGNhbm5vdCBiZSBudWxsJyk7XG4gICAgICAgIGlmIChpc19kYXRlKGEpICYmIGlzX2RhdGUoYikpIHtcbiAgICAgICAgICAgIGEgPSBhLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGIgPSBiLmdldFRpbWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGRlbHRhID0gYiAtIGE7XG4gICAgICAgICAgICByZXR1cm4gdCA9PiBuZXcgRGF0ZShhICsgdCAqIGRlbHRhKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYik7XG4gICAgICAgIGNvbnN0IGludGVycG9sYXRvcnMgPSB7fTtcbiAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpbnRlcnBvbGF0b3JzW2tleV0gPSBnZXRfaW50ZXJwb2xhdG9yKGFba2V5XSwgYltrZXldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBpbnRlcnBvbGF0b3JzW2tleV0odCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICBjb25zdCBkZWx0YSA9IGIgLSBhO1xuICAgICAgICByZXR1cm4gdCA9PiBhICsgdCAqIGRlbHRhO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBpbnRlcnBvbGF0ZSAke3R5cGV9IHZhbHVlc2ApO1xufVxuZnVuY3Rpb24gdHdlZW5lZCh2YWx1ZSwgZGVmYXVsdHMgPSB7fSkge1xuICAgIGNvbnN0IHN0b3JlID0gd3JpdGFibGUodmFsdWUpO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCB0YXJnZXRfdmFsdWUgPSB2YWx1ZTtcbiAgICBmdW5jdGlvbiBzZXQobmV3X3ZhbHVlLCBvcHRzKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldF92YWx1ZSA9IG5ld192YWx1ZTtcbiAgICAgICAgbGV0IHByZXZpb3VzX3Rhc2sgPSB0YXNrO1xuICAgICAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gNDAwLCBlYXNpbmcgPSBsaW5lYXIsIGludGVycG9sYXRlID0gZ2V0X2ludGVycG9sYXRvciB9ID0gYXNzaWduKGFzc2lnbih7fSwgZGVmYXVsdHMpLCBvcHRzKTtcbiAgICAgICAgaWYgKGR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgICBpZiAocHJldmlvdXNfdGFzaykge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2suYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IHRhcmdldF92YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc3RhcnQgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBsZXQgZm47XG4gICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAobm93IDwgc3RhcnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBpZiAoIXN0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICBmbiA9IGludGVycG9sYXRlKHZhbHVlLCBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZHVyYXRpb24gPT09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24odmFsdWUsIG5ld192YWx1ZSk7XG4gICAgICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldmlvdXNfdGFzaykge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzX3Rhc2suYWJvcnQoKTtcbiAgICAgICAgICAgICAgICBwcmV2aW91c190YXNrID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVsYXBzZWQgPSBub3cgLSBzdGFydDtcbiAgICAgICAgICAgIGlmIChlbGFwc2VkID4gZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICBzdG9yZS5zZXQodmFsdWUgPSBuZXdfdmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHN0b3JlLnNldCh2YWx1ZSA9IGZuKGVhc2luZyhlbGFwc2VkIC8gZHVyYXRpb24pKSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0YXNrLnByb21pc2U7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHNldCxcbiAgICAgICAgdXBkYXRlOiAoZm4sIG9wdHMpID0+IHNldChmbih0YXJnZXRfdmFsdWUsIHZhbHVlKSwgb3B0cyksXG4gICAgICAgIHN1YnNjcmliZTogc3RvcmUuc3Vic2NyaWJlXG4gICAgfTtcbn1cblxuZXhwb3J0IHsgc3ByaW5nLCB0d2VlbmVkIH07XG4iLCI8c2NyaXB0PlxyXG4gIGltcG9ydCB7IG9uTW91bnQgfSBmcm9tIFwic3ZlbHRlXCJcclxuXHJcbiAgZXhwb3J0IGxldCBzaXplID0gMTBcclxuICBleHBvcnQgbGV0IHggPSBbLTAuNSwgMC41XVxyXG4gIGV4cG9ydCBsZXQgeSA9IFswLjI1LCAxXVxyXG4gIGV4cG9ydCBsZXQgZHVyYXRpb24gPSAyMDAwXHJcbiAgZXhwb3J0IGxldCBpbmZpbml0ZSA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCBkZWxheSA9IFswLCA1MF1cclxuICBleHBvcnQgbGV0IGNvbG9yUmFuZ2UgPSBbMCwgMzYwXVxyXG4gIGV4cG9ydCBsZXQgY29sb3JBcnJheSA9IFtdXHJcbiAgZXhwb3J0IGxldCBhbW91bnQgPSA1MFxyXG4gIGV4cG9ydCBsZXQgaXRlcmF0aW9uQ291bnQgPSAxXHJcbiAgZXhwb3J0IGxldCBmYWxsRGlzdGFuY2UgPSBcIjEwMHB4XCJcclxuICBleHBvcnQgbGV0IHJvdW5kZWQgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgY29uZSA9IGZhbHNlXHJcbiAgZXhwb3J0IGxldCBub0dyYXZpdHkgPSBmYWxzZVxyXG4gIGV4cG9ydCBsZXQgeFNwcmVhZCA9IDAuMTVcclxuICBleHBvcnQgbGV0IGRlc3Ryb3lPbkNvbXBsZXRlID0gdHJ1ZVxyXG5cclxuICBsZXQgY29tcGxldGUgPSBmYWxzZVxyXG5cclxuICBvbk1vdW50KCgpID0+IHtcclxuICAgIGlmICghZGVzdHJveU9uQ29tcGxldGUgfHwgaW5maW5pdGUgfHwgaXRlcmF0aW9uQ291bnQgPT0gXCJpbmZpbml0ZVwiKSByZXR1cm5cclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IGNvbXBsZXRlID0gdHJ1ZSwgKGR1cmF0aW9uICsgZGVsYXlbMV0pICogaXRlcmF0aW9uQ291bnQpXHJcbiAgfSlcclxuXHJcbiAgZnVuY3Rpb24gcmFuZG9tQmV0d2VlbihtaW4sIG1heCkge1xyXG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0Q29sb3IoKSB7XHJcbiAgICBpZiAoY29sb3JBcnJheS5sZW5ndGgpIHJldHVybiBjb2xvckFycmF5W01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChjb2xvckFycmF5Lmxlbmd0aCAtIDEpKV1cclxuICAgIGVsc2UgcmV0dXJuIGBoc2woJHtNYXRoLnJvdW5kKHJhbmRvbUJldHdlZW4oY29sb3JSYW5nZVswXSwgY29sb3JSYW5nZVsxXSkpfSwgNzUlLCA1MCVgXHJcbiAgfVxyXG48L3NjcmlwdD5cclxuXHJcblxyXG5cclxueyNpZiAhY29tcGxldGV9XHJcbiAgPGRpdiBjbGFzcz1cImNvbmZldHRpLWhvbGRlclwiIGNsYXNzOnJvdW5kZWQgY2xhc3M6Y29uZSBjbGFzczpuby1ncmF2aXR5PXtub0dyYXZpdHl9PlxyXG4gICAgeyNlYWNoIHsgbGVuZ3RoOiBhbW91bnQgfSBhcyBffVxyXG4gICAgICA8ZGl2XHJcbiAgICAgICAgY2xhc3M9XCJjb25mZXR0aVwiXHJcbiAgICAgICAgc3R5bGU9XCJcclxuICAgICAgICAtLWZhbGwtZGlzdGFuY2U6IHtmYWxsRGlzdGFuY2V9O1xyXG4gICAgICAgIC0tc2l6ZToge3NpemV9cHg7XHJcbiAgICAgICAgLS1jb2xvcjoge2dldENvbG9yKCl9O1xyXG4gICAgICAgIC0tc2tldzoge3JhbmRvbUJldHdlZW4oLTQ1LCA0NSl9ZGVnLHtyYW5kb21CZXR3ZWVuKC00NSwgNDUpfWRlZztcclxuICAgICAgICAtLXJvdGF0aW9uLXh5ejoge3JhbmRvbUJldHdlZW4oLTEwLCAxMCl9LCB7cmFuZG9tQmV0d2VlbigtMTAsIDEwKX0sIHtyYW5kb21CZXR3ZWVuKC0xMCwgMTApfTtcclxuICAgICAgICAtLXJvdGF0aW9uLWRlZzoge3JhbmRvbUJldHdlZW4oMCwgMzYwKX1kZWc7XHJcbiAgICAgICAgLS10cmFuc2xhdGUteS1tdWx0aXBsaWVyOiB7cmFuZG9tQmV0d2Vlbih5WzBdLCB5WzFdKX07XHJcbiAgICAgICAgLS10cmFuc2xhdGUteC1tdWx0aXBsaWVyOiB7cmFuZG9tQmV0d2Vlbih4WzBdLCB4WzFdKX07XHJcbiAgICAgICAgLS1zY2FsZTogezAuMSAqIHJhbmRvbUJldHdlZW4oMiwgMTApfTtcclxuICAgICAgICAtLXRyYW5zaXRpb24tZHVyYXRpb246IHtpbmZpbml0ZSA/IGBjYWxjKCR7ZHVyYXRpb259bXMgKiB2YXIoLS1zY2FsZSkpYCA6IGAke2R1cmF0aW9ufW1zYH07XHJcbiAgICAgICAgLS10cmFuc2l0aW9uLWRlbGF5OiB7cmFuZG9tQmV0d2VlbihkZWxheVswXSwgZGVsYXlbMV0pfW1zO1xyXG4gICAgICAgIC0tdHJhbnNpdGlvbi1pdGVyYXRpb24tY291bnQ6IHtpbmZpbml0ZSA/ICdpbmZpbml0ZScgOiBpdGVyYXRpb25Db3VudH07XHJcbiAgICAgICAgLS14LXNwcmVhZDogeygxIC0geFNwcmVhZCl9XCIgLz5cclxuICAgIHsvZWFjaH1cclxuICA8L2Rpdj5cclxuey9pZn1cclxuXHJcblxyXG5cclxuPHN0eWxlPlxyXG4gIC5jb25mZXR0aS1ob2xkZXIge1xyXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIH1cclxuXHJcbiAgQGtleWZyYW1lcyByb3RhdGUge1xyXG4gICAgMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHNrZXcodmFyKC0tc2tldykpIHJvdGF0ZTNkKHZhcigtLWZ1bGwtcm90YXRpb24pKTtcclxuICAgIH1cclxuXHJcbiAgICAxMDAlIHtcclxuICAgICAgdHJhbnNmb3JtOiBza2V3KHZhcigtLXNrZXcpKSByb3RhdGUzZCh2YXIoLS1yb3RhdGlvbi14eXopLCBjYWxjKHZhcigtLXJvdGF0aW9uLWRlZykgKyAzNjBkZWcpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBrZXlmcmFtZXMgdHJhbnNsYXRlIHtcclxuICAgIDAlIHtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICA4JSB7XHJcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWShjYWxjKHZhcigtLXRyYW5zbGF0ZS15KSAqIDAuOTUpKSB0cmFuc2xhdGVYKGNhbGModmFyKC0tdHJhbnNsYXRlLXgpICogKHZhcigtLXgtc3ByZWFkKSAqIDAuOSkpKTtcclxuICAgICAgb3BhY2l0eTogMTtcclxuICAgIH1cclxuXHJcbiAgICAxMiUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkodmFyKC0tdHJhbnNsYXRlLXkpKSB0cmFuc2xhdGVYKGNhbGModmFyKC0tdHJhbnNsYXRlLXgpICogKHZhcigtLXgtc3ByZWFkKSAqIDAuOTUpKSk7XHJcbiAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICB9XHJcblxyXG4gICAgMTYlIHtcclxuICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKHZhcigtLXRyYW5zbGF0ZS15KSkgdHJhbnNsYXRlWChjYWxjKHZhcigtLXRyYW5zbGF0ZS14KSAqIHZhcigtLXgtc3ByZWFkKSkpO1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoY2FsYyh2YXIoLS10cmFuc2xhdGUteSkgKyB2YXIoLS1mYWxsLWRpc3RhbmNlKSkpIHRyYW5zbGF0ZVgodmFyKC0tdHJhbnNsYXRlLXgpKTtcclxuICAgICAgb3BhY2l0eTogMDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIEBrZXlmcmFtZXMgbm8tZ3Jhdml0eS10cmFuc2xhdGUge1xyXG4gICAgMCUge1xyXG4gICAgICBvcGFjaXR5OiAxO1xyXG4gICAgfVxyXG5cclxuICAgIDEwMCUge1xyXG4gICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkodmFyKC0tdHJhbnNsYXRlLXkpKSB0cmFuc2xhdGVYKHZhcigtLXRyYW5zbGF0ZS14KSk7XHJcbiAgICAgIG9wYWNpdHk6IDA7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAuY29uZmV0dGkge1xyXG4gICAgLS10cmFuc2xhdGUteTogY2FsYygtMjAwcHggKiB2YXIoLS10cmFuc2xhdGUteS1tdWx0aXBsaWVyKSk7XHJcbiAgICAtLXRyYW5zbGF0ZS14OiBjYWxjKDIwMHB4ICogdmFyKC0tdHJhbnNsYXRlLXgtbXVsdGlwbGllcikpO1xyXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xyXG4gICAgaGVpZ2h0OiBjYWxjKHZhcigtLXNpemUpICogdmFyKC0tc2NhbGUpKTtcclxuICAgIHdpZHRoOiBjYWxjKHZhcigtLXNpemUpICogdmFyKC0tc2NhbGUpKTtcclxuICAgIGFuaW1hdGlvbjogdHJhbnNsYXRlIHZhcigtLXRyYW5zaXRpb24tZHVyYXRpb24pIHZhcigtLXRyYW5zaXRpb24tZGVsYXkpIHZhcigtLXRyYW5zaXRpb24taXRlcmF0aW9uLWNvdW50KSBsaW5lYXI7XHJcbiAgICBvcGFjaXR5OiAwO1xyXG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XHJcbiAgfVxyXG5cclxuICAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICAtLWZ1bGwtcm90YXRpb246IHZhcigtLXJvdGF0aW9uLXh5eiksIHZhcigtLXJvdGF0aW9uLWRlZyk7XHJcbiAgICBjb250ZW50OiAnJztcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvcik7XHJcbiAgICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XHJcbiAgICB0cmFuc2Zvcm06IHNrZXcodmFyKC0tc2tldykpIHJvdGF0ZTNkKHZhcigtLWZ1bGwtcm90YXRpb24pKTtcclxuICAgIGFuaW1hdGlvbjogcm90YXRlIHZhcigtLXRyYW5zaXRpb24tZHVyYXRpb24pIHZhcigtLXRyYW5zaXRpb24tZGVsYXkpIHZhcigtLXRyYW5zaXRpb24taXRlcmF0aW9uLWNvdW50KSBsaW5lYXI7XHJcbiAgfVxyXG5cclxuICAucm91bmRlZCAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgfVxyXG5cclxuICAuY29uZSAuY29uZmV0dGkge1xyXG4gICAgLS10cmFuc2xhdGUteDogY2FsYygyMDBweCAqIHZhcigtLXRyYW5zbGF0ZS15LW11bHRpcGxpZXIpICogdmFyKC0tdHJhbnNsYXRlLXgtbXVsdGlwbGllcikpO1xyXG4gIH1cclxuXHJcbiAgLm5vLWdyYXZpdHkgLmNvbmZldHRpIHtcclxuICAgIGFuaW1hdGlvbi1uYW1lOiBuby1ncmF2aXR5LXRyYW5zbGF0ZTtcclxuICAgIGFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246IGVhc2Utb3V0O1xyXG4gIH1cclxuXHJcbiAgQG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uKSB7XHJcbiAgICAuY29uZmV0dGksXHJcbiAgICAuY29uZmV0dGk6OmJlZm9yZSB7XHJcbiAgICAgIGFuaW1hdGlvbjogbm9uZTtcclxuICAgIH1cclxuICB9XHJcbjwvc3R5bGU+XHJcbiIsIjxzY3JpcHQgY29udGV4dD1cIm1vZHVsZVwiPlxuICBleHBvcnQgY29uc3QgbWFwcyA9IHtcbiAgICAnc21hbGwnOiBbXG4gICAgICAnU0ZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRicsXG4gICAgICAnRkZIRkZGRkZGRicsXG4gICAgICAnSEZGRkZIRkZGRicsXG4gICAgICAnRkZIRkZGSEZGRicsXG4gICAgICAnSEZGRkZIRkZGRicsXG4gICAgICAnRkZIRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRicsXG4gICAgICAnRkZGR0ZGRkZGRidcbiAgICBdLFxuICAgICcxNngxNic6IFtcbiAgICAgICdISEZGRkZGRkZGRkZGRkhIJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGRkZIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkdGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZISEhGRkZGSEhIRkZGJyxcbiAgICAgICdGRkZISEhISEhISEhIRkZGJyxcbiAgICAgICdGRkZGSEhISEhISEhGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRlNGRkZGRkZIJyxcbiAgICAgICdISEZGRkZGRkZGRkZGRkhIJ1xuICAgIF0sXG4gICAgJzMyeDMyJzogW1xuICAgICAgJ0hISEhISEZGRkZGRkZGRkZGRkZGRkZGSEhISEhISEhIJyxcbiAgICAgICdISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISEhISCcsXG4gICAgICAnRkZGRlNGRkZISEZGRkZGRkZGRkZGRkZGRkZGRkZGRkgnLFxuICAgICAgJ0ZGRkZGRkZGRkhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0hISEhIRkZGRkZGRkZGSEhISEhISEhGRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEhISEhISEhISEhISEhISEhISEZGRkZGRkZGRicsXG4gICAgICAnSEhISEhISEhISEhISEhISEhISEhISEZGRkZGRkZGRkYnLFxuICAgICAgJ0hIRkZISEhISEhISEhISEhGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdIRkZGRkZGRkZGRkZGSEhISEhGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRkZGRkZGSEhGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhISEhGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEhISEhGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISCcsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhISEgnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZISEhIRkZIJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhIRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkdGRkZGRkZGSEZGRkZGRkZGRicsXG4gICAgICAnRkZGRkZGRkZGRkZGRkZGRkZGRkZGSEZGRkZGRkZGRkYnLFxuICAgICAgJ0ZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkhGRkhGRkZGJyxcbiAgICAgICdGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgICAnSEZGRkZGRkZGRkZGRkZGRkZGRkZGRkZIRkZGRkZGRkYnLFxuICAgICAgJ0hISEhISEhGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGJyxcbiAgICAgICdISEhISEhISEhISEhGRkZGRkZGRkZGRkZGRkZGRkZGRicsXG4gICAgXSxcbiAgfVxuICBleHBvcnQgY29uc3QgY29sb3JzID0ge1xuICAgICdIJzogJyMxOTc2ZDInLFxuICAgICdTJzogJyNlZjlhOWEnLFxuICAgICdGJzogJyNlMWY1ZmUnLFxuICAgICdHJzogJyM4MWM3ODQnLFxuICAgICdUJzogJyNmZmUwYjInXG4gIH1cbjwvc2NyaXB0PiIsIjxzY3JpcHQ+XG4gIGltcG9ydCB7IG9uTW91bnQsIHRpY2sgfSBmcm9tICdzdmVsdGUnO1xuICBpbXBvcnQgeyB0d2VlbmVkIH0gZnJvbSBcInN2ZWx0ZS9tb3Rpb25cIjtcbiAgaW1wb3J0IHsgY3ViaWNPdXQgfSBmcm9tIFwic3ZlbHRlL2Vhc2luZ1wiO1xuICBpbXBvcnQgeyBDb25mZXR0aSB9IGZyb20gXCJzdmVsdGUtY29uZmV0dGlcIjtcbiAgaW1wb3J0IHsgbWFwcywgY29sb3JzIH0gZnJvbSBcIi4vY29uc3RhbnRzLnN2ZWx0ZVwiXG5cbiAgbGV0IGNhbnZhcztcblxuICBsZXQgc2VsZWN0ZWRNYXA7XG4gIGxldCBzZWxlY3RlZFRlYWNoZXI7XG4gIGxldCBzZWxlY3RlZFJlc2V0O1xuXG4gIHZhciByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgdmFyIGxlZnRQcmVzc2VkID0gZmFsc2U7XG4gIHZhciB1cFByZXNzZWQgPSBmYWxzZTtcbiAgdmFyIGRvd25QcmVzc2VkID0gZmFsc2U7XG5cbiAgdmFyIG1hcENoYW5nZWQgPSB0cnVlO1xuXG4gIHZhciBwb3M7ICAvLyB0aGUgcG9zaXRpb24gd2hlcmUgdGhlIHBsYXllciBpcyBkaXNwbGF5ZWRcbiAgdmFyIHJlYWxQb3M7ICAvLyB0aGUgYWN0dWFsIHBvc2l0aW9uIG9mIHRoZSBwbGF5ZXIgKGFuaW1hdGlvbnMgZG9uJ3QgY2hhbmdlIHRoaXMpXG4gIHZhciBoaXN0b3J5ID0gW107ICAvLyB0aGUgaGlzdG9yeSBvZiBwbGF5ZXIgcG9zaXRpb25zXG5cbiAgdmFyIGhhc0ludGVyYWN0ZWQgPSBmYWxzZTsgIC8vIGhhcyB0aGUgcmVhZGVyIGludGVyYWN0ZWQgd2l0aCB0aGUgZ2FtZSB5ZXQ/XG4gIHZhciBzdGF0dXNNZXNzYWdlID0gJyc7ICAvLyBkaXNwbGF5ZWQgc3RhdHVzIG1lc3NhZ2VcbiAgdmFyIHN0YXR1c1RpbWVyID0gbnVsbDsgIC8vIHRpbWVyIGlkIGZvciBjbGVhcmluZyBvbGQgdGltZXJcblxuICB2YXIgY29uZmV0dGkgPSBmYWxzZTtcblxuICB2YXIgcGl4ZWxSYXRpbzsgLy8gYWRqdXN0IGdhbWUgcmVzb2x1dGlvbiB0byBoaWdoZXIgcmVzb2x1dGlvbiBkaXNwbGF5c1xuXG4gIGNvbnN0IHJvYm90ID0gbmV3IEltYWdlKCk7XG4gIHJvYm90LnNyYyA9ICcuL2ltYWdlcy9yb2JvdC5wbmcnO1xuXG4gIGNvbnN0IHJvYm90RmxpcHBlZCA9IG5ldyBJbWFnZSgpO1xuICByb2JvdEZsaXBwZWQuc3JjID0gJy4vaW1hZ2VzL3JvYm90LWZsaXBwZWQucG5nJ1xuXG4gIHZhciBmbGlwcGVkID0gZmFsc2U7XG4gIHZhciBpbWFnZSA9IHJvYm90O1xuXG4gIG9uTW91bnQoKCkgPT4ge1xuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbztcbiAgICBjdHguc2NhbGUocGl4ZWxSYXRpbywgcGl4ZWxSYXRpbyk7XG5cbiAgICB2YXIgdGlsZVNpemU7XG4gICAgdmFyIG1hcDtcbiAgICB2YXIgc3RhcnQ7XG4gICAgdmFyIGxhc3RQb3NpdGlvbjtcbiAgICB2YXIgdGVhY2hlck1hcDtcblxuICAgIGRyYXdFbnZpcm9ubWVudCgpO1xuXG4gICAgZnVuY3Rpb24gb25lU3RlcFJlYWNoKGJhc2VNYXNrKSB7XG4gICAgICBsZXQgcm93cyA9IGJhc2VNYXNrLmxlbmd0aDtcbiAgICAgIGxldCBjb2xzID0gYmFzZU1hc2tbMF0ubGVuZ3RoO1xuXG4gICAgICBsZXQgb25lU3RlcE1hc2sgPSBuZXcgQXJyYXkocm93cykuZmlsbChmYWxzZSkubWFwKCgpID0+IG5ldyBBcnJheShjb2xzKS5maWxsKGZhbHNlKSk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd3M7IGkrKykge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGNvbHM7IGorKykge1xuICAgICAgICAgIHZhciByZXMgPSBmYWxzZTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzIHw9IGJhc2VNYXNrW2ldW2orMV1cbiAgICAgICAgICB9IGNhdGNoKGUpIHt9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlcyB8PSBiYXNlTWFza1tpKzFdW2pdXG4gICAgICAgICAgfSBjYXRjaChlKSB7fVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXMgfD0gYmFzZU1hc2tbaV1bai0xXVxuICAgICAgICAgIH0gY2F0Y2goZSkge31cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzIHw9IGJhc2VNYXNrW2ktMV1bal1cbiAgICAgICAgICB9IGNhdGNoKGUpIHt9XG5cbiAgICAgICAgICBvbmVTdGVwTWFza1tpXVtqXSA9IHJlc1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvbmVTdGVwTWFzaztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZGRUZWFjaGVyKGJhc2VNYXAsIGRpc3RhbmNlKSB7XG5cbiAgICAgIGlmIChkaXN0YW5jZSA9PSAwKSB7XG4gICAgICAgIHJldHVybiBiYXNlTWFwXG4gICAgICB9XG5cbiAgICAgIHZhciBuZXdCYXNlTWFwID0gbmV3IEFycmF5KCk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBuZXdCYXNlTWFwLnB1c2gobWFwW2ldLnNwbGl0KCcnKSlcbiAgICAgIH1cblxuICAgICAgbGV0IGJhc2VEYW5nZXJNYXNrID0gbmV3QmFzZU1hcC5tYXAoKHJvdykgPT4ge1xuICAgICAgICByZXR1cm4gcm93Lm1hcChlbGVtZW50ID0+IGVsZW1lbnQgPT0gJ0gnKVxuICAgICAgfSlcbiAgICAgIGxldCBiYXNlRW1wdHlNYXNrID0gbmV3QmFzZU1hcC5tYXAoKHJvdykgPT4ge1xuICAgICAgICByZXR1cm4gcm93Lm1hcChlbGVtZW50ID0+IGVsZW1lbnQgPT0gJ0YnKVxuICAgICAgfSlcblxuICAgICAgdmFyIHByZXZpb3VzTWFzayA9IEFycmF5LmZyb20oYmFzZURhbmdlck1hc2spO1xuICAgICAgdmFyIHJlYWNoTWFza1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXN0YW5jZTsgaSsrKSB7XG4gICAgICAgIHJlYWNoTWFzayA9IG9uZVN0ZXBSZWFjaChwcmV2aW91c01hc2spO1xuICAgICAgICBwcmV2aW91c01hc2sgPSByZWFjaE1hc2subWFwKChyb3csIGkpID0+IHtcbiAgICAgICAgICByZXR1cm4gcm93Lm1hcCgoZWxlbWVudCwgaikgPT4gZWxlbWVudCB8fCBwcmV2aW91c01hc2tbaV1bal0pXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIHZhciBuZXdNYXAgPSBBcnJheS5mcm9tKG5ld0Jhc2VNYXApO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdCYXNlTWFwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbmV3QmFzZU1hcFswXS5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGlmIChyZWFjaE1hc2tbaV1bal0gJiYgYmFzZUVtcHR5TWFza1tpXVtqXSkge1xuICAgICAgICAgICAgbmV3TWFwW2ldW2pdID0gJ1QnXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGxldCB0ZWFjaGVyTWFwID0gbmV3IEFycmF5KCk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhc2VNYXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGVhY2hlck1hcC5wdXNoKG5ld01hcFtpXS5qb2luKCcnKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0ZWFjaGVyTWFwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRyYXdFbnZpcm9ubWVudCgpIHtcbiAgICAgIG1hcCA9IG1hcHNbc2VsZWN0ZWRNYXBdXG4gICAgICB0aWxlU2l6ZSA9IGNhbnZhcy5oZWlnaHQgLyBtYXAubGVuZ3RoO1xuICAgICAgdGVhY2hlck1hcCA9IGFkZFRlYWNoZXIobWFwLCBzZWxlY3RlZFRlYWNoZXIpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG1hcFswXS5sZW5ndGg7IGorKykge1xuICAgICAgICAgIGxldCBzdGF0ZSA9IHRlYWNoZXJNYXBbaV1bal07XG5cbiAgICAgICAgICBpZiAoc3RhdGUgPT0gJ1MnKSB7XG4gICAgICAgICAgICBzdGFydCA9IFtqLCBpXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsZXQgeCA9IGogKiB0aWxlU2l6ZTtcbiAgICAgICAgICBsZXQgeSA9IGkgKiB0aWxlU2l6ZTtcblxuICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICBjdHgucmVjdCh4LCB5LCB0aWxlU2l6ZSArIDEsIHRpbGVTaXplICsgMSk7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGNvbG9yc1tzdGF0ZV07XG4gICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7IFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZnVuY3Rpb24gZHJhd0FnZW50KCkge1xuICAgICAgaWYgKGZsaXBwZWQpIHtcbiAgICAgICAgaW1hZ2UgPSByb2JvdEZsaXBwZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpbWFnZSA9IHJvYm90O1xuICAgICAgfVxuXG4gICAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAkcG9zWzBdICogdGlsZVNpemUsICRwb3NbMV0gKiB0aWxlU2l6ZSwgdGlsZVNpemUsIHRpbGVTaXplKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtb3ZlQWdlbnQobmV3UG9zKSB7XG4gICAgICBwb3Muc2V0KG5ld1Bvcyk7XG4gICAgICByZWFsUG9zID0gbmV3UG9zO1xuICAgICAgaGlzdG9yeS5wdXNoKHJlYWxQb3MpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlc2V0QWdlbnQoKSB7XG4gICAgICBoaXN0b3J5ID0gW107XG4gICAgICBtb3ZlQWdlbnQoc3RhcnQpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRyYXcoKSB7XG5cbiAgICAgIGlmIChsZWZ0UHJlc3NlZCB8fCByaWdodFByZXNzZWQgfHwgdXBQcmVzc2VkIHx8IGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGhhc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cbiAgICAgIGRyYXdFbnZpcm9ubWVudCgpO1xuXG4gICAgICBpZiAobWFwQ2hhbmdlZCkge1xuICAgICAgICBwb3MgPSB0d2VlbmVkKHN0YXJ0LCB7XG4gICAgICAgICAgZHVyYXRpb246IDE1MCxcbiAgICAgICAgICBlYXNpbmc6IGN1YmljT3V0LFxuICAgICAgICB9KTtcbiAgICAgICAgcmVzZXRBZ2VudCgpO1xuICAgICAgfVxuXG4gICAgICBkcmF3QWdlbnQoKTsgXG5cbiAgICAgIC8vIHNsaXAgd2l0aCAyMCUgcHJvYmFiaWxpdHlcbiAgICAgIGNvbnN0IHJuZCA9IE1hdGgucmFuZG9tKClcbiAgICAgIGlmIChsZWZ0UHJlc3NlZCB8fCByaWdodFByZXNzZWQpIHtcbiAgICAgICAgaWYgKHJuZCA8IDAuMSkge1xuICAgICAgICAgIGxlZnRQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgcmlnaHRQcmVzc2VkID0gZmFsc2U7XG4gICAgICAgICAgdXBQcmVzc2VkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChybmQgPCAwLjIpIHtcbiAgICAgICAgICBsZWZ0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIGRvd25QcmVzc2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAodXBQcmVzc2VkIHx8IGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGlmIChybmQgPCAwLjEpIHtcbiAgICAgICAgICB1cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIGxlZnRQcmVzc2VkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChybmQgPCAwLjIpIHtcbiAgICAgICAgICB1cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICBkb3duUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIHJpZ2h0UHJlc3NlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChybmQgPCAwLjIgJiYgKHVwUHJlc3NlZCB8fCBkb3duUHJlc3NlZCB8fCBsZWZ0UHJlc3NlZCB8fCByaWdodFByZXNzZWQpKSB7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3UganVzdCBzbGlwcGVkLicpXG4gICAgICB9XG5cbiAgICAgIGlmIChsZWZ0UHJlc3NlZCkgZmxpcHBlZCA9IHRydWU7XG4gICAgICBpZiAocmlnaHRQcmVzc2VkKSBmbGlwcGVkID0gZmFsc2U7XG5cbiAgICAgIC8vIHJlbWVtYmVyIGxhc3QgcG9zaXRpb25cbiAgICAgIGxhc3RQb3NpdGlvbiA9IEFycmF5LmZyb20ocmVhbFBvcyk7XG4gICAgICBsZXQgW3gsIHldID0gQXJyYXkuZnJvbShsYXN0UG9zaXRpb24pO1xuXG4gICAgICAvLyBjaGFuZ2UgcGxheWVyIHBvc1xuICAgICAgaWYgKHJpZ2h0UHJlc3NlZCkge1xuICAgICAgICBpZiAoeCA8IG1hcFswXS5sZW5ndGggLSAxKSB4ICs9IDFcbiAgICAgIH0gZWxzZSBpZiAobGVmdFByZXNzZWQpIHtcbiAgICAgICAgaWYgKHggPiAwKSB4IC09IDFcbiAgICAgIH0gZWxzZSBpZiAodXBQcmVzc2VkKSB7XG4gICAgICAgIGlmICh5ID4gMCkgeSAtPSAxXG4gICAgICB9IGVsc2UgaWYgKGRvd25QcmVzc2VkKSB7XG4gICAgICAgIGlmICh5IDwgbWFwLmxlbmd0aCAtIDEpIHkgKz0gMVxuICAgICAgfVxuXG4gICAgICAvLyBtb3ZlIGlmIGJ1dHRvbiBpcyBwcmVzc2VkXG4gICAgICBpZiAocmlnaHRQcmVzc2VkIHx8IGxlZnRQcmVzc2VkIHx8IGRvd25QcmVzc2VkIHx8IHVwUHJlc3NlZCkge1xuICAgICAgICBtb3ZlQWdlbnQoW3gsIHldKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gY2hlY2sgZm9yIHdpbiBhbmQgZmFpbFxuICAgICAgaWYgKG1hcFt5XVt4XSA9PSAnRycpIHtcbiAgICAgICAgY29uZmV0dGkgPSB0cnVlO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtjb25mZXR0aSA9IGZhbHNlfSwgMzAwMCk7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3Ugd29uIScpO1xuICAgICAgICByZXNldEFnZW50KCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChtYXBbeV1beF0gPT0gJ0gnKSB7XG4gICAgICAgIHNob3dNZXNzYWdlKCdZb3UgZmFpbGVkLicpO1xuICAgICAgICByZXNldEFnZW50KCk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRlYWNoZXIgaW50ZXJ2ZW50aW9uc1xuICAgICAgZWxzZSBpZiAodGVhY2hlck1hcFt5XVt4XSA9PSAnVCcpIHtcbiAgICAgICAgaWYgKHNlbGVjdGVkUmVzZXQgPT0gJ0hSJykge1xuICAgICAgICAgIC8vIGhhcmQgcmVzZXRcbiAgICAgICAgICByZXNldEFnZW50KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRSZXNldCA9PSAnQjQnKSB7XG4gICAgICAgICAgLy8gYmFjayA0IHJlc2V0XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0ICYmIGhpc3RvcnkubGVuZ3RoID4gMTsgaSsrKSB7XG4gICAgICAgICAgICBoaXN0b3J5LnBvcCgpXG4gICAgICAgICAgfVxuICAgICAgICAgIG1vdmVBZ2VudChoaXN0b3J5W2hpc3RvcnkubGVuZ3RoLTFdKTtcbiAgICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZFJlc2V0ID09ICdTUicpIHtcbiAgICAgICAgICAvLyBzb2Z0IHJlc2V0XG4gICAgICAgICAgbW92ZUFnZW50KGxhc3RQb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgc2hvd01lc3NhZ2UoJ1RoZSB0ZWFjaGVyIHNldCB5b3UgYmFjay4nKTtcbiAgICAgIH1cblxuICAgICAgbWFwQ2hhbmdlZCA9IGZhbHNlO1xuXG4gICAgICByaWdodFByZXNzZWQgPSBmYWxzZTtcbiAgICAgIGxlZnRQcmVzc2VkID0gZmFsc2U7XG4gICAgICB1cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgIGRvd25QcmVzc2VkID0gZmFsc2U7XG5cbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShkcmF3KTtcbiAgICB9XG5cbiAgICBkcmF3KCk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIG1hcENoYW5nZWRIYW5kbGVyKCkge1xuICAgIG1hcENoYW5nZWQgPSB0cnVlO1xuICB9XG4gIFxuICBmdW5jdGlvbiBrZXlEb3duSGFuZGxlcihlKSB7XG5cdFx0aWYoZS5rZXlDb2RlID09IDM5IHx8IGUua2V5ID09ICdkJykge1xuXHRcdFx0cmlnaHRQcmVzc2VkID0gdHJ1ZTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdFx0ZWxzZSBpZihlLmtleUNvZGUgPT0gMzcgfHwgZS5rZXkgPT0gJ2EnKSB7XG5cdFx0XHRsZWZ0UHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuICAgIGVsc2UgaWYoZS5rZXlDb2RlID09IDM4IHx8IGUua2V5ID09ICd3Jykge1xuICAgICAgdXBQcmVzc2VkID0gdHJ1ZTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgZWxzZSBpZihlLmtleUNvZGUgPT0gNDAgfHwgZS5rZXkgPT0gJ3MnKSB7XG4gICAgICBkb3duUHJlc3NlZCA9IHRydWU7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXHR9XG5cbiAgZnVuY3Rpb24gc2hvd01lc3NhZ2UobXNnKSB7XG4gICAgLy8gc2hvdyBhIHN0YXR1cyBtZXNzYWdlIGJlbG93IHRoZSBtYXBcbiAgICBzdGF0dXNNZXNzYWdlID0gJyc7ICAvLyBjbGVhciBzdGF0dXMgbWVzc2FnZSBhbmQgY3NzIHRyYW5zaXRpb25cbiAgICBjbGVhclRpbWVvdXQoc3RhdHVzVGltZXIpOyAgLy8gcmVzZXQgcHJldmlvdXMgc3RhdHVzIG1lc3NhZ2UgY2xlYXJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtzdGF0dXNNZXNzYWdlID0gbXNnfSwgMSkgIC8vIHdhaXQgZm9yIHN0YXR1c01lc3NhZ2UgdG8gYmUgcmVzZXRcbiAgICBzdGF0dXNUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge3N0YXR1c01lc3NhZ2UgPSAnJ30sIDIwMDApICAvLyBjbGVhciBzdGF0dXMgbWVzc2FnZSBhZnRlciBzb21lIHRpbWVcbiAgfVxuPC9zY3JpcHQ+XG5cbjxzdmVsdGU6d2luZG93IG9uOmtleWRvd249e2tleURvd25IYW5kbGVyfS8+XG5cbjxkaXYgY2xhc3M9XCJnYW1lXCI+XG5cbiAgPGRpdiBjbGFzcz1cIm1hcFwiPlxuICAgIDxjYW52YXNcbiAgICAgIGJpbmQ6dGhpcz17Y2FudmFzfVxuICAgICAgd2lkdGg9ezUwMCAqIHBpeGVsUmF0aW99XG4gICAgICBoZWlnaHQ9ezUwMCAqIHBpeGVsUmF0aW99XG4gICAgICBzdHlsZT1cIndpZHRoOiAzMDBweDsgaGVpZ2h0OiAzMDBweDtcIlxuICAgICAgb246Y2xpY2s9eygpID0+IHNob3dNZXNzYWdlKCdQcmVzcyB0aGUgYXJyb3cga2V5cyB0byBtb3ZlLi4uJyl9XG4gICAgPjwvY2FudmFzPlxuXG4gICAgPGltZyB3aWR0aD0zMDAgYWx0PVwiTGVnZW5kIGZvciB0aGUgYWJvdmUgbWluaS1nYW1lXCIgc3JjPVwiLi9pbWFnZXMvbWFwX2xlZ2VuZF9zdGFja2VkLnN2Z1wiPlxuXG4gICAgeyNpZiBjb25mZXR0aX1cbiAgICAgIDxDb25mZXR0aSBjb25lIGRlbGF5PXtbMCwgMjAwXX0gYW1vdW50PTUwIHg9e1stMC43LCAwLjddfSB5PXtbMC41LCAxLjVdfSAvPlxuICAgIHsvaWZ9XG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJjb250cm9sc1wiPlxuXG4gICAgeyNpZiBoYXNJbnRlcmFjdGVkfVxuICAgICAgPHAgY2xhc3M9XCJzdGF0dXNcIiBzdHlsZT1cInRyYW5zaXRpb246IGNvbG9yIHtzdGF0dXNNZXNzYWdlID8gMiA6IDB9czsgdHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246IGVhc2UtaW47IGNvbG9yOiB7c3RhdHVzTWVzc2FnZSA/ICd3aGl0ZScgOiAnYmxhY2snfTtcIj57c3RhdHVzTWVzc2FnZX08L3A+XG4gICAgezplbHNlfVxuICAgICAgPHAgY2xhc3M9XCJzdGF0dXNcIj5QcmVzcyB0aGUgYXJyb3cga2V5cyB0byBtb3ZlLi4uPC9wPlxuICAgIHsvaWZ9XG5cbiAgICA8ZGl2IGNsYXNzPVwibWVudVwiPlxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGZvcj1cIm1hcFwiPkNob29zZSBhIG1hcDo8L2xhYmVsPlxuICAgICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkTWFwfSBvbjpjaGFuZ2U9e21hcENoYW5nZWRIYW5kbGVyfSBuYW1lPVwibWFwXCIgaWQ9XCJtYXBcIj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwic21hbGxcIj5Gcm96ZW4gTGFrZTwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxNngxNlwiPkZyb3plbiBTbWlsZXk8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMzJ4MzJcIj5MYXJnZSBMYWtlPC9vcHRpb24+XG4gICAgICAgIDwvc2VsZWN0PlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxsYWJlbCBmb3I9XCJ0ZWFjaGVyXCI+QWRkIGEgdGVhY2hlcjo8L2xhYmVsPlxuICAgICAgICA8c2VsZWN0IGJpbmQ6dmFsdWU9e3NlbGVjdGVkVGVhY2hlcn0gbmFtZT1cInRlYWNoZXJcIiBpZD1cInRlYWNoZXJcIj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMFwiPk5vIFRlYWNoZXI8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMVwiPkRpc3RhbmNlIDE8L29wdGlvbj5cbiAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPkRpc3RhbmNlIDI8L29wdGlvbj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdj5cbiAgICAgICAgPGxhYmVsIGZvcj1cInJlc2V0XCI+UmVzZXQgc3RyYXRlZ3k6PC9sYWJlbD5cbiAgICAgICAgPHNlbGVjdCBiaW5kOnZhbHVlPXtzZWxlY3RlZFJlc2V0fSBuYW1lPVwicmVzZXRcIiBpZD1cInJlc2V0XCIgZGlzYWJsZWQ9e3NlbGVjdGVkVGVhY2hlcj09MH0+XG4gICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlNSXCI+U29mdCBSZXNldDwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJCNFwiPkJhY2sgNDwvb3B0aW9uPlxuICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJIUlwiPkhhcmQgUmVzZXQ8L29wdGlvbj5cbiAgICAgICAgPC9zZWxlY3Q+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJrZXlib2FyZFwiPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IHVwUHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTkzOzwvYnV0dG9uPlxuICAgICAgPGRpdj48L2Rpdj5cbiAgICAgIDxidXR0b24gb246Y2xpY2s9eygpID0+IGxlZnRQcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTI7PC9idXR0b24+XG4gICAgICA8YnV0dG9uIG9uOmNsaWNrPXsoKSA9PiBkb3duUHJlc3NlZCA9IHRydWV9IGNsYXNzPVwia2V5XCI+JiM4NTk1OzwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBvbjpjbGljaz17KCkgPT4gcmlnaHRQcmVzc2VkID0gdHJ1ZX0gY2xhc3M9XCJrZXlcIj4mIzg1OTQ7PC9idXR0b24+XG4gICAgPC9kaXY+XG5cbiAgPC9kaXY+XG5cbjwvZGl2PlxuXG48c3R5bGU+XG5cdGNhbnZhcyB7XG4gICAgcGFkZGluZzogMWVtXG4gIH1cblxuICAuZ2FtZSB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgcGFkZGluZy1ib3R0b206IDEuNWVtO1xuICB9XG5cbiAgLmNvbnRyb2xzIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgfVxuXG4gIC5zdGF0dXMge1xuICAgIGhlaWdodDogMWVtO1xuICAgIHdpZHRoOiAxNmVtO1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICB0cmFuc2l0aW9uOiBjb2xvciAxcztcbiAgICBwYWRkaW5nLXRvcDogMWVtO1xuICB9XG5cbiAgLm1hcCB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIH1cblxuICAubWVudSB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgcGFkZGluZzogMC41ZW07XG4gIH1cblxuICAubWVudSBkaXYge1xuICAgIG1hcmdpbjogMC4zZW07XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB9XG5cbiAgLmtleSB7XG5cdFx0YmFja2dyb3VuZC1jb2xvcjogI2VlZTtcblx0XHRib3JkZXItcmFkaXVzOiA0cHg7XG5cdFx0Zm9udC1zaXplOiAxZW07XG5cdFx0cGFkZGluZzogMC41ZW0gMC41ZW07XG5cdFx0Ym9yZGVyLXRvcDogNXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTtcblx0XHRib3JkZXItbGVmdDogNXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC41KTtcblx0XHRib3JkZXItcmlnaHQ6IDVweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMik7XG5cdFx0Ym9yZGVyLWJvdHRvbTogNXB4IHNvbGlkIHJnYmEoMCwgMCwgMCwgMC4yKTtcblx0XHRjb2xvcjogIzU1NTtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgd2lkdGg6IDRlbTtcbiAgICBoZWlnaHQ6IDRlbTtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG5cdH1cblxuICBAbWVkaWEgKG1pbi13aWR0aDogNzY4cHgpIHtcbiAgICAuZ2FtZSB7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgIH1cbiAgICAuY29udHJvbHMge1xuICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG4gICAgLm1lbnUge1xuICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICB9XG4gICAgLm1lbnUgZGl2IHtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICBnYXA6IDEwcHg7XG4gICAgfVxuICAgIC5rZXkge1xuICAgICAgd2lkdGg6IDNlbTtcbiAgICAgIGhlaWdodDogM2VtO1xuICAgIH1cbiAgfVxuXG4gIC5rZXlib2FyZCB7XG4gICAgZGlzcGxheTogZ3JpZDtcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IGF1dG8gYXV0byBhdXRvO1xuICAgIGdyaWQtZ2FwOiAwLjVlbTtcbiAgICBwYWRkaW5nOiAxZW07XG4gIH1cblxuICAua2V5OmFjdGl2ZSB7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2RkZDtcbiAgfVxuPC9zdHlsZT5cbiIsIi8vIEhvdCByZWxvYWRpbmdcbmltcG9ydCAqIGFzIF91bnVzZWQgZnJvbSBcInJhdy1sb2FkZXIhLi9pbmRleC5lanNcIjtcbi8vIFRPRE86IGRpc2FibGUgYmVmb3JlIHB1Ymxpc2hpbmdcblxuaW1wb3J0IFRyYWplY3RvcmllcyBmcm9tIFwiLi9kaWFncmFtcy90cmFqZWN0b3JpZXMuc3ZlbHRlXCI7XG5pbXBvcnQgQmFjayBmcm9tIFwiLi9kaWFncmFtcy9iYWNrLnN2ZWx0ZVwiXG5pbXBvcnQgSW5jcmVtZW50YWwgZnJvbSBcIi4vZGlhZ3JhbXMvaW5jcmVtZW50YWwuc3ZlbHRlXCJcbmltcG9ydCBHcmlkIGZyb20gXCIuL2RpYWdyYW1zL2dyaWQuc3ZlbHRlXCJcblxuLy8gbGF6aWx5IGluaXRpYWxpemUgYW55IGRpYWdyYW0gYmVsb3cgdGhlIGZvbGQuIEUuRzpcblxuY29uc3QgdHJhamVjdG9yaWVzVGFnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0cmFqZWN0b3JpZXMtdmlzdWFsaXphdGlvblwiKTtcbmxldCB0cmFqZWN0b3JpZXM7XG50cmFqZWN0b3JpZXNUYWcuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5XCIsICgpID0+IHtcblx0Y29uc3QgdGFyZ2V0ID0gdHJhamVjdG9yaWVzVGFnLnF1ZXJ5U2VsZWN0b3IoXCIjdHJhamVjdG9yaWVzLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHR0cmFqZWN0b3JpZXMgPSBuZXcgVHJhamVjdG9yaWVzKHsgdGFyZ2V0IH0pO1xufSk7XG5cbmNvbnN0IGJhY2tUYWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJhY2stdmlzdWFsaXphdGlvblwiKTtcbmxldCBiYWNrO1xuYmFja1RhZy5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlcIiwgKCkgPT4ge1xuXHRjb25zdCB0YXJnZXQgPSBiYWNrVGFnLnF1ZXJ5U2VsZWN0b3IoXCIjYmFjay12aXN1YWxpemF0aW9uLXRhcmdldFwiKTtcblx0YmFjayA9IG5ldyBCYWNrKHsgdGFyZ2V0IH0pO1xufSk7XG5cbmNvbnN0IGluY3JlbWVudGFsVGFnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbmNyZW1lbnRhbC12aXN1YWxpemF0aW9uXCIpO1xubGV0IGluY3JlbWVudGFsO1xuaW5jcmVtZW50YWxUYWcuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5XCIsICgpID0+IHtcblx0Y29uc3QgdGFyZ2V0ID0gaW5jcmVtZW50YWxUYWcucXVlcnlTZWxlY3RvcihcIiNpbmNyZW1lbnRhbC12aXN1YWxpemF0aW9uLXRhcmdldFwiKTtcblx0aW5jcmVtZW50YWwgPSBuZXcgSW5jcmVtZW50YWwoeyB0YXJnZXQgfSk7XG59KTtcblxuY29uc3QgZ3JpZFRhZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ3JpZC12aXN1YWxpemF0aW9uXCIpO1xubGV0IGdyaWQ7XG5ncmlkVGFnLmFkZEV2ZW50TGlzdGVuZXIoXCJyZWFkeVwiLCAoKSA9PiB7XG5cdGNvbnN0IHRhcmdldCA9IGdyaWRUYWcucXVlcnlTZWxlY3RvcihcIiNncmlkLXZpc3VhbGl6YXRpb24tdGFyZ2V0XCIpO1xuXHRncmlkID0gbmV3IEdyaWQoeyB0YXJnZXQgfSk7XG59KTsiXSwic291cmNlUm9vdCI6IiJ9